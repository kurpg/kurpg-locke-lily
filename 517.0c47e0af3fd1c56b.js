(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[517],{517:(de,he,fe)=>{fe(9993),Opal.modules["racc/parser"]=function(t){var G,C,v,s=[],u=t.$r(s),e=t.nil,K=t.$$$,x=t.module,T=t.klass,a=t.truthy,j=t.const_set,Y=t.defs,W=t.gvars,Z=t.rb_lt,z=t.send,J=t.to_a,g=t.rb_minus,F=t.def,O=t.to_ary,te=t.neqeq,L=t.rb_plus,c=t.eqeq,i=t.rb_ge,k=t.rb_gt,H=t.eqeqeq,Q=t.rb_le,$e=t.rb_times;return G=s,C=[x(s[0],"Racc")].concat(G),v=t.$r(C),T(C[0],v("StandardError"),"ParseError"),a(K("::","ParseError","skip_raise")?"constant":e)||j(s[0],"ParseError",K(u("Racc"),"ParseError")),function(S,G){var I,m,_,d,p,v=[x(S,"Racc")].concat(G),R=t.$r(v);return a(R("Racc_No_Extensions","skip_raise")?"constant":e)||j(v[0],"Racc_No_Extensions",!1),I=v,_=[m=T(v[0],null,"Parser")].concat(I),d=t.$r(_),(p=m.$$prototype).yydebug=p.racc_debug_out=p.racc_error_status=p.racc_t=p.racc_vstack=p.racc_val=p.racc_state=p.racc_tstack=e,j(_[0],"Racc_Runtime_Version","1.4.6"),j(_[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),j(_[0],"Racc_Runtime_Core_Version_R","1.4.6"),j(_[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),j(_[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),j(_[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),j(_[0],"Racc_Runtime_Core_Version",d("Racc_Runtime_Core_Version_R")),j(_[0],"Racc_Runtime_Core_Revision",d("Racc_Runtime_Core_Revision_R")),j(_[0],"Racc_Runtime_Type","ruby"),Y(d("Parser"),"$racc_runtime_type",function(){return d("Racc_Runtime_Type")},0),F(m,"$_racc_setup",function(){var $,b,r=this,y=e,n=e,w=e;return null==W.stderr&&(W.stderr=e),a(K(r.$class(),"Racc_debug_parser"))||(r.yydebug=!1),a(null!=($=r.yydebug)&&$!==e?"instance-variable":e)||(r.yydebug=!1),a(r.yydebug)&&(a(null!=(b=r.racc_debug_out)&&b!==e?"instance-variable":e)||(r.racc_debug_out=W.stderr),r.racc_debug_out=a(y=r.racc_debug_out)?y:W.stderr),n=K(r.$class(),"Racc_arg"),a(Z(n.$size(),14))&&(z(n,"[]=",J(w=[13,!0])),g(w.length,1)),n},0),F(m,"$_racc_init_sysvars",function(){var $=this;return $.racc_state=[0],$.racc_tstack=[],$.racc_vstack=[],$.racc_t=e,$.racc_val=e,$.racc_read_next=!0,$.racc_user_yyerror=!1,$.racc_error_status=0},0),F(m,"$do_parse",function(){return this.$__send__(d("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),F(m,"$next_token",function(){return this.$raise(d("NotImplementedError"),this.$class()+"#next_token is not defined")},0),F(m,"$_racc_do_parse_rb",function($,b){var r,n=this,w=e,B=e,N=e,D=e,A=e,o=e,U=e,V=e;return r=O($),w=null==r[0]?e:r[0],B=null==r[1]?e:r[1],N=null==r[2]?e:r[2],D=null==r[3]?e:r[3],A=null==r[10]?e:r[10],n.$_racc_init_sysvars(),o=U=V=e,z(n,"catch",["racc_end_parse"],function M(){var re,ie,P=null==M.$$s?this:M.$$s,se=e;for(null==P.racc_state&&(P.racc_state=e),null==P.racc_read_next&&(P.racc_read_next=e),null==P.racc_t&&(P.racc_t=e),null==P.yydebug&&(P.yydebug=e),null==P.racc_val&&(P.racc_val=e);a(!0);)for(a(V=D["$[]"](P.racc_state["$[]"](-1)))?(a(P.racc_read_next)&&te(P.racc_t,0)&&(ie=P.$next_token(),re=O(ie),o=null==re[0]?e:re[0],P.racc_val=null==re[1]?e:re[1],P.racc_t=a(o)?a(se=A["$[]"](o))?se:1:0,a(P.yydebug)&&P.$racc_read_token(P.racc_t,o,P.racc_val),P.racc_read_next=!1),V=L(V,P.racc_t),a(i(V,0))&&a(U=w["$[]"](V))&&c(B["$[]"](V),P.racc_state["$[]"](-1))||(U=N["$[]"](P.racc_state["$[]"](-1)))):U=N["$[]"](P.racc_state["$[]"](-1));a(U=P.$_racc_evalact(U,$)););},{$$arity:0,$$s:n})},2),F(m,"$yyparse",function($,b){return this.$__send__(d("Racc_YY_Parse_Method"),$,b,this.$_racc_setup(),!0)},2),F(m,"$_racc_yyparse_rb",function($,b,r,y){var n,B=this,N=e,D=e,l=e,A=e,U=e,V=e,M=e;return n=O(r),N=null==n[0]?e:n[0],D=null==n[1]?e:n[1],l=null==n[2]?e:n[2],A=null==n[3]?e:n[3],U=null==n[10]?e:n[10],B.$_racc_init_sysvars(),V=e,M=e,z(B,"catch",["racc_end_parse"],function ne(){var P=null==ne.$$s?this:ne.$$s;for(null==P.racc_state&&(P.racc_state=e);!a(M=A["$[]"](P.racc_state["$[]"](-1)));)for(;a(V=P.$_racc_evalact(l["$[]"](P.racc_state["$[]"](-1)),r)););return z($,"__send__",[b],function se(ae,oe){var ee=null==se.$$s?this:se.$$s,_e=e,le=e;for(null==ee.racc_t&&(ee.racc_t=e),null==ee.racc_state&&(ee.racc_state=e),null==ee.racc_read_next&&(ee.racc_read_next=e),null==ae&&(ae=e),null==oe&&(oe=e),ee.racc_t=a(ae)?a(_e=U["$[]"](ae))?_e:1:0,ee.racc_val=oe,ee.racc_read_next=!1,M=L(M,ee.racc_t),a(i(M,0))&&a(V=N["$[]"](M))&&c(D["$[]"](M),ee.racc_state["$[]"](-1))||(V=l["$[]"](ee.racc_state["$[]"](-1)));a(V=ee.$_racc_evalact(V,r)););for(;a(a(_e=a(le=(M=A["$[]"](ee.racc_state["$[]"](-1)))["$!"]())?le:ee.racc_read_next["$!"]())?_e:ee.racc_t["$=="](0));)for(a(M)&&a(M=L(M,ee.racc_t))&&a(i(M,0))&&a(V=N["$[]"](M))&&c(D["$[]"](M),ee.racc_state["$[]"](-1))||(V=l["$[]"](ee.racc_state["$[]"](-1)));a(V=ee.$_racc_evalact(V,r)););},{$$arity:2,$$s:P})},{$$arity:0,$$s:B})},4),F(m,"$_racc_evalact",function($,b){var r,l,n=this,w=e,B=e,D=e,A=e,o=e,U=e,V=e;if(w=null==(r=O(b))[0]?e:r[0],B=null==r[1]?e:r[1],D=null==r[3]?e:r[3],l=null==r[11]?e:r[11],A=null==r[12]?e:r[12],a(k($,0))&&a(Z($,l)))a(k(n.racc_error_status,0))&&(c(n.racc_t,1)||(n.racc_error_status=g(n.racc_error_status,1))),n.racc_vstack.$push(n.racc_val),n.racc_state.$push($),n.racc_read_next=!0,a(n.yydebug)&&(n.racc_tstack.$push(n.racc_t),n.$racc_shift(n.racc_t,n.racc_tstack,n.racc_vstack));else if(a(Z($,0))&&a(k($,A["$-@"]()))){if(o=z(n,"catch",["racc_jump"],function M(){var ne=null==M.$$s?this:M.$$s;return null==ne.racc_state&&(ne.racc_state=e),ne.racc_state.$push(ne.$_racc_do_reduce(b,$)),!1},{$$arity:0,$$s:n}),a(o)){if(H(1,U=o))return n.racc_user_yyerror=!0,A["$-@"]();if(H(2,U))return l;n.$raise("[Racc Bug] unknown jump code")}}else if(c($,l))a(n.yydebug)&&n.$racc_accept(),n.$throw("racc_end_parse",n.racc_vstack["$[]"](0));else{if(c($,A["$-@"]())){for(H(0,U=n.racc_error_status)?a(b["$[]"](21))||n.$on_error(n.racc_t,n.racc_val,n.racc_vstack):H(3,U)&&(c(n.racc_t,0)&&n.$throw("racc_end_parse",e),n.racc_read_next=!0),n.racc_user_yyerror=!1,n.racc_error_status=3;a(!0)&&!(a(V=D["$[]"](n.racc_state["$[]"](-1)))&&(V=L(V,1),a(i(V,0))&&a($=w["$[]"](V))&&c(B["$[]"](V),n.racc_state["$[]"](-1))));)a(Q(n.racc_state.$size(),1))&&n.$throw("racc_end_parse",e),n.racc_state.$pop(),n.racc_vstack.$pop(),a(n.yydebug)&&(n.racc_tstack.$pop(),n.$racc_e_pop(n.racc_state,n.racc_tstack,n.racc_vstack));return $}n.$raise("[Racc Bug] unknown action "+$.$inspect())}return a(n.yydebug)&&n.$racc_next_state(n.racc_state["$[]"](-1),n.racc_state),e},2),F(m,"$_racc_do_reduce",function($,b){var r,A,U,P,se,ae,ee,n=this,B=e,N=e,D=e,l=e,o=e,V=e,M=e,ne=e,re=e,ie=e,oe=e,ce=e,ue=e,_e=e;return B=null==(r=O($))[4]?e:r[4],N=null==r[5]?e:r[5],D=null==r[6]?e:r[6],l=null==r[7]?e:r[7],A=null==r[8]?e:r[8],o=null==r[9]?e:r[9],U=null==r[13]?e:r[13],V=n.racc_state,M=n.racc_vstack,ne=n.racc_tstack,re=$e(b,-3),ie=o["$[]"](re),P=o["$[]"](L(re,1)),se=o["$[]"](L(re,2)),ae=[],a(n.yydebug)&&(oe=ne["$[]"](ie["$-@"](),ie)),ce=M["$[]"](ie["$-@"](),ie),a(n.yydebug)&&(ue=[ie["$-@"](),ie,ae],z(ne,"[]=",J(ue)),g(ue.length,1)),ue=[ie["$-@"](),ie,ae],z(M,"[]=",J(ue)),g(ue.length,1),ue=[ie["$-@"](),ie,ae],z(V,"[]=",J(ue)),g(ue.length,1),a(U)?M.$push(n.$__send__(se,ce,M,ce["$[]"](0))):M.$push(n.$__send__(se,ce,M)),ne.$push(P),a(n.yydebug)&&n.$racc_reduce(oe,P,ne,M),ee=g(P,A),a(re=l["$[]"](ee))&&(re=L(re,V["$[]"](-1)),a(i(re,0))&&a(_e=B["$[]"](re))&&c(N["$[]"](re),ee))?_e:D["$[]"](ee)},2),F(m,"$on_error",function($,b,r){var n,y=this;return y.$raise(d("ParseError"),y.$sprintf("\nparse error on value %s (%s)",b.$inspect(),a(n=y.$token_to_str($))?n:"?"))},3),F(m,"$yyerror",function(){return this.$throw("racc_jump",1)},0),F(m,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),F(m,"$yyerrok",function(){return this.racc_error_status=0},0),F(m,"$racc_read_token",function($,b,r){var y=this;return y.racc_debug_out.$print("read    "),y.racc_debug_out.$print(b.$inspect(),"(",y.$racc_token2str($),") "),y.racc_debug_out.$puts(r.$inspect()),y.racc_debug_out.$puts()},3),F(m,"$racc_shift",function($,b,r){var y=this;return y.racc_debug_out.$puts("shift   "+y.$racc_token2str($)),y.$racc_print_stacks(b,r),y.racc_debug_out.$puts()},3),F(m,"$racc_reduce",function($,b,r,y){var n=this,w=e;return(w=n.racc_debug_out).$print("reduce "),a($["$empty?"]())?w.$print(" <none>"):z($,"each",[],function B(N){return null==N&&(N=e),w.$print(" ",(null==B.$$s?this:B.$$s).$racc_token2str(N))},{$$arity:1,$$s:n}),w.$puts(" --\x3e "+n.$racc_token2str(b)),n.$racc_print_stacks(r,y),n.racc_debug_out.$puts()},4),F(m,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),F(m,"$racc_e_pop",function($,b,r){var y=this;return y.racc_debug_out.$puts("error recovering mode: pop token"),y.$racc_print_states($),y.$racc_print_stacks(b,r),y.racc_debug_out.$puts()},3),F(m,"$racc_next_state",function($,b){var r=this;return r.racc_debug_out.$puts("goto    "+$),r.$racc_print_states(b),r.racc_debug_out.$puts()},2),F(m,"$racc_print_stacks",function($,b){var y=e;return(y=this.racc_debug_out).$print("        ["),z($,"each_index",[],function n(w){return null==w&&(w=e),y.$print(" (",(null==n.$$s?this:n.$$s).$racc_token2str($["$[]"](w))," ",b["$[]"](w).$inspect(),")")},{$$arity:1,$$s:this}),y.$puts(" ]")},2),F(m,"$racc_print_states",function($){var r=e;return(r=this.racc_debug_out).$print("        ["),z($,"each",[],function(n){return null==n&&(n=e),r.$print(" ",n)},1),r.$puts(" ]")},1),F(m,"$racc_token2str",function($){var r;return a(r=K(this.$class(),"Racc_token_to_s_table")["$[]"]($))?r:this.$raise("[Racc Bug] can't convert token "+$+" to string")},1),F(m,"$token_to_str",function($){return K(this.$class(),"Racc_token_to_s_table")["$[]"]($)},1)}(s[0],s)},Opal.modules.strscan=function(t){var J,g,F,O,te,X=[],s=t.nil,e=t.def,K=t.truthy,x=t.eqeqeq,T=t.Opal,a=t.send,j=t.to_a,Y=t.rb_minus,W=t.alias;return J=X,F=[g=(0,t.klass)(X[0],null,"StringScanner")].concat(J),O=t.$r(F),(te=g.$$prototype).pos=te.string=te.working=te.matched=te.prev_pos=te.match=s,g.$attr_reader("pos","matched"),e(g,"$initialize",function(c){var i=this;return i.string=c,i.pos=0,i.matched=s,i.working=c,i.match=[]},1),g.$attr_reader("string"),e(g,"$beginning_of_line?",function(){var c=this;return 0===c.pos||"\n"===c.string.charAt(c.pos-1)},0),e(g,"$scan",function(c){var i=this,k=(c=i.$anchor(c)).exec(i.working);return null==k?i.matched=s:"object"==typeof k?(i.prev_pos=i.pos,i.pos+=k[0].length,i.working=i.working.substring(k[0].length),i.matched=k[0],i.match=k,k[0]):"string"==typeof k?(i.pos+=k.length,i.working=i.working.substring(k.length),k):s},1),e(g,"$scan_until",function(c){var i=this;c=i.$anchor(c);for(var Q,k=i.pos,H=i.working;;){if(Q=c.exec(H),k+=1,H=H.substr(1),null!=Q)return i.matched=i.string.substr(i.pos,k-i.pos-1+Q[0].length),i.match=Q,i.prev_pos=k-1,i.pos=k,i.working=H.substr(Q[0].length),i.matched;if(0===H.length)return i.match=[],i.matched=s}},1),e(g,"$[]",function(c){var k;if(K(this.match["$empty?"]()))return s;x(O("Symbol"),k=c)?c=c.$to_s():x(O("String"),k)||(c=T["$coerce_to!"](c,O("Integer"),"to_int"));var H=this.match;return c<0&&(c+=H.length),c<0||c>=H.length||null==H[c]?s:H[c]},1),e(g,"$check",function(c){var i=this,k=(c=i.$anchor(c)).exec(i.working);return i.matched=null==k?s:k[0]},1),e(g,"$check_until",function(c){var i=this,k=i.prev_pos,H=i.pos,Q=i.$scan_until(c);return Q!==s&&(i.matched=Q.substr(-1),i.working=i.string.substr(H)),i.prev_pos=k,i.pos=H,Q},1),e(g,"$peek",function(c){return this.working.substring(0,c)},1),e(g,"$eos?",function(){return 0===this.working.length},0),e(g,"$exist?",function(c){var k=c.exec(this.working);return null==k?s:0==k.index?0:k.index+1},1),e(g,"$skip",function(c){var i=this,k=(c=i.$anchor(c)).exec(i.working);if(null==k)return i.match=[],i.matched=s;var H=k[0],Q=H.length;return i.matched=H,i.match=k,i.prev_pos=i.pos,i.pos+=Q,i.working=i.working.substring(Q),Q},1),e(g,"$skip_until",function(c){var k=this.$scan_until(c);return k===s?s:(this.matched=k.substr(-1),k.length)},1),e(g,"$get_byte",function(){var c=this,i=s;return c.pos<c.string.length?(c.prev_pos=c.pos,c.pos+=1,i=c.matched=c.working.substring(0,1),c.working=c.working.substring(1)):c.matched=s,i},0),e(g,"$match?",function(c){var i=this,k=(c=i.$anchor(c)).exec(i.working);return null==k?s:(i.prev_pos=i.pos,k[0].length)},1),e(g,"$pos=",function(c){var i=this;return c<0&&(c+=i.string.$length()),i.pos=c,i.working=i.string.slice(c)},1),e(g,"$matched_size",function(){return this.matched===s?s:this.matched.length},0),e(g,"$post_match",function(){var c=this;return c.matched===s?s:c.string.substr(c.pos)},0),e(g,"$pre_match",function(){var c=this;return c.matched===s?s:c.string.substr(0,c.prev_pos)},0),e(g,"$reset",function(){var c=this;return c.working=c.string,c.matched=s,c.pos=0},0),e(g,"$rest",function(){return this.working},0),e(g,"$rest?",function(){return 0!==this.working.length},0),e(g,"$rest_size",function(){return this.$rest().$size()},0),e(g,"$terminate",function(){var i,c=this;return c.match=s,i=[c.string.$length()],a(c,"pos=",j(i)),i[Y(i.length,1)]},0),e(g,"$unscan",function(){var c=this;return c.pos=c.prev_pos,c.prev_pos=s,c.match=s,c},0),W(g,"bol?","beginning_of_line?"),W(g,"getch","get_byte"),g.$private(),e(g,"$anchor",function(c){var i=c.toString().match(/\/([^\/]+)$/);return i=i?i[1]:void 0,new RegExp("^(?:"+c.source+")",i)},1)},Opal.modules["bcdice/normalize"]=function(t){var a,Z,Y,X=[],s=t.nil,u=t.module,e=t.eqeqeq,K=t.def,x=t.eqeq;return a=X,Y=[u(X[0],"BCDice")].concat(a),(Z=u(Y[0],"Normalize")).$module_function(),K(Z,"$comparison_operator",function(J){var g;return e(/<=|=</,g=J)?"<=":e(/>=|=>/,g)?">=":e(/<>|!=|=!/,g)?"!=":e(/</,g)?"<":e(/>/,g)?">":e(/=/,g)?"==":s},1),K(Z,"$target_number",function(J){return x(J,"?")?J:J.$to_i()},1)},Opal.modules["bcdice/common_command/lexer"]=function(t){var W,g,c,i,k,H,O,z,X=t.top,s=[],u=t.nil,e=t.module,K=t.klass,x=t.const_set,T=t.hash2,a=t.truthy,j=t.def;return X.$require("strscan"),X.$require("bcdice/normalize"),W=s,g=z=[e(s[0],"BCDice")].concat(W),c=O=[e(z[0],"CommonCommand")].concat(g),k=[i=K(O[0],null,"Lexer")].concat(c),H=t.$r(k),i.$$prototype.scanner=u,x(k[0],"SYMBOLS",T(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),j(i,"$initialize",function(S){var q;return S=a(q=S.$split(" ",2).$first())?q:"",this.scanner=H("StringScanner").$new(S)},1),j(i,"$next_token",function(){var S=this,G=u,q=u,C=u,R=u;return a(S.scanner["$eos?"]())?[!1,"$"]:a(G=S.scanner.$scan(/\d+/))?["NUMBER",G.$to_i()]:a(q=S.scanner.$scan(/[<>!=]+/))?["CMP_OP",H("Normalize").$comparison_operator(q)]:(C=S.scanner.$getch().$upcase(),[a(R=H("SYMBOLS")["$[]"](C))?R:C.$to_sym(),C])},0),j(i,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/common_command/reroll_dice/node"]=function(t){var L,H,G,R,_,d,p,f,$,h,C,$e,i,X=[],s=t.nil,u=t.module,e=t.klass,K=t.hash2,x=t.def,T=t.truthy,a=t.send,j=t.rb_lt,Y=t.rb_plus,W=t.rb_gt,Z=t.eqeq,z=t.to_a,J=t.rb_minus,g=t.eqeqeq,F=t.rb_le,O=t.rb_ge;return L=X,H=i=[u(X[0],"BCDice")].concat(L),G=$e=[u(i[0],"CommonCommand")].concat(H),R=C=[u($e[0],"RerollDice")].concat(G),_=h=[u(C[0],"Node")].concat(R),p=[d=e(h[0],null,"Command")].concat(_),f=t.$r(p),($=d.$$prototype).cmp_op=$.reroll_cmp_op=$.target_number_node=$.reroll_threshold_node=$.notations=$.source=s,x(d,"$initialize",function(r){var y,n,w,B,N,D,l,A=this;if(null==r)r=K([],{});else if(!r.$$is_hash)throw t.ArgumentError.$new("expected kwargs");if(!t.hasOwnProperty.call(r.$$smap,"secret"))throw t.ArgumentError.$new("missing keyword: secret");if(y=r.$$smap.secret,!t.hasOwnProperty.call(r.$$smap,"notations"))throw t.ArgumentError.$new("missing keyword: notations");if(n=r.$$smap.notations,!t.hasOwnProperty.call(r.$$smap,"source"))throw t.ArgumentError.$new("missing keyword: source");return w=r.$$smap.source,null==(B=r.$$smap.cmp_op)&&(B=s),null==(N=r.$$smap.target_number)&&(N=s),null==(D=r.$$smap.reroll_cmp_op)&&(D=s),null==(l=r.$$smap.reroll_threshold)&&(l=s),A.secret=y,A.notations=n,A.cmp_op=B,A.target_number_node=N,A.reroll_cmp_op=D,A.reroll_threshold_node=l,A.source=w},1),x(d,"$eval",function(r,y){var n,w,N,D,A,U,V,ne,B=this,l=s,o=s,M=s,re=s,ie=s,P=s,se=s,ae=s;return N=r.$round_type(),D=T(l=B.cmp_op)?l:r.$default_cmp_op(),A=T(l=T(o=B.reroll_cmp_op)?o:D)?l:">=",U=T(l=(n=B.target_number_node)===s||null==n?s:a(n,"eval",[N]))?l:r.$default_target_number(),V=T(l=T(o=(w=B.reroll_threshold_node)===s||null==w?s:a(w,"eval",[N]))?o:r.$reroll_dice_reroll_threshold())?l:U,M=f("RerollCondition").$new(A,V),ne=a(B.notations,"map",[],function(ce){return null==ce&&(ce=s),ce.$to_dice(N)},1),T(a(ne,"all?",[],function(ce){return null==ce&&(ce=s),M["$valid?"](ce.$sides())},1))?(ie=(re=B.$roll(ne,y,M,r["$sort_barabara_dice?"]())).$flatten(),P=re.$take(B.notations.$size()).$flatten().$count(1),se=T(D)?a(ie,"count",[],function(ce){return null==ce&&(ce=s),ce.$send(D,U)},1):0,ae=[B.$expr(N,M,D,U),a(re,"map",[],function(ce){return null==ce&&(ce=s),ce.$join(",")},1).$join(" + "),"\u6210\u529f\u6570"+se,r.$grich_text(P,ie.$size(),se)].$compact(),B.$result_with_text(ae.$join(" \uff1e "))):B.$result_with_text(B.source+" \uff1e \u6761\u4ef6\u304c\u9593\u9055\u3063\u3066\u3044\u307e\u3059\u30022R6>=5 \u3042\u308b\u3044\u306f 2R6[5] \u306e\u3088\u3046\u306b\u632f\u308a\u8db3\u3057\u76ee\u6a19\u5024\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002")},2),d.$private(),x(d,"$roll",function(r,y,n,w){var N=s,D=s,l=s,A=s,o=s,U=s;for(N=[],D=0;T(T(l=r["$empty?"]()["$!"]())?j(D,f("REROLL_LIMIT")):l);)A=r.$shift(),D=Y(D,1),o=A.$roll(y),T(w)&&o["$sort!"](),N.$push(o),U=a(o,"count",[],function(M){return null==M&&(M=s),n["$reroll?"](M)},1),T(W(U,0))&&r.$push(f("Dice").$new(U,A.$sides()));return N},4),x(d,"$expr",function(r,y,n,w){var N,D,l;return N=a(this.notations,"map",[],function(o){return null==o&&(o=s),o.$to_dice(r)},1).$join("+"),D=Z(y.$cmp_op(),n)?"":f("Format").$comparison_operator(y.$cmp_op()),l=f("Format").$comparison_operator(n),"("+N+"["+D+y.$threshold()+"]"+l+w+")"},4),x(d,"$result_with_text",function(r){return a(f("Result").$new(),"tap",[],function n(w){var B=null==n.$$s?this:n.$$s,N=s;return null==B.secret&&(B.secret=s),null==w&&(w=s),a(w,"secret=",z(N=[B.secret])),J(N.length,1),a(w,"text=",z(N=[r])),N[J(N.length,1)]},{$$arity:1,$$s:this})},1),function(I,m){var _=e(I,null,"RerollCondition"),d=_.$$prototype;d.threshold=d.cmp_op=s,_.$attr_reader("cmp_op"),_.$attr_reader("threshold"),x(_,"$initialize",function(f,$){return this.cmp_op=f,this.threshold=$},2),x(_,"$valid?",function(f){var $=this,b=s;return!!T($.threshold)&&(g("<=",b=$.cmp_op)?j($.threshold,f):g("<",b)?F($.threshold,f):g(">=",b)?W($.threshold,1):g(">",b)?O($.threshold,1):!g("!=",b)||t.Range.$new(1,f,!1)["$include?"]($.threshold))},1),x(_,"$reroll?",function(f){return f.$send(this.cmp_op,this.threshold)},1)}(h[0]),function(I,m,_){var d=e(I,null,"Notation"),p=[d].concat(_),f=t.$r(p),$=d.$$prototype;$.times=$.sides=s,x(d,"$initialize",function(r,y){return this.times=r,this.sides=y},2),x(d,"$to_dice",function(r){var n,w;return n=this.times.$eval(r),w=this.sides.$eval(r),f("Dice").$new(n,w)},1)}(h[0],0,h),function(I,m){var _=e(I,null,"Dice");return _.$attr_reader("times","sides"),x(_,"$initialize",function(p,f){return this.times=p,this.sides=f},2),x(_,"$roll",function(p){return p.$roll_barabara(this.$times(),this.$sides())},1),x(_,"$to_s",function(){return this.$times()+"R"+this.$sides()},0)}(h[0])},Opal.modules["bcdice/arithmetic/node"]=function(t){var F,c,Q,v,R,S,G,k,te,X=[],s=t.nil,u=t.$$$,e=t.module,K=t.klass,x=t.def,T=t.send2,a=t.find_super,j=t.eqeq,Y=t.const_set,W=t.eqeqeq,Z=t.rb_divide,z=t.truthy,J=t.alias;return F=X,c=te=[e(X[0],"BCDice")].concat(F),Q=k=[e(te[0],"Arithmetic")].concat(c),S=[e(k[0],"Node")].concat(Q),G=t.$r(S),(R=(v=K(S[0],null,"BinaryOp")).$$prototype).lhs=R.rhs=R.op=s,x(v,"$initialize",function(h,I,m){var _=this;return _.lhs=h,_.op=I,_.rhs=m},3),x(v,"$eval",function(h){var _,I=this,m=s;return m=I.lhs.$eval(h),_=I.rhs.$eval(h),m.$send(I.op,_)},1),x(v,"$output",function(){var h=this;return""+h.lhs.$output()+h.op+h.rhs.$output()},0),x(v,"$s_exp",function(){var h=this;return"("+h.$op_for_s_exp()+" "+h.lhs.$s_exp()+" "+h.rhs.$s_exp()+")"},0),x(v,"$op_for_s_exp",function(){return this.op},0),function(q,C,v){var R=K(q,C,"DivideBase"),E=[R].concat(v),h=t.$r(E),I=R.$$prototype;I.lhs=I.rhs=I.op=s,x(R,"$initialize",function m(_,d){return delete m.$$p,T(this,a(this,"initialize",m,!1,!0),"initialize",[_,"/",d],null)},2),x(R,"$eval",function(_){var p,f,d=this;return p=d.lhs.$eval(_),f=d.rhs.$eval(_),j(f,0)&&d.$raise(h("ZeroDivisionError")),d.$divide_and_round(p,f,_)},1),x(R,"$output",function m(){var _=m.$$p||s,d=this;return delete m.$$p,""+T(d,a(d,"output",m,!1,!0),"output",[],_)+d.$rounding_method()},0),R.$private(),x(R,"$rounding_method",function(){return u(this.$class(),"ROUNDING_METHOD")},0),x(R,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),x(R,"$divide_and_round",function(_,d,p){return this.$raise(h("NotImplementedError"))},3)}(S[0],G("BinaryOp"),S),function(q,C,v){var R=K(q,C,"DivideWithGameSystemDefault"),E=[R].concat(v),h=t.$r(E);Y(E[0],"ROUNDING_METHOD",""),R.$private(),x(R,"$divide_and_round",function(m,_,d){var p,f=s;return W(u(h("RoundType"),"CEIL"),p=d)?Z(m.$to_f(),_).$ceil():W(u(h("RoundType"),"ROUND"),p)?(f=Z(m.$to_f(),_),z(f["$negative?"]())?f.$abs().$round()["$-@"]():f.$round()):Z(m,_).$floor()},3)}(S[0],G("DivideBase"),S),function(q,C,v){var R=K(q,C,"DivideWithCeil"),E=[R].concat(v);Y(E[0],"ROUNDING_METHOD","C"),R.$private(),x(R,"$divide_and_round",function(I,m,_){return Z(I.$to_f(),m).$ceil()},3)}(S[0],G("DivideBase"),S),function(q,C,v){var R=K(q,C,"DivideWithRound"),E=[R].concat(v);Y(E[0],"ROUNDING_METHOD","R"),R.$private(),x(R,"$divide_and_round",function(I,m,_){var d=s;return d=Z(I.$to_f(),m),z(d["$negative?"]())?d.$abs().$round()["$-@"]():d.$round()},3)}(S[0],G("DivideBase"),S),function(q,C,v){var R=K(q,C,"DivideWithFloor"),E=[R].concat(v);Y(E[0],"ROUNDING_METHOD","F"),R.$private(),x(R,"$divide_and_round",function(I,m,_){return Z(I,m).$floor()},3)}(S[0],G("DivideBase"),S),function(q,C){var v=K(q,null,"Negative");v.$$prototype.body=s,x(v,"$initialize",function(h){return this.body=h},1),x(v,"$eval",function(h){return this.body.$eval(h)["$-@"]()},1),x(v,"$output",function(){return"-"+this.body.$output()},0),x(v,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(S[0]),function(q,C){var v=K(q,null,"Parenthesis");v.$$prototype.expr=s,x(v,"$initialize",function(h){return this.expr=h},1),x(v,"$eval",function(h){return this.expr.$eval(h)},1),x(v,"$output",function(){return"("+this.expr.$output()+")"},0),x(v,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(S[0]),function(q,C){var v=K(q,null,"Number");return v.$$prototype.value=s,x(v,"$initialize",function(h){return this.value=h},1),x(v,"$eval",function(h){return this.value},1),x(v,"$output",function(){return this.value.$to_s()},0),J(v,"s_exp","output")}(S[0])},Opal.modules["bcdice/common_command/barabara_dice/parser"]=function(t){var g,L,H,C,h,I,m,_,d,p,f,$,b,n,v,R,E,$e,S,i,O,X=t.top,s=[],u=t.nil,e=t.$$$,K=t.module,x=t.klass,T=t.defs,a=t.def,j=t.hash,Y=t.const_set,W=t.hash2,Z=t.to_ary,z=t.truthy;return X.$require("racc/parser.rb"),X.$require("bcdice/common_command/lexer"),X.$require("bcdice/common_command/reroll_dice/node"),X.$require("bcdice/arithmetic/node"),g=s,L=O=[K(s[0],"BCDice")].concat(g),H=i=[K(O[0],"CommonCommand")].concat(L),$e=[K(i[0],"BarabaraDice")].concat(H),S=t.$r($e),C=$e,R=[v=x($e[0],e(S("Racc"),"Parser"),"Parser")].concat(C),E=t.$r(R),v.$$prototype.lexer=u,T(v,"$parse",function(l){return this.$new().$parse(l)},1),a(v,"$parse",function(l){try{return this.lexer=E("Lexer").$new(l),this.$do_parse()}catch(o){if(!t.rescue(o,[E("ParseError")]))throw o;try{return u}finally{t.pop_exception()}}},1),v.$private(),a(v,"$next_token",function(){return this.lexer.$next_token()},0),h=[13,9,3,9,24,25,9,9,9,26,18,19,8,12,8,18,19,8,8,8,9,4,9,38,36,37,39,18,19,18,19,8,9,8,9,27,28,24,25,18,19,18,19,8,9,8,9,27,28,27,28,18,19,18,19,8,10,8,14],I=[5,2,0,8,15,15,13,14,12,15,8,8,2,5,8,12,12,13,14,12,18,1,19,34,34,34,34,18,18,19,19,18,24,19,25,16,16,21,21,24,24,25,25,24,27,25,28,31,31,32,32,27,27,28,28,27,4,28,7],m=[-6,21,-1,u,56,-9,u,55,1,u,u,u,6,4,5,-5,24,u,18,20,u,28,u,u,30,32,u,42,44,u,u,36,38,u,19,u,u,u,u,u],_=[-2,-25,-25,-3,-25,-4,-7,-25,-25,-24,40,-1,-25,-25,-25,-25,-11,-14,-25,-25,-22,-5,-6,-8,-25,-25,-23,-25,-25,-20,-21,-9,-10,-12,-15,-13,-16,-17,-18,-19],d=[7,1,6,15,2,29,30,21,31,32,5,7,23,22,33,34,11,35],p=[7,1,6,5,2,9,9,5,8,8,3,7,7,6,9,9,4,10],f=[u,1,4,8,11,-5,0,-2,-16,-13,-17],$=[u,u,u,u,u,u,u,20,16,17,u],b=[0,0,"racc_error",3,24,"_reduce_1",0,25,"_reduce_2",1,25,"_reduce_3",0,27,"_reduce_4",2,27,"_reduce_5",3,26,"_reduce_6",1,26,"_reduce_7",3,29,"_reduce_8",3,28,"_reduce_9",3,28,"_reduce_10",1,28,"_reduce_none",3,31,"_reduce_12",4,31,"_reduce_13",1,31,"_reduce_none",0,33,"_reduce_15",1,33,"_reduce_16",1,33,"_reduce_17",1,33,"_reduce_18",1,33,"_reduce_19",2,32,"_reduce_20",2,32,"_reduce_21",1,32,"_reduce_none",3,30,"_reduce_23",1,30,"_reduce_24"],n=j(!1,0,"error",1,"NUMBER",2,"B",3,"R",4,"U",5,"C",6,"F",7,"S",8,"PLUS",9,"MINUS",10,"ASTERISK",11,"SLASH",12,"PARENL",13,"PARENR",14,"BRACKETL",15,"BRACKETR",16,"LESS",17,"GREATER",18,"EQUAL",19,"NOT",20,"AT",21,"CMP_OP",22),Y(R[0],"Racc_arg",[h,I,_,m,d,p,$,f,23,b,n,40,25,!0]),Y(R[0],"Racc_token_to_s_table",["$end","error","NUMBER","B","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","LESS","GREATER","EQUAL","NOT","AT","CMP_OP","$start","expr","secret","notations","target","add","dice","term","mul","unary","round_type"]),Y(R[0],"Racc_debug_parser",!1),a(v,"$_reduce_1",function(l,A,o){return e(E("Node"),"Command").$new(W(["secret","notations","cmp_op","target_number"],{secret:l["$[]"](0),notations:l["$[]"](1),cmp_op:l["$[]"](2)["$[]"]("cmp_op"),target_number:l["$[]"](2)["$[]"]("target")}))},3),a(v,"$_reduce_2",function(l,A,o){return!1},3),a(v,"$_reduce_3",function(l,A,o){return!0},3),a(v,"$_reduce_4",function(l,A,o){return W([],{})},3),a(v,"$_reduce_5",function(l,A,o){var U,ne,re;return re=null==(U=Z(l))[1]?u:U[1],z(ne=null==U[0]?u:U[0])||this.$raise(E("ParseError")),W(["cmp_op","target"],{cmp_op:ne,target:re})},3),a(v,"$_reduce_6",function(l,A,o){var U=u;return(U=l["$[]"](0)).$push(l["$[]"](2)),U},3),a(v,"$_reduce_7",function(l,A,o){return[l["$[]"](0)]},3),a(v,"$_reduce_8",function(l,A,o){var U,V;return U=l["$[]"](0),V=l["$[]"](2),e(E("Node"),"Notation").$new(U,V)},3),a(v,"$_reduce_9",function(l,A,o){return e(e(E("Arithmetic"),"Node"),"BinaryOp").$new(l["$[]"](0),"+",l["$[]"](2))},3),a(v,"$_reduce_10",function(l,A,o){return e(e(E("Arithmetic"),"Node"),"BinaryOp").$new(l["$[]"](0),"-",l["$[]"](2))},3),a(v,"$_reduce_12",function(l,A,o){return e(e(E("Arithmetic"),"Node"),"BinaryOp").$new(l["$[]"](0),"*",l["$[]"](2))},3),a(v,"$_reduce_13",function(l,A,o){return l["$[]"](3).$new(l["$[]"](0),l["$[]"](2))},3),a(v,"$_reduce_15",function(l,A,o){return e(e(E("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),a(v,"$_reduce_16",function(l,A,o){return e(e(E("Arithmetic"),"Node"),"DivideWithCeil")},3),a(v,"$_reduce_17",function(l,A,o){return e(e(E("Arithmetic"),"Node"),"DivideWithCeil")},3),a(v,"$_reduce_18",function(l,A,o){return e(e(E("Arithmetic"),"Node"),"DivideWithRound")},3),a(v,"$_reduce_19",function(l,A,o){return e(e(E("Arithmetic"),"Node"),"DivideWithFloor")},3),a(v,"$_reduce_20",function(l,A,o){return l["$[]"](1)},3),a(v,"$_reduce_21",function(l,A,o){return e(e(E("Arithmetic"),"Node"),"Negative").$new(l["$[]"](1))},3),a(v,"$_reduce_23",function(l,A,o){return l["$[]"](1)},3),a(v,"$_reduce_24",function(l,A,o){return e(e(E("Arithmetic"),"Node"),"Number").$new(l["$[]"](0))},3),a(v,"$_reduce_none",function(l,A,o){return l["$[]"](0)},3)},Opal.modules["bcdice/common_command/barabara_dice"]=function(t){var j,z,O,c,k,H,te,L,g,W,s=[],u=t.nil,e=t.module,K=t.const_set,x=t.send,T=t.def;return t.top.$require("bcdice/common_command/barabara_dice/parser"),j=s,z=W=[e(s[0],"BCDice")].concat(j),O=g=[e(W[0],"CommonCommand")].concat(z),K((L=[te=e(g[0],"BarabaraDice")].concat(O))[0],"PREFIX_PATTERN",/\d+B\d+/.$freeze()),k=[c=t.get_singleton_class(te)].concat(L),H=t.$r(k),T(c,"$eval",function($e,S,G){var q;return(q=H("Parser").$parse($e))===u||null==q?u:x(q,"eval",[S,G])},3)},Opal.modules["bcdice/dice_table/table"]=function(t){var W,g,c,i,k,H,Q,O,z,X=[],s=t.nil,u=t.module,e=t.klass,K=t.hash2,x=t.defs,T=t.truthy,a=t.def,j=t.rb_minus;return W=X,g=z=[u(X[0],"BCDice")].concat(W),c=O=[u(z[0],"DiceTable")].concat(g),k=[i=e(O[0],null,"Table")].concat(c),H=t.$r(k),(Q=i.$$prototype).times=Q.sides=Q.name=Q.items=s,x(i,"$from_i18n",function(S,G){var C=s;return C=H("I18n").$t(S,K(["locale"],{locale:G})),this.$new(C["$[]"]("name"),C["$[]"]("type"),C["$[]"]("items"))},2),a(i,"$initialize",function(S,G,q){var C=this,v=s;return C.name=S,C.items=q.$freeze(),v=/(\d+)D(\d+)/i.$match(G),T(v)||C.$raise(H("ArgumentError"),"Unexpected table type: "+G),C.times=v["$[]"](1).$to_i(),C.sides=v["$[]"](2).$to_i()},3),a(i,"$roll",function(S){var q,G=this;return q=S.$roll_sum(G.times,G.sides),G.$choice(q)},1),a(i,"$choice",function(S){var q,G=this;return q=j(S,G.times),H("RollResult").$new(G.name,S,G.items["$[]"](q))},1)},Opal.queue(function(t){var c,Q,v,R,E,h,S,G,k,X=t.top,s=[],u=t.nil,e=t.$$$,K=t.module,x=t.klass,T=t.const_set,a=t.send2,j=t.find_super,Y=t.def,W=t.regexp,Z=t.hash2,z=t.truthy,J=t.eqeqeq,g=t.send,F=t.rb_gt,O=t.rb_ge,te=t.rb_plus;return X.$require("bcdice/common_command/barabara_dice"),X.$require("bcdice/dice_table/table"),c=s,Q=k=[K(s[0],"BCDice")].concat(c),S=[K(k[0],"GameSystem")].concat(Q),G=t.$r(S),v=S,E=[R=x(S[0],G("Base"),"NinjaSlayer")].concat(v),h=t.$r(E),R.$$prototype.randomizer=u,T(E[0],"ID","NinjaSlayer"),T(E[0],"NAME","\u30cb\u30f3\u30b8\u30e3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG"),T(E[0],"SORT_KEY","\u306b\u3093\u3057\u3084\u3059\u308c\u3044\u3084\u3042RPG"),T(E[0],"HELP_MESSAGE","\u30fb\u901a\u5e38\u5224\u5b9a\u3000NJ\n\u3000NJx[y] or NJx@y or NJx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 \u7701\u7565\u6642\u306fNORMAL(4)\n\u3000\u4f8b:NJ4@H \u96e3\u6613\u5ea6HARD\u3001\u5224\u5b9a\u30c0\u30a4\u30b94\u3067\u5224\u5b9a\n\u30fb\u56de\u907f\u5224\u5b9a\u3000EV\n\u3000EVx[y]/z or EVx@y/z or EVx/z or EVx[y] or EVx@y or EVx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 z=\u653b\u6483\u5074\u306e\u6210\u529f\u6570(\u7701\u7565\u53ef) \u96e3\u6613\u5ea6\u3092\u7701\u7565\u6642\u306fNORMAL(4)\n\u3000\u653b\u6483\u5074\u306e\u6210\u529f\u6570\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\u3001\u30ab\u30a6\u30f3\u30bf\u30fc\u30ab\u30e9\u30c6\u767a\u751f\u6642\u306b\u306f\u8868\u793a\n\u3000\u4f8b:EV5/3 \u96e3\u6613\u5ea6NORMAL(\u7701\u7565\u6642)\u3001\u5224\u5b9a\u30c0\u30a4\u30b95\u3001\u653b\u6483\u5074\u306e\u6210\u529f\u65703\u3067\u5224\u5b9a\n\u30fb\u8fd1\u63a5\u653b\u6483\u3000AT\n\u3000ATx[y] or ATx@y or ATx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 \u7701\u7565\u6642\u306fNORMAL(4) \u30b5\u30c4\u30d0\u30c4\uff01\u767a\u751f\u6642\u306b\u306f\u8868\u793a\n\u3000\u4f8b:AT6[H] \u96e3\u6613\u5ea6HARD,\u5224\u5b9a\u30c0\u30a4\u30b95\u3067\u8fd1\u63a5\u653b\u6483\u306e\u5224\u5b9a\n\u30fb\u30b5\u30c4\u30d0\u30c4\u5224\u5b9a\u3000SB\n\u30fb\u96fb\u5b50\u6226\u3000EL\n\u3000ELx[y] or ELx@y or ELx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 \u7701\u7565\u6642\u306fNORMAL(4)\n\u3000\u4f8b:EL6[H] \u96e3\u6613\u5ea6HARD,\u5224\u5b9a\u30c0\u30a4\u30b95\u3067\u96fb\u5b50\u6226\u306e\u5224\u5b9a\n\n\u30fb\u96e3\u6613\u5ea6\n\u3000KIDS=K,EASY=E,NORMAL=N,HARD=H,ULTRA HARD=UH \u6570\u5b57\u306b\u3082\u5bfe\u5fdc\n"),Y(R,"$initialize",function m(_){var p=this;return delete m.$$p,a(p,j(p,"initialize",m,!1,!0),"initialize",[_],null),p.default_cmp_op=">=",p.default_target_number=4},1),T(E[0],"DIFFICULTY_VALUE_RE","UH|[2-6KENH]".$freeze()),T(E[0],"DIFFICULTY_RE",("(\\[("+h("DIFFICULTY_VALUE_RE")+")\\]|@("+h("DIFFICULTY_VALUE_RE")+"))").$freeze()),T(E[0],"NJ_RE",W(["^(S)?NJ(\\d+)",h("DIFFICULTY_RE"),"?$"],"i").$freeze()),T(E[0],"EV_RE",W(["^EV(\\d+)",h("DIFFICULTY_RE"),"?(?:/(\\d+))?$"],"i").$freeze()),T(E[0],"AT_RE",W(["^AT(\\d+)",h("DIFFICULTY_RE"),"?$"],"i").$freeze()),T(E[0],"EL_RE",W(["^EL(\\d+)",h("DIFFICULTY_RE"),"?$"],"i").$freeze()),T(E[0],"EV",h("Struct").$new("num","difficulty","targetValue")),T(E[0],"AT",h("Struct").$new("num","difficulty")),T(E[0],"EL",h("Struct").$new("num","difficulty")),T(E[0],"DIFFICULTY_SYMBOL_TO_INTEGER",Z(["K","E","N","H","UH"],{K:2,E:3,N:4,H:5,UH:6}).$freeze()),Y(R,"$change_text",function(_){var p=u,f=u,$=u;return p=h("NJ_RE").$match(_),z(p)?(f=this.$bRollCommand(p["$[]"](2),this.$integerValueOfDifficulty(z($=p["$[]"](4))?$:p["$[]"](5))),""+p["$[]"](1)+f):_},1),Y(R,"$eval_game_system_specific_command",function(_){var d=this,p=u,f=u,$=u;return d.$debug("eval_game_system_specific_command begin string",_),z(p=h("TABLES")["$[]"](_))?p.$roll(d.$randomizer()):J(h("EV"),f=$=d.$parse(_))?d.$executeEV($):J(h("AT"),f)?d.$executeAT($):J(h("EL"),f)?d.$executeEL($):u},1),R.$private(),Y(R,"$parse",function(_){var p,d=this;return J(h("EV_RE"),p=_)?d.$parseEV(h("Regexp").$last_match()):J(h("AT_RE"),p)?d.$parseAT(h("Regexp").$last_match()):J(h("EL_RE"),p)?d.$parseEL(h("Regexp").$last_match()):u},1),Y(R,"$parseEV",function(_){var d,f,$,b,r;return f=_["$[]"](1).$to_i(),$=this.$integerValueOfDifficulty(z(b=_["$[]"](3))?b:_["$[]"](4)),r=(d=_["$[]"](5))===u||null==d?u:g(d,"to_i",[]),h("EV").$new(f,$,r)},1),Y(R,"$parseAT",function(_){var p,f,$;return p=_["$[]"](1).$to_i(),f=this.$integerValueOfDifficulty(z($=_["$[]"](3))?$:_["$[]"](4)),h("AT").$new(p,f)},1),Y(R,"$parseEL",function(_){var p,f,$;return p=_["$[]"](1).$to_i(),f=this.$integerValueOfDifficulty(z($=_["$[]"](3))?$:_["$[]"](4)),h("EL").$new(p,f)},1),Y(R,"$executeEV",function(_){var p,d=this,f=u,$=u;return p=d.$bRollCommand(_.$num(),_.$difficulty()),$=[(f=e(e(h("BCDice"),"CommonCommand"),"BarabaraDice").$eval(p,d,d.randomizer)).$text()],z(_.$targetValue())&&z(F(f.$success_num(),_.$targetValue()))&&$.$push("\u30ab\u30a6\u30f3\u30bf\u30fc\u30ab\u30e9\u30c6!!"),$.$join(" \uff1e ")},1),Y(R,"$executeAT",function(_){var p,$,d=this,f=u,b=u;return p=d.$bRollCommand(_.$num(),_.$difficulty()),$=(f=e(e(h("BCDice"),"CommonCommand"),"BarabaraDice").$eval(p,d,d.randomizer)).$last_dice_list().$count(6),b=[f.$text()],z(O($,2))&&b.$push("\u30b5\u30c4\u30d0\u30c4!!"),b.$join(" \uff1e ")},1),Y(R,"$executeEL",function(_){var p,b,r,d=this,f=u,$=u;return p=d.$bRollCommand(_.$num(),_.$difficulty()),b=($=(f=e(e(h("BCDice"),"CommonCommand"),"BarabaraDice").$eval(p,d,d.randomizer)).$last_dice_list()).$count(6),r=g($,"count",[],function(n){return null==n&&(n=u),O(n,_.$difficulty())},1),z(O(b,1))?[f.$text()+" + "+b,te(r,b)].$join(" \uff1e "):f.$text()},1),Y(R,"$integerValueOfDifficulty",function(_){return z(_)?z(/^[2-6]$/.$match(_))?_.$to_i():h("DIFFICULTY_SYMBOL_TO_INTEGER").$fetch(_.$upcase()):4},1),Y(R,"$bRollCommand",function(_,d){return _+"B6>="+d},2),T(E[0],"SATSUBATSU_TABLE",["\u300c\u6b7b\u306d\u30fc\u30c3\uff01\u300d\u8179\u90e8\u306b\u5f37\u70c8\u306a\u4e00\u6483\uff01\u3000\u6575\u306f\u304f\u306e\u5b57\u306b\u6298\u308c\u66f2\u304c\u308a\u3001\u30ef\u30a4\u30e4\u30fc\u30a2\u30af\u30b7\u30e7\u30f3\u3081\u3044\u3066\u5439\u3063\u98db\u3093\u3060\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8+1\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u6575\u306f\u5f8c\u65b9\u306e\u58c1\u307e\u305f\u306f\u969c\u5bb3\u7269\u306b\u5411\u304b\u3063\u3066\u3001\u4f55\u30de\u30b9\u3067\u3082\u307e\u3063\u3059\u3050\u5f3e\u304d\u98db\u3070\u3055\u308c\u308b\uff08\u4ed6\u306e\u30ad\u30e3\u30e9\u306e\u3044\u308b\u30de\u30b9\u306f\u901a\u904e\u3059\u308b\uff09\u3002\u58c1\u307e\u305f\u306f\u969c\u5bb3\u7269\u306b\u63a5\u89e6\u3057\u305f\u6642\u70b9\u3067\u3001\u6575\u306f\u3055\u3089\u306b1\u30c0\u30e1\u30fc\u30b8\u3092\u53d7\u3051\u308b\u3002\u6575\u306f\u3053\u306e\u6fc0\u7a81\u30c0\u30e1\u30fc\u30b8\u306b\u5bfe\u3057\u3066\u6539\u3081\u3066\u300e\u56de\u907f\u5224\u5b9a\u300f\u3092\u884c\u3063\u3066\u3082\u826f\u3044\u3002","\u300c\u30a4\u30e4\u30fc\u30c3\uff01\u300d\u982d\u90e8\u3078\u306e\u75db\u70c8\u306a\u30ab\u30e9\u30c6\uff01\u3000\u773c\u7403\u7834\u58ca\u3082\u3057\u304f\u306f\u6fc0\u3057\u3044\u8133\u9707\u76ea\u304c\u6575\u3092\u8972\u3046\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u3055\u3089\u306b\u6575\u306e\u3010\u30cb\u30e5\u30fc\u30ed\u30f3\u3011\u3068\u3010\u30ef\u30b6\u30de\u30a8\u3011\u304c\u305d\u308c\u305e\u308c1\u305a\u3064\u6e1b\u5c11\u3059\u308b\uff08\u3053\u308c\u306b\u3088\u308b\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u82e6\u3057\u307f\u629c\u3044\u3066\u6b7b\u306c\u304c\u3044\u3044\u300d\u6025\u6240\u3092\u60c5\u3051\u5bb9\u8d66\u306a\u304f\u7834\u58ca\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8+1\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u8010\u3048\u96e3\u3044\u82e6\u75db\u306b\u3088\u308a\u3001\u6575\u306f\u3010\u7cbe\u795e\u529b\u3011\u304c-2\u3055\u308c\u3001\u3010\u30cb\u30e5\u30fc\u30ed\u30f3\u3011\u304c1\u6e1b\u5c11\u3059\u308b\uff08\u3053\u308c\u306b\u3088\u308b\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u9003\u3052\u3089\u308c\u308b\u3082\u306e\u306a\u3089\u9003\u3052\u3066\u307f\u3088\u300d\u6575\u306e\u811a\u3092\u7c89\u7815\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u3055\u3089\u306b\u6575\u306e\u3010\u811a\u529b\u3011\u304cD3\u6e1b\u5c11\u3059\u308b\uff08\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u3053\u308c\u3067\u624b\u3082\u8db3\u3082\u51fa\u307e\u3044\uff01\u300d\u6575\u306e\u4e21\u8155\u3092\u5207\u308a\u98db\u3070\u3057\u305f\uff01\u3000\u9bae\u8840\u304c\u30b9\u30d7\u30ea\u30f3\u30af\u30e9\u30fc\u3081\u3044\u3066\u5674\u304d\u51fa\u3059\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8+1\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u3055\u3089\u306b\u6575\u306e\u3010\u30ef\u30b6\u30de\u30a8\u3011\u3068\u3010\u30ab\u30e9\u30c6\u3011\u304c\u305d\u308c\u305e\u308c2\u6e1b\u5c11\u3059\u308b\uff08\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u30a4\u30a4\u30a4\u30e4\u30a2\u30a2\u30a2\u30a2\u30fc\u30fc\u30fc\u30fc\u30c3\uff01\u300d\u30e4\u30ea\u3081\u3044\u305f\u30c1\u30e7\u30c3\u30d7\u304c\u6575\u306e\u80f8\u3092\u8cab\u901a\uff01\u3000\u3055\u3089\u306b\u5fc3\u81d3\u3092\u63b4\u307f\u53d6\u308a\u3001\u63e1\u308a\u3064\u3076\u3057\u305f\uff01\u3000\u30ca\u30e0\u30a2\u30df\u30c0\u30d6\u30c4\uff01\uff1a\u6575\u306f\u6b8b\u308a\u3010\u4f53\u529b\u3011\u306b\u95a2\u4fc2\u306a\u304f\u5373\u6b7b\u3059\u308b\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD6\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD6\u4e0a\u6607\u3059\u308b\u3002"].$freeze()),T(E[0],"TABLES",Z(["SB"],{SB:e(h("DiceTable"),"Table").$new("\u30b5\u30c4\u30d0\u30c4\u8868","1D6",h("SATSUBATSU_TABLE"))}).$freeze()),R.$register_prefix("NJ","EV","AT","EL",h("TABLES").$keys())})}}]);