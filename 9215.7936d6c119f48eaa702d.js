(self.webpackChunkudonarium_lily=self.webpackChunkudonarium_lily||[]).push([[9215],{9215:function(Xe,Je,Ze){Ze(4656),Opal.modules["bcdice/arithmetic_evaluator"]=function(e){var H,M,w,x,L,Z,l,q,X=[],P=e.nil,r=e.$$$,y=e.$$,$=e.module,K=e.hash2,c=e.truthy;return H=X,M=q=[$(X[0],"BCDice")].concat(H),l=[Z=$(q[0],"ArithmeticEvaluator")].concat(M),w=e.get_singleton_class(Z),L=[w].concat(l),void e.def(w,"$eval",x=function(Y,U){var v,h=P;if(null==U)U=K([],{});else if(!U.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(v=U.$$smap.round_type)&&(v=r(y(L,"RoundType"),"FLOOR")),c(Y)&&c(h=y(L,"Arithmetic").$eval(Y,v))?h:0},x.$$arity=-2)},Opal.modules["i18n/backend/fallbacks"]=function(e){function j(q,n){return"number"==typeof q&&"number"==typeof n?q-n:q["$-"](n)}var n,l,L,x,Q,M,Z,P=[],r=e.nil,y=e.$$$,$=e.$$,K=e.module,c=e.truthy,W=e.send,H=e.send2,t=e.hash2;return n=P,Z=[M=K(P[0],"I18n")].concat(n),e.class_variable_set(Z[0],"@@fallbacks",r),l=e.get_singleton_class(M),Q=[l].concat(Z),e.def(l,"$fallbacks",L=function(){var Y,a,v;return e.class_variable_set(Q[1],"@@fallbacks",c(v=null==(Y=Q[1].$$cvars["@@fallbacks"])?r:Y)?v:y(y($(Q,"I18n"),"Locale"),"Fallbacks").$new()),c(a=$(Q,"Thread").$current()["$[]"]("i18n_fallbacks"))?a:null==(Y=Q[1].$$cvars["@@fallbacks"])?r:Y},L.$$arity=0),e.def(l,"$fallbacks=",x=function(Y){var U,a;return e.class_variable_set(Q[1],"@@fallbacks",c(Y["$is_a?"]($(Q,"Array")))?y(y($(Q,"I18n"),"Locale"),"Fallbacks").$new(Y):Y),a=["i18n_fallbacks",null==(U=Q[1].$$cvars["@@fallbacks"])?r:U],W($(Q,"Thread").$current(),"[]=",e.to_a(a)),a[j(a.length,1)]},x.$$arity=1),void function(l,w){var L=[K(l,"Backend")].concat(w);!function(x,ee){var v,a,h,s,Y=K(x,"Fallbacks"),U=[Y].concat(ee);e.def(Y,"$translate",v=function(N,o,u){try{var R,F=v.$$p,C=this,g=r,b=r,A=r,p=r,T=r,_=r;for(F&&(v.$$p=null),T=0,_=arguments.length,p=new Array(_);T<_;T++)p[T]=arguments[T];return null==u&&(u=$(U,"EMPTY_HASH")),!c(u.$fetch("fallback",!0))||c(u["$[]"]("fallback_in_progress"))?H(C,e.find_super_dispatcher(C,"translate",v,!1,!0),"translate",p,F):(c(u["$[]"]("default"))&&(g=C["$extract_non_symbol_default!"](u)),b=u.$merge(t(["fallback_in_progress"],{fallback_in_progress:!0})),W($(U,"I18n").$fallbacks()["$[]"](N),"each",[],((R=function(k){var E,S=null==R.$$s?this:R.$$s;null==k&&(k=r);try{return W(S,"catch",["exception"],((E=function(){var ve=null==E.$$s?this:E.$$s,ge=r;if(ge=H(ve,e.find_iter_super_dispatcher(ve,"translate",E.$$def||R.$$def||v,!1,!1),"translate",[k,o,b],null),c(ge["$nil?"]()))return r;c(N.$to_s()["$!="](k.$to_s()))&&ve.$on_fallback(N,k,o,u),e.ret(ge)}).$$s=S,E.$$arity=0,E))}catch(ce){if(!e.rescue(ce,[y($(U,"I18n"),"InvalidLocale")]))throw ce;try{return r}finally{e.pop_exception()}}}).$$s=C,R.$$arity=1,R)),c(c(A=u["$key?"]("default"))?u["$[]"]("default")["$nil?"]():A)?r:c(g)?H(C,e.find_super_dispatcher(C,"translate",v,!1,!0),"translate",[N,r,u.$merge(t(["default"],{default:g}))],null):C.$throw("exception",y($(U,"I18n"),"MissingTranslation").$new(N,o,u)))}catch(m){if(m===e.returner)return m.$v;throw m}},v.$$arity=-3),e.def(Y,"$extract_non_symbol_default!",a=function(N){var o,F,R=r,J=r;return R=[N["$[]"]("default")].$flatten(),F=W(R,"detect",[],((o=function(g){return null==g&&(g=r),g["$is_a?"]($(U,"Symbol"))["$!"]()}).$$s=this,o.$$arity=1,o)),c(F)&&(J=["default",R["$[]"](0,R.$index(F))],W(N,"[]=",e.to_a(J)),j(J.length,1)),F},a.$$arity=1),e.def(Y,"$exists?",h=function(N,o,u){try{var R,F=h.$$p,C=this,g=r,b=r,A=r;for(F&&(h.$$p=null),b=0,A=arguments.length,g=new Array(A);b<A;b++)g[b]=arguments[b];return null==u&&(u=$(U,"EMPTY_HASH")),c(u.$fetch("fallback",!0))?(W($(U,"I18n").$fallbacks()["$[]"](N),"each",[],((R=function(T){var _=null==R.$$s?this:R.$$s;null==T&&(T=r);try{if(!c(H(_,e.find_iter_super_dispatcher(_,"exists?",R.$$def||h,!1,!1),"exists?",[T,o],null)))return r;e.ret(!0)}catch(m){if(!e.rescue(m,[y($(U,"I18n"),"InvalidLocale")]))throw m;try{return r}finally{e.pop_exception()}}}).$$s=C,R.$$arity=1,R)),!1):H(C,e.find_super_dispatcher(C,"exists?",h,!1,!0),"exists?",g,F)}catch(p){if(p===e.returner)return p.$v;throw p}},h.$$arity=-3),Y.$private(),e.def(Y,"$on_fallback",s=function(N,o,u,R){return r},s.$$arity=4)}(L[0],L)}(Z[0],Z)},Opal.modules["bcdice/randomizer"]=function(e){function j(l,w){return"number"==typeof l&&"number"==typeof w?l>w:l["$>"](w)}function X(l,w){return"number"==typeof l&&"number"==typeof w?l+w:l["$+"](w)}function P(l,w){return"number"==typeof l&&"number"==typeof w?l<=w:l["$<="](w)}function r(l,w){return"number"==typeof l&&"number"==typeof w?l-w:l["$-"](w)}function y(l,w){return"number"==typeof l&&"number"==typeof w?l*w:l["$*"](w)}var w,Y,a,h,s,f,N,o,u,R,F,J,C,U,v,L,c=[],W=e.nil,H=e.$$$,t=e.$$,n=e.klass,M=e.truthy,Z=e.send;return w=c,Y=L=[(0,e.module)(c[0],"BCDice")].concat(w),U=n(L[0],null,"Randomizer"),v=[U].concat(Y),U.$$prototype.rand_results=U.$$prototype.detailed_rand_results=W,e.const_set(v[0],"UPPER_LIMIT_DICE_TIMES",200),e.const_set(v[0],"UPPER_LIMIT_DICE_SIDES",1e3),e.const_set(v[0],"UPPER_LIMIT_RANDS",1e4),e.def(U,"$initialize",a=function(){return this.rand_results=[],this.detailed_rand_results=[]},a.$$arity=0),U.$attr_reader("rand_results"),U.$attr_reader("detailed_rand_results"),e.const_set(v[0],"DetailedRandResult",t(v,"Struct").$new("kind","sides","value")),e.def(U,"$roll_barabara",h=function(b,A){var p,_,T=this;return M(j(X(T.rand_results.$size(),b),t(v,"UPPER_LIMIT_RANDS")))&&T.$raise(t(v,"TooManyRandsError")),M(M(_=P(b,0))?_:j(b,t(v,"UPPER_LIMIT_DICE_TIMES")))?[]:Z(t(v,"Array"),"new",[b],((p=function(){return(null==p.$$s?this:p.$$s).$roll_once(A)}).$$s=T,p.$$arity=0,p))},h.$$arity=2),e.def(U,"$roll_sum",s=function(b,A){return this.$roll_barabara(b,A).$sum()},s.$$arity=2),e.def(U,"$roll_once",f=function(b){var p,T=W;return M(M(p=P(b,0))?p:j(b,t(v,"UPPER_LIMIT_DICE_SIDES")))?0:(T=this.$rand_inner(b),this.$push_to_detail("normal",b,T),T)},f.$$arity=1),e.def(U,"$roll_index",N=function(b){return r(this.$roll_once(b),1)},N.$$arity=1),e.def(U,"$roll_tens_d10",o=function(){var p,A=W;return(A=this.$rand_inner(10))["$=="](10)&&(A=0),p=y(A,10),this.$push_to_detail("tens_d10",10,p),p},o.$$arity=0),e.def(U,"$roll_d9",u=function(){var A;return A=r(this.$rand_inner(10),1),this.$push_to_detail("d9",10,A),A},u.$$arity=0),e.def(U,"$roll_d66",R=function(b){var A,_,T=W;return T=Z(t(v,"Array"),"new",[2],((A=function(){return(null==A.$$s?this:A.$$s).$roll_once(6)}).$$s=this,A.$$arity=0,A)),_=b,H(t(v,"D66SortType"),"ASC")["$==="](_)?T["$sort!"]():H(t(v,"D66SortType"),"DESC")["$==="](_)&&T["$sort!"]()["$reverse!"](),X(y(T["$[]"](0),10),T["$[]"](1))},R.$$arity=1),U.$private(),e.def(U,"$rand_inner",F=function(b){var p,A=this;return M(function(l,w){return"number"==typeof l&&"number"==typeof w?l>=w:l["$>="](w)}(A.rand_results.$size(),t(v,"UPPER_LIMIT_RANDS")))&&A.$raise(t(v,"TooManyRandsError")),p=A.$random(b),A.rand_results["$<<"]([p,b]),p},F.$$arity=1),e.def(U,"$random",J=function(b){return X(t(v,"Kernel").$rand(b),1)},J.$$arity=1),e.def(U,"$push_to_detail",C=function(b,A,p){var _;return _=t(v,"DetailedRandResult").$new(b,A,p),this.detailed_rand_results.$push(_)},C.$$arity=3),void function(x,ee,Y){[n(x,ee,"TooManyRandsError")].concat(Y)}(L[0],t(L,"StandardError"),L)},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var H,M,L,Y,U,v,a,x,ee,l,q,X=[],P=e.nil,y=e.$$,$=e.module,K=e.klass,c=e.truthy;return H=X,M=q=[$(X[0],"BCDice")].concat(H),L=l=[$(q[0],"DiceTable")].concat(M),x=K(l[0],null,"RollResult"),ee=[x].concat(L),x.$$prototype.table_name=x.$$prototype.value=x.$$prototype.body=P,e.def(x,"$initialize",Y=function(s,f,N){var o=this;return o.table_name=s,o.value=f,o.body=N},Y.$$arity=3),x.$attr_reader("table_name"),x.$attr_reader("value"),x.$attr_reader("body"),e.def(x,"$to_s",U=function(){var s=this;return s.table_name+"("+s.value+") \uff1e "+s.body},U.$$arity=0),e.def(x,"$last_body",v=function(){var s=this;return c(s.body["$is_a?"](y(ee,"RollResult")))?s.body.$last_body():s.body},v.$$arity=0),void e.def(x,"$empty?",a=function(){return!1},a.$$arity=0)},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var t,Z,x,U,v,ee,Y,w,n,P=[],r=e.nil,$=e.$$,K=e.module,c=e.klass,W=e.truthy;return t=P,Z=n=[K(P[0],"BCDice")].concat(t),x=w=[K(n[0],"DiceTable")].concat(Z),ee=c(w[0],null,"ChainTable"),Y=[ee].concat(x),ee.$$prototype.times=ee.$$prototype.sides=ee.$$prototype.items=ee.$$prototype.name=r,e.def(ee,"$initialize",U=function(h,s,f){var N=this,o=r;return N.name=h,N.items=f.$freeze(),o=/(\d+)D(\d+)/i.$match(s),W(o)||N.$raise($(Y,"ArgumentError"),"Unexpected table type: "+s),N.times=o["$[]"](1).$to_i(),N.sides=o["$[]"](2).$to_i()},U.$$arity=3),void e.def(ee,"$roll",v=function(h){var f,N,s=this,o=r;return N=function(H,t){return"number"==typeof H&&"number"==typeof t?H-t:H["$-"](t)}(f=h.$roll_sum(s.times,s.sides),s.times),o=s.items["$[]"](N),W(o["$respond_to?"]("roll"))&&(o=o.$roll(h)),$(Y,"RollResult").$new(s.name,f,o)},v.$$arity=1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){function P(q,n){return"number"==typeof q&&"number"==typeof n?q-n:q["$-"](n)}var n,w,Y,a,h,s,U,v,L,Z,y=[],$=e.nil,c=e.$$,W=e.module,H=e.klass,t=e.hash2;return n=y,w=Z=[W(y[0],"BCDice")].concat(n),Y=L=[W(Z[0],"DiceTable")].concat(w),U=H(L[0],null,"D66GridTable"),v=[U].concat(Y),U.$$prototype.name=U.$$prototype.items=$,e.defs(U,"$from_i18n",a=function(N,o){var R=$;return R=c(v,"I18n").$t(N,t(["locale","raise"],{locale:o,raise:!0})),this.$new(R["$[]"]("name"),R["$[]"]("items"))},a.$$arity=2),e.def(U,"$initialize",h=function(N,o){return this.name=N,this.items=o.$freeze()},h.$$arity=2),void e.def(U,"$roll",s=function(N){var u,R,F,J,C,q;return u=N.$roll_once(6),R=N.$roll_once(6),F=function(q,n){return"number"==typeof q&&"number"==typeof n?q+n:q["$+"](n)}("number"==typeof(q=u)?10*q:q["$*"](10),R),J=P(u,1),C=P(R,1),c(v,"RollResult").$new(this.name,F,this.items["$[]"](J)["$[]"](C))},s.$$arity=1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var H,M,L,Y,U,x,ee,l,q,X=[],P=e.nil,y=e.$$,$=e.module,K=e.klass,c=e.hash2;return e.top.$require("bcdice/dice_table/d66_grid_table"),H=X,M=q=[$(X[0],"BCDice")].concat(H),L=l=[$(q[0],"DiceTable")].concat(M),x=K(l[0],y(l,"D66GridTable"),"D66HalfGridTable"),ee=[x].concat(L),e.defs(x,"$from_i18n",Y=function(a,h){var f=P;return f=y(ee,"I18n").$t(a,c(["locale","raise"],{locale:h,raise:!0})),this.$new(f["$[]"]("name"),f["$[]"]("items_1_2_3"),f["$[]"]("items_4_5_6"))},Y.$$arity=2),void e.def(x,"$initialize",U=function(a,h,s){return this.name=a,this.items=[h,h,h,s,s,s].$freeze()},U.$$arity=3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var H,M,L,Y,U,x,ee,l,q,X=[],P=e.nil,y=e.$$,$=e.module,K=e.klass,c=e.hash2;return e.top.$require("bcdice/dice_table/d66_grid_table"),H=X,M=q=[$(X[0],"BCDice")].concat(H),L=l=[$(q[0],"DiceTable")].concat(M),x=K(l[0],y(l,"D66GridTable"),"D66OneThirdTable"),ee=[x].concat(L),e.defs(x,"$from_i18n",Y=function(a,h){var f=P;return f=y(ee,"I18n").$t(a,c(["locale","raise"],{locale:h,raise:!0})),this.$new(f["$[]"]("name"),f["$[]"]("items_1_2"),f["$[]"]("items_3_4"),f["$[]"]("items_5_6"))},Y.$$arity=2),void e.def(x,"$initialize",U=function(a,h,s,f){return this.name=a,this.items=[h,h,s,s,f,f].$freeze()},U.$$arity=4)},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var n,w,Y,a,h,s,f,U,v,L,Z,r=[],y=e.nil,$=e.$$$,K=e.$$,c=e.module,W=e.klass,H=e.hash2,t=e.truthy;return n=r,w=Z=[c(r[0],"BCDice")].concat(n),Y=L=[c(Z[0],"DiceTable")].concat(w),U=W(L[0],null,"D66Table"),v=[U].concat(Y),U.$$prototype.sort_type=U.$$prototype.items=U.$$prototype.name=y,e.defs(U,"$from_i18n",a=function(o,u){var J,F=y;return F=K(v,"I18n").$t(o,H(["locale"],{locale:u})),J=K(v,"D66SortType").$const_get(F["$[]"]("d66_sort_type")),this.$new(F["$[]"]("name"),J,F["$[]"]("items"))},a.$$arity=2),e.def(U,"$initialize",h=function(o,u,R){var F=this;return F.name=o,F.sort_type=u,F.items=R.$freeze()},h.$$arity=3),e.def(U,"$roll",s=function(o){var F,g,q,u=this,R=y,J=y,C=y;return R=o.$roll_barabara(2,6),F=u.sort_type,$(K(v,"D66SortType"),"ASC")["$==="](F)?R["$sort!"]():$(K(v,"D66SortType"),"DESC")["$==="](F)&&R["$sort!"]()["$reverse!"](),J=function(q,n){return"number"==typeof q&&"number"==typeof n?q+n:q["$+"](n)}("number"==typeof(q=R["$[]"](0))?10*q:q["$*"](10),R["$[]"](1)),C=t(g=u.items["$[]"](J))?g:u.items["$[]"](J.$to_s()),t(C["$respond_to?"]("roll"))&&(C=C.$roll(o)),K(v,"RollResult").$new(u.name,J,C)},s.$$arity=1),void e.def(U,"$choice",f=function(o){return K(v,"RollResult").$new(this.name,o,this.items["$[]"](o))},f.$$arity=1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){function j(M,Z){return"number"==typeof M&&"number"==typeof Z?M+Z:M["$+"](Z)}var Z,v,s,a,L,ee,w,y=[],$=e.nil,c=e.$$,W=e.module,H=e.klass,t=e.hash2,q=e.send,n=e.send2;return e.top.$require("bcdice/dice_table/d66_table"),Z=y,L=w=[W(y[0],"BCDice")].concat(Z),v=ee=[W(w[0],"DiceTable")].concat(L),[a=H(ee[0],c(ee,"D66Table"),"D66LeftRangeTable")].concat(v),void e.def(a,"$initialize",s=function(N,o,u){var R,g,C=this;return s.$$p&&(s.$$p=null),g=t([],{}),q(u,"each",[],((R=function(b){function A(p){return b.apply(this,arguments)}return A.toString=function(){return b.toString()},A}(function(b){var p,_,k,A=null==R.$$s?this:R.$$s;return null==b&&(b=$),p=e.to_ary(b),k=null==p[1]?$:p[1],q(null==p[0]?$:p[0],"each",[],((_=function(E){var ve;return null==E&&(E=$),q(k,"each_with_index",[],((ve=function(Ce,Re){var Te,be,M;return null==Ce&&(Ce=$),null==Re&&(Re=$),Te=j("number"==typeof(M=E)?10*M:M["$*"](10),j(Re,1)),q(g,"[]=",e.to_a(be=[Te,Ce])),be[function(M,Z){return"number"==typeof M?M-1:M["$-"](1)}(be.length)]}).$$s=null==_.$$s?this:_.$$s,ve.$$arity=2,ve))}).$$s=A,_.$$arity=1,_))})).$$s=C,R.$$arity=1,R)),n(C,e.find_super_dispatcher(C,"initialize",s,!1,!0),"initialize",[N,o,g],null)},s.$$arity=3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var n,w,Y,a,h,U,v,L,Z,y=[],$=e.nil,c=e.$$,W=e.module,H=e.klass,t=e.truthy;return n=y,w=Z=[W(y[0],"BCDice")].concat(n),Y=L=[W(Z[0],"DiceTable")].concat(w),U=H(L[0],null,"D66ParityTable"),v=[U].concat(Y),U.$$prototype.odd=U.$$prototype.even=U.$$prototype.name=$,e.def(U,"$initialize",a=function(f,N,o){var u=this;return u.name=f,u.odd=N.$freeze(),u.even=o.$freeze()},a.$$arity=3),void e.def(U,"$roll",h=function(f){var u,F,J,q,N=this,o=$;return o=f.$roll_once(6),u=f.$roll_once(6),F=(t(o["$odd?"]())?N.odd:N.even)["$[]"]("number"==typeof(q=u)?q-1:q["$-"](1)),J=function(q,n){return"number"==typeof q&&"number"==typeof n?q+n:q["$+"](n)}(function(q,n){return"number"==typeof q?10*q:q["$*"](10)}(o),u),c(v,"RollResult").$new(N.name,J,F)},h.$$arity=1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var q,l,ee,v,a,Y,U,Q,M,r=[],y=e.nil,K=e.$$,c=e.module,W=e.klass,H=e.send;return q=r,l=M=[c(r[0],"BCDice")].concat(q),ee=Q=[c(M[0],"DiceTable")].concat(l),Y=W(Q[0],null,"D66RangeTable"),U=[Y].concat(ee),Y.$$prototype.items=Y.$$prototype.name=y,e.def(Y,"$initialize",v=function(s,f){return this.name=s,this.items=f.$freeze()},v.$$arity=2),void e.def(Y,"$roll",a=function(s){var f,o,u,R,t,N=this,F=y;return o=s.$roll_once(6),u=s.$roll_once(6),R=function(t,q){return"number"==typeof t&&"number"==typeof q?t+q:t["$+"](q)}("number"==typeof(t=o)?10*t:t["$*"](10),u),F=H(N.items,"find",[],((f=function(C){return null==C&&(C=y),C["$[]"](0)["$include?"](R)}).$$s=N,f.$$arity=1,f)),K(U,"RollResult").$new(N.name,R,F["$[]"](1))},a.$$arity=1)},Opal.modules["bcdice/dice_table/range_table"]=function(e){var M,Q,U,h,s,f,N,o,u,R,F,J,v,a,x,l,y=[],$=e.nil,c=e.$$,W=e.module,H=e.klass,t=e.send,q=e.truthy;return M=y,Q=l=[W(y[0],"BCDice")].concat(M),U=x=[W(l[0],"DiceTable")].concat(Q),v=H(x[0],null,"RangeTable"),a=[v].concat(U),v.$$prototype.name=v.$$prototype.items=v.$$prototype.num_of_dice=v.$$prototype.num_of_sides=v.$$prototype.formatter=$,e.const_set(a[0],"RollResult",t(c(a,"Struct"),"new",["sum","values","content","formatted"],((h=function(){return(null==h.$$s?this:h.$$s).$alias_method("to_s","formatted")}).$$s=v,h.$$arity=0,h))),e.const_set(a[0],"Item",c(a,"Struct").$new("range","content")),e.const_set(a[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),e.const_set(a[0],"DEFAULT_FORMATTER",t(v,"lambda",[],($$2=function(C){function g(b,A){return C.apply(this,arguments)}return g.toString=function(){return C.toString()},g}(function(C,g){return null==$$2.$$s||$$2,null==C&&(C=$),null==g&&(g=$),C.$name()+"("+g.$sum()+") \uff1e "+g.$content()}),$$2.$$s=v,$$2.$$arity=2,$$2))),v.$attr_reader("name"),v.$attr_reader("num_of_dice"),v.$attr_reader("num_of_sides"),e.def(v,"$initialize",s=function(g,b,A){var m,p=s.$$p,T=p||$,_=this,k=$;return p&&(s.$$p=null),p&&(s.$$p=null),_.name=g.$freeze(),_.formatter=q(m=T)?m:c(a,"DEFAULT_FORMATTER"),k=c(a,"DICE_ROLL_METHOD_RE").$match(b),q(k)||_.$raise(c(a,"ArgumentError"),_.name+": invalid dice roll method: "+b),_.num_of_dice=k["$[]"](1).$to_i(),_.num_of_sides=k["$[]"](2).$to_i(),_.$store(A)},s.$$arity=3),e.def(v,"$fetch",f=function(g){var b,p,A=this;return p=t(A.items,"find",[],((b=function(_){return null==_&&(_=$),_.$range()["$include?"](g)}).$$s=A,b.$$arity=1,b)),q(p)||A.$raise(c(a,"RangeError"),A.name+": value is out of range: "+g),p},f.$$arity=1),e.def(v,"$roll",N=function(g){var p,T,_,n,b=this,A=$;return p=(A=g.$roll_barabara(b.num_of_dice,b.num_of_sides)).$sum(),T=c(a,"RollResult").$new(p,A,b.$fetch(p).$content()),_=[b.formatter["$[]"](b,T)],t(T,"formatted=",e.to_a(_)),"number"==typeof(n=_.length)||n["$-"](1),T},N.$$arity=1),v.$private(),e.def(v,"$store",o=function(g){var b,A,p,_,m,T=this;return _=t(g,"map",[],((b=function(S,E){return null==S&&(S=$),null==E&&(E=$),[(null==b.$$s?this:b.$$s).$coerce_to_int_range(S),E]}).$$s=T,b.$$arity=2,b)),m=t(_,"sort_by",[],((A=function(S,E){return null==S&&(S=$),null==E&&(E=$),S.$min()}).$$s=T,A.$$arity=2,A)),T.$assert_min_sum_is_covered(m),T.$assert_max_sum_is_covered(m),T.$assert_no_gap_or_overlap_in_ranges(m),T.items=t(m,"map",[],(p=function(S,E){return null==S&&(S=$),null==E&&(E=$),c(a,"Item").$new(S,E.$freeze()).$freeze()},p.$$s=T,p.$$arity=2,p)).$freeze(),T},o.$$arity=1),e.def(v,"$coerce_to_int_range",u=function(g){var A,p=$;return A=g,c(a,"Integer")["$==="](A)?c(a,"Range").$new(g,g):c(a,"Range")["$==="](A)&&q(q(p=g.$begin()["$is_a?"](c(a,"Integer")))?g.$end()["$is_a?"](c(a,"Integer")):p)?g:this.$raise(c(a,"TypeError"),this.name+": "+g+" ("+g.$class()+") must be an Integer or a Range with Integers ")},u.$$arity=1),e.def(v,"$assert_min_sum_is_covered",R=function(g){var A,b=this,p=$;return A=b.num_of_dice,p=g.$first()["$[]"](0),q(p["$include?"](A))||b.$raise(c(a,"RangeError"),b.name+": min value ("+A+") is not covered: "+p),b},R.$$arity=1),e.def(v,"$assert_max_sum_is_covered",F=function(g){var A,b=this,p=$;return A=function(n,M){return"number"==typeof n&&"number"==typeof M?n*M:n["$*"](M)}(b.num_of_dice,b.num_of_sides),p=g.$last()["$[]"](0),q(p["$include?"](A))||b.$raise(c(a,"RangeError"),b.name+": max value ("+A+") is not covered: "+p),b},F.$$arity=1),void e.def(v,"$assert_no_gap_or_overlap_in_ranges",J=function(g){var b;return t(g,"each_cons",[2],((b=function(T,_){var E,ce,n,m=null==b.$$s?this:b.$$s,k=$,S=$;return null==m.name&&(m.name=$),null==T&&(T=$),null==_&&(_=$),k=T["$[]"](0),S=_["$[]"](0),ce="number"==typeof(n=E=k.$max())?n+1:n["$+"](1),q(S["$include?"](E))&&m.$raise(c(a,"RangeError"),m.name+": Range overlap: "+k+" and "+S),q(S["$include?"](ce))?$:m.$raise(c(a,"RangeError"),m.name+": Range gap: "+k+" and "+S)}).$$s=this,b.$$arity=2,b)),this},J.$$arity=1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var t,Z,x,a,f,N,o,h,s,Y,w,n,P=[],r=e.nil,y=e.$$$,$=e.$$,K=e.module,c=e.klass,W=e.send;return t=P,Z=n=[K(P[0],"BCDice")].concat(t),x=w=[K(n[0],"DiceTable")].concat(Z),a=Y=[c(w[0],null,"SaiFicSkillTable")].concat(x),h=c(Y[0],null,"Category"),s=[h].concat(a),h.$$prototype.name=r,e.def(h,"$initialize",f=function(R,F,J,C){var g,b=this;return b.name=R,b.skills=W(F.$map(),"with_index",[2],((g=function(A){function p(T,_){return A.apply(this,arguments)}return p.toString=function(){return A.toString()},p}(function(A,p){return null==A&&(A=r),null==p&&(p=r),y($(s,"SaiFicSkillTable"),"Skill").$new(R,A,J,p,C)})).$$s=b,g.$$arity=2,g)),b.dice=J},f.$$arity=4),e.def(h,"$roll",N=function(R){return this.$skills()["$[]"]("number"==typeof(H=R.$roll_sum(2,6))?H-2:H["$-"](2));var H},N.$$arity=1),e.def(h,"$to_s",o=function(){return this.name},o.$$arity=0),void h.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var H,M,v,s,f,a,L,ee,l,q,X=[],P=e.nil,$=e.module,K=e.klass,c=e.hash2;return H=X,M=q=[$(X[0],"BCDice")].concat(H),L=l=[$(q[0],"DiceTable")].concat(M),v=ee=[K(l[0],null,"SaiFicSkillTable")].concat(L),[a=K(ee[0],null,"Skill")].concat(v),a.$$prototype.s_format=a.$$prototype.category_dice=a.$$prototype.row_dice=a.$$prototype.category_name=a.$$prototype.name=P,e.def(a,"$initialize",s=function(o,u,R,F,J){var C=this;return C.category_name=o,C.name=u,C.category_dice=R,C.row_dice=F,C.s_format=J},s.$$arity=5),e.def(a,"$to_s",f=function(){var o=this;return o.$format(o.s_format,c(["category_dice","row_dice","category_name","skill_name"],{category_dice:o.category_dice,row_dice:o.row_dice,category_name:o.category_name,skill_name:o.name}))},f.$$arity=0),void a.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var Z,L,v,s,f,N,o,u,R,F,a,h,ee,w,P=e.top,r=[],y=e.nil,$=e.$$$,K=e.$$,c=e.module,W=e.klass,H=e.hash2,t=e.send,n=e.truthy;return P.$require("bcdice/dice_table/sai_fic_skill_table/category"),P.$require("bcdice/dice_table/sai_fic_skill_table/skill"),Z=r,L=w=[c(r[0],"BCDice")].concat(Z),v=ee=[c(w[0],"DiceTable")].concat(L),a=W(ee[0],null,"SaiFicSkillTable"),h=[a].concat(v),a.$$prototype.rtt=a.$$prototype.rtt_format=a.$$prototype.rct=a.$$prototype.rct_format=a.$$prototype.rttn=a.$$prototype.rttn_format=a.$$prototype.categories=y,e.defs(a,"$from_i18n",s=function(C,g,b){var A,p,T,_,E,S=y;if(null==b)b=H([],{});else if(!b.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(A=b.$$smap.rtt)&&(A=y),null==(p=b.$$smap.rct)&&(p=y),null==(T=b.$$smap.rttn)&&(T=y),E=(S=K(h,"I18n").$t("RTT",H(["locale","raise","default"],{locale:g,raise:!1,default:H([],{})})).$merge(K(h,"I18n").$t(C,H(["locale","raise"],{locale:g,raise:!0}))))["$[]"]("items"),S=t(S,"select",[],((_=function(ce){function ve(ge,Ce){return ce.apply(this,arguments)}return ve.toString=function(){return ce.toString()},ve}(function(ce,ve){return null==ce&&(ce=y),null==ve&&(ve=y),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](ce)})).$$s=this,_.$$arity=2,_)),this.$new(E,e.to_hash(S).$merge(H(["rtt","rct","rttn"],{rtt:A,rct:p,rttn:T})))},s.$$arity=-3),e.const_set(h[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),e.const_set(h[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),e.const_set(h[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),e.const_set(h[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),e.def(a,"$initialize",f=function(C,g){var b,A,p,T,_,m,k,S,E=this;if(null==g)g=H([],{});else if(!g.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(b=g.$$smap.rtt)&&(b=y),null==(A=g.$$smap.rct)&&(A=y),null==(p=g.$$smap.rttn)&&(p=y),null==(T=g.$$smap.rtt_format)&&(T=K(h,"DEFAULT_RTT")),null==(_=g.$$smap.rct_format)&&(_=K(h,"DEFAULT_RCT")),null==(m=g.$$smap.rttn_format)&&(m=K(h,"DEFAULT_RTTN")),null==(k=g.$$smap.s_format)&&(k=K(h,"DEFAULT_S")),E.categories=t(C.$map(),"with_index",[1],((S=function(ve,ge){var Re,Te,be;return null==ve&&(ve=y),null==ge&&(ge=y),Te=null==(Re=e.to_ary(ve))[0]?y:Re[0],be=null==Re[1]?y:Re[1],$(K(h,"SaiFicSkillTable"),"Category").$new(Te,be,ge,k)}).$$s=E,S.$$arity=2,S.$$has_top_level_mlhs_arg=!0,S)),E.rtt=b,E.rct=A,E.rttn=p.$to_a(),E.rtt_format=T,E.rct_format=_,E.rttn_format=m},f.$$arity=-2),e.const_set(h[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),a.$attr_reader("categories"),e.def(a,"$roll_command",N=function(C,g){var A,b=this,p=y,T=y,_=y;return n(["RTT",b.rtt]["$include?"](A=g))?b.$format_skill(b.rtt_format,b.$roll_skill(C)):n(["RCT",b.rct]["$include?"](A))?(p=b.$roll_category(C),b.$format(b.rct_format,H(["category_dice","category_name"],{category_dice:p.$dice(),category_name:p.$name()}))):n(n(T=_=K(h,"RTTN").$index(A))?T:_=b.rttn.$index(A))?b.$format_skill(b.rttn_format,b.categories["$[]"](_).$roll(C)):y},N.$$arity=2),e.def(a,"$roll_category",o=function(C){return this.categories["$[]"]("number"==typeof(M=C.$roll_once(6))?M-1:M["$-"](1));var M},o.$$arity=1),e.def(a,"$roll_skill",u=function(C){return this.$roll_category(C).$roll(C)},u.$$arity=1),e.def(a,"$prefixes",R=function(){var C=this;return function(M,Z){return"number"==typeof M&&"number"==typeof Z?M+Z:M["$+"](Z)}(["RTT[1-6]?","RCT",C.rtt,C.rct],C.rttn).$compact()},R.$$arity=0),a.$private(),void e.def(a,"$format_skill",F=function(C,g){return this.$format(C,H(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:g.$category_dice(),row_dice:g.$row_dice(),category_name:g.$category_name(),skill_name:g.$name(),text:g.$to_s()}))},F.$$arity=2)},Opal.modules["bcdice/dice_table/table"]=function(e){var q,l,ee,v,a,h,s,Y,U,Q,M,P=[],r=e.nil,$=e.$$,K=e.module,c=e.klass,W=e.hash2,H=e.truthy;return q=P,l=M=[K(P[0],"BCDice")].concat(q),ee=Q=[K(M[0],"DiceTable")].concat(l),Y=c(Q[0],null,"Table"),U=[Y].concat(ee),Y.$$prototype.times=Y.$$prototype.sides=Y.$$prototype.name=Y.$$prototype.items=r,e.defs(Y,"$from_i18n",v=function(N,o){var R=r;return R=$(U,"I18n").$t(N,W(["locale"],{locale:o})),this.$new(R["$[]"]("name"),R["$[]"]("type"),R["$[]"]("items"))},v.$$arity=2),e.def(Y,"$initialize",a=function(N,o,u){var R=this,F=r;return R.name=N,R.items=u.$freeze(),F=/(\d+)D(\d+)/i.$match(o),H(F)||R.$raise($(U,"ArgumentError"),"Unexpected table type: "+o),R.times=F["$[]"](1).$to_i(),R.sides=F["$[]"](2).$to_i()},a.$$arity=3),e.def(Y,"$roll",h=function(N){var u,o=this;return u=N.$roll_sum(o.times,o.sides),o.$choice(u)},h.$$arity=1),void e.def(Y,"$choice",s=function(N){var u,o=this;return u=function(t,q){return"number"==typeof t&&"number"==typeof q?t-q:t["$-"](q)}(N,o.times),$(U,"RollResult").$new(o.name,N,o.items["$[]"](u))},s.$$arity=1)},Opal.modules["bcdice/dice_table"]=function(e){var j=e.top;return j.$require("bcdice/dice_table/roll_result"),j.$require("bcdice/dice_table/chain_table"),j.$require("bcdice/dice_table/d66_grid_table"),j.$require("bcdice/dice_table/d66_half_grid_table"),j.$require("bcdice/dice_table/d66_one_third_table"),j.$require("bcdice/dice_table/d66_left_range_table"),j.$require("bcdice/dice_table/d66_parity_table"),j.$require("bcdice/dice_table/d66_range_table"),j.$require("bcdice/dice_table/d66_table"),j.$require("bcdice/dice_table/range_table"),j.$require("bcdice/dice_table/sai_fic_skill_table"),j.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var c,q,M,H,X=[],$=e.module;return c=X,q=H=[$(X[0],"BCDice")].concat(c),M=[$(H[0],"D66SortType")].concat(q),e.const_set(M[0],"NO_SORT","no_sort"),e.const_set(M[0],"ASC","asc"),e.const_set(M[0],"DESC","desc"),void function(t,q){var M=[$(t,"RoundType")].concat(q);e.const_set(M[0],"CEIL","ceil"),e.const_set(M[0],"FLOOR","floor"),e.const_set(M[0],"ROUND","round")}(H[0],H)},Opal.modules["bcdice/translate"]=function(e){var H,M,w,Z,l,q,X=[],P=e.nil,y=e.$$,$=e.module,K=e.hash2;return H=X,M=q=[$(X[0],"BCDice")].concat(H),Z=$(q[0],"Translate"),l=[Z].concat(M),void e.def(Z,"$translate",w=function(L,x){var ee,Y=this;if(null==Y.locale&&(Y.locale=P),null==x)x=K([],{});else if(!x.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return ee=e.kwrestargs(x,{}),y(l,"I18n").$translate(L,K(["locale","raise"],{locale:Y.locale,raise:!0}).$merge(e.to_hash(ee)))},w.$$arity=-2)},Opal.modules["bcdice/result"]=function(e){function j(H,t){return"number"==typeof H&&"number"==typeof t?H-t:H["$-"](t)}var t,h,N,o,u,R,F,l,L,x,ee,Y,U,v,a,w,Q,n,P=[],r=e.nil,c=e.klass,W=e.send;return t=P,l=n=[(0,e.module)(P[0],"BCDice")].concat(t),Q=[w=c(n[0],null,"Result")].concat(l),w.$$prototype.secret=w.$$prototype.success=w.$$prototype.failure=w.$$prototype.critical=w.$$prototype.fumble=r,[h=e.get_singleton_class(w)].concat(Q),e.def(h,"$success",N=function(C){var g;return W(this.$new(),"tap",[],((g=function(A){function p(T){return A.apply(this,arguments)}return p.toString=function(){return A.toString()},p}(function(A){var T=r;return null==A&&(A=r),W(A,"text=",e.to_a(T=[C])),j(T.length,1),W(A,"success=",e.to_a(T=[!0])),T[j(T.length,1)]})).$$s=this,g.$$arity=1,g))},N.$$arity=1),e.def(h,"$failure",o=function(C){var g;return W(this.$new(),"tap",[],((g=function(p){var _=r;return null==p&&(p=r),W(p,"text=",e.to_a(_=[C])),j(_.length,1),W(p,"failure=",e.to_a(_=[!0])),_[j(_.length,1)]}).$$s=this,g.$$arity=1,g))},o.$$arity=1),e.def(h,"$critical",u=function(C){var g;return W(this.$new(),"tap",[],((g=function(p){var _=r;return null==p&&(p=r),W(p,"text=",e.to_a(_=[C])),j(_.length,1),W(p,"critical=",e.to_a(_=[!0])),j(_.length,1),W(p,"success=",e.to_a(_=[!0])),_[j(_.length,1)]}).$$s=this,g.$$arity=1,g))},u.$$arity=1),e.def(h,"$fumble",R=function(C){var g;return W(this.$new(),"tap",[],((g=function(p){var _=r;return null==p&&(p=r),W(p,"text=",e.to_a(_=[C])),j(_.length,1),W(p,"fumble=",e.to_a(_=[!0])),j(_.length,1),W(p,"failure=",e.to_a(_=[!0])),_[j(_.length,1)]}).$$s=this,g.$$arity=1,g))},R.$$arity=1),e.def(h,"$nothing",F=function(){return"nothing"},F.$$arity=0),e.def(w,"$initialize",L=function(s){var f=this;return null==s&&(s=r),f.text=s,f.rands=r,f.detailed_rands=r,f.secret=!1,f.success=!1,f.failure=!1,f.critical=!1,f.fumble=!1},L.$$arity=-1),w.$attr_accessor("text","rands","detailed_rands"),w.$attr_writer("secret","success","failure","critical","fumble"),e.def(w,"$secret?",x=function(){return this.secret},x.$$arity=0),e.def(w,"$success?",ee=function(){return this.success},ee.$$arity=0),e.def(w,"$failure?",Y=function(){return this.failure},Y.$$arity=0),e.def(w,"$critical?",U=function(){return this.critical},U.$$arity=0),e.def(w,"$fumble?",v=function(){return this.fumble},v.$$arity=0),void e.def(w,"$condition=",a=function(s){return this.success=s,this.failure=s["$!"]()},a.$$arity=1)},Opal.modules["racc/parser"]=function(e){function j(L,x){return"number"==typeof L&&"number"==typeof x?L<x:L["$<"](x)}function X(L,x){return"number"==typeof L&&"number"==typeof x?L-x:L["$-"](x)}function P(L,x){return"number"==typeof L&&"number"==typeof x?L+x:L["$+"](x)}function r(L,x){return"number"==typeof L&&"number"==typeof x?L>=x:L["$>="](x)}function y(L,x){return"number"==typeof L&&"number"==typeof x?L>x:L["$>"](x)}function $(L,x){return"number"==typeof L&&"number"==typeof x?L<=x:L["$<="](x)}var U,v,a,x,Y,H=[],t=e.nil,q=e.$$$,n=e.$$,M=e.module,Z=e.klass,l=e.truthy,w=e.gvars,Q=e.send;return x=H,U=(Y=[M(H[0],"Racc")].concat(x))[0],v=n(Y,"StandardError"),a=Y,[Z(U,v,"ParseError")].concat(a),l(q("::","ParseError","skip_raise")?"constant":t)||e.const_set(H[0],"ParseError",q(n(H,"Racc"),"ParseError")),function(L,x){var h,N,o,u,R,F,J,C,g,b,A,p,T,_,m,k,S,E,ce,ve,ge,Ce,Re,ze,Te,s,f,Y=[M(L,"Racc")].concat(x);l(n(Y,"Racc_No_Extensions","skip_raise")?"constant":t)||e.const_set(Y[0],"Racc_No_Extensions",!1),h=Y,s=Z(Y[0],null,"Parser"),f=[s].concat(h),s.$$prototype.yydebug=s.$$prototype.racc_debug_out=s.$$prototype.racc_error_status=s.$$prototype.racc_t=s.$$prototype.racc_vstack=s.$$prototype.racc_val=s.$$prototype.racc_state=s.$$prototype.racc_tstack=t,e.const_set(f[0],"Racc_Runtime_Version","1.4.6"),e.const_set(f[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),e.const_set(f[0],"Racc_Runtime_Core_Version_R","1.4.6"),e.const_set(f[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),e.const_set(f[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),e.const_set(f[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),e.const_set(f[0],"Racc_Runtime_Core_Version",n(f,"Racc_Runtime_Core_Version_R")),e.const_set(f[0],"Racc_Runtime_Core_Revision",n(f,"Racc_Runtime_Core_Revision_R")),e.const_set(f[0],"Racc_Runtime_Type","ruby"),e.defs(n(f,"Parser"),"$racc_runtime_type",N=function(){return n(f,"Racc_Runtime_Type")},N.$$arity=0),e.def(s,"$_racc_setup",o=function(){var re,te,i=this,V=t,G=t,B=t;return null==w.stderr&&(w.stderr=t),l(q(i.$class(),"Racc_debug_parser"))||(i.yydebug=!1),l(null!=(re=i.yydebug)&&re!==t?"instance-variable":t)||(i.yydebug=!1),l(i.yydebug)&&(l(null!=(te=i.racc_debug_out)&&te!==t?"instance-variable":t)||(i.racc_debug_out=w.stderr),i.racc_debug_out=l(V=i.racc_debug_out)?V:w.stderr),G=q(i.$class(),"Racc_arg"),l(j(G.$size(),14))&&(Q(G,"[]=",e.to_a(B=[13,!0])),X(B.length,1)),G},o.$$arity=0),e.def(s,"$_racc_init_sysvars",u=function(){var re=this;return re.racc_state=[0],re.racc_tstack=[],re.racc_vstack=[],re.racc_t=t,re.racc_val=t,re.racc_read_next=!0,re.racc_user_yyerror=!1,re.racc_error_status=0},u.$$arity=0),e.def(s,"$do_parse",R=function(){return this.$__send__(n(f,"Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},R.$$arity=0),e.def(s,"$next_token",F=function(){return this.$raise(n(f,"NotImplementedError"),this.$class()+"#next_token is not defined")},F.$$arity=0),e.def(s,"$_racc_do_parse_rb",J=function(re,te){var i,G,B=this,$e=t,ae=t,fe=t,we=t,le=t,he=t,Pe=t,me=t;return i=e.to_ary(re),$e=null==i[0]?t:i[0],ae=null==i[1]?t:i[1],fe=null==i[2]?t:i[2],we=null==i[3]?t:i[3],le=null==i[10]?t:i[10],B.$_racc_init_sysvars(),he=Pe=me=t,Q(B,"catch",["racc_end_parse"],((G=function(){var Ie,Fe,ye=null==G.$$s?this:G.$$s,qe=t,Ke=t,We=t;for(null==ye.racc_state&&(ye.racc_state=t),null==ye.racc_read_next&&(ye.racc_read_next=t),null==ye.racc_t&&(ye.racc_t=t),null==ye.yydebug&&(ye.yydebug=t),null==ye.racc_val&&(ye.racc_val=t);l(!0);)for(l(me=we["$[]"](ye.racc_state["$[]"](-1)))?(l(ye.racc_read_next)&&l(ye.racc_t["$!="](0))&&(Fe=ye.$next_token(),Ie=e.to_ary(Fe),he=null==Ie[0]?t:Ie[0],ye.racc_val=null==Ie[1]?t:Ie[1],ye.racc_t=l(he)?l(qe=le["$[]"](he))?qe:1:0,l(ye.yydebug)&&ye.$racc_read_token(ye.racc_t,he,ye.racc_val),ye.racc_read_next=!1),me=P(me,ye.racc_t),l(l(Ke=l(We=r(me,0))?Pe=$e["$[]"](me):We)?ae["$[]"](me)["$=="](ye.racc_state["$[]"](-1)):Ke)||(Pe=fe["$[]"](ye.racc_state["$[]"](-1)))):Pe=fe["$[]"](ye.racc_state["$[]"](-1));l(Pe=ye.$_racc_evalact(Pe,re)););}).$$s=B,G.$$arity=0,G))},J.$$arity=2),e.def(s,"$yyparse",C=function(re,te){return this.$__send__(n(f,"Racc_YY_Parse_Method"),re,te,this.$_racc_setup(),!0)},C.$$arity=2),e.def(s,"$_racc_yyparse_rb",g=function(re,te,i,V){var G,$e,fe=t,we=t,oe=t,le=t,Pe=t,me=t,De=t;return G=e.to_ary(i),fe=null==G[0]?t:G[0],we=null==G[1]?t:G[1],oe=null==G[2]?t:G[2],le=null==G[3]?t:G[3],Pe=null==G[10]?t:G[10],this.$_racc_init_sysvars(),me=t,De=t,Q(this,"catch",["racc_end_parse"],(($e=function(){var qe,Ae=null==$e.$$s?this:$e.$$s;for(null==Ae.racc_state&&(Ae.racc_state=t);!l(De=le["$[]"](Ae.racc_state["$[]"](-1)));)for(;l(me=Ae.$_racc_evalact(oe["$[]"](Ae.racc_state["$[]"](-1)),i)););return Q(re,"__send__",[te],((qe=function(We,Le){var _e,xe,Ne=null==qe.$$s?this:qe.$$s,ke=t,O=t,I=t,de=t,ne=t,d=t,ie=t;for(null==Ne.racc_t&&(Ne.racc_t=t),null==Ne.racc_state&&(Ne.racc_state=t),null==Ne.racc_read_next&&(Ne.racc_read_next=t),null==We&&(We=t),null==Le&&(Le=t),Ne.racc_t=l(We)?l(ke=Pe["$[]"](We))?ke:1:0,Ne.racc_val=Le,Ne.racc_read_next=!1,De=P(De,Ne.racc_t),l(l(_e=l(xe=r(De,0))?me=fe["$[]"](De):xe)?we["$[]"](De)["$=="](Ne.racc_state["$[]"](-1)):_e)||(me=oe["$[]"](Ne.racc_state["$[]"](-1)));l(me=Ne.$_racc_evalact(me,i)););for(;l(l(O=l(I=(De=le["$[]"](Ne.racc_state["$[]"](-1)))["$!"]())?I:Ne.racc_read_next["$!"]())?O:Ne.racc_t["$=="](0));)for(l(l(de=l(ne=l(d=l(ie=De)?De=P(De,Ne.racc_t):ie)?r(De,0):d)?me=fe["$[]"](De):ne)?we["$[]"](De)["$=="](Ne.racc_state["$[]"](-1)):de)||(me=oe["$[]"](Ne.racc_state["$[]"](-1)));l(me=Ne.$_racc_evalact(me,i)););}).$$s=Ae,qe.$$arity=2,qe))}).$$s=this,$e.$$arity=0,$e))},g.$$arity=4),e.def(s,"$_racc_evalact",b=function(re,te){var i,G,oe,he,B=this,$e=t,ae=t,we=t,le=t,Pe=t,me=t,De=t,ye=t,Ae=t,Ie=t;if($e=null==(i=e.to_ary(te))[0]?t:i[0],ae=null==i[1]?t:i[1],we=null==i[3]?t:i[3],oe=null==i[11]?t:i[11],le=null==i[12]?t:i[12],l(l(he=y(re,0))?j(re,oe):he))l(y(B.racc_error_status,0))&&(B.racc_t["$=="](1)||(B.racc_error_status=X(B.racc_error_status,1))),B.racc_vstack.$push(B.racc_val),B.racc_state.$push(re),B.racc_read_next=!0,l(B.yydebug)&&(B.racc_tstack.$push(B.racc_t),B.$racc_shift(B.racc_t,B.racc_tstack,B.racc_vstack));else if(l(l(Pe=j(re,0))?y(re,le["$-@"]()):Pe)){if(me=Q(B,"catch",["racc_jump"],((G=function(){var qe=null==G.$$s?this:G.$$s;return null==qe.racc_state&&(qe.racc_state=t),qe.racc_state.$push(qe.$_racc_do_reduce(te,re)),!1}).$$s=B,G.$$arity=0,G)),l(me)){if(1["$==="](De=me))return B.racc_user_yyerror=!0,le["$-@"]();if(2["$==="](De))return oe;B.$raise("[Racc Bug] unknown jump code")}}else if(re["$=="](oe))l(B.yydebug)&&B.$racc_accept(),B.$throw("racc_end_parse",B.racc_vstack["$[]"](0));else{if(re["$=="](le["$-@"]())){for((0)["$==="](De=B.racc_error_status)?l(te["$[]"](21))||B.$on_error(B.racc_t,B.racc_val,B.racc_vstack):3["$==="](De)&&(B.racc_t["$=="](0)&&B.$throw("racc_end_parse",t),B.racc_read_next=!0),B.racc_user_yyerror=!1,B.racc_error_status=3;l(!0)&&(!l(ye=we["$[]"](B.racc_state["$[]"](-1)))||(ye=P(ye,1),!l(l(Ae=l(Ie=r(ye,0))?re=$e["$[]"](ye):Ie)?ae["$[]"](ye)["$=="](B.racc_state["$[]"](-1)):Ae)));)l($(B.racc_state.$size(),1))&&B.$throw("racc_end_parse",t),B.racc_state.$pop(),B.racc_vstack.$pop(),l(B.yydebug)&&(B.racc_tstack.$pop(),B.$racc_e_pop(B.racc_state,B.racc_tstack,B.racc_vstack));return re}B.$raise("[Racc Bug] unknown action "+re.$inspect())}return l(B.yydebug)&&B.$racc_next_state(B.racc_state["$[]"](-1),B.racc_state),t},b.$$arity=2),e.def(s,"$_racc_do_reduce",A=function(re,te){var i,oe,he,Ie,Fe,qe,Ne,G=this,$e=t,ae=t,fe=t,we=t,le=t,Pe=t,me=t,De=t,ye=t,Ae=t,Ke=t,We=t,Le=t,He=t,Ge=t,ke=t;return $e=null==(i=e.to_ary(re))[4]?t:i[4],ae=null==i[5]?t:i[5],fe=null==i[6]?t:i[6],we=null==i[7]?t:i[7],oe=null==i[8]?t:i[8],le=null==i[9]?t:i[9],he=null==i[13]?t:i[13],Pe=G.racc_state,me=G.racc_vstack,De=G.racc_tstack,ye=function(L,x){return"number"==typeof L?-3*L:L["$*"](-3)}(te),Ae=le["$[]"](ye),Ie=le["$[]"](P(ye,1)),Fe=le["$[]"](P(ye,2)),qe=[],l(G.yydebug)&&(Ke=De["$[]"](Ae["$-@"](),Ae)),We=me["$[]"](Ae["$-@"](),Ae),l(G.yydebug)&&(Le=[Ae["$-@"](),Ae,qe],Q(De,"[]=",e.to_a(Le)),X(Le.length,1)),Le=[Ae["$-@"](),Ae,qe],Q(me,"[]=",e.to_a(Le)),X(Le.length,1),Le=[Ae["$-@"](),Ae,qe],Q(Pe,"[]=",e.to_a(Le)),X(Le.length,1),l(he)?me.$push(G.$__send__(Fe,We,me,We["$[]"](0))):me.$push(G.$__send__(Fe,We,me)),De.$push(Ie),l(G.yydebug)&&G.$racc_reduce(Ke,Ie,De,me),Ne=X(Ie,oe),l(ye=we["$[]"](Ne))&&(ye=P(ye,Pe["$[]"](-1)),l(l(He=l(Ge=r(ye,0))?ke=$e["$[]"](ye):Ge)?ae["$[]"](ye)["$=="](Ne):He))?ke:fe["$[]"](Ne)},A.$$arity=2),e.def(s,"$on_error",p=function(re,te,i){var G,V=this;return V.$raise(n(f,"ParseError"),V.$sprintf("\nparse error on value %s (%s)",te.$inspect(),l(G=V.$token_to_str(re))?G:"?"))},p.$$arity=3),e.def(s,"$yyerror",T=function(){return this.$throw("racc_jump",1)},T.$$arity=0),e.def(s,"$yyaccept",_=function(){return this.$throw("racc_jump",2)},_.$$arity=0),e.def(s,"$yyerrok",m=function(){return this.racc_error_status=0},m.$$arity=0),e.def(s,"$racc_read_token",k=function(re,te,i){var V=this;return V.racc_debug_out.$print("read    "),V.racc_debug_out.$print(te.$inspect(),"(",V.$racc_token2str(re),") "),V.racc_debug_out.$puts(i.$inspect()),V.racc_debug_out.$puts()},k.$$arity=3),e.def(s,"$racc_shift",S=function(re,te,i){var V=this;return V.racc_debug_out.$puts("shift   "+V.$racc_token2str(re)),V.$racc_print_stacks(te,i),V.racc_debug_out.$puts()},S.$$arity=3),e.def(s,"$racc_reduce",E=function(re,te,i,V){var G,B=this,$e=t;return($e=B.racc_debug_out).$print("reduce "),l(re["$empty?"]())?$e.$print(" <none>"):Q(re,"each",[],((G=function(fe){return null==fe&&(fe=t),$e.$print(" ",(null==G.$$s?this:G.$$s).$racc_token2str(fe))}).$$s=B,G.$$arity=1,G)),$e.$puts(" --\x3e "+B.$racc_token2str(te)),B.$racc_print_stacks(i,V),B.racc_debug_out.$puts()},E.$$arity=4),e.def(s,"$racc_accept",ce=function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},ce.$$arity=0),e.def(s,"$racc_e_pop",ve=function(re,te,i){var V=this;return V.racc_debug_out.$puts("error recovering mode: pop token"),V.$racc_print_states(re),V.$racc_print_stacks(te,i),V.racc_debug_out.$puts()},ve.$$arity=3),e.def(s,"$racc_next_state",ge=function(re,te){var i=this;return i.racc_debug_out.$puts("goto    "+re),i.$racc_print_states(te),i.racc_debug_out.$puts()},ge.$$arity=2),e.def(s,"$racc_print_stacks",Ce=function(re,te){var i,G=t;return(G=this.racc_debug_out).$print("        ["),Q(re,"each_index",[],((i=function($e){return null==$e&&($e=t),G.$print(" (",(null==i.$$s?this:i.$$s).$racc_token2str(re["$[]"]($e))," ",te["$[]"]($e).$inspect(),")")}).$$s=this,i.$$arity=1,i)),G.$puts(" ]")},Ce.$$arity=2),e.def(s,"$racc_print_states",Re=function(re){var te,V=t;return(V=this.racc_debug_out).$print("        ["),Q(re,"each",[],((te=function(B){return null==B&&(B=t),V.$print(" ",B)}).$$s=this,te.$$arity=1,te)),V.$puts(" ]")},Re.$$arity=1),e.def(s,"$racc_token2str",ze=function(re){var i;return l(i=q(this.$class(),"Racc_token_to_s_table")["$[]"](re))?i:this.$raise("[Racc Bug] can't convert token "+re+" to string")},ze.$$arity=1),e.def(s,"$token_to_str",Te=function(re){return q(this.$class(),"Racc_token_to_s_table")["$[]"](re)},Te.$$arity=1)}(H[0],H)},Opal.modules["bcdice/arithmetic/node"]=function(e){function j(H,t){return"number"==typeof H&&"number"==typeof t?H/t:H["$/"](t)}var t,Z,L,Y,U,v,s,f,N,o,u,R,a,h,ee,w,n,P=[],r=e.nil,y=e.$$$,$=e.$$,K=e.module,c=e.klass,W=e.send2;return t=P,Z=n=[K(P[0],"BCDice")].concat(t),L=w=[K(n[0],"Arithmetic")].concat(Z),function(Y,U,v){var s,f,N,o,u,a=c(Y,null,"BinaryOp");[a].concat(v),a.$$prototype.lhs=a.$$prototype.rhs=a.$$prototype.op=r,e.def(a,"$initialize",s=function(F,J,C){var g=this;return g.lhs=F,g.op=J,g.rhs=C},s.$$arity=3),e.def(a,"$eval",f=function(F){var g,J=this,C=r;return C=J.lhs.$eval(F),g=J.rhs.$eval(F),C.$send(J.op,g)},f.$$arity=1),e.def(a,"$output",N=function(){var F=this;return""+F.lhs.$output()+F.op+F.rhs.$output()},N.$$arity=0),e.def(a,"$s_exp",o=function(){var F=this;return"("+F.$op_for_s_exp()+" "+F.lhs.$s_exp()+" "+F.rhs.$s_exp()+")"},o.$$arity=0),e.def(a,"$op_for_s_exp",u=function(){return this.op},u.$$arity=0)}((ee=[K(w[0],"Node")].concat(L))[0],0,ee),Y=ee[0],U=$(ee,"BinaryOp"),v=ee,a=c(Y,U,"DivideBase"),h=[a].concat(v),a.$$prototype.lhs=a.$$prototype.rhs=a.$$prototype.op=r,e.def(a,"$initialize",s=function(J,C){return s.$$p&&(s.$$p=null),W(this,e.find_super_dispatcher(this,"initialize",s,!1,!0),"initialize",[J,"/",C],null)},s.$$arity=2),e.def(a,"$eval",f=function(J){var g,C=this,b=r;return g=C.lhs.$eval(J),(b=C.rhs.$eval(J))["$=="](0)&&C.$raise($(h,"ZeroDivisionError")),C.$divide_and_round(g,b,J)},f.$$arity=1),e.def(a,"$output",N=function(){var J=N.$$p,g=this,b=r,A=r,p=r;for(J&&(N.$$p=null),A=0,p=arguments.length,b=new Array(p);A<p;A++)b[A]=arguments[A];return""+W(g,e.find_super_dispatcher(g,"output",N,!1,!0),"output",b,J)+g.$rounding_method()},N.$$arity=0),a.$private(),e.def(a,"$rounding_method",o=function(){return y(this.$class(),"ROUNDING_METHOD")},o.$$arity=0),e.def(a,"$op_for_s_exp",u=function(){return""+this.op+this.$rounding_method()},u.$$arity=0),e.def(a,"$divide_and_round",R=function(J,C,g){return this.$raise($(h,"NotImplementedError"))},R.$$arity=3),function(Y,U,v){var s,a=c(Y,U,"DivideWithGameSystemDefault"),h=[a].concat(v);e.const_set(h[0],"ROUNDING_METHOD",""),a.$private(),e.def(a,"$divide_and_round",s=function(N,o,u){var F;return F=u,y($(h,"RoundType"),"CEIL")["$==="](F)?j(N.$to_f(),o).$ceil():y($(h,"RoundType"),"ROUND")["$==="](F)?j(N.$to_f(),o).$round():j(N,o).$to_i()},s.$$arity=3)}(ee[0],$(ee,"DivideBase"),ee),function(Y,U,v){var s,a=c(Y,U,"DivideWithCeil"),h=[a].concat(v);e.const_set(h[0],"ROUNDING_METHOD","C"),a.$private(),e.def(a,"$divide_and_round",s=function(N,o,u){return j(N.$to_f(),o).$ceil()},s.$$arity=3)}(ee[0],$(ee,"DivideBase"),ee),function(Y,U,v){var s,a=c(Y,U,"DivideWithRound"),h=[a].concat(v);e.const_set(h[0],"ROUNDING_METHOD","R"),a.$private(),e.def(a,"$divide_and_round",s=function(N,o,u){return j(N.$to_f(),o).$round()},s.$$arity=3)}(ee[0],$(ee,"DivideBase"),ee),function(Y,U,v){var s,a=c(Y,U,"DivideWithFloor"),h=[a].concat(v);e.const_set(h[0],"ROUNDING_METHOD","F"),a.$private(),e.def(a,"$divide_and_round",s=function(N,o,u){return j(N,o).$to_i()},s.$$arity=3)}(ee[0],$(ee,"DivideBase"),ee),function(Y,U,v){var s,f,N,o,a=c(Y,null,"Negative");[a].concat(v),a.$$prototype.body=r,e.def(a,"$initialize",s=function(R){return this.body=R},s.$$arity=1),e.def(a,"$eval",f=function(R){return this.body.$eval(R)["$-@"]()},f.$$arity=1),e.def(a,"$output",N=function(){return"-"+this.body.$output()},N.$$arity=0),e.def(a,"$s_exp",o=function(){return"(- "+this.body.$s_exp()+")"},o.$$arity=0)}(ee[0],0,ee),function(Y,U,v){var s,f,N,o,a=c(Y,null,"Parenthesis");[a].concat(v),a.$$prototype.expr=r,e.def(a,"$initialize",s=function(R){return this.expr=R},s.$$arity=1),e.def(a,"$eval",f=function(R){return this.expr.$eval(R)},f.$$arity=1),e.def(a,"$output",N=function(){return"("+this.expr.$output()+")"},N.$$arity=0),e.def(a,"$s_exp",o=function(){return"(Parenthesis "+this.expr.$s_exp()+")"},o.$$arity=0)}(ee[0],0,ee),void function(Y,U,v){var s,f,N,a=c(Y,null,"Number");[a].concat(v),a.$$prototype.value=r,e.def(a,"$initialize",s=function(u){return this.value=u},s.$$arity=1),e.def(a,"$eval",f=function(u){return this.value},f.$$arity=1),e.def(a,"$output",N=function(){return this.value.$to_s()},N.$$arity=0),e.alias(a,"s_exp","output")}(ee[0],0,ee)},Opal.modules.strscan=function(e){var q,Z,l,w,Q,L,x,ee,Y,U,v,a,h,s,f,N,o,u,R,F,J,C,g,b,A,p,n,M,P=[],r=e.nil,$=e.$$,c=e.truthy,W=e.send;return q=P,n=(0,e.klass)(P[0],null,"StringScanner"),M=[n].concat(q),n.$$prototype.pos=n.$$prototype.string=n.$$prototype.working=n.$$prototype.matched=n.$$prototype.prev_pos=n.$$prototype.match=r,n.$attr_reader("pos"),n.$attr_reader("matched"),e.def(n,"$initialize",Z=function(_){var m=this;return m.string=_,m.pos=0,m.matched=r,m.working=_,m.match=[]},Z.$$arity=1),n.$attr_reader("string"),e.def(n,"$beginning_of_line?",l=function(){var _=this;return 0===_.pos||"\n"===_.string.charAt(_.pos-1)},l.$$arity=0),e.alias(n,"bol?","beginning_of_line?"),e.def(n,"$scan",w=function(_){var m=this,k=(_=m.$anchor(_)).exec(m.working);return null==k?m.matched=r:"object"==typeof k?(m.prev_pos=m.pos,m.pos+=k[0].length,m.working=m.working.substring(k[0].length),m.matched=k[0],m.match=k,k[0]):"string"==typeof k?(m.pos+=k.length,m.working=m.working.substring(k.length),k):r},w.$$arity=1),e.def(n,"$scan_until",Q=function(_){var m=this;_=m.$anchor(_);for(var E,k=m.pos,S=m.working;;){if(E=_.exec(S),k+=1,S=S.substr(1),null!=E)return m.matched=m.string.substr(m.pos,k-m.pos-1+E[0].length),m.match=E,m.prev_pos=k-1,m.pos=k,m.working=S.substr(E[0].length),m.matched;if(0===S.length)return m.match=[],m.matched=r}},Q.$$arity=1),e.def(n,"$[]",L=function(_){var k;if(c(this.match["$empty?"]()))return r;k=_,$(M,"Symbol")["$==="](k)?_=_.$to_s():$(M,"String")["$==="](k)||(_=$(M,"Opal")["$coerce_to!"](_,$(M,"Integer"),"to_int"));var S=this.match;return _<0&&(_+=S.length),_<0||_>=S.length||null==S[_]?r:S[_]},L.$$arity=1),e.def(n,"$check",x=function(_){var m=this,k=(_=m.$anchor(_)).exec(m.working);return m.matched=null==k?r:k[0]},x.$$arity=1),e.def(n,"$check_until",ee=function(_){var m=this,k=m.prev_pos,S=m.pos,E=m.$scan_until(_);return E!==r&&(m.matched=E.substr(-1),m.working=m.string.substr(S)),m.prev_pos=k,m.pos=S,E},ee.$$arity=1),e.def(n,"$peek",Y=function(_){return this.working.substring(0,_)},Y.$$arity=1),e.def(n,"$eos?",U=function(){return 0===this.working.length},U.$$arity=0),e.def(n,"$exist?",v=function(_){var k=_.exec(this.working);return null==k?r:0==k.index?0:k.index+1},v.$$arity=1),e.def(n,"$skip",a=function(_){var m=this,k=(_=m.$anchor(_)).exec(m.working);if(null==k)return m.match=[],m.matched=r;var S=k[0],E=S.length;return m.matched=S,m.match=k,m.prev_pos=m.pos,m.pos+=E,m.working=m.working.substring(E),E},a.$$arity=1),e.def(n,"$skip_until",h=function(_){var k=this.$scan_until(_);return k===r?r:(this.matched=k.substr(-1),k.length)},h.$$arity=1),e.def(n,"$get_byte",s=function(){var _=this,m=r;return _.pos<_.string.length?(_.prev_pos=_.pos,_.pos+=1,m=_.matched=_.working.substring(0,1),_.working=_.working.substring(1)):_.matched=r,m},s.$$arity=0),e.alias(n,"getch","get_byte"),e.def(n,"$match?",f=function(_){var m=this,k=(_=m.$anchor(_)).exec(m.working);return null==k?r:(m.prev_pos=m.pos,k[0].length)},f.$$arity=1),e.def(n,"$pos=",N=function(_){var m=this;return _<0&&(_+=m.string.$length()),m.pos=_,m.working=m.string.slice(_)},N.$$arity=1),e.def(n,"$matched_size",o=function(){return this.matched===r?r:this.matched.length},o.$$arity=0),e.def(n,"$post_match",u=function(){var _=this;return _.matched===r?r:_.string.substr(_.pos)},u.$$arity=0),e.def(n,"$pre_match",R=function(){var _=this;return _.matched===r?r:_.string.substr(0,_.prev_pos)},R.$$arity=0),e.def(n,"$reset",F=function(){var _=this;return _.working=_.string,_.matched=r,_.pos=0},F.$$arity=0),e.def(n,"$rest",J=function(){return this.working},J.$$arity=0),e.def(n,"$rest?",C=function(){return 0!==this.working.length},C.$$arity=0),e.def(n,"$rest_size",g=function(){return this.$rest().$size()},g.$$arity=0),e.def(n,"$terminate",b=function(){var m,H,_=this;return _.match=r,m=[_.string.$length()],W(_,"pos=",e.to_a(m)),m[(H=m.length,"number"==typeof H?H-1:H["$-"](1))]},b.$$arity=0),e.def(n,"$unscan",A=function(){var _=this;return _.pos=_.prev_pos,_.prev_pos=r,_.match=r,_},A.$$arity=0),n.$private(),e.def(n,"$anchor",p=function(_){var k=_.toString().match(/\/([^\/]+)$/);return k=k?k[1]:void 0,new RegExp("^(?:"+_.source+")",k)},p.$$arity=1),r&&"anchor"},Opal.modules["bcdice/normalize"]=function(e){var q,Z,l,n,c,H,X=[],P=e.nil,$=e.module;return c=X,q=H=[$(X[0],"BCDice")].concat(c),[n=$(H[0],"Normalize")].concat(q),n.$module_function(),e.def(n,"$comparison_operator",Z=function(Q){var x;return/<=|=</["$==="](x=Q)?"<=":/>=|=>/["$==="](x)?">=":/<>|!=|=!/["$==="](x)?"!=":/</["$==="](x)?"<":/>/["$==="](x)?">":/=/["$==="](x)?"==":P},Z.$$arity=1),void e.def(n,"$target_number",l=function(Q){return Q["$=="]("?")?Q:Q.$to_i()},l.$$arity=1)},Opal.modules["bcdice/command/lexer"]=function(e){var q,l,ee,v,a,h,Y,U,Q,M,j=e.top,X=[],P=e.nil,y=e.$$,$=e.module,K=e.klass,c=e.hash2,W=e.truthy,H=e.send;return j.$require("strscan"),j.$require("bcdice/normalize"),q=X,l=M=[$(X[0],"BCDice")].concat(q),ee=Q=[$(M[0],"Command")].concat(l),Y=K(Q[0],null,"Lexer"),U=[Y].concat(ee),Y.$$prototype.scanner=Y.$$prototype.notations=P,e.const_set(U[0],"SYMBOLS",c(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),e.def(Y,"$initialize",v=function(f,N){var o,u,R,J,F=this;return f=W(J=(u=(o=f)===P||null==o?P:H(o,"split",[" ",2]))===P||null==u?P:H(u,"first",[]))?J:"",F.scanner=y(U,"StringScanner").$new(f),F.notations=H(N,"map",[],((R=function(C){function g(b){return C.apply(this,arguments)}return g.toString=function(){return C.toString()},g}(function(C){return null==C&&(C=P),W(C["$is_a?"](y(U,"String")))?y(U,"Regexp").$new(C):C})).$$s=F,R.$$arity=1,R))},v.$$arity=2),e.def(Y,"$next_token",a=function(){try{var f,N=this,o=P,u=P,F=P,J=P;return W(N.scanner["$eos?"]())?[!1,"$"]:(H(N.notations,"each",[],((f=function(g){var A,b=null==f.$$s?this:f.$$s;if(null==b.scanner&&(b.scanner=P),null==g&&(g=P),A=b.scanner.$scan(g),!W(A))return P;e.ret(["NOTATION",A])}).$$s=N,f.$$arity=1,f)),W(o=N.scanner.$scan(/\d+/))?["NUMBER",o.$to_i()]:W(u=N.scanner.$scan(/[<>!=]+/))?(u=y(U,"Normalize").$comparison_operator(u),[W(u)?"CMP_OP":"ILLEGAL",u]):(F=N.scanner.$getch().$upcase(),[W(J=y(U,"SYMBOLS")["$[]"](F))?J:F.$to_sym(),F]))}catch(C){if(C===e.returner)return C.$v;throw C}},a.$$arity=0),void e.def(Y,"$source",h=function(){return this.scanner.$string()},h.$$arity=0)},Opal.modules["bcdice/command/parsed"]=function(e){var H,M,L,Y,U,v,x,ee,l,q,X=[],P=e.nil,y=e.$$,$=e.module,K=e.klass,c=e.truthy;return H=X,M=q=[$(X[0],"BCDice")].concat(H),L=l=[$(q[0],"Command")].concat(M),x=K(l[0],null,"Parsed"),ee=[x].concat(L),x.$$prototype.question_target=x.$$prototype.critical=x.$$prototype.fumble=x.$$prototype.dollar=x.$$prototype.modify_number=x.$$prototype.target_number=x.$$prototype.prefix_number=x.$$prototype.command=x.$$prototype.suffix_number=x.$$prototype.cmp_op=P,x.$attr_accessor("command"),x.$attr_accessor("prefix_number"),x.$attr_accessor("suffix_number"),x.$attr_accessor("critical"),x.$attr_accessor("fumble"),x.$attr_accessor("dollar"),x.$attr_accessor("modify_number"),x.$attr_accessor("cmp_op"),x.$attr_accessor("target_number"),x.$attr_writer("question_target"),e.def(x,"$initialize",Y=function(){var h=this;return h.prefix_number=P,h.suffix_number=P,h.critical=P,h.fumble=P,h.dollar=P,h.cmp_op=P,h.target_number=P,h.question_target=!1},Y.$$arity=0),e.def(x,"$question_target?",U=function(){return this.question_target},U.$$arity=0),void e.def(x,"$to_s",v=function(h){var F,s=this,f=P,N=P,o=P,u=P,R=P;return null==h&&(h="after_command"),f=c(s.critical)?"@"+s.critical:P,N=c(s.fumble)?"#"+s.fumble:P,o=c(s.dollar)?"$"+s.dollar:P,u=y(ee,"Format").$modifier(s.modify_number),R=c(s.question_target)?"?":s.target_number,"after_command"["$==="](F=h)?[s.prefix_number,s.command,s.suffix_number,f,N,o,u,s.cmp_op,R].$join():"after_modify_number"["$==="](F)?[s.prefix_number,s.command,s.suffix_number,u,f,N,o,s.cmp_op,R].$join():"after_target_number"["$==="](F)?[s.prefix_number,s.command,s.suffix_number,u,s.cmp_op,R,f,N,o].$join():P},v.$$arity=-1)},Opal.modules["bcdice/command/parser"]=function(e){function j(M,Z){return"number"==typeof M&&"number"==typeof Z?M-Z:M["$-"](Z)}var Z,L,Y,U,v,s,f,N,o,u,R,F,J,C,g,b,A,p,T,_,m,k,S,E,ce,ve,ge,Ce,Re,ze,Te,be,re,te,i,V,G,B,$e,ae,fe,we,oe,le,he,Pe,me,De,ye,Ae,Ie,Fe,qe,Ke,We,Le,Ne,He,Ge,ke,O,a,h,ee,w,X=e.top,P=[],r=e.nil,y=e.$$$,$=e.$$,K=e.klass,c=e.module,W=e.hash2,H=e.send2,t=e.send,q=e.hash,n=e.truthy;return X.$require("racc/parser.rb"),X.$require("bcdice/arithmetic/node"),X.$require("bcdice/command/lexer"),X.$require("bcdice/command/parsed"),function(M,Z,l){[K(M,Z,"Parser")].concat(l)}(y($(P,"BCDice"),"Command"),y($(P,"Racc"),"Parser"),P),Z=P,L=w=[c(P[0],"BCDice")].concat(Z),Y=(ee=[c(w[0],"Command")].concat(L))[0],U=y($(ee,"Racc"),"Parser"),v=ee,a=K(Y,U,"Parser"),h=[a].concat(v),a.$$prototype.notations=a.$$prototype.lexer=a.$$prototype.modifier=a.$$prototype.prefix_number=a.$$prototype.suffix_number=a.$$prototype.need_suffix_number=a.$$prototype.need_prefix_number=a.$$prototype.critical=a.$$prototype.fumble=a.$$prototype.dollar=a.$$prototype.allowed_cmp_op=a.$$prototype.question_target=r,e.def(a,"$initialize",s=function(d,ie){var z,D,se,Ee,ue=s.$$p,Se=this;if(ue&&(s.$$p=null),z=e.slice.call(arguments,0,arguments.length),null==(D=e.extract_kwargs(z)))D=W([],{});else if(!D.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(se=z,!e.hasOwnProperty.call(D.$$smap,"round_type"))throw e.ArgumentError.$new("missing keyword: round_type");return Ee=D.$$smap.round_type,H(Se,e.find_super_dispatcher(Se,"initialize",s,!1,!0),"initialize",[],null),Se.notations=se,Se.round_type=Ee,Se.prefix_number=!1,Se.suffix_number=!1,Se.need_prefix_number=!1,Se.need_suffix_number=!1,Se.modifier=!0,Se.critical=!1,Se.fumble=!1,Se.dollar=!1,Se.allowed_cmp_op=[r,">=",">","<=","<","==","!="],Se.question_target=!1},s.$$arity=-2),e.def(a,"$disable_modifier",f=function(){return this.modifier=!1,this},f.$$arity=0),e.def(a,"$enable_prefix_number",N=function(){return this.prefix_number=!0,this},N.$$arity=0),e.def(a,"$enable_suffix_number",o=function(){return this.suffix_number=!0,this},o.$$arity=0),e.def(a,"$has_prefix_number",u=function(){var d=this;return d.prefix_number=!0,d.need_prefix_number=!0,d},u.$$arity=0),e.def(a,"$has_suffix_number",R=function(){var d=this;return d.suffix_number=!0,d.need_suffix_number=!0,d},R.$$arity=0),e.def(a,"$enable_critical",F=function(){return this.critical=!0,this},F.$$arity=0),e.def(a,"$enable_fumble",J=function(){return this.fumble=!0,this},J.$$arity=0),e.def(a,"$enable_dollar",C=function(){return this.dollar=!0,this},C.$$arity=0),e.def(a,"$restrict_cmp_op_to",g=function(d){var ie,D=this;return ie=e.slice.call(arguments,0,arguments.length),D.allowed_cmp_op=ie,D},g.$$arity=-1),e.def(a,"$enable_question_target",b=function(){return this.question_target=!0,this},b.$$arity=0),e.def(a,"$parse",A=function(d){try{return this.lexer=$(h,"Lexer").$new(d,this.notations),this.$do_parse()}catch(z){if(!e.rescue(z,[$(h,"ParseError"),$(h,"ZeroDivisionError")]))throw z;try{return r}finally{e.pop_exception()}}},A.$$arity=1),a.$private(),e.def(a,"$parsed",p=function(d,ie,z,D){var se;return t($(h,"Parsed").$new(),"tap",[],((se=function(Be){var Me,Ue,je,Ye,Ve,Qe,Se=null==se.$$s?this:se.$$s,pe=r;return null==Se.round_type&&(Se.round_type=r),null==Be&&(Be=r),pe=[d["$[]"]("command")],t(Be,"command=",e.to_a(pe)),j(pe.length,1),pe=[(Me=d["$[]"]("prefix"),Me===r||null==Me?r:t(Me,"eval",[Se.round_type]))],t(Be,"prefix_number=",e.to_a(pe)),j(pe.length,1),pe=[(Ue=d["$[]"]("suffix"),Ue===r||null==Ue?r:t(Ue,"eval",[Se.round_type]))],t(Be,"suffix_number=",e.to_a(pe)),j(pe.length,1),pe=[(je=ie["$[]"]("critical"),je===r||null==je?r:t(je,"eval",[Se.round_type]))],t(Be,"critical=",e.to_a(pe)),j(pe.length,1),pe=[(Ye=ie["$[]"]("fumble"),Ye===r||null==Ye?r:t(Ye,"eval",[Se.round_type]))],t(Be,"fumble=",e.to_a(pe)),j(pe.length,1),pe=[(Ve=ie["$[]"]("dollar"),Ve===r||null==Ve?r:t(Ve,"eval",[Se.round_type]))],t(Be,"dollar=",e.to_a(pe)),j(pe.length,1),pe=[z.$eval(Se.round_type)],t(Be,"modify_number=",e.to_a(pe)),j(pe.length,1),pe=[D["$[]"]("cmp_op")],t(Be,"cmp_op=",e.to_a(pe)),j(pe.length,1),D["$[]"]("target")["$=="]("?")?(t(Be,"question_target=",e.to_a(pe=[!0])),j(pe.length,1),t(Be,"target_number=",e.to_a(pe=[0])),pe[j(pe.length,1)]):(t(Be,"question_target=",e.to_a(pe=[!1])),j(pe.length,1),pe=[(Qe=D["$[]"]("target"),Qe===r||null==Qe?r:t(Qe,"eval",[Se.round_type]))],t(Be,"target_number=",e.to_a(pe)),pe[j(pe.length,1)])}).$$s=this,se.$$arity=1,se))},p.$$arity=4),e.def(a,"$next_token",T=function(){return this.lexer.$next_token()},T.$$arity=0),Fe=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,33,34,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,r,r,17,18,6,r,5,r,r,17,18,r,r,5,23,24,25,26,56,54,55,57],qe=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,r,17,15,15,18,18,23,r,18,30,30,23,23,24,r,23,31,31,24,24,25,r,24,44,44,25,25,28,r,25,47,47,28,28,29,r,28,48,48,29,29,33,r,29,49,49,33,33,34,r,33,50,50,34,34,36,r,34,r,r,36,36,37,r,36,r,r,37,37,r,r,37,27,27,27,27,52,52,52,52],Ke=[-2,4,16,-3,-1,11,r,33,13,35,23,30,1,r,28,40,r,37,44,r,r,-2,r,51,58,65,0,106,72,79,47,54,r,86,93,r,100,107,r,r,r,r,r,r,63,r,r,68,75,82,89,r,120,r,r,r,r,r],We=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],Le=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,r,r,21,47,48,40,51,52,49,50,44,46,3,r,r,r,13,r,r,r,r,r,r,r,32],Ne=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,r,r,4,8,8,5,7,7,8,8,9,5,6,r,r,r,6,r,r,r,r,r,r,r,6],He=[r,6,13,3,9,-1,27,-15,-10,-1,-38],Ge=[r,r,r,r,r,r,19,16,15,r,r],ke=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],O=q(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),e.const_set(h[0],"Racc_arg",[Fe,qe,We,Ke,Le,Ne,Ge,He,19,ke,O,58,35,!0]),e.const_set(h[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),e.const_set(h[0],"Racc_debug_parser",!1),e.def(a,"$_reduce_1",_=function(d,ie,z){var D;return n(this.modifier)||this.$raise($(h,"ParseError")),D=e.to_ary(d),this.$parsed(null==D[0]?r:D[0],null==D[1]?r:D[1],null==D[2]?r:D[2],null==D[3]?r:D[3])},_.$$arity=3),e.def(a,"$_reduce_2",m=function(d,ie,z){var D;return n(this.modifier)||this.$raise($(h,"ParseError")),D=e.to_ary(d),this.$parsed(null==D[0]?r:D[0],null==D[2]?r:D[2],null==D[1]?r:D[1],null==D[3]?r:D[3])},m.$$arity=3),e.def(a,"$_reduce_3",k=function(d,ie,z){var D,Se;return Se=null==(D=e.to_ary(d))[2]?r:D[2],this.$parsed(null==D[0]?r:D[0],null==D[1]?r:D[1],y(y($(h,"Arithmetic"),"Node"),"Number").$new(0),Se)},k.$$arity=3),e.def(a,"$_reduce_4",S=function(d,ie,z){var se,D=this;return n(n(se=D.prefix_number)?D.suffix_number:se)||D.$raise($(h,"ParseError")),W(["command","prefix","suffix"],{command:d["$[]"](1),prefix:d["$[]"](0),suffix:d["$[]"](2)})},S.$$arity=3),e.def(a,"$_reduce_5",E=function(d,ie,z){var D=this;return n(D.prefix_number)||D.$raise($(h,"ParseError")),n(D.need_suffix_number)&&D.$raise($(h,"ParseError")),W(["command","prefix"],{command:d["$[]"](1),prefix:d["$[]"](0)})},E.$$arity=3),e.def(a,"$_reduce_6",ce=function(d,ie,z){var D=this;return n(D.suffix_number)||D.$raise($(h,"ParseError")),n(D.need_prefix_number)&&D.$raise($(h,"ParseError")),W(["command","suffix"],{command:d["$[]"](0),suffix:d["$[]"](1)})},ce.$$arity=3),e.def(a,"$_reduce_7",ve=function(d,ie,z){var se,D=this;return n(n(se=D.need_prefix_number)?se:D.need_suffix_number)&&D.$raise($(h,"ParseError")),W(["command"],{command:d["$[]"](0)})},ve.$$arity=3),e.def(a,"$_reduce_8",ge=function(d,ie,z){return W([],{})},ge.$$arity=3),e.def(a,"$_reduce_9",Ce=function(d,ie,z){var D,Se,Ue,Me,ue=r;return ue=null==(D=e.to_ary(d))[0]?r:D[0],Se=null==D[2]?r:D[2],n(n(Me=this.critical)?ue["$[]"]("critical")["$nil?"]():Me)||this.$raise($(h,"ParseError")),t(ue,"[]=",e.to_a(Ue=["critical",Se])),j(Ue.length,1),ue},Ce.$$arity=3),e.def(a,"$_reduce_10",Re=function(d,ie,z){var D,Se,Ue,Me,ue=r;return ue=null==(D=e.to_ary(d))[0]?r:D[0],Se=null==D[2]?r:D[2],n(n(Me=this.fumble)?ue["$[]"]("fumble")["$nil?"]():Me)||this.$raise($(h,"ParseError")),t(ue,"[]=",e.to_a(Ue=["fumble",Se])),j(Ue.length,1),ue},Re.$$arity=3),e.def(a,"$_reduce_11",ze=function(d,ie,z){var D,Se,Ue,Me,ue=r;return ue=null==(D=e.to_ary(d))[0]?r:D[0],Se=null==D[2]?r:D[2],n(n(Me=this.dollar)?ue["$[]"]("dollar")["$nil?"]():Me)||this.$raise($(h,"ParseError")),t(ue,"[]=",e.to_a(Ue=["dollar",Se])),j(Ue.length,1),ue},ze.$$arity=3),e.def(a,"$_reduce_12",Te=function(d,ie,z){return d["$[]"](1)},Te.$$arity=3),e.def(a,"$_reduce_13",be=function(d,ie,z){return y(y($(h,"Arithmetic"),"Node"),"Negative").$new(d["$[]"](1))},be.$$arity=3),e.def(a,"$_reduce_14",re=function(d,ie,z){return y(y($(h,"Arithmetic"),"Node"),"BinaryOp").$new(d["$[]"](0),"+",d["$[]"](2))},re.$$arity=3),e.def(a,"$_reduce_15",te=function(d,ie,z){return y(y($(h,"Arithmetic"),"Node"),"BinaryOp").$new(d["$[]"](0),"-",d["$[]"](2))},te.$$arity=3),e.def(a,"$_reduce_16",i=function(d,ie,z){return n(this.allowed_cmp_op["$include?"](r))||this.$raise($(h,"ParseError")),W([],{})},i.$$arity=3),e.def(a,"$_reduce_17",V=function(d,ie,z){var D,ue,Be;return Be=null==(D=e.to_ary(d))[1]?r:D[1],n(this.allowed_cmp_op["$include?"](ue=null==D[0]?r:D[0]))||this.$raise($(h,"ParseError")),W(["cmp_op","target"],{cmp_op:ue,target:Be})},V.$$arity=3),e.def(a,"$_reduce_18",G=function(d,ie,z){var se,D=this;return se=d["$[]"](0),n(D.question_target)||D.$raise($(h,"ParseError")),n(D.allowed_cmp_op["$include?"](se))||D.$raise($(h,"ParseError")),W(["cmp_op","target"],{cmp_op:se,target:"?"})},G.$$arity=3),e.def(a,"$_reduce_19",B=function(d,ie,z){return y(y($(h,"Arithmetic"),"Node"),"BinaryOp").$new(d["$[]"](0),"+",d["$[]"](2))},B.$$arity=3),e.def(a,"$_reduce_20",$e=function(d,ie,z){return y(y($(h,"Arithmetic"),"Node"),"BinaryOp").$new(d["$[]"](0),"-",d["$[]"](2))},$e.$$arity=3),e.def(a,"$_reduce_22",ae=function(d,ie,z){return y(y($(h,"Arithmetic"),"Node"),"BinaryOp").$new(d["$[]"](0),"*",d["$[]"](2))},ae.$$arity=3),e.def(a,"$_reduce_23",fe=function(d,ie,z){return d["$[]"](3).$new(d["$[]"](0),d["$[]"](2))},fe.$$arity=3),e.def(a,"$_reduce_25",we=function(d,ie,z){return y(y($(h,"Arithmetic"),"Node"),"DivideWithGameSystemDefault")},we.$$arity=3),e.def(a,"$_reduce_26",oe=function(d,ie,z){return y(y($(h,"Arithmetic"),"Node"),"DivideWithCeil")},oe.$$arity=3),e.def(a,"$_reduce_27",le=function(d,ie,z){return y(y($(h,"Arithmetic"),"Node"),"DivideWithCeil")},le.$$arity=3),e.def(a,"$_reduce_28",he=function(d,ie,z){return y(y($(h,"Arithmetic"),"Node"),"DivideWithRound")},he.$$arity=3),e.def(a,"$_reduce_29",Pe=function(d,ie,z){return y(y($(h,"Arithmetic"),"Node"),"DivideWithFloor")},Pe.$$arity=3),e.def(a,"$_reduce_30",me=function(d,ie,z){return d["$[]"](1)},me.$$arity=3),e.def(a,"$_reduce_31",De=function(d,ie,z){return y(y($(h,"Arithmetic"),"Node"),"Negative").$new(d["$[]"](1))},De.$$arity=3),e.def(a,"$_reduce_33",ye=function(d,ie,z){return d["$[]"](1)},ye.$$arity=3),e.def(a,"$_reduce_34",Ae=function(d,ie,z){return y(y($(h,"Arithmetic"),"Node"),"Number").$new(d["$[]"](0))},Ae.$$arity=3),void e.def(a,"$_reduce_none",Ie=function(d,ie,z){return d["$[]"](0)},Ie.$$arity=3)},Opal.modules["bcdice/deprecated/checker"]=function(e){var H,M,Q,ee,Y,U,v,a,h,L,x,l,q,X=[],P=e.nil,y=e.$$,$=e.module,K=e.send,c=e.truthy;return H=X,M=q=[$(X[0],"BCDice")].concat(H),Q=l=[$(q[0],"Deprecated")].concat(M),L=$(l[0],"Checker"),x=[L].concat(Q),L.$private(),e.def(L,"$check_result_legacy",ee=function(f,N,o,u){var C,A,R=this,F=P,J=P,g=P,b=P,p=P;return F=K(N,"map",[],"sides".$to_proc()),C=(J=K(N,"map",[],"value".$to_proc())).$sum(),g=[100]["$==="](b=F)?R.$check_1D100(f,C,o,u):[20]["$==="](b)?R.$check_1D20(f,C,o,u):[6,6]["$==="](b)?R.$check_2D6(f,C,J,o,u):P,c(c(A=g["$nil?"]())?A:g["$empty?"]())&&(b=F.$uniq(),g=[10]["$==="](b)?R.$check_nD10(f,C,J,o,u):[6]["$==="](b)?R.$check_nD6(f,C,J,o,u):P,c(c(p=g["$nil?"]())?p:g["$empty?"]()))?P:y(x,"Result").$new(g.$delete_prefix(" \uff1e "))},ee.$$arity=4),e.def(L,"$check_1D100",Y=function(f,N,o,u){return P},Y.$$arity=4),e.def(L,"$check_1D20",U=function(f,N,o,u){return P},U.$$arity=4),e.def(L,"$check_nD10",v=function(f,N,o,u,R){return P},v.$$arity=5),e.def(L,"$check_2D6",a=function(f,N,o,u,R){return P},a.$$arity=5),void e.def(L,"$check_nD6",h=function(f,N,o,u,R){return P},h.$$arity=5)},Opal.modules["bcdice/base"]=function(e){function j(w,Q){return"number"==typeof w&&"number"==typeof Q?w+Q:w["$+"](Q)}function X(w,Q){return"number"==typeof w&&"number"==typeof Q?w-Q:w["$-"](Q)}var Q,U,h,s,f,N,o,u,R,F,J,C,g,b,A,p,T,_,m,k,S,E,ce,ve,ge,Ce,Re,ze,Te,be,re,te,G,B,$e,ae,fe,V,v,a,x,$=e.top,K=[],c=e.nil,W=e.$$$,H=e.$$,t=e.module,q=e.klass,n=e.truthy,M=e.send,Z=e.range,l=c;return $.$require("i18n"),$.$require("i18n/backend/fallbacks"),$.$require("bcdice/randomizer"),$.$require("bcdice/dice_table"),$.$require("bcdice/enum"),$.$require("bcdice/translate"),$.$require("bcdice/result"),$.$require("bcdice/command/parser"),$.$require("bcdice/deprecated/checker"),Q=K,U=x=[t(K[0],"BCDice")].concat(Q),v=q(x[0],null,"Base"),a=[v].concat(U),v.$$prototype.sort_add_dice=v.$$prototype.sort_barabara_dice=v.$$prototype.enabled_d9=v.$$prototype.raw_input=v.$$prototype.randomizer=v.$$prototype.enabled_upcase_input=v.$$prototype.debug=c,te=e.get_singleton_class(v),V=[te].concat(a),te.$attr_reader("prefixes"),e.def(te,"$register_prefix",G=function(oe){var he,Pe=this,me=c;return null==Pe.prefixes&&(Pe.prefixes=c),he=e.slice.call(arguments,0,arguments.length),Pe.prefixes=n(me=Pe.prefixes)?me:[],Pe.prefixes.$concat(he.$flatten())},G.$$arity=-1),e.def(te,"$register_prefix_from_super_class",B=function(){return this.$register_prefix(this.$superclass().$prefixes())},B.$$arity=0),e.def(te,"$prefixes_pattern",$e=function(){var le,oe=this,he=c;return null==oe.prefixes_pattern&&(oe.prefixes_pattern=c),null==oe.prefixes&&(oe.prefixes=c),oe.prefixes_pattern=n(le=oe.prefixes_pattern)?le:c,n(oe.prefixes_pattern)?oe.prefixes_pattern:(oe.prefixes=n(he=oe.prefixes)?he:[],oe.prefixes.$freeze(),oe.prefixes_pattern=(n(oe.prefixes["$empty?"]())?/(?!)/:e.regexp(["^(S)?(",oe.prefixes.$join("|"),")"],"i")).$freeze())},$e.$$arity=0),e.def(te,"$command_pattern",ae=function(){var oe,he,le=this,Pe=c,me=c;return null==le.command_pattern&&(le.command_pattern=c),null==le.prefixes&&(le.prefixes=c),le.command_pattern=n(he=le.command_pattern)?he:c,n(le.command_pattern)?le.command_pattern:(le.prefixes=n(Pe=le.prefixes)?Pe:[],le.prefixes.$freeze(),me=j(M(W(H(V,"CommonCommand"),"COMMANDS"),"map",[],((oe=function(ye){return null==ye&&(ye=c),W(ye,"PREFIX_PATTERN").$source()}).$$s=le,oe.$$arity=1,oe)),le.prefixes),le.command_pattern=e.regexp(["^S?(",me.$join("|"),")"],"i").$freeze())},ae.$$arity=0),e.def(te,"$eval",fe=function(oe){return this.$new(oe).$eval()},fe.$$arity=1),v.$include(H(a,"Translate")),v.$include(W(H(a,"Deprecated"),"Checker")),e.def(v,"$initialize",h=function(i){var V=this;return V.raw_input=i,V.sort_add_dice=!1,V.sort_barabara_dice=!1,V.d66_sort_type=W(H(a,"D66SortType"),"NO_SORT"),V.enabled_d9=!1,V.round_type=W(H(a,"RoundType"),"FLOOR"),V.sides_implicit_d=6,V.upper_dice_reroll_threshold=c,V.reroll_dice_reroll_threshold=c,V.default_cmp_op=c,V.default_target_number=c,V.enabled_upcase_input=!0,V.locale="ja_jp",V.randomizer=W(H(a,"BCDice"),"Randomizer").$new(),V.debug=!1},h.$$arity=1),v.$attr_accessor("randomizer"),v.$attr_reader("d66_sort_type"),v.$attr_reader("round_type"),v.$attr_reader("sides_implicit_d"),v.$attr_reader("upper_dice_reroll_threshold"),v.$attr_reader("reroll_dice_reroll_threshold"),v.$attr_reader("default_cmp_op"),v.$attr_reader("default_target_number"),e.def(v,"$sort_add_dice?",s=function(){return this.sort_add_dice},s.$$arity=0),e.def(v,"$sort_barabara_dice?",f=function(){return this.sort_barabara_dice},f.$$arity=0),e.def(v,"$enabled_d9?",N=function(){return this.enabled_d9},N.$$arity=0),e.def(v,"$enable_debug",o=function(){return this.debug=!0},o.$$arity=0),e.def(v,"$eval",u=function(){var V,G,B,i=this,$e=c;return V=W(H(a,"BCDice"),"Preprocessor").$process(i.raw_input,i),G=n(B=i.$dice_command(V))?B:i.$eval_common_command(i.raw_input),n(G)?($e=[i.randomizer.$rand_results()],M(G,"rands=",e.to_a($e)),X($e.length,1),$e=[i.randomizer.$detailed_rand_results()],M(G,"detailed_rands=",e.to_a($e)),X($e.length,1),G):c},u.$$arity=0),e.def(v,"$change_text",R=function(i){return i},R.$$arity=1),e.def(v,"$check_result",F=function(i,V,G,B){var $e=this,ae=c,fe=c,we=c,oe=c,le=c;return ae=$e.$check_result_legacy(i,V,G,B),n(ae)?ae:(fe=M(V,"map",[],"sides".$to_proc()),oe=(we=M(V,"map",[],"value".$to_proc())).$sum(),(ae=[100]["$==="](le=fe)?$e.$result_1d100(i,oe,G,B):[20]["$==="](le)?$e.$result_1d20(i,oe,G,B):[6,6]["$==="](le)?$e.$result_2d6(i,oe,we,G,B):c)["$=="](H(a,"Result").$nothing())?c:n(ae)?ae:(le=fe.$uniq(),(ae=[10]["$==="](le)?$e.$result_nd10(i,oe,we,G,B):[6]["$==="](le)?$e.$result_nd6(i,oe,we,G,B):c)["$=="](H(a,"Result").$nothing())?c:n(ae)?ae:$e.$result_ndx(i,G,B)))},F.$$arity=4),e.def(v,"$grich_text",J=function(i,V,G){return c},J.$$arity=3),v.$private(),e.def(v,"$eval_common_command",C=function(i){try{var V;return i=this.$change_text(i),M(W(H(a,"CommonCommand"),"COMMANDS"),"each",[],((V=function($e){var fe,ae=null==V.$$s?this:V.$$s;if(null==ae.randomizer&&(ae.randomizer=c),null==$e&&($e=c),fe=$e.$eval(i,ae,ae.randomizer),!n(fe))return c;e.ret(fe)}).$$s=this,V.$$arity=1,V)),c}catch(B){if(B===e.returner)return B.$v;throw B}},C.$$arity=1),e.def(v,"$dice_command",g=function(i){var V,G=this,B=c,$e=c,ae=c,fe=c,we=c,oe=c,le=c;return n(G.enabled_upcase_input)&&(i=i.$upcase()),B=G.$class().$prefixes_pattern().$match(i),n(B)?($e=B["$[]"](1)["$nil?"]()["$!"](),n($e)&&(i=i["$[]"](Z(1,-1,!1))),ae=G.$eval_game_system_specific_command(i),n(ae["$is_a?"](H(a,"Result")))?(fe=[n(we=ae["$secret?"]())?we:$e],M(ae,"secret=",e.to_a(fe)),X(fe.length,1),ae):n(n(oe=n(le=ae["$nil?"]())?le:ae["$empty?"]())?oe:ae["$=="]("1"))?c:M(H(a,"Result").$new(),"tap",[],((V=function(Pe){return null==Pe&&(Pe=c),fe=[ae.$to_s()],M(Pe,"text=",e.to_a(fe)),X(fe.length,1),M(Pe,"secret=",e.to_a(fe=[$e])),fe[X(fe.length,1)]}).$$s=G,V.$$arity=1,V))):c},g.$$arity=1),e.def(v,"$eval_game_system_specific_command",b=function(i){return c},b.$$arity=1),e.def(v,"$result_ndx",A=function(i,V,G){return n(G["$is_a?"](H(a,"String")))?c:n(i.$send(V,G))?H(a,"Result").$success(this.$translate("success")):H(a,"Result").$failure(this.$translate("failure"))},A.$$arity=3),e.def(v,"$result_1d100",p=function(i,V,G,B){return c},p.$$arity=4),e.def(v,"$result_1d20",T=function(i,V,G,B){return c},T.$$arity=4),e.def(v,"$result_nd10",_=function(i,V,G,B,$e){return c},_.$$arity=5),e.def(v,"$result_2d6",m=function(i,V,G,B,$e){return c},m.$$arity=5),e.def(v,"$result_nd6",k=function(i,V,G,B,$e){return c},k.$$arity=5),e.def(v,"$get_table_by_2d6",S=function(i){return this.$get_table_by_nD6(i,2)},S.$$arity=1),e.def(v,"$get_table_by_1d6",E=function(i){return this.$get_table_by_nD6(i,1)},E.$$arity=1),e.def(v,"$get_table_by_nD6",ce=function(i,V){return this.$get_table_by_nDx(i,V,6)},ce.$$arity=2),e.def(v,"$get_table_by_nDx",ve=function(i,V,G){var $e,ae=c;return $e=this.randomizer.$roll_sum(V,G),ae=this.$get_table_value(i["$[]"](X($e,V))),n(ae["$nil?"]())?["1",0]:[ae,$e]},ve.$$arity=3),e.def(v,"$get_table_by_1d3",ge=function(i){var B,$e,w,V=this,ae=c;return V.$debug("get_table_by_1d3"),B=V.randomizer.$roll_sum(1,6),V.$debug("num",B),$e=(w=X(B,1),"number"==typeof w?w/2:w["$/"](2)).$to_i(),V.$debug("index",$e),ae=i["$[]"]($e),n(ae["$nil?"]())?["1",0]:[ae,B]},ge.$$arity=1),e.def(v,"$get_table_by_d66_swap",Ce=function(i){var G;return G=this.randomizer.$roll_d66(W(H(a,"D66SortType"),"ASC")),[this.$get_table_by_number(G,i),G]},Ce.$$arity=1),e.def(v,"$get_table_by_d66",Re=function(i){var G,B,$e,fe,w,ae=c;return G=this.randomizer.$roll_once(6),B=this.randomizer.$roll_once(6),$e=j("number"==typeof(w=X(G,1))?6*w:w["$*"](6),X(B,1)),ae=i["$[]"]($e),fe=""+G+B,n(ae["$nil?"]())?["1",fe]:[ae,fe]},Re.$$arity=1),e.def(v,"$get_table_by_number",ze=function(i,V,G){try{var B;return null==G&&(G="1"),M(V,"each",[],((B=function(fe){var oe,we=null==B.$$s?this:B.$$s;if(null==fe&&(fe=c),oe=fe["$[]"](0),!n(function(w,Q){return"number"==typeof w&&"number"==typeof Q?w>=Q:w["$>="](Q)}(oe,i)))return c;e.ret(we.$get_table_value(fe["$[]"](1)))}).$$s=this,B.$$arity=1,B)),this.$get_table_value(G)}catch(ae){if(ae===e.returner)return ae.$v;throw ae}},ze.$$arity=-3),e.def(v,"$get_table_value",Te=function(i){return n(i["$is_a?"](H(a,"Proc")))?i.$call():i},Te.$$arity=1),e.def(v,"$roll_tables",be=function(i,V){var B=c;return B=V["$[]"](i),n(B)?B.$roll(this.randomizer).$to_s():c},be.$$arity=2),e.def(v,"$debug",re=function(i,V){var B,$e,ae=this,fe=c,we=c;return B=e.slice.call(arguments,1,arguments.length),n(ae.debug)?(fe=n(i["$is_a?"](H(a,"String")))?i:i.$inspect(),n(B["$empty?"]())?ae.$warn(fe):(we=M(B,"map",[],(($e=function(le){return null==le&&(le=c),n(le["$is_a?"](H(a,"String")))?'"'+le+'"':le.$inspect()}).$$s=ae,$e.$$arity=1,$e)),ae.$warn(fe+": "+we.$join(", ")))):c},re.$$arity=-2),W(W(H(K,"I18n"),"Backend"),"Simple").$include(W(W(H(K,"I18n"),"Backend"),"Fallbacks")),H(K,"I18n").$load_path()["$<<"](H(K,"Dir")["$[]"](H(K,"File").$join($.$__dir__(),"../../i18n/**/*.yml"))),l=["ja_jp"],M(H(K,"I18n"),"default_locale=",e.to_a(l)),X(l.length,1),l=[["ja_jp"]],M(H(K,"I18n").$fallbacks(),"defaults=",e.to_a(l)),l[X(l.length,1)]},Opal.modules["bcdice/game_system/sword_world/rating_lexer"]=function(e){var q,l,ee,h,N,o,u,s,f,U,Q,M,X=[],P=e.nil,y=e.$$,$=e.module,K=e.klass,c=e.hash2,W=e.truthy,H=e.send;return e.top.$require("strscan"),q=X,l=M=[$(X[0],"BCDice")].concat(q),ee=Q=[$(M[0],"GameSystem")].concat(l),h=U=[K(Q[0],y(Q,"Base"),"SwordWorld")].concat(ee),s=K(U[0],null,"RatingLexer"),f=[s].concat(h),s.$$prototype.scanner=P,e.const_set(f[0],"SYMBOLS",c(["+","-","*","/","(",")","[","]","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),e.def(s,"$initialize",N=function(F){var J,C,b;return F=W(b=(C=(J=F)===P||null==J?P:H(J,"split",[" ",2]))===P||null==C?P:H(C,"first",[]))?b:"",this.scanner=y(f,"StringScanner").$new(F)},N.$$arity=1),e.def(s,"$next_token",o=function(){var F=this,J=P,C=P,b=P;return W(F.scanner["$eos?"]())?[!1,"$"]:W(J=F.scanner.$scan(/\d+/))?["NUMBER",J.$to_i()]:(C=F.scanner.$getch().$upcase(),[W(b=y(f,"SYMBOLS")["$[]"](C))?b:C.$to_sym(),C])},o.$$arity=0),void e.def(s,"$source",u=function(){return this.scanner.$string()},u.$$arity=0)},Opal.modules["bcdice/game_system/sword_world/rating_parsed"]=function(e){function j(q,n){return"number"==typeof q&&"number"==typeof n?q<n:q["$<"](n)}function X(q,n){return"number"==typeof q&&"number"==typeof n?q+n:q["$+"](n)}function P(q,n){return"number"==typeof q&&"number"==typeof n?q>n:q["$>"](n)}var n,w,Y,s,o,u,R,F,J,C,g,b,A,p,T,_,m,f,N,v,L,Z,y=[],$=e.nil,c=e.$$,W=e.module,H=e.klass,t=e.truthy;return n=y,w=Z=[W(y[0],"BCDice")].concat(n),Y=L=[W(Z[0],"GameSystem")].concat(w),s=v=[H(L[0],c(L,"Base"),"SwordWorld")].concat(Y),f=H(v[0],null,"RatingParsed"),N=[f].concat(s),f.$$prototype.modifier_after_half=f.$$prototype.critical=f.$$prototype.semi_fixed_val=f.$$prototype.kept_modify=f.$$prototype.first_modify=f.$$prototype.first_to=f.$$prototype.rateup=f.$$prototype.tmp_fixed_val=f.$$prototype.rate=f.$$prototype.greatest_fortune=f.$$prototype.modifier=$,f.$attr_accessor("rate"),f.$attr_writer("critical"),f.$attr_writer("kept_modify"),f.$attr_writer("first_to"),f.$attr_writer("first_modify"),f.$attr_writer("rateup"),f.$attr_accessor("greatest_fortune"),f.$attr_writer("semi_fixed_val"),f.$attr_writer("tmp_fixed_val"),f.$attr_accessor("modifier"),f.$attr_writer("modifier_after_half"),e.def(f,"$initialize",o=function(){var S=this;return S.critical=$,S.min_critical=$,S.kept_modify=$,S.first_to=$,S.first_modify=$,S.greatest_fortune=!1,S.rateup=$,S.semi_fixed_val=$,S.tmp_fixed_val=$},o.$$arity=0),e.def(f,"$half",u=function(){return this.modifier_after_half["$nil?"]()["$!"]()},u.$$arity=0),e.def(f,"$critical",R=function(){var E;return t(E=this.critical)?E:t(this.$half())?13:10},R.$$arity=0),e.def(f,"$min_critical",F=function(){var S=this,E=$;return E=3,t(S.semi_fixed_val["$nil?"]())||(t(S.kept_modify["$nil?"]())?t(j(E,X(S.semi_fixed_val,2)))&&(E=X(S.semi_fixed_val,2)):t(j(E,X(X(S.semi_fixed_val,S.kept_modify),2)))&&(E=X(X(S.semi_fixed_val,S.kept_modify),2)),S.semi_fixed_val["$=="](1)&&(E=3)),t(P(E,13))&&(E=13),E},F.$$arity=0),e.def(f,"$first_modify",J=function(){var E;return t(E=this.first_modify)?E:0},J.$$arity=0),e.def(f,"$first_to",C=function(){var E;return t(E=this.first_to)?E:0},C.$$arity=0),e.def(f,"$rateup",g=function(){var E;return t(E=this.rateup)?E:0},g.$$arity=0),e.def(f,"$semi_fixed_val",b=function(){var ce,E=$;return E=t(ce=this.semi_fixed_val)?ce:0,t(P(E,6))&&(E=6),E},b.$$arity=0),e.def(f,"$tmp_fixed_val",A=function(){var ce,E=$;return E=t(ce=this.tmp_fixed_val)?ce:0,t(P(E,6))&&(E=6),E},A.$$arity=0),e.def(f,"$kept_modify",p=function(){var E;return t(E=this.kept_modify)?E:0},p.$$arity=0),e.def(f,"$modifier_after_half",T=function(){var E;return t(E=this.modifier_after_half)?E:0},T.$$arity=0),e.def(f,"$to_s",_=function(){var S=this,E=$;return E="KeyNo."+S.rate,t(j(S.$critical(),13))&&(E=X(E,"c["+S.$critical()+"]")),t(S.$first_modify()["$!="](0))&&(E=X(E,"m["+c(N,"Format").$modifier(S.$first_modify())+"]")),t(S.$first_to()["$!="](0))&&(E=X(E,"m["+S.$first_to()+"]")),t(S.$rateup()["$!="](0))&&(E=X(E,"r["+S.$rateup()+"]")),t(S.greatest_fortune)&&(E=X(E,"gf")),t(S.$semi_fixed_val()["$!="](0))&&(E=X(E,"sf["+S.$semi_fixed_val()+"]")),t(S.$tmp_fixed_val()["$!="](0))&&(E=X(E,"tf["+S.$tmp_fixed_val()+"]")),t(S.$kept_modify()["$!="](0))&&(E=X(E,"a["+c(N,"Format").$modifier(S.$kept_modify())+"]")),t(S.modifier["$!="](0))&&(E=X(E,c(N,"Format").$modifier(S.modifier))),E},_.$$arity=0),void e.def(f,"$infinite_roll?",m=function(){return j(this.$critical(),this.$min_critical())},m.$$arity=0)},Opal.modules["bcdice/game_system/sword_world/rating_parser"]=function(e){function j(M,Z){return"number"==typeof M&&"number"==typeof Z?M-Z:M["$-"](Z)}var Z,L,v,N,R,F,J,C,g,b,A,p,T,_,m,k,S,E,ce,ve,ge,Ce,Re,ze,Te,be,re,te,i,V,G,B,$e,ae,fe,we,oe,le,he,Pe,me,De,ye,Ae,Ie,Fe,qe,Ke,Ne,o,u,h,ee,w,X=e.top,P=[],r=e.nil,y=e.$$$,$=e.$$,K=e.module,c=e.klass,W=e.hash2,H=e.send2,t=e.send,q=e.hash,n=e.truthy;return X.$require("racc/parser.rb"),X.$require("bcdice/arithmetic/node"),X.$require("bcdice/enum"),X.$require("bcdice/game_system/sword_world/rating_lexer"),X.$require("bcdice/game_system/sword_world/rating_parsed"),Z=P,L=w=[K(P[0],"BCDice")].concat(Z),v=ee=[K(w[0],"GameSystem")].concat(L),N=h=[c(ee[0],$(ee,"Base"),"SwordWorld")].concat(v),o=c(h[0],y($(h,"Racc"),"Parser"),"RatingParser"),u=[o].concat(N),o.$$prototype.lexer=o.$$prototype.version=r,e.def(o,"$initialize",R=function(_e){var xe,O;if(R.$$p&&(R.$$p=null),null==_e)_e=W([],{});else if(!_e.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(xe=_e.$$smap.version)&&(xe="v1_0"),null==(O=_e.$$smap.round_type)&&(O=y($(u,"RoundType"),"CEIL")),H(this,e.find_super_dispatcher(this,"initialize",R,!1,!0),"initialize",[],null),this.version=xe,this.round_type=O},R.$$arity=-1),e.def(o,"$set_debug",F=function(){return this.yydebug=!0,this},F.$$arity=0),e.def(o,"$parse",J=function(_e){try{return this.lexer=$(u,"RatingLexer").$new(_e),this.$do_parse()}catch(O){if(!e.rescue(O,[$(u,"ParseError"),$(u,"ZeroDivisionError")]))throw O;try{return r}finally{e.pop_exception()}}},J.$$arity=1),o.$private(),e.def(o,"$parsed",C=function(_e,xe,O){var I;return t($(u,"RatingParsed").$new(),"tap",[],((I=function(d){var z,D,se,Ee,ie=null==I.$$s?this:I.$$s,ue=r;return null==ie.round_type&&(ie.round_type=r),null==d&&(d=r),t(d,"rate=",e.to_a(ue=[_e])),j(ue.length,1),ue=[(z=O["$[]"]("critical"),z===r||null==z?r:t(z,"eval",[ie.round_type]))],t(d,"critical=",e.to_a(ue)),j(ue.length,1),ue=[(D=O["$[]"]("kept_modify"),D===r||null==D?r:t(D,"eval",[ie.round_type]))],t(d,"kept_modify=",e.to_a(ue)),j(ue.length,1),ue=[O["$[]"]("first_to")],t(d,"first_to=",e.to_a(ue)),j(ue.length,1),ue=[O["$[]"]("first_modify")],t(d,"first_modify=",e.to_a(ue)),j(ue.length,1),ue=[(se=O["$[]"]("rateup"),se===r||null==se?r:t(se,"eval",[ie.round_type]))],t(d,"rateup=",e.to_a(ue)),j(ue.length,1),ue=[O.$fetch("greatest_fortune",!1)],t(d,"greatest_fortune=",e.to_a(ue)),j(ue.length,1),ue=[O["$[]"]("semi_fixed_val")],t(d,"semi_fixed_val=",e.to_a(ue)),j(ue.length,1),ue=[O["$[]"]("tmp_fixed_val")],t(d,"tmp_fixed_val=",e.to_a(ue)),j(ue.length,1),ue=[xe.$eval(ie.round_type)],t(d,"modifier=",e.to_a(ue)),j(ue.length,1),ue=[(Ee=O["$[]"]("modifier_after_half"),Ee===r||null==Ee?r:t(Ee,"eval",[ie.round_type]))],t(d,"modifier_after_half=",e.to_a(ue)),ue[j(ue.length,1)]}).$$s=this,I.$$arity=1,I))},C.$$arity=3),e.def(o,"$next_token",g=function(){return this.lexer.$next_token()},g.$$arity=0),Pe=[15,14,16,5,17,18,20,21,57,58,23,24,11,59,12,19,13,15,14,16,4,17,18,20,21,4,30,3,30,11,8,12,19,13,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,9,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,37,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,38,39,32,26,27,26,27,29,46,29,33,34,51,52,53,54],me=[6,6,6,1,6,6,6,6,49,49,10,10,6,49,6,6,6,22,22,22,3,22,22,22,22,0,11,0,12,22,4,22,22,22,11,11,12,12,11,14,12,15,41,41,43,43,19,14,14,15,15,14,20,15,19,19,5,21,19,23,20,20,44,44,20,21,21,23,23,21,24,23,26,45,45,50,50,27,24,24,26,26,24,29,26,27,27,16,55,27,56,29,29,62,62,29,55,55,56,56,55,57,56,58,63,63,17,18,13,57,57,58,58,57,25,58,13,13,33,34,38,39],De=[22,3,r,17,28,56,-4,r,r,r,0,24,26,106,37,39,80,99,100,44,50,55,13,57,68,97,70,75,r,81,r,r,r,116,117,r,r,r,118,119,r,30,r,32,50,61,r,r,r,-2,63,r,r,r,r,86,88,99,101,r,r,r,81,92],ye=[-33,-33,-4,-33,-33,-33,-1,-4,-3,64,-5,-33,-33,-33,-11,-33,-33,-33,-33,-33,-33,-33,-2,-33,-33,-33,-33,-33,-30,-33,-32,-7,-8,-33,-33,-12,-13,-14,-33,-33,-17,-18,-27,-19,-20,-21,-6,-28,-29,-33,-24,-9,-10,-15,-16,-33,-33,-33,-33,-31,-25,-26,-22,-23],Ae=[25,31,6,35,36,1,49,22,40,41,43,2,44,45,7,47,48,r,50,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,60,61,62,63],Ie=[5,5,3,5,5,1,7,3,5,6,6,2,6,6,2,5,5,r,6,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,5,5,6,6],Fe=[r,5,11,0,r,-11,-11,-23,r],qe=[r,r,r,r,10,42,r,r,28],Ke=[0,0,"racc_error",2,22,"_reduce_1",3,22,"_reduce_2",2,23,"_reduce_3",0,24,"_reduce_4",2,24,"_reduce_5",4,24,"_reduce_6",3,24,"_reduce_7",3,24,"_reduce_8",4,24,"_reduce_9",4,24,"_reduce_10",2,24,"_reduce_11",3,24,"_reduce_12",3,24,"_reduce_13",3,24,"_reduce_14",4,24,"_reduce_15",4,24,"_reduce_16",3,24,"_reduce_17",2,25,"_reduce_18",2,25,"_reduce_19",3,25,"_reduce_20",3,25,"_reduce_21",3,28,"_reduce_22",3,28,"_reduce_23",1,28,"_reduce_none",3,27,"_reduce_25",3,27,"_reduce_26",1,27,"_reduce_none",2,26,"_reduce_28",2,26,"_reduce_29",1,26,"_reduce_none",3,29,"_reduce_31",1,29,"_reduce_32"],Ne=q(!1,0,"error",1,"NUMBER",2,"K",3,"R",4,"H",5,"G",6,"F",7,"S",8,"T",9,"PLUS",10,"MINUS",11,"ASTERISK",12,"SLASH",13,"PARENL",14,"PARENR",15,"BRACKETL",16,"BRACKETR",17,"AT",18,"SHARP",19,"DOLLAR",20),e.const_set(u[0],"Racc_arg",[Pe,me,ye,De,Ae,Ie,qe,Fe,21,Ke,Ne,64,33,!0]),e.const_set(u[0],"Racc_token_to_s_table",["$end","error","NUMBER","K","R","H","G","F","S","T","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","AT","SHARP","DOLLAR","$start","expr","rate","option","modifier","unary","mul","add","term"]),e.const_set(u[0],"Racc_debug_parser",!1),e.def(o,"$_reduce_1",b=function(_e,xe,O){var I,d,z,D,ie=r;return d=null==(I=e.to_ary(_e))[0]?r:I[0],z=n(D=(ie=null==I[1]?r:I[1])["$[]"]("modifier"))?D:y(y($(u,"Arithmetic"),"Node"),"Number").$new(0),this.$parsed(d,z,ie)},b.$$arity=3),e.def(o,"$_reduce_2",A=function(_e,xe,O){var I,ie,Ee,ue,z=r,se=r;return ie=null==(I=e.to_ary(_e))[1]?r:I[1],n((z=null==I[2]?r:I[2])["$[]"]("modifier_after_half"))||(se=["modifier_after_half",y(y($(u,"Arithmetic"),"Node"),"Number").$new(0)],t(z,"[]=",e.to_a(se)),j(se.length,1)),Ee=n(ue=z["$[]"]("modifier"))?ue:y(y($(u,"Arithmetic"),"Node"),"Number").$new(0),this.$parsed(ie,Ee,z)},A.$$arity=3),e.def(o,"$_reduce_3",p=function(_e,xe,O){return _e["$[]"](1).$to_i()},p.$$arity=3),e.def(o,"$_reduce_4",T=function(_e,xe,O){return W([],{})},T.$$arity=3),e.def(o,"$_reduce_5",_=function(_e,xe,O){var I,ie,z,d=r;return ie=null==(I=e.to_ary(_e))[1]?r:I[1],n((d=null==I[0]?r:I[0])["$[]"]("modifier")["$nil?"]())||this.$raise($(u,"ParseError")),t(d,"[]=",e.to_a(z=["modifier",ie])),j(z.length,1),d},_.$$arity=3),e.def(o,"$_reduce_6",m=function(_e,xe,O){var I,z,D,d=r;return z=null==(I=e.to_ary(_e))[2]?r:I[2],n((d=null==I[0]?r:I[0])["$[]"]("critical")["$nil?"]())||this.$raise($(u,"ParseError")),t(d,"[]=",e.to_a(D=["critical",z])),j(D.length,1),d},m.$$arity=3),e.def(o,"$_reduce_7",k=function(_e,xe,O){var I,z,D,d=r;return z=null==(I=e.to_ary(_e))[2]?r:I[2],n((d=null==I[0]?r:I[0])["$[]"]("critical")["$nil?"]())||this.$raise($(u,"ParseError")),t(d,"[]=",e.to_a(D=["critical",z])),j(D.length,1),d},k.$$arity=3),e.def(o,"$_reduce_8",S=function(_e,xe,O){var I,se,D,d=r,z=r;return z=null==(I=e.to_ary(_e))[2]?r:I[2],n(n(D=(d=null==I[0]?r:I[0])["$[]"]("first_to")["$nil?"]())?d["$[]"]("first_modify")["$nil?"]():D)||this.$raise($(u,"ParseError")),se=["first_to",z.$to_i()],t(d,"[]=",e.to_a(se)),j(se.length,1),d},S.$$arity=3),e.def(o,"$_reduce_9",E=function(_e,xe,O){var I,se,D,d=r,z=r;return z=null==(I=e.to_ary(_e))[3]?r:I[3],n(n(D=(d=null==I[0]?r:I[0])["$[]"]("first_to")["$nil?"]())?d["$[]"]("first_modify")["$nil?"]():D)||this.$raise($(u,"ParseError")),se=["first_modify",z.$to_i()],t(d,"[]=",e.to_a(se)),j(se.length,1),d},E.$$arity=3),e.def(o,"$_reduce_10",ce=function(_e,xe,O){var I,se,D,d=r,z=r;return z=null==(I=e.to_ary(_e))[3]?r:I[3],n(n(D=(d=null==I[0]?r:I[0])["$[]"]("first_to")["$nil?"]())?d["$[]"]("first_modify")["$nil?"]():D)||this.$raise($(u,"ParseError")),se=["first_modify",z.$to_i()["$-@"]()],t(d,"[]=",e.to_a(se)),j(se.length,1),d},ce.$$arity=3),e.def(o,"$_reduce_11",ve=function(_e,xe,O){var I,z,d=r;return I=e.to_ary(_e),n((d=null==I[0]?r:I[0])["$[]"]("modifier_after_half")["$nil?"]())||this.$raise($(u,"ParseError")),z=["modifier_after_half",y(y($(u,"Arithmetic"),"Node"),"Number").$new(0)],t(d,"[]=",e.to_a(z)),j(z.length,1),d},ve.$$arity=3),e.def(o,"$_reduce_12",ge=function(_e,xe,O){var I,z,D,d=r;return z=null==(I=e.to_ary(_e))[2]?r:I[2],n((d=null==I[0]?r:I[0])["$[]"]("modifier_after_half")["$nil?"]())||this.$raise($(u,"ParseError")),t(d,"[]=",e.to_a(D=["modifier_after_half",z])),j(D.length,1),d},ge.$$arity=3),e.def(o,"$_reduce_13",Ce=function(_e,xe,O){var I,z,se,D,d=r;return d=null==(I=e.to_ary(_e))[0]?r:I[0],z=null==I[2]?r:I[2],n(n(D=["v2_5","v2_0"]["$include?"](this.version))?d["$[]"]("rateup")["$nil?"]():D)||this.$raise($(u,"ParseError")),t(d,"[]=",e.to_a(se=["rateup",z])),j(se.length,1),d},Ce.$$arity=3),e.def(o,"$_reduce_14",Re=function(_e,xe,O){var I,z,ne=this,d=r;return d=null==(I=e.to_ary(_e))[0]?r:I[0],n(["v2_5","v2_0"]["$include?"](ne.version))||ne.$raise($(u,"ParseError")),n(d["$[]"]("greatest_fortune")["$nil?"]())||ne.$raise($(u,"ParseError")),n(d["$[]"]("semi_fixed_val")["$nil?"]())||ne.$raise($(u,"ParseError")),n(d["$[]"]("tmp_fixed_val")["$nil?"]())||ne.$raise($(u,"ParseError")),t(d,"[]=",e.to_a(z=["greatest_fortune",!0])),j(z.length,1),d},Re.$$arity=3),e.def(o,"$_reduce_15",ze=function(_e,xe,O){var I,D,ne=this,d=r,z=r;return d=null==(I=e.to_ary(_e))[0]?r:I[0],z=null==I[3]?r:I[3],n(["v2_5","v2_0"]["$include?"](ne.version))||ne.$raise($(u,"ParseError")),n(d["$[]"]("greatest_fortune")["$nil?"]())||ne.$raise($(u,"ParseError")),n(d["$[]"]("semi_fixed_val")["$nil?"]())||ne.$raise($(u,"ParseError")),n(d["$[]"]("tmp_fixed_val")["$nil?"]())||ne.$raise($(u,"ParseError")),D=["semi_fixed_val",z.$to_i()],t(d,"[]=",e.to_a(D)),j(D.length,1),d},ze.$$arity=3),e.def(o,"$_reduce_16",Te=function(_e,xe,O){var I,D,ne=this,d=r,z=r;return d=null==(I=e.to_ary(_e))[0]?r:I[0],z=null==I[3]?r:I[3],n(["v2_5","v2_0"]["$include?"](ne.version))||ne.$raise($(u,"ParseError")),n(d["$[]"]("greatest_fortune")["$nil?"]())||ne.$raise($(u,"ParseError")),n(d["$[]"]("semi_fixed_val")["$nil?"]())||ne.$raise($(u,"ParseError")),n(d["$[]"]("tmp_fixed_val")["$nil?"]())||ne.$raise($(u,"ParseError")),D=["tmp_fixed_val",z.$to_i()],t(d,"[]=",e.to_a(D)),j(D.length,1),d},Te.$$arity=3),e.def(o,"$_reduce_17",be=function(_e,xe,O){var I,z,se,D,d=r;return d=null==(I=e.to_ary(_e))[0]?r:I[0],z=null==I[2]?r:I[2],n(n(D=this.version["$=="]("v2_5"))?d["$[]"]("kept_modify")["$nil?"]():D)||this.$raise($(u,"ParseError")),t(d,"[]=",e.to_a(se=["kept_modify",z])),j(se.length,1),d},be.$$arity=3),e.def(o,"$_reduce_18",re=function(_e,xe,O){return _e["$[]"](1)},re.$$arity=3),e.def(o,"$_reduce_19",te=function(_e,xe,O){return y(y($(u,"Arithmetic"),"Node"),"Negative").$new(_e["$[]"](1))},te.$$arity=3),e.def(o,"$_reduce_20",i=function(_e,xe,O){return y(y($(u,"Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"+",_e["$[]"](2))},i.$$arity=3),e.def(o,"$_reduce_21",V=function(_e,xe,O){return y(y($(u,"Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"-",_e["$[]"](2))},V.$$arity=3),e.def(o,"$_reduce_22",G=function(_e,xe,O){return y(y($(u,"Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"+",_e["$[]"](2))},G.$$arity=3),e.def(o,"$_reduce_23",B=function(_e,xe,O){return y(y($(u,"Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"-",_e["$[]"](2))},B.$$arity=3),e.def(o,"$_reduce_25",$e=function(_e,xe,O){return y(y($(u,"Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"*",_e["$[]"](2))},$e.$$arity=3),e.def(o,"$_reduce_26",ae=function(_e,xe,O){return y(y($(u,"Arithmetic"),"Node"),"DivideWithGameSystemDefault").$new(_e["$[]"](0),_e["$[]"](2))},ae.$$arity=3),e.def(o,"$_reduce_28",fe=function(_e,xe,O){return _e["$[]"](1)},fe.$$arity=3),e.def(o,"$_reduce_29",we=function(_e,xe,O){return y(y($(u,"Arithmetic"),"Node"),"Negative").$new(_e["$[]"](1))},we.$$arity=3),e.def(o,"$_reduce_31",oe=function(_e,xe,O){return _e["$[]"](1)},oe.$$arity=3),e.def(o,"$_reduce_32",le=function(_e,xe,O){return y(y($(u,"Arithmetic"),"Node"),"Number").$new(_e["$[]"](0))},le.$$arity=3),void e.def(o,"$_reduce_none",he=function(_e,xe,O){return _e["$[]"](0)},he.$$arity=3)},Opal.modules["bcdice/game_system/SwordWorld"]=function(e){function j(L,x){return"number"==typeof L&&"number"==typeof x?L>=x:L["$>="](x)}function X(L,x){return"number"==typeof L&&"number"==typeof x?L<=x:L["$<="](x)}function P(L,x){return"number"==typeof L&&"number"==typeof x?L-x:L["$-"](x)}function r(L,x){return"number"==typeof L&&"number"==typeof x?L>x:L["$>"](x)}function y(L,x){return"number"==typeof L&&"number"==typeof x?L+x:L["$+"](x)}function K(L,x){return"number"==typeof L&&"number"==typeof x?L*x:L["$*"](x)}var x,v,N,R,F,J,C,g,b,A,p,T,o,u,h,Y,W=e.top,H=[],t=e.nil,n=e.$$,M=e.module,Z=e.klass,l=e.send2,w=e.truthy,Q=e.send;return W.$require("bcdice/base"),W.$require("bcdice/game_system/sword_world/rating_parser"),x=H,v=Y=[M(H[0],"BCDice")].concat(x),N=h=[M(Y[0],"GameSystem")].concat(v),o=Z(h[0],n(h,"Base"),"SwordWorld"),u=[o].concat(N),o.$$prototype.rating_table=o.$$prototype.randomizer=t,e.const_set(u[0],"ID","SwordWorld"),e.const_set(u[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG"),e.const_set(u[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u3068"),e.const_set(u[0],"HELP_MESSAGE","\u30fbSW\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx[c]+m$f) (x:\u30ad\u30fc, c:\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024, m:\u30dc\u30fc\u30ca\u30b9, f:\u51fa\u76ee\u4fee\u6b63)\n"),o.$register_prefix("H?K"),e.def(o,"$initialize",R=function(m){var E=this;return R.$$p&&(R.$$p=null),l(E,e.find_super_dispatcher(E,"initialize",R,!1,!0),"initialize",[m],null),E.rating_table=0},R.$$arity=1),e.def(o,"$result_2d6",F=function(m,k,S,E,ce){var ge=t;return w(j(k,12))?n(u,"Result").$critical("\u81ea\u52d5\u7684\u6210\u529f"):w(X(k,2))?n(u,"Result").$fumble("\u81ea\u52d5\u7684\u5931\u6557"):w(w(ge=E["$!="](">="))?ge:ce["$=="]("?"))?t:w(j(m,ce))?n(u,"Result").$success("\u6210\u529f"):n(u,"Result").$failure("\u5931\u6557")},F.$$arity=5),e.def(o,"$eval_game_system_specific_command",J=function(m){return this.$rating(m)},J.$$arity=1),o.$private(),e.def(o,"$rating_parser",C=function(){return n(u,"RatingParser").$new()},C.$$arity=0),e.def(o,"$rating",g=function(m){var k,S,E,ce,ve=this,ge=t,Ce=t,Re=t,ze=t,Te=t,be=t,re=t,te=t,i=t,V=t,G=t,B=t,$e=t,ae=t,we=t,oe=t;return ve.$debug("rating string",m),ge=ve.$rating_parser().$parse(m),w(ge)?(Ce=ve.$getSW2_0_RatingTable(),Re=P(Ce.$length(),1),ve.$debug("keyMax",Re),w(r(ge.$rate(),Re))?"\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc\u306f"+Re+"\u307e\u3067\u3067\u3059":w(ge["$infinite_roll?"]())?n(u,"Result").$new("C\u5024\u3092"+ge.$min_critical()+"\u4ee5\u4e0a\u306b\u3057\u3066\u304f\u3060\u3055\u3044"):(ze=ve.$getNewRates(Ce),Te=ge+" \uff1e ",be=[],re=[],te=[],i=0,V=0,G=0,B=0,$e=ge.$first_to(),ae=ge.$first_modify(),function(){var le=e.new_brk();try{Q(ve,"loop",[],((k=function(){var me,De,Fe,qe,Ie,L,Pe=null==k.$$s?this:k.$$s,ye=t,Ae=t;if(De=Pe.$rollDice(ge,B),Ae=null==(me=e.to_ary(De))[1]?t:me[1],i=ye=null==me[0]?t:me[0],w($e["$!="](0))?(i=ye=$e,$e=0):w(ae["$!="](0))&&(i=y(i,ae),ae=0),w(X(ye,2))&&(be["$<<"](ye.$to_s()),re["$<<"](Ae.$to_s()),te["$<<"]("**"),B=y(B,1),e.brk(t,le)),w(w(Ie=ge.$kept_modify()["$!="](0))?i["$!="](2):Ie)&&(i=y(i,ge.$kept_modify())),w("number"==typeof(L=i)?L<2:L["$<"](2))&&(i=2),w(r(i,12))&&(i=12),Fe=[y(ge.$rate(),K(B,ge.$rateup())),Re].$min(),Pe.$debug("currentKey",Fe),qe=ze["$[]"](i)["$[]"](Fe),Pe.$debug("rateValue",qe),G=y(G,qe),V=y(V,i),be["$<<"](i.$to_s()),re["$<<"](Ae.$to_s()),te["$<<"](w(r(i,2))?qe:"**"),B=y(B,1),w(j(i,ge.$critical())))return t;e.brk(t,le)}).$$s=ve,k.$$brk=le,k.$$arity=0,k))}catch(he){if(he===le)return he.$v;throw he}}(),E=ve.$getResultText(G,ge,re,be,te,V,B),S=e.to_ary(E),we=null==S[1]?t:S[1],oe=null==S[2]?t:S[2],Te=y(Te,null==S[0]?t:S[0]),Q(n(u,"Result").$new(),"tap",[],((ce=function(he){var me=t;return null==he&&(he=t),Q(he,"text=",e.to_a(me=[Te])),P(me.length,1),Q(he,"critical=",e.to_a(me=[we])),P(me.length,1),Q(he,"fumble=",e.to_a(me=[oe])),me[P(me.length,1)]}).$$s=ve,ce.$$arity=1,ce)))):(ve.$debug("not matched"),"1")},g.$$arity=1),e.def(o,"$getSW2_0_RatingTable",b=function(){return["*,0,0,0,1,2,2,3,3,4,4","*,0,0,0,1,2,3,3,3,4,4","*,0,0,0,1,2,3,4,4,4,4","*,0,0,1,1,2,3,4,4,4,5","*,0,0,1,2,2,3,4,4,5,5","*,0,1,1,2,2,3,4,5,5,5","*,0,1,1,2,3,3,4,5,5,5","*,0,1,1,2,3,4,4,5,5,6","*,0,1,2,2,3,4,4,5,6,6","*,0,1,2,3,3,4,4,5,6,7","*,1,1,2,3,3,4,5,5,6,7","*,1,2,2,3,3,4,5,6,6,7","*,1,2,2,3,4,4,5,6,6,7","*,1,2,3,3,4,4,5,6,7,7","*,1,2,3,4,4,4,5,6,7,8","*,1,2,3,4,4,5,5,6,7,8","*,1,2,3,4,4,5,6,7,7,8","*,1,2,3,4,5,5,6,7,7,8","*,1,2,3,4,5,6,6,7,7,8","*,1,2,3,4,5,6,7,7,8,9","*,1,2,3,4,5,6,7,8,9,10","*,1,2,3,4,6,6,7,8,9,10","*,1,2,3,5,6,6,7,8,9,10","*,2,2,3,5,6,7,7,8,9,10","*,2,3,4,5,6,7,7,8,9,10","*,2,3,4,5,6,7,8,8,9,10","*,2,3,4,5,6,8,8,9,9,10","*,2,3,4,6,6,8,8,9,9,10","*,2,3,4,6,6,8,9,9,10,10","*,2,3,4,6,7,8,9,9,10,10","*,2,4,4,6,7,8,9,10,10,10","*,2,4,5,6,7,8,9,10,10,11","*,3,4,5,6,7,8,10,10,10,11","*,3,4,5,6,8,8,10,10,10,11","*,3,4,5,6,8,9,10,10,11,11","*,3,4,5,7,8,9,10,10,11,12","*,3,5,5,7,8,9,10,11,11,12","*,3,5,6,7,8,9,10,11,12,12","*,3,5,6,7,8,10,10,11,12,13","*,4,5,6,7,8,10,11,11,12,13","*,4,5,6,7,9,10,11,11,12,13","*,4,6,6,7,9,10,11,12,12,13","*,4,6,7,7,9,10,11,12,13,13","*,4,6,7,8,9,10,11,12,13,14","*,4,6,7,8,10,10,11,12,13,14","*,4,6,7,9,10,10,11,12,13,14","*,4,6,7,9,10,10,12,13,13,14","*,4,6,7,9,10,11,12,13,13,15","*,4,6,7,9,10,12,12,13,13,15","*,4,6,7,10,10,12,12,13,14,15","*,4,6,8,10,10,12,12,13,15,15","*,5,7,8,10,10,12,12,13,15,15","*,5,7,8,10,11,12,12,13,15,15","*,5,7,9,10,11,12,12,14,15,15","*,5,7,9,10,11,12,13,14,15,16","*,5,7,10,10,11,12,13,14,16,16","*,5,8,10,10,11,12,13,15,16,16","*,5,8,10,11,11,12,13,15,16,17","*,5,8,10,11,12,12,13,15,16,17","*,5,9,10,11,12,12,14,15,16,17","*,5,9,10,11,12,13,14,15,16,18","*,5,9,10,11,12,13,14,16,17,18","*,5,9,10,11,13,13,14,16,17,18","*,5,9,10,11,13,13,15,17,17,18","*,5,9,10,11,13,14,15,17,17,18","*,5,9,10,12,13,14,15,17,18,18","*,5,9,10,12,13,15,15,17,18,19","*,5,9,10,12,13,15,16,17,19,19","*,5,9,10,12,14,15,16,17,19,19","*,5,9,10,12,14,16,16,17,19,19","*,5,9,10,12,14,16,17,18,19,19","*,5,9,10,13,14,16,17,18,19,20","*,5,9,10,13,15,16,17,18,19,20","*,5,9,10,13,15,16,17,19,20,21","*,6,9,10,13,15,16,18,19,20,21","*,6,9,10,13,16,16,18,19,20,21","*,6,9,10,13,16,17,18,19,20,21","*,6,9,10,13,16,17,18,20,21,22","*,6,9,10,13,16,17,19,20,22,23","*,6,9,10,13,16,18,19,20,22,23","*,6,9,10,13,16,18,20,21,22,23","*,6,9,10,13,17,18,20,21,22,23","*,6,9,10,14,17,18,20,21,22,24","*,6,9,11,14,17,18,20,21,23,24","*,6,9,11,14,17,19,20,21,23,24","*,6,9,11,14,17,19,21,22,23,24","*,7,10,11,14,17,19,21,22,23,25","*,7,10,12,14,17,19,21,22,24,25","*,7,10,12,14,18,19,21,22,24,25","*,7,10,12,15,18,19,21,22,24,26","*,7,10,12,15,18,19,21,23,25,26","*,7,11,13,15,18,19,21,23,25,26","*,7,11,13,15,18,20,21,23,25,27","*,8,11,13,15,18,20,22,23,25,27","*,8,11,13,16,18,20,22,23,25,28","*,8,11,14,16,18,20,22,23,26,28","*,8,11,14,16,19,20,22,23,26,28","*,8,12,14,16,19,20,22,24,26,28","*,8,12,15,16,19,20,22,24,27,28","*,8,12,15,17,19,20,22,24,27,29","*,8,12,15,18,19,20,22,24,27,30"]},b.$$arity=0),e.def(o,"$getNewRates",A=function(m){var k,E=t,ce=t,ve=t,ge=t,Ce=t,Re=t,ze=t,Te=t,be=t,re=t,te=t,i=t;return E=[],ce=[],ve=[],ge=[],Ce=[],Re=[],ze=[],Te=[],be=[],re=[],te=[],Q(m,"each",[],((k=function(B){var ae=t;return null==B&&(B=t),ae=B.$split(/,/),te.$push(0),E.$push(ae["$[]"](1).$to_i()),ce.$push(ae["$[]"](2).$to_i()),ve.$push(ae["$[]"](3).$to_i()),ge.$push(ae["$[]"](4).$to_i()),Ce.$push(ae["$[]"](5).$to_i()),Re.$push(ae["$[]"](6).$to_i()),ze.$push(ae["$[]"](7).$to_i()),Te.$push(ae["$[]"](8).$to_i()),be.$push(ae["$[]"](9).$to_i()),re.$push(ae["$[]"](10).$to_i())}).$$s=this,k.$$arity=1,k)),this.rating_table["$=="](1)&&(i=[31,(i=[32,(i=[33,10],Q(re,"[]=",e.to_a(i)),i[P(i.length,1)])],Q(re,"[]=",e.to_a(i)),i[P(i.length,1)])],Q(re,"[]=",e.to_a(i)),P(i.length,1)),[te,te,te,E,ce,ve,ge,Ce,Re,ze,Te,be,re]},A.$$arity=1),e.def(o,"$rollDice",p=function(m,k){var E=t;return[(E=this.randomizer.$roll_barabara(2,6)).$sum(),E.$join(",")]},p.$$arity=2),void e.def(o,"$getResultText",T=function(m,k,S,E,ce,ve,ge){var L,Re=t,ze=t,Te=t,be=t,re=t,te=t;return(Re=[]).$push("2D:["+S.$join(" ")+"]="+E.$join(",")),w(X(ve,2))?(Re.$push(ce.$join(",")),Re.$push("\u81ea\u52d5\u7684\u5931\u6557"),[Re.$join(" \uff1e "),!1,!0]):(w(w(ze=r(ce.$size(),1))?ze:k.$modifier()["$!="](0))?(Te=y(ce.$join(","),n(u,"Format").$modifier(k.$modifier())),w(k.$half())&&(Te="("+Te+")/2",w(k.$modifier_after_half()["$!="](0))&&(Te=y(Te,n(u,"Format").$modifier(k.$modifier_after_half())))),Re.$push(Te)):w(k.$half())&&(Te=ce.$first()+"/2",w(k.$modifier_after_half()["$!="](0))&&(Te=y(Te,n(u,"Format").$modifier(k.$modifier_after_half()))),Re.$push(Te)),w(r(ge,1))&&(be=P(ge,1)+"\u56de\u8ee2",Re.$push(be)),re=y(m,k.$modifier()),w(k.$half())&&(re=(L=re,"number"==typeof L?L/2:L["$/"](2)).$ceil(),w(k.$modifier_after_half()["$!="](0))&&(re=y(re,k.$modifier_after_half()))),te=re.$to_s(),Re.$push(te),[Re.$join(" \uff1e "),r(ge,1),!1])},T.$$arity=7)},Opal.modules["bcdice/game_system/sword_world/transcendent_test"]=function(e){function X(Z,l){return"number"==typeof Z&&"number"==typeof l?Z>=l:Z["$>="](l)}function r(Z,l){return"number"==typeof Z&&"number"==typeof l?Z-l:Z["$-"](l)}var l,x,a,o,F,J,C,g,b,A,u,R,s,Y,Q,$=[],K=e.nil,W=e.$$,H=e.module,t=e.klass,q=e.hash2,n=e.truthy,M=e.send;return e.top.$require("bcdice/result"),l=$,x=Q=[H($[0],"BCDice")].concat(l),a=Y=[H(Q[0],"GameSystem")].concat(x),o=s=[t(Y[0],W(Y,"SwordWorld"),"SwordWorld2_0")].concat(a),u=t(s[0],null,"TranscendentTest"),R=[u].concat(o),u.$$prototype.modifier=u.$$prototype.critical_value=u.$$prototype.expression=u.$$prototype.modifier_str=u.$$prototype.target=u.$$prototype.cmp_op=K,e.const_set(R[0],"RESULT_STR",q(["success","failure","super_success","critical","fumble"],{success:"\u6210\u529f",failure:"\u5931\u6557",super_success:"\u8d85\u6210\u529f",critical:"\u81ea\u52d5\u7684\u6210\u529f",fumble:"\u81ea\u52d5\u7684\u5931\u6557"}).$freeze()),e.def(u,"$initialize",F=function(T,_,m,k){var S=this;return S.critical_value=T,S.modifier=_,S.cmp_op=m,S.target=k,S.modifier_str=W(R,"Format").$modifier(S.modifier),S.expression=S.$node_expression()},F.$$arity=4),e.def(u,"$execute",J=function(T){var m,Ce,ge,Z,k=this,S=K,E=K,ce=K,ve=K,Re=K,ze=K,Te=K;if(n("number"==typeof(Z=k.critical_value)?Z<3:Z["$<"](3)))return"("+k.expression+") \uff1e \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u304c\u5c0f\u3055\u3059\u304e\u307e\u3059\u30023\u4ee5\u4e0a\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002";if(E=[S=T.$roll_barabara(2,6)],ce=S["$=="]([1,1]),ve=S["$=="]([6,6]),n(n(ge=ce["$!"]())?ve["$!"]():ge))for(;n(X(k.$sum_of_dice(E.$last()),k.critical_value));)E.$push(T.$roll_barabara(2,6));return Re=function(Z,l){return"number"==typeof Z&&"number"==typeof l?Z+l:Z["$+"](l)}(Ce=k.$sum_of_dice(E),k.modifier),ze=k.$result_status(Re,E.$length(),ce,ve),Te=["("+k.expression+")",""+k.$dice_str(E,Ce)+k.modifier_str,Re,W(R,"RESULT_STR")["$[]"](ze)].$compact(),M(W(R,"Result").$new(),"tap",[],((m=function(re){var i=K;return null==re&&(re=K),i=[Te.$join(" \uff1e ")],M(re,"text=",e.to_a(i)),r(i.length,1),i=[ze["$=="]("fumble")],M(re,"fumble=",e.to_a(i)),r(i.length,1),i=[ze["$=="]("critical")],M(re,"critical=",e.to_a(i)),r(i.length,1),i=[["success","super_success","critical"]["$include?"](ze)],M(re,"success=",e.to_a(i)),r(i.length,1),i=[["failure","fumble"]["$include?"](ze)],M(re,"failure=",e.to_a(i)),i[r(i.length,1)]}).$$s=k,m.$$arity=1,m))},J.$$arity=1),u.$private(),e.def(u,"$node_expression",C=function(){var _,T=this;return _="2D6@"+T.critical_value+T.modifier_str,n(T.target)?""+_+T.cmp_op+T.target:_},C.$$arity=0),e.def(u,"$sum_of_dice",g=function(T){return T.$flatten().$sum()},g.$$arity=1),e.def(u,"$dice_str",b=function(T,_){var m;return""+_+M(T,"map",[],(m=function(ce){return null==ce&&(ce=K),"["+ce.$join(",")+"]"},m.$$s=this,m.$$arity=1,m)).$join()},b.$$arity=2),void e.def(u,"$result_status",A=function(T,_,m,k){var S=this,E=K;return n(S.target)?n(m)?"fumble":n(k)?"critical":n(T.$send(S.cmp_op,S.target))?n(n(E=X(_,2))?X(T,41):E)?"super_success":"success":"failure":"no_target"},A.$$arity=4)},function(e){function j(l,w){return"number"==typeof l&&"number"==typeof w?l>w:l["$>"](w)}function X(l,w){return"number"==typeof l&&"number"==typeof w?l+w:l["$+"](w)}function P(l,w){return"number"==typeof l&&"number"==typeof w?l*w:l["$*"](w)}var w,ee,h,N,o,u,R,F,J,C,g,b,s,f,U,L,y=e.top,$=[],K=e.nil,c=e.$$$,W=e.$$,H=e.module,t=e.klass,q=e.send2,n=e.truthy,M=e.hash2,Z=e.send;y.$require("bcdice/arithmetic_evaluator"),y.$require("bcdice/game_system/SwordWorld"),y.$require("bcdice/game_system/sword_world/transcendent_test"),w=$,ee=L=[H($[0],"BCDice")].concat(w),h=U=[H(L[0],"GameSystem")].concat(ee),s=t(U[0],W(U,"SwordWorld"),"SwordWorld2_0"),f=[s].concat(h),s.$$prototype.randomizer=K,e.const_set(f[0],"ID","SwordWorld2.0"),e.const_set(f[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.0"),e.const_set(f[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u30682.0"),e.const_set(f[0],"HELP_MESSAGE",'\u81ea\u52d5\u7684\u6210\u529f\u3001\u6210\u529f\u3001\u5931\u6557\u3001\u81ea\u52d5\u7684\u5931\u6557\u306e\u81ea\u52d5\u5224\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx)\n\u3000"K\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc+\u30dc\u30fc\u30ca\u30b9"\u306e\u5f62\u3067\u8a18\u5165\u3057\u307e\u3059\u3002\n\u3000\u30dc\u30fc\u30ca\u30b9\u306e\u90e8\u5206\u306b\u300cK20+K30\u300d\u306e\u3088\u3046\u306b\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u53d6\u308b\u3053\u3068\u306f\u51fa\u6765\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001\u30dc\u30fc\u30ca\u30b9\u306f\u8907\u6570\u53d6\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3082\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3068\u540c\u69d8\u306b\u3001\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306b\u96a0\u308c\u3066\u30ed\u30fc\u30eb\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2\n\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u8a2d\u5b9a\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306f"[\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024]"\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u3000\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502410\u3068\u3057\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u51e6\u7406\u304c\u5fc5\u8981\u306a\u3044\u3068\u304d\u306f13\u306a\u3069\u3068\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u9632\u5fa1\u6642\u306a\u3069\u306e\u5bfe\u5fdc)\n\u3000\u307e\u305f\u30bf\u30a4\u30d7\u306e\u8efd\u6e1b\u5316\u306e\u305f\u3081\u306b\u672b\u5c3e\u306b\u300c@\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u300d\u3067\u3082\u51e6\u7406\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u3000\u4f8b\uff09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u534a\u6e1b (HKx, KxH+N)\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u5148\u982d\u307e\u305f\u306f\u672b\u5c3e\u306b"H"\u3092\u3064\u3051\u308b\u3068\u3001\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3092\u632f\u3063\u3066\u6700\u7d42\u7d50\u679c\u3092\u534a\u6e1b\u3055\u305b\u307e\u3059\u3002\n\u3000\u672b\u5c3e\u306b\u3064\u3051\u305f\u5834\u5408\u3001\u76f4\u5f8c\u306b\u4fee\u6b63\u3092\u3092\u3064\u3051\u308b\u3053\u3068\u3067\u3001\u534a\u6e1b\u5f8c\u306e\u52a0\u6e1b\u7b97\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3000\u3053\u306e\u969b\u3001\u8907\u6570\u306e\u9805\u306b\u3088\u308b\u4fee\u6b63\u306b\u306f\u30ab\u30c3\u30b3\u3067\u56f2\u3046\u3053\u3068\u304c\u5fc5\u8981\u3067\u3059\uff08\u30ab\u30c3\u30b3\u304c\u306a\u3044\u3068\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3059\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u306a\u3057\u3068\u6271\u308f\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H(1+1)\n\n\u30fb\u30c0\u30a4\u30b9\u76ee\u306e\u4fee\u6b63\uff08\u904b\u547d\u5909\u8ee2\u3084\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30ec\u30a4\u7528\uff09\n\u3000\u672b\u5c3e\u306b\u300c$\u4fee\u6b63\u5024\u300d\u3067\u30c0\u30a4\u30b9\u76ee\u306b\u4fee\u6b63\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\u3000$\uff0b\uff11\u3068\u4fee\u6b63\u8868\u8a18\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u306b\uff0b\u4fee\u6b63\u3001\uff04\uff19\u306e\u3088\u3046\u306b\u56fa\u5b9a\u5024\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u3092\u305d\u306e\u51fa\u76ee\u306b\u5dee\u3057\u66ff\u3048\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3057\u305f\u5834\u5408\u3067\u3082\u56fa\u5b9a\u5024\u3084\u4fee\u6b63\u5024\u306e\u9069\u7528\u306f\u6700\u521d\u306e\u4e00\u56de\u3060\u3051\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9\n\n\u30fb\u9996\u5207\u308a\u5200\u7528\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u4e0a\u6607 r10\n\u3000\u4f8b\uff09K20r10\u3000K30+24@8R10\u3000K40+24@8$12r10\n\n\u30fb\u30b0\u30ec\u30a4\u30c6\u30b9\u30c8\u30d5\u30a9\u30fc\u30c1\u30e5\u30f3\u306f\u672b\u5c3e\u306b gf\n\u3000\u4f8b\uff09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r10gf\n\n\u30fb\u5a01\u529b\u8868\u30921d+sf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u3082\u7d99\u7d9a sf4\n\u3000\u4f8b\uff09k10sf4\u3000k0+5SF4@13\u3000k70+26sf3@9\n\n\u30fb\u5a01\u529b\u8868\u30921d+tf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u306f2d\u3067\u53c2\u7167 tf3\n\u3000\u4f8b\uff09k10tf3\u3000k0+5TF4@13\u3000k70+26tf3@9\n\n\u30fb\u8d85\u8d8a\u5224\u5b9a\u7528\u306b2d6\u30ed\u30fc\u30eb\u306b 2D6@10 \u66f8\u5f0f\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u4ed8\u4e0e\u304c\u53ef\u80fd\u306b\u3002\n\u3000\u4f8b\uff092D6@10\u30002D6@10+11>=30\n\n\u30fb\u6210\u9577\u3000(Gr)\n\u3000\u672b\u5c3e\u306b\u6570\u5b57\u3092\u4ed8\u52a0\u3059\u308b\u3053\u3068\u3067\u3001\u8907\u6570\u56de\u306e\u6210\u9577\u3092\u307e\u3068\u3081\u3066\u884c\u3048\u307e\u3059\u3002\n\u3000\u4f8b\uff09Gr3\n\n\u30fb\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000(FT)\n\u3000\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u7d61\u307f\u52b9\u679c\u8868\u3000(TT)\n\u3000\u7d61\u307f\u52b9\u679c\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n'),s.$register_prefix("H?K","Gr","2D6?@\\d+","FT","TT"),e.def(s,"$initialize",N=function(p){var m=this;return N.$$p&&(N.$$p=null),q(m,e.find_super_dispatcher(m,"initialize",N,!1,!0),"initialize",[p],null),m.rating_table=2},N.$$arity=1),e.def(s,"$eval_game_system_specific_command",o=function(p){var k,m=this,E=K;return o.$$p&&(o.$$p=null),/^Gr(\d+)?/i["$==="](k=p)?n(p["$=~"](/^Gr(\d+)/i))?m.$growth(W(f,"Regexp").$last_match(1).$to_i()):m.$growth():/^2D6?@\d+/i["$==="](k)?(E=c(W(f,"Command"),"Parser").$new(/2D6?/i,M(["round_type"],{round_type:c(c(W(f,"BCDice"),"RoundType"),"CEIL")})).$enable_critical().$restrict_cmp_op_to(K,">=",">").$parse(p),n(E)?W(f,"TranscendentTest").$new(E.$critical(),E.$modify_number(),E.$cmp_op(),E.$target_number()).$execute(m.randomizer):K):"FT"["$==="](k)?m.$get_fumble_table():"TT"["$==="](k)?m.$get_tangle_table():q(m,e.find_super_dispatcher(m,"eval_game_system_specific_command",o,!1,!0),"eval_game_system_specific_command",[p],null)},o.$$arity=1),e.def(s,"$rating_parser",u=function(){return W(f,"RatingParser").$new(M(["version"],{version:"v2_0"}))},u.$$arity=0),e.def(s,"$rollDice",R=function(p,T){var k=this,S=K,E=K;return R.$$p&&(R.$$p=null),n(j(p.$semi_fixed_val(),0))?[X(S=k.randomizer.$roll_once(6),p.$semi_fixed_val()),S+","+p.$semi_fixed_val()]:n(n(E=T["$=="](0))?j(p.$tmp_fixed_val(),0):E)?[X(S=k.randomizer.$roll_once(6),p.$tmp_fixed_val()),S+","+p.$tmp_fixed_val()]:n(p.$greatest_fortune())?n(p.$greatest_fortune())?[P(S=k.randomizer.$roll_once(6),2),S+","+S]:K:q(k,e.find_super_dispatcher(k,"rollDice",R,!1,!0),"rollDice",[p,T],null)},R.$$arity=2),e.def(s,"$growth",F=function(p){var T;return null==p&&(p=1),Z(e.Range.$new(1,p,!1),"map",[],(T=function(){return(null==T.$$s?this:T.$$s).$growth_step()},T.$$s=this,T.$$arity=0,T)).$join(" | ")},F.$$arity=-1),e.def(s,"$growth_step",J=function(){var T,_,k,p=this,m=K;return T=p.randomizer.$roll_once(6),_=p.randomizer.$roll_once(6),m=p.$get_ability_by_dice(T),k=p.$get_ability_by_dice(_),n(m["$!="](k))?"["+T+","+_+"]->("+m+" or "+k+")":"["+T+","+_+"]->("+m+")"},J.$$arity=0),e.def(s,"$get_ability_by_dice",C=function(p){return["\u5668\u7528\u5ea6","\u654f\u6377\u5ea6","\u7b4b\u529b","\u751f\u547d\u529b","\u77e5\u529b","\u7cbe\u795e\u529b"]["$[]"]("number"==typeof(l=p)?l-1:l["$-"](1));var l},C.$$arity=1),e.def(s,"$get_fumble_table",g=function(){var p,T;return T=this.$get_table_by_1d6(["\u3053\u306e\u8868\u30922\u56de\u632f\u308a\u3001\u305d\u306e\u4e21\u65b9\u3092\u9069\u7528\u3059\u308b\u3002\uff08\u540c\u3058\u51fa\u76ee\u306b\u3088\u308b\u5f71\u97ff\u306f\u7d2f\u7a4d\u3057\u306a\u3044\uff09\u3002\u3053\u306e\u81ea\u52d5\u5931\u6557\u306b\u3088\u308a\u5f97\u3089\u308c\u308b\u7d4c\u9a13\u70b9\u306f\u3001+50\u70b9\u3055\u308c\u308b","\u30c0\u30e1\u30fc\u30b8\u306b\u3001\u653b\u6483\u8005\u3092\u5f37\u5316\u3057\u3066\u3044\u308b\u300c\u5263\u306e\u304b\u3051\u3089\u300d\u306e\u6570\u304c\u8ffd\u52a0\u3055\u308c\u308b","\u30c0\u30e1\u30fc\u30b8\u306b\u3001\u653b\u6483\u8005\u306e\u300c\u30ec\u30d9\u30eb\u300d\u304c\u8ffd\u52a0\u3055\u308c\u308b","\u30c0\u30e1\u30fc\u30b8\u6c7a\u5b9a\u30922\u56de\u884c\u3044\u3001\u3088\u308a\u9ad8\u3044\u65b9\u3092\u63a1\u7528\u3059\u308b","\u5408\u7b97\u30c0\u30e1\u30fc\u30b8\u30922\u500d\u3059\u308b","\u9632\u8b77\u70b9\u7121\u52b9"]),"\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868("+(null==(p=e.to_ary(T))[1]?K:p[1])+") \u2192 "+(null==p[0]?K:p[0])},g.$$arity=0),e.def(s,"$get_tangle_table",b=function(){var p,T;return T=this.$get_table_by_1d6(["\u982d\u3084\u9854\uff1a\u7259\u3084\u565b\u307f\u3064\u304d\u306a\u3069\u306b\u304a\u3051\u308b\u547d\u4e2d\u529b\u5224\u5b9a\u53ca\u3073\u3001\u9b54\u6cd5\u306e\u884c\u4f7f\u3084\u30d6\u30ec\u30b9\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b","\u6b66\u5668\u3084\u76fe\uff1a\u6b66\u5668\u306e\u4f7f\u7528\u4e0d\u53ef\u3001\u53c8\u306f\u76fe\u306e\u56de\u907f\u529b\u4fee\u6b63\u53ca\u3073\u9632\u8b77\u70b9\u3092\u7121\u52b9\u5316\u3059\u308b","\u8155\u3084\u624b\uff1a\u6b66\u5668\u3084\u722a\u306a\u3069\u306b\u304a\u3051\u308b\u547d\u4e2d\u529b\u5224\u5b9a\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3001\u76fe\u3092\u6301\u3064\u8155\u65b9\u306e\u8155\u306a\u3089\u305d\u306e\u76fe\u306e\u56de\u907f\u529b\u4fee\u6b63\u53ca\u3073\u9632\u8b77\u70b9\u3092\u7121\u52b9\u5316\u3059\u308b","\u811a\u3084\u8db3\uff1a\u79fb\u52d5\u4e0d\u53ef\u3001\u66f4\u306b\u56de\u907f\u529b\u5224\u5b9a\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b \u203b\u4e21\u8db3\u306b\u7d61\u3093\u3067\u3082\u7d2f\u7a4d\u3057\u306a\u3044","\u80f4\u4f53\uff1a\u751f\u547d\u30fb\u7cbe\u795e\u62b5\u6297\u529b\u3092\u57fa\u6e96\u5024\u306b\u7528\u3044\u308b\u5224\u5b9a\u3092\u9664\u304d\u3001\u3042\u3089\u3086\u308b\u884c\u70ba\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b","\u7279\u6b8a\uff1a\u5c3b\u5c3e\u3084\u7ffc\u306a\u3069\u306b\u547d\u4e2d\u3002\u7d61\u3081\u3089\u308c\u305f\u90e8\u4f4d\u3092\u4f7f\u7528\u3059\u308b\u5224\u5b9a\u306b\u304a\u3044\u3066-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3001\u307e\u305f\u306f\u305d\u3053\u304c\u4f7f\u3048\u3066\u3044\u305f\u3053\u3068\u306b\u3088\u308b\u30dc\u30fc\u30ca\u30b9\u4fee\u6b63\u3092\u5931\u3046 \u203b\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f\u6c7a\u3081\u76f4\u3057"]),"\u7d61\u307f\u52b9\u679c\u8868("+(null==(p=e.to_ary(T))[1]?K:p[1])+") \u2192 "+(null==p[0]?K:p[0])},b.$$arity=0)}(Opal)}}]);