(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[8999],{8999:(de,me,fe)=>{fe(9993),Opal.modules["i18n/backend/fallbacks"]=function(r){var U,u,N,L,A,o,M=[],t=r.nil,v=r.$$$,e=r.module,g=r.class_variable_set,S=r.truthy,I=r.class_variable_get,a=r.def,P=r.send,W=r.to_a,z=r.rb_minus,C=r.send2,F=r.find_super,j=r.hash2,B=r.find_block_super,G=r.neqeq;return U=M,o=[A=e(M[0],"I18n")].concat(U),g(o[0],"@@fallbacks",t),u=r.get_singleton_class(A),N=[u].concat(o),L=r.$r(N),a(u,"$fallbacks",function(){var y=t;return g(N[1],"@@fallbacks",S(null!=N[1].$$cvars["@@fallbacks"]?"class variable":t)&&S(y=I(N[1],"@@fallbacks",!1))?y:v(v(L("I18n"),"Locale"),"Fallbacks").$new()),S(y=L("Thread").$current()["$[]"]("i18n_fallbacks"))?y:I(N[1],"@@fallbacks",!1)},0),a(u,"$fallbacks=",function(m){var y;return g(N[1],"@@fallbacks",S(m["$is_a?"](L("Array")))?v(v(L("I18n"),"Locale"),"Fallbacks").$new(m):m),y=["i18n_fallbacks",I(N[1],"@@fallbacks",!1)],P(L("Thread").$current(),"[]=",W(y)),y[z(y.length,1)]},1),function(u,D){var m,y,p,d,L=[e(u,"Backend")].concat(D);return m=L,p=[y=e(L[0],"Fallbacks")].concat(m),d=r.$r(p),a(y,"$translate",function l(s,c,i){try{var n=l.$$p||t,$=this,f=t,E=t;return delete l.$$p,null==i&&(i=d("EMPTY_HASH")),S(i.$fetch("fallback",!0))?S(i["$[]"]("fallback_in_progress"))?C($,F($,"translate",l,!1,!0),"translate",[s,c,i],n):(S(i["$[]"]("default"))&&(f=$["$extract_non_symbol_default!"](i)),E=i.$merge(j(["fallback_in_progress"],{fallback_in_progress:!0})),P(d("I18n").$fallbacks()["$[]"](s),"each",[],function h(R){var q=null==h.$$s?this:h.$$s;null==R&&(R=t);try{return P(q,"catch",["exception"],function H(){var _=null==H.$$s?this:H.$$s,K=t;if(K=C(_,B(_,"translate",H.$$def||h.$$def||l,!1,!1),"translate",[R,c,E],null),S(K["$nil?"]()))return t;G(s.$to_s(),R.$to_s())&&_.$on_fallback(s,R,c,i),r.ret(K)},{$$arity:0,$$s:q})}catch(H){if(!r.rescue(H,[v(d("I18n"),"InvalidLocale")]))throw H;try{return t}finally{r.pop_exception()}}},{$$arity:1,$$s:$}),S(i["$key?"]("default"))&&S(i["$[]"]("default")["$nil?"]())?t:S(f)?C($,F($,"translate",l,!1,!0),"translate",[s,t,i.$merge(j(["default"],{default:f}))],null):$.$throw("exception",v(d("I18n"),"MissingTranslation").$new(s,c,i))):C($,F($,"translate",l,!1,!0),"translate",[s,c,i],n)}catch(h){if(h===r.returner)return h.$v;throw h}},-3),a(y,"$extract_non_symbol_default!",function(s){var i,c=t,n=t;return c=[s["$[]"]("default")].$flatten(),i=P(c,"detect",[],function(f){return null==f&&(f=t),f["$is_a?"](d("Symbol"))["$!"]()},1),S(i)&&(n=["default",c["$[]"](0,c.$index(i))],P(s,"[]=",W(n)),z(n.length,1)),i},1),a(y,"$exists?",function l(s,c,i){try{var n=l.$$p||t,$=this;return delete l.$$p,null==i&&(i=d("EMPTY_HASH")),S(i.$fetch("fallback",!0))?(P(d("I18n").$fallbacks()["$[]"](s),"each",[],function f(E){var h=null==f.$$s?this:f.$$s;null==E&&(E=t);try{if(!S(C(h,B(h,"exists?",f.$$def||l,!1,!1),"exists?",[E,c],null)))return t;r.ret(!0)}catch(R){if(!r.rescue(R,[v(d("I18n"),"InvalidLocale")]))throw R;try{return t}finally{r.pop_exception()}}},{$$arity:1,$$s:$}),!1):C($,F($,"exists?",l,!1,!0),"exists?",[s,c,i],n)}catch(f){if(f===r.returner)return f.$v;throw f}},-3),y.$private(),a(y,"$on_fallback",function(s,c,i,n){return t},4)}(o[0],o)},Opal.modules["bcdice/randomizer"]=function(r){var A,b,m,y,p,d,u,D,M=[],t=r.nil,v=r.$$$,g=r.klass,S=r.const_set,I=r.def,a=r.truthy,P=r.rb_gt,W=r.rb_plus,z=r.rb_le,C=r.send,F=r.rb_minus,j=r.eqeq,B=r.rb_times,G=r.eqeqeq,Q=r.rb_ge;return A=M,u=[(0,r.module)(M[0],"BCDice")].concat(A),D=r.$r(u),b=u,y=[m=g(u[0],null,"Randomizer")].concat(b),p=r.$r(y),(d=m.$$prototype).rand_results=d.detailed_rand_results=t,S(y[0],"UPPER_LIMIT_DICE_TIMES",200),S(y[0],"UPPER_LIMIT_DICE_SIDES",1e4),S(y[0],"UPPER_LIMIT_RANDS",1e4),I(m,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]},0),m.$attr_reader("rand_results"),m.$attr_reader("detailed_rand_results"),S(y[0],"DetailedRandResult",p("Struct").$new("kind","sides","value")),I(m,"$roll_barabara",function(s,c){var i=this;return a(P(W(i.rand_results.$size(),s),p("UPPER_LIMIT_RANDS")))&&i.$raise(p("TooManyRandsError")),a(z(s,0))||a(P(s,p("UPPER_LIMIT_DICE_TIMES")))?[]:C(p("Array"),"new",[s],function n(){return(null==n.$$s?this:n.$$s).$roll_once(c)},{$$arity:0,$$s:i})},2),I(m,"$roll_sum",function(s,c){return this.$roll_barabara(s,c).$sum()},2),I(m,"$roll_once",function(s){var i=t;return a(z(s,0))||a(P(s,p("UPPER_LIMIT_DICE_SIDES")))?0:(i=this.$rand_inner(s),this.$push_to_detail("normal",s,i),i)},1),I(m,"$roll_index",function(s){return F(this.$roll_once(s),1)},1),I(m,"$roll_tens_d10",function(){var i,c=t;return c=this.$rand_inner(10),j(c,10)&&(c=0),i=B(c,10),this.$push_to_detail("tens_d10",10,i),i},0),I(m,"$roll_d9",function(){var c;return c=F(this.$rand_inner(10),1),this.$push_to_detail("d9",10,c),c},0),I(m,"$roll_d66",function(s){var n,i=t;return i=C(p("Array"),"new",[2],function $(){return(null==$.$$s?this:$.$$s).$roll_once(6)},{$$arity:0,$$s:this}),G(v(p("D66SortType"),"ASC"),n=s)?i["$sort!"]():G(v(p("D66SortType"),"DESC"),n)&&i["$sort!"]()["$reverse!"](),W(B(i["$[]"](0),10),i["$[]"](1))},1),m.$private(),I(m,"$rand_inner",function(s){var i,c=this;return a(Q(c.rand_results.$size(),p("UPPER_LIMIT_RANDS")))&&c.$raise(p("TooManyRandsError")),i=c.$random(s),c.rand_results["$<<"]([i,s]),i},1),I(m,"$random",function(s){return W(p("Kernel").$rand(s),1)},1),I(m,"$push_to_detail",function(s,c,i){var $;return $=p("DetailedRandResult").$new(s,c,i),this.detailed_rand_results.$push($)},3),g(u[0],D("StandardError"),"TooManyRandsError"),t},Opal.modules["bcdice/dice_table/roll_result"]=function(r){var a,C,Q,U,A,o,u,j,W,M=[],t=r.nil,v=r.module,e=r.klass,g=r.def,S=r.truthy;return a=M,C=W=[v(M[0],"BCDice")].concat(a),Q=j=[v(W[0],"DiceTable")].concat(C),A=[U=e(j[0],null,"RollResult")].concat(Q),o=r.$r(A),(u=U.$$prototype).table_name=u.value=u.body=t,g(U,"$initialize",function(N,L,b){var m=this;return m.table_name=N,m.value=L,m.body=b},3),U.$attr_reader("table_name"),U.$attr_reader("value"),U.$attr_reader("body"),g(U,"$to_s",function(){var N=this;return N.table_name+"("+N.value+") \uff1e "+N.body},0),g(U,"$last_body",function(){var N=this;return S(N.body["$is_a?"](o("RollResult")))?N.body.$last_body():N.body},0),g(U,"$empty?",function(){return!1},0)},Opal.modules["bcdice/dice_table/chain_table"]=function(r){var P,F,U,A,o,u,D,B,z,M=[],t=r.nil,v=r.module,e=r.klass,g=r.truthy,S=r.def,I=r.rb_minus;return P=M,F=z=[v(M[0],"BCDice")].concat(P),U=B=[v(z[0],"DiceTable")].concat(F),o=[A=e(B[0],null,"ChainTable")].concat(U),u=r.$r(o),(D=A.$$prototype).times=D.sides=D.items=D.name=t,S(A,"$initialize",function(L,b,m){var y=this,p=t;return y.name=L,y.items=m.$freeze(),p=/(\d+)D(\d+)/i.$match(b),g(p)||y.$raise(u("ArgumentError"),"Unexpected table type: "+b),y.times=p["$[]"](1).$to_i(),y.sides=p["$[]"](2).$to_i()},3),S(A,"$roll",function(L){var m,y,b=this,p=t;return m=L.$roll_sum(b.times,b.sides),y=I(m,b.times),p=b.items["$[]"](y),g(p["$respond_to?"]("roll"))&&(p=p.$roll(L)),u("RollResult").$new(b.name,m,p)},1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(r){var C,G,u,D,N,L,b,U,j,M=[],t=r.nil,v=r.module,e=r.klass,g=r.hash2,S=r.defs,I=r.def,a=r.rb_plus,P=r.rb_times,W=r.rb_minus;return C=M,G=j=[v(M[0],"BCDice")].concat(C),u=U=[v(j[0],"DiceTable")].concat(G),N=[D=e(U[0],null,"D66GridTable")].concat(u),L=r.$r(N),(b=D.$$prototype).name=b.items=t,S(D,"$from_i18n",function(y,p){var l=t;return l=L("I18n").$t(y,g(["locale","raise"],{locale:p,raise:!0})),this.$new(l["$[]"]("name"),l["$[]"]("items"))},2),I(D,"$initialize",function(y,p){return this.name=y,this.items=p.$freeze()},2),I(D,"$roll",function(y){var d,l,s,c,i;return d=y.$roll_once(6),l=y.$roll_once(6),s=a(P(d,10),l),c=W(d,1),i=W(l,1),L("RollResult").$new(this.name,s,this.items["$[]"](c)["$[]"](i))},1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(r){var W,j,o,u,D,N,G,Q,C,t=[],v=r.nil,e=r.module,g=r.klass,S=r.hash2,I=r.defs,a=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),W=t,j=C=[e(t[0],"BCDice")].concat(W),G=[e(C[0],"DiceTable")].concat(j),Q=r.$r(G),o=G,D=[u=g(G[0],Q("D66GridTable"),"D66HalfGridTable")].concat(o),N=r.$r(D),I(u,"$from_i18n",function(b,m){var p=v;return p=N("I18n").$t(b,S(["locale","raise"],{locale:m,raise:!0})),this.$new(p["$[]"]("name"),p["$[]"]("items_1_2_3"),p["$[]"]("items_4_5_6"))},2),a(u,"$initialize",function(b,m,y){return this.name=b,this.items=[m,m,m,y,y,y].$freeze()},3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(r){var W,j,o,u,D,N,G,Q,C,t=[],v=r.nil,e=r.module,g=r.klass,S=r.hash2,I=r.defs,a=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),W=t,j=C=[e(t[0],"BCDice")].concat(W),G=[e(C[0],"DiceTable")].concat(j),Q=r.$r(G),o=G,D=[u=g(G[0],Q("D66GridTable"),"D66OneThirdTable")].concat(o),N=r.$r(D),I(u,"$from_i18n",function(b,m){var p=v;return p=N("I18n").$t(b,S(["locale","raise"],{locale:m,raise:!0})),this.$new(p["$[]"]("name"),p["$[]"]("items_1_2"),p["$[]"]("items_3_4"),p["$[]"]("items_5_6"))},2),a(u,"$initialize",function(b,m,y,p){return this.name=b,this.items=[m,m,y,y,p,p].$freeze()},4)},Opal.modules["bcdice/dice_table/d66_table"]=function(r){var j,U,N,L,b,m,y,o,G,M=[],t=r.nil,v=r.$$$,e=r.module,g=r.klass,S=r.hash2,I=r.defs,a=r.def,P=r.eqeqeq,W=r.rb_plus,z=r.rb_times,C=r.truthy;return j=M,U=G=[e(M[0],"BCDice")].concat(j),N=o=[e(G[0],"DiceTable")].concat(U),b=[L=g(o[0],null,"D66Table")].concat(N),m=r.$r(b),(y=L.$$prototype).sort_type=y.items=y.name=t,I(L,"$from_i18n",function(d,l){var i,c=t;return c=m("I18n").$t(d,S(["locale"],{locale:l})),i=m("D66SortType").$const_get(c["$[]"]("d66_sort_type")),this.$new(c["$[]"]("name"),i,c["$[]"]("items"))},2),a(L,"$initialize",function(d,l,s){var c=this;return c.name=d,c.sort_type=l,c.items=s.$freeze()},3),a(L,"$roll",function(d){var l=this,s=t,c=t,i=t,n=t;return s=d.$roll_barabara(2,6),P(v(m("D66SortType"),"ASC"),c=l.sort_type)?s["$sort!"]():P(v(m("D66SortType"),"DESC"),c)&&s["$sort!"]()["$reverse!"](),i=W(z(s["$[]"](0),10),s["$[]"](1)),n=C(c=l.items["$[]"](i))?c:l.items["$[]"](i.$to_s()),C(n["$respond_to?"]("roll"))&&(n=n.$roll(d)),m("RollResult").$new(l.name,i,n)},1),a(L,"$choice",function(d){return m("RollResult").$new(this.name,d,this.items["$[]"](d))},1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(r){var Q,u,N,L,A,t=[],v=r.nil,e=r.module,g=r.klass,S=r.hash2,I=r.send,a=r.to_ary,P=r.rb_plus,W=r.rb_times,z=r.to_a,C=r.rb_minus,F=r.send2,j=r.find_super,B=r.def;return r.top.$require("bcdice/dice_table/d66_table"),Q=t,u=A=[e(t[0],"BCDice")].concat(Q),N=[e(A[0],"DiceTable")].concat(u),L=r.$r(N),B(g(N[0],L("D66Table"),"D66LeftRangeTable"),"$initialize",function p(d,l,s){var n;return delete p.$$p,n=S([],{}),I(s,"each",[],function(f){var E,q;return null==f&&(f=v),E=a(f),q=null==E[1]?v:E[1],I(null==E[0]?v:E[0],"each",[],function(_){return null==_&&(_=v),I(q,"each_with_index",[],function(k,J){var ie,te;return null==k&&(k=v),null==J&&(J=v),ie=P(W(_,10),P(J,1)),I(n,"[]=",z(te=[ie,k])),te[C(te.length,1)]},2)},1)},1),F(this,j(this,"initialize",p,!1,!0),"initialize",[d,l,n],null)},3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(r){var F,Q,D,N,L,b,m,A,B,M=[],t=r.nil,v=r.module,e=r.klass,g=r.hash2,S=r.defs,I=r.def,a=r.truthy,P=r.rb_minus,W=r.rb_plus,z=r.rb_times;return F=M,Q=B=[v(M[0],"BCDice")].concat(F),D=A=[v(B[0],"DiceTable")].concat(Q),L=[N=e(A[0],null,"D66ParityTable")].concat(D),b=r.$r(L),(m=N.$$prototype).odd=m.even=m.name=t,S(N,"$from_i18n",function(p,d){var s=t;return s=b("I18n").$t(p,g(["locale","raise"],{locale:d,raise:!0})),this.$new(s["$[]"]("name"),s["$[]"]("odd"),s["$[]"]("even"))},2),I(N,"$initialize",function(p,d,l){var s=this;return s.name=p,s.odd=d.$freeze(),s.even=l.$freeze()},3),I(N,"$roll",function(p){var s,i,n,d=this,l=t;return l=p.$roll_once(6),s=p.$roll_once(6),i=(a(l["$odd?"]())?d.odd:d.even)["$[]"](P(s,1)),n=W(z(l,10),s),b("RollResult").$new(d.name,n,i)},1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(r){var W,j,A,o,u,D,N,G,C,M=[],t=r.nil,v=r.module,e=r.klass,g=r.def,S=r.rb_plus,I=r.rb_times,a=r.send;return W=M,j=C=[v(M[0],"BCDice")].concat(W),A=G=[v(C[0],"DiceTable")].concat(j),u=[o=e(G[0],null,"D66RangeTable")].concat(A),D=r.$r(u),(N=o.$$prototype).items=N.name=t,g(o,"$initialize",function(b,m){return this.name=b,this.items=m.$freeze()},2),g(o,"$roll",function(b){var y,p,d,l=t;return y=b.$roll_once(6),p=b.$roll_once(6),d=S(I(y,10),p),l=a(this.items,"find",[],function(c){return null==c&&(c=t),c["$[]"](0)["$include?"](d)},1),D("RollResult").$new(this.name,d,l["$[]"](1))},1)},Opal.modules["bcdice/dice_table/range_table"]=function(r){var B,A,L,b,m,y,p,u,Q,M=[],t=r.nil,v=r.module,e=r.klass,g=r.const_set,S=r.send,I=r.truthy,a=r.def,P=r.to_a,W=r.rb_minus,z=r.eqeqeq,C=r.rb_times,F=r.rb_plus;return B=M,A=Q=[v(M[0],"BCDice")].concat(B),L=u=[v(Q[0],"DiceTable")].concat(A),m=[b=e(u[0],null,"RangeTable")].concat(L),y=r.$r(m),(p=b.$$prototype).name=p.items=p.num_of_dice=p.num_of_sides=p.formatter=t,g(m[0],"RollResult",S(y("Struct"),"new",["sum","values","content","formatted"],function d(){return(null==d.$$s?this:d.$$s).$alias_method("to_s","formatted")},{$$arity:0,$$s:b})),g(m[0],"Item",y("Struct").$new("range","content")),g(m[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),g(m[0],"DEFAULT_FORMATTER",S(b,"lambda",[],function(l,s){return null==l&&(l=t),null==s&&(s=t),l.$name()+"("+s.$sum()+") \uff1e "+s.$content()},2)),b.$attr_reader("name"),b.$attr_reader("num_of_dice"),b.$attr_reader("num_of_sides"),a(b,"$initialize",function d(l,s,c){var $,i=d.$$p||t,n=this,f=t;return delete d.$$p,n.name=l.$freeze(),n.formatter=I($=i)?$:y("DEFAULT_FORMATTER"),f=y("DICE_ROLL_METHOD_RE").$match(s),I(f)||n.$raise(y("ArgumentError"),n.name+": invalid dice roll method: "+s),n.num_of_dice=f["$[]"](1).$to_i(),n.num_of_sides=f["$[]"](2).$to_i(),n.$store(c)},3),a(b,"$fetch",function(l){var c,s=this;return c=S(s.items,"find",[],function(n){return null==n&&(n=t),n.$range()["$include?"](l)},1),I(c)||s.$raise(y("RangeError"),s.name+": value is out of range: "+l),c},1),a(b,"$roll",function(l){var i,n,$,s=this,c=t;return i=(c=l.$roll_barabara(s.num_of_dice,s.num_of_sides)).$sum(),n=y("RollResult").$new(i,c,s.$fetch(i).$content()),$=[s.formatter["$[]"](s,n)],S(n,"formatted=",P($)),W($.length,1),n},1),b.$private(),a(b,"$store",function(l){var c,i,s=this;return c=S(l,"map",[],function n($,f){return null==$&&($=t),null==f&&(f=t),[(null==n.$$s?this:n.$$s).$coerce_to_int_range($),f]},{$$arity:2,$$s:s}),i=S(c,"sort_by",[],function($,f){return null==$&&($=t),null==f&&(f=t),$.$min()},2),s.$assert_min_sum_is_covered(i),s.$assert_max_sum_is_covered(i),s.$assert_no_gap_or_overlap_in_ranges(i),s.items=S(i,"map",[],function($,f){return null==$&&($=t),null==f&&(f=t),y("Item").$new($,f.$freeze()).$freeze()},2).$freeze(),s},1),a(b,"$coerce_to_int_range",function(l){var c;return z(y("Integer"),c=l)?y("Range").$new(l,l):z(y("Range"),c)&&I(l.$begin()["$is_a?"](y("Integer")))&&I(l.$end()["$is_a?"](y("Integer")))?l:this.$raise(y("TypeError"),this.name+": "+l+" ("+l.$class()+") must be an Integer or a Range with Integers ")},1),a(b,"$assert_min_sum_is_covered",function(l){var c,s=this,i=t;return c=s.num_of_dice,i=l.$first()["$[]"](0),I(i["$include?"](c))||s.$raise(y("RangeError"),s.name+": min value ("+c+") is not covered: "+i),s},1),a(b,"$assert_max_sum_is_covered",function(l){var c,s=this,i=t;return c=C(s.num_of_dice,s.num_of_sides),i=l.$last()["$[]"](0),I(i["$include?"](c))||s.$raise(y("RangeError"),s.name+": max value ("+c+") is not covered: "+i),s},1),a(b,"$assert_no_gap_or_overlap_in_ranges",function(l){return S(l,"each_cons",[2],function c(i,n){var h,R,$=null==c.$$s?this:c.$$s,f=t,E=t;return null==$.name&&($.name=t),null==i&&(i=t),null==n&&(n=t),f=i["$[]"](0),E=n["$[]"](0),h=f.$max(),R=F(h,1),I(E["$include?"](h))&&$.$raise(y("RangeError"),$.name+": Range overlap: "+f+" and "+E),I(E["$include?"](R))?t:$.$raise(y("RangeError"),$.name+": Range gap: "+f+" and "+E)},{$$arity:2,$$s:this}),this},1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(r){var W,j,A,L,b,m,y,u,G,C,M=[],t=r.nil,v=r.$$$,e=r.module,g=r.klass,S=r.send,I=r.def,a=r.rb_minus;return W=M,j=C=[e(M[0],"BCDice")].concat(W),A=G=[e(C[0],"DiceTable")].concat(j),L=u=[g(G[0],null,"SaiFicSkillTable")].concat(A),m=[b=g(u[0],null,"Category")].concat(L),y=r.$r(m),b.$$prototype.name=t,I(b,"$initialize",function(l,s,c,i){var n=this;return n.name=l,n.skills=S(s.$map(),"with_index",[2],function(f,E){return null==f&&(f=t),null==E&&(E=t),v(y("SaiFicSkillTable"),"Skill").$new(l,f,c,E,i)},2),n.dice=c},4),I(b,"$roll",function(l){return this.$skills()["$[]"](a(l.$roll_sum(2,6),2))},1),I(b,"$to_s",function(){return this.name},0),b.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(r){var a,C,Q,D,N,A,j,W,M=[],t=r.nil,v=r.module,e=r.klass,g=r.def,S=r.hash2;return a=M,C=W=[v(M[0],"BCDice")].concat(a),Q=j=[v(W[0],"DiceTable")].concat(C),A=[e(j[0],null,"SaiFicSkillTable")].concat(Q),(N=(D=e(A[0],null,"Skill")).$$prototype).s_format=N.category_dice=N.row_dice=N.category_name=N.name=t,g(D,"$initialize",function(b,m,y,p,d){var l=this;return l.category_name=b,l.name=m,l.category_dice=y,l.row_dice=p,l.s_format=d},5),g(D,"$to_s",function(){var b=this;return b.$format(b.s_format,S(["category_dice","row_dice","category_name","skill_name"],{category_dice:b.category_dice,row_dice:b.row_dice,category_name:b.category_name,skill_name:b.name}))},0),D.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(r){var U,D,y,p,d,l,s,L,o,M=r.top,t=[],v=r.nil,e=r.$$$,g=r.module,S=r.klass,I=r.hash2,a=r.send,W=r.defs,z=r.const_set,C=r.to_ary,F=r.def,j=r.truthy,B=r.rb_minus,G=r.rb_plus;return M.$require("bcdice/dice_table/sai_fic_skill_table/category"),M.$require("bcdice/dice_table/sai_fic_skill_table/skill"),U=t,D=o=[g(t[0],"BCDice")].concat(U),y=L=[g(o[0],"DiceTable")].concat(D),d=[p=S(L[0],null,"SaiFicSkillTable")].concat(y),l=r.$r(d),(s=p.$$prototype).rtt=s.rtt_format=s.rct=s.rct_format=s.rttn=s.rttn_format=s.categories=v,W(p,"$from_i18n",function(i,n,$){var f,E,h,_,H=v;if(null==$)$=I([],{});else if(!$.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(f=$.$$smap.rtt)&&(f=v),null==(E=$.$$smap.rct)&&(E=v),null==(h=$.$$smap.rttn)&&(h=v),_=(H=l("I18n").$t("RTT",I(["locale","raise","default"],{locale:n,raise:!1,default:I([],{})})).$merge(l("I18n").$t(i,I(["locale","raise"],{locale:n,raise:!0}))))["$[]"]("items"),H=a(H,"select",[],function(k,J){return null==k&&(k=v),null==J&&(J=v),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](k)},2),this.$new(_,r.to_hash(H).$merge(I(["rtt","rct","rttn"],{rtt:f,rct:E,rttn:h})))},-3),z(d[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),z(d[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),z(d[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),z(d[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),F(p,"$initialize",function(i,n){var $,f,E,h,R,q,H,_=this;if(null==n)n=I([],{});else if(!n.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==($=n.$$smap.rtt)&&($=v),null==(f=n.$$smap.rct)&&(f=v),null==(E=n.$$smap.rttn)&&(E=v),null==(h=n.$$smap.rtt_format)&&(h=l("DEFAULT_RTT")),null==(R=n.$$smap.rct_format)&&(R=l("DEFAULT_RCT")),null==(q=n.$$smap.rttn_format)&&(q=l("DEFAULT_RTTN")),null==(H=n.$$smap.s_format)&&(H=l("DEFAULT_S")),_.categories=a(i.$map(),"with_index",[1],function(k,J){var ie,ce,ne;return null==k&&(k=v),null==J&&(J=v),ce=null==(ie=C(k))[0]?v:ie[0],ne=null==ie[1]?v:ie[1],e(l("SaiFicSkillTable"),"Category").$new(ce,ne,J,H)},{$$arity:2,$$has_top_level_mlhs_arg:!0}),_.rtt=$,_.rct=f,_.rttn=E.$to_a(),_.rtt_format=h,_.rct_format=R,_.rttn_format=q},-2),z(d[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),p.$attr_reader("categories"),F(p,"$roll_command",function(i,n){var f,$=this,E=v,h=v;return j(["RTT",$.rtt]["$include?"](f=n))?$.$format_skill($.rtt_format,$.$roll_skill(i)):j(["RCT",$.rct]["$include?"](f))?(E=$.$roll_category(i),$.$format($.rct_format,I(["category_dice","category_name"],{category_dice:E.$dice(),category_name:E.$name()}))):j(h=l("RTTN").$index(f))||j(h=$.rttn.$index(f))?$.$format_skill($.rttn_format,$.categories["$[]"](h).$roll(i)):v},2),F(p,"$roll_category",function(i){return this.categories["$[]"](B(i.$roll_once(6),1))},1),F(p,"$roll_skill",function(i){return this.$roll_category(i).$roll(i)},1),F(p,"$prefixes",function(){var i=this;return G(["RTT[1-6]?","RCT",i.rtt,i.rct],i.rttn).$compact()},0),p.$private(),F(p,"$format_skill",function(i,n){return this.$format(i,I(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:n.$category_dice(),row_dice:n.$row_dice(),category_name:n.$category_name(),skill_name:n.$name(),text:n.$to_s()}))},2)},Opal.modules["bcdice/dice_table/table"]=function(r){var z,B,o,u,D,N,L,Q,F,M=[],t=r.nil,v=r.module,e=r.klass,g=r.hash2,S=r.defs,I=r.truthy,a=r.def,P=r.rb_minus;return z=M,B=F=[v(M[0],"BCDice")].concat(z),o=Q=[v(F[0],"DiceTable")].concat(B),D=[u=e(Q[0],null,"Table")].concat(o),N=r.$r(D),(L=u.$$prototype).times=L.sides=L.name=L.items=t,S(u,"$from_i18n",function(m,y){var d=t;return d=N("I18n").$t(m,g(["locale"],{locale:y})),this.$new(d["$[]"]("name"),d["$[]"]("type"),d["$[]"]("items"))},2),a(u,"$initialize",function(m,y,p){var d=this,l=t;return d.name=m,d.items=p.$freeze(),l=/(\d+)D(\d+)/i.$match(y),I(l)||d.$raise(N("ArgumentError"),"Unexpected table type: "+y),d.times=l["$[]"](1).$to_i(),d.sides=l["$[]"](2).$to_i()},3),a(u,"$roll",function(m){var p,y=this;return p=m.$roll_sum(y.times,y.sides),y.$choice(p)},1),a(u,"$choice",function(m){var p,y=this;return p=P(m,y.times),N("RollResult").$new(y.name,m,y.items["$[]"](p))},1)},Opal.modules["bcdice/dice_table"]=function(r){var M=r.top;return M.$require("bcdice/dice_table/roll_result"),M.$require("bcdice/dice_table/chain_table"),M.$require("bcdice/dice_table/d66_grid_table"),M.$require("bcdice/dice_table/d66_half_grid_table"),M.$require("bcdice/dice_table/d66_one_third_table"),M.$require("bcdice/dice_table/d66_left_range_table"),M.$require("bcdice/dice_table/d66_parity_table"),M.$require("bcdice/dice_table/d66_range_table"),M.$require("bcdice/dice_table/d66_table"),M.$require("bcdice/dice_table/range_table"),M.$require("bcdice/dice_table/sai_fic_skill_table"),M.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(r){var S,W,C,a,M=[],v=r.module,e=r.const_set;return S=M,W=a=[v(M[0],"BCDice")].concat(S),C=[v(a[0],"D66SortType")].concat(W),e(C[0],"NO_SORT","no_sort"),e(C[0],"ASC","asc"),e(C[0],"DESC","desc"),function(P,W){var C=[v(P,"RoundType")].concat(W);return e(C[0],"CEIL","ceil"),e(C[0],"FLOOR","floor"),e(C[0],"ROUND","round")}(a[0],a)},Opal.modules["bcdice/translate"]=function(r){var a,C,F,j,B,W,M=[],t=r.nil,v=r.module,e=r.hash2,S=r.def;return a=M,C=W=[v(M[0],"BCDice")].concat(a),j=[F=v(W[0],"Translate")].concat(C),B=r.$r(j),S(F,"$translate",function(Q,U){var A,o=this;if(null==o.locale&&(o.locale=t),null==U)U=e([],{});else if(!U.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return A=r.kwrestargs(U,{}),B("I18n").$translate(Q,e(["locale","raise"],{locale:o.locale,raise:!0}).$merge(r.to_hash(A)))},-2)},Opal.modules["bcdice/result"]=function(r){var W,B,A,G,U,C,M=[],t=r.nil,e=r.klass,g=r.send,S=r.to_a,I=r.rb_minus,a=r.def;return W=M,B=C=[(0,r.module)(M[0],"BCDice")].concat(W),[G=e(C[0],null,"Result")].concat(B),(U=G.$$prototype).secret=U.success=U.failure=U.critical=U.fumble=t,a(A=r.get_singleton_class(G),"$success",function(D){return g(this.$new(),"tap",[],function(b){var m=t;return null==b&&(b=t),g(b,"text=",S(m=[D])),I(m.length,1),g(b,"success=",S(m=[!0])),m[I(m.length,1)]},1)},1),a(A,"$failure",function(D){return g(this.$new(),"tap",[],function(b){var m=t;return null==b&&(b=t),g(b,"text=",S(m=[D])),I(m.length,1),g(b,"failure=",S(m=[!0])),m[I(m.length,1)]},1)},1),a(A,"$critical",function(D){return g(this.$new(),"tap",[],function(b){var m=t;return null==b&&(b=t),g(b,"text=",S(m=[D])),I(m.length,1),g(b,"critical=",S(m=[!0])),I(m.length,1),g(b,"success=",S(m=[!0])),m[I(m.length,1)]},1)},1),a(A,"$fumble",function(D){return g(this.$new(),"tap",[],function(b){var m=t;return null==b&&(b=t),g(b,"text=",S(m=[D])),I(m.length,1),g(b,"fumble=",S(m=[!0])),I(m.length,1),g(b,"failure=",S(m=[!0])),m[I(m.length,1)]},1)},1),a(A,"$nothing",function(){return"nothing"},0),a(G,"$initialize",function(o){var u=this;return null==o&&(o=t),u.text=o,u.rands=t,u.detailed_rands=t,u.secret=!1,u.success=!1,u.failure=!1,u.critical=!1,u.fumble=!1},-1),G.$attr_accessor("text","rands","detailed_rands"),G.$attr_writer("secret","success","failure","critical","fumble"),a(G,"$secret?",function(){return this.secret},0),a(G,"$success?",function(){return this.success},0),a(G,"$failure?",function(){return this.failure},0),a(G,"$critical?",function(){return this.critical},0),a(G,"$fumble?",function(){return this.fumble},0),a(G,"$condition=",function(o){return this.success=o,this.failure=o["$!"]()},1)},Opal.modules["racc/parser"]=function(r){var y,d,l,t=[],v=r.$r(t),e=r.nil,g=r.$$$,S=r.module,I=r.klass,a=r.truthy,P=r.const_set,W=r.defs,z=r.gvars,C=r.rb_lt,F=r.send,j=r.to_a,B=r.rb_minus,G=r.def,Q=r.to_ary,U=r.neqeq,A=r.rb_plus,o=r.eqeq,u=r.rb_ge,D=r.rb_gt,N=r.eqeqeq,L=r.rb_le,b=r.rb_times;return y=t,d=[S(t[0],"Racc")].concat(y),l=r.$r(d),I(d[0],l("StandardError"),"ParseError"),a(g("::","ParseError","skip_raise")?"constant":e)||P(t[0],"ParseError",g(v("Racc"),"ParseError")),function(m,y){var n,$,f,E,h,l=[S(m,"Racc")].concat(y),s=r.$r(l);return a(s("Racc_No_Extensions","skip_raise")?"constant":e)||P(l[0],"Racc_No_Extensions",!1),n=l,f=[$=I(l[0],null,"Parser")].concat(n),E=r.$r(f),(h=$.$$prototype).yydebug=h.racc_debug_out=h.racc_error_status=h.racc_t=h.racc_vstack=h.racc_val=h.racc_state=h.racc_tstack=e,P(f[0],"Racc_Runtime_Version","1.4.6"),P(f[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),P(f[0],"Racc_Runtime_Core_Version_R","1.4.6"),P(f[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),P(f[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),P(f[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),P(f[0],"Racc_Runtime_Core_Version",E("Racc_Runtime_Core_Version_R")),P(f[0],"Racc_Runtime_Core_Revision",E("Racc_Runtime_Core_Revision_R")),P(f[0],"Racc_Runtime_Type","ruby"),W(E("Parser"),"$racc_runtime_type",function(){return E("Racc_Runtime_Type")},0),G($,"$_racc_setup",function(){var q,H,_=this,K=e,k=e,J=e;return null==z.stderr&&(z.stderr=e),a(g(_.$class(),"Racc_debug_parser"))||(_.yydebug=!1),a(null!=(q=_.yydebug)&&q!==e?"instance-variable":e)||(_.yydebug=!1),a(_.yydebug)&&(a(null!=(H=_.racc_debug_out)&&H!==e?"instance-variable":e)||(_.racc_debug_out=z.stderr),_.racc_debug_out=a(K=_.racc_debug_out)?K:z.stderr),k=g(_.$class(),"Racc_arg"),a(C(k.$size(),14))&&(F(k,"[]=",j(J=[13,!0])),B(J.length,1)),k},0),G($,"$_racc_init_sysvars",function(){var q=this;return q.racc_state=[0],q.racc_tstack=[],q.racc_vstack=[],q.racc_t=e,q.racc_val=e,q.racc_read_next=!0,q.racc_user_yyerror=!1,q.racc_error_status=0},0),G($,"$do_parse",function(){return this.$__send__(E("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),G($,"$next_token",function(){return this.$raise(E("NotImplementedError"),this.$class()+"#next_token is not defined")},0),G($,"$_racc_do_parse_rb",function(q,H){var _,k=this,J=e,ie=e,te=e,ce=e,V=e,T=e,Z=e,x=e;return _=Q(q),J=null==_[0]?e:_[0],ie=null==_[1]?e:_[1],te=null==_[2]?e:_[2],ce=null==_[3]?e:_[3],V=null==_[10]?e:_[10],k.$_racc_init_sysvars(),T=Z=x=e,F(k,"catch",["racc_end_parse"],function w(){var re,X,Y=null==w.$$s?this:w.$$s,ae=e;for(null==Y.racc_state&&(Y.racc_state=e),null==Y.racc_read_next&&(Y.racc_read_next=e),null==Y.racc_t&&(Y.racc_t=e),null==Y.yydebug&&(Y.yydebug=e),null==Y.racc_val&&(Y.racc_val=e);a(!0);)for(a(x=ce["$[]"](Y.racc_state["$[]"](-1)))?(a(Y.racc_read_next)&&U(Y.racc_t,0)&&(X=Y.$next_token(),re=Q(X),T=null==re[0]?e:re[0],Y.racc_val=null==re[1]?e:re[1],Y.racc_t=a(T)?a(ae=V["$[]"](T))?ae:1:0,a(Y.yydebug)&&Y.$racc_read_token(Y.racc_t,T,Y.racc_val),Y.racc_read_next=!1),x=A(x,Y.racc_t),a(u(x,0))&&a(Z=J["$[]"](x))&&o(ie["$[]"](x),Y.racc_state["$[]"](-1))||(Z=te["$[]"](Y.racc_state["$[]"](-1)))):Z=te["$[]"](Y.racc_state["$[]"](-1));a(Z=Y.$_racc_evalact(Z,q)););},{$$arity:0,$$s:k})},2),G($,"$yyparse",function(q,H){return this.$__send__(E("Racc_YY_Parse_Method"),q,H,this.$_racc_setup(),!0)},2),G($,"$_racc_yyparse_rb",function(q,H,_,K){var k,te=e,ce=e,ne=e,V=e,Z=e,x=e,w=e;return k=Q(_),te=null==k[0]?e:k[0],ce=null==k[1]?e:k[1],ne=null==k[2]?e:k[2],V=null==k[3]?e:k[3],Z=null==k[10]?e:k[10],this.$_racc_init_sysvars(),x=e,w=e,F(this,"catch",["racc_end_parse"],function ee(){var Y=null==ee.$$s?this:ee.$$s;for(null==Y.racc_state&&(Y.racc_state=e);!a(w=V["$[]"](Y.racc_state["$[]"](-1)));)for(;a(x=Y.$_racc_evalact(ne["$[]"](Y.racc_state["$[]"](-1)),_)););return F(q,"__send__",[H],function ae(se,_e){var $e=null==ae.$$s?this:ae.$$s,O=e,oe=e;for(null==$e.racc_t&&($e.racc_t=e),null==$e.racc_state&&($e.racc_state=e),null==$e.racc_read_next&&($e.racc_read_next=e),null==se&&(se=e),null==_e&&(_e=e),$e.racc_t=a(se)?a(O=Z["$[]"](se))?O:1:0,$e.racc_val=_e,$e.racc_read_next=!1,w=A(w,$e.racc_t),a(u(w,0))&&a(x=te["$[]"](w))&&o(ce["$[]"](w),$e.racc_state["$[]"](-1))||(x=ne["$[]"]($e.racc_state["$[]"](-1)));a(x=$e.$_racc_evalact(x,_)););for(;a(a(O=a(oe=(w=V["$[]"]($e.racc_state["$[]"](-1)))["$!"]())?oe:$e.racc_read_next["$!"]())?O:$e.racc_t["$=="](0));)for(a(w)&&a(w=A(w,$e.racc_t))&&a(u(w,0))&&a(x=te["$[]"](w))&&o(ce["$[]"](w),$e.racc_state["$[]"](-1))||(x=ne["$[]"]($e.racc_state["$[]"](-1)));a(x=$e.$_racc_evalact(x,_)););},{$$arity:2,$$s:Y})},{$$arity:0,$$s:this})},4),G($,"$_racc_evalact",function(q,H){var _,ne,k=this,J=e,ie=e,ce=e,V=e,T=e,Z=e,x=e;if(J=null==(_=Q(H))[0]?e:_[0],ie=null==_[1]?e:_[1],ce=null==_[3]?e:_[3],ne=null==_[11]?e:_[11],V=null==_[12]?e:_[12],a(D(q,0))&&a(C(q,ne)))a(D(k.racc_error_status,0))&&(o(k.racc_t,1)||(k.racc_error_status=B(k.racc_error_status,1))),k.racc_vstack.$push(k.racc_val),k.racc_state.$push(q),k.racc_read_next=!0,a(k.yydebug)&&(k.racc_tstack.$push(k.racc_t),k.$racc_shift(k.racc_t,k.racc_tstack,k.racc_vstack));else if(a(C(q,0))&&a(D(q,V["$-@"]()))){if(T=F(k,"catch",["racc_jump"],function w(){var ee=null==w.$$s?this:w.$$s;return null==ee.racc_state&&(ee.racc_state=e),ee.racc_state.$push(ee.$_racc_do_reduce(H,q)),!1},{$$arity:0,$$s:k}),a(T)){if(N(1,Z=T))return k.racc_user_yyerror=!0,V["$-@"]();if(N(2,Z))return ne;k.$raise("[Racc Bug] unknown jump code")}}else if(o(q,ne))a(k.yydebug)&&k.$racc_accept(),k.$throw("racc_end_parse",k.racc_vstack["$[]"](0));else{if(o(q,V["$-@"]())){for(N(0,Z=k.racc_error_status)?a(H["$[]"](21))||k.$on_error(k.racc_t,k.racc_val,k.racc_vstack):N(3,Z)&&(o(k.racc_t,0)&&k.$throw("racc_end_parse",e),k.racc_read_next=!0),k.racc_user_yyerror=!1,k.racc_error_status=3;a(!0)&&!(a(x=ce["$[]"](k.racc_state["$[]"](-1)))&&(x=A(x,1),a(u(x,0))&&a(q=J["$[]"](x))&&o(ie["$[]"](x),k.racc_state["$[]"](-1))));)a(L(k.racc_state.$size(),1))&&k.$throw("racc_end_parse",e),k.racc_state.$pop(),k.racc_vstack.$pop(),a(k.yydebug)&&(k.racc_tstack.$pop(),k.$racc_e_pop(k.racc_state,k.racc_tstack,k.racc_vstack));return q}k.$raise("[Racc Bug] unknown action "+q.$inspect())}return a(k.yydebug)&&k.$racc_next_state(k.racc_state["$[]"](-1),k.racc_state),e},2),G($,"$_racc_do_reduce",function(q,H){var _,V,Z,Y,ae,se,$e,k=this,ie=e,te=e,ce=e,ne=e,T=e,x=e,w=e,ee=e,re=e,X=e,_e=e,le=e,ue=e,O=e;return ie=null==(_=Q(q))[4]?e:_[4],te=null==_[5]?e:_[5],ce=null==_[6]?e:_[6],ne=null==_[7]?e:_[7],V=null==_[8]?e:_[8],T=null==_[9]?e:_[9],Z=null==_[13]?e:_[13],x=k.racc_state,w=k.racc_vstack,ee=k.racc_tstack,re=b(H,-3),X=T["$[]"](re),Y=T["$[]"](A(re,1)),ae=T["$[]"](A(re,2)),se=[],a(k.yydebug)&&(_e=ee["$[]"](X["$-@"](),X)),le=w["$[]"](X["$-@"](),X),a(k.yydebug)&&(ue=[X["$-@"](),X,se],F(ee,"[]=",j(ue)),B(ue.length,1)),ue=[X["$-@"](),X,se],F(w,"[]=",j(ue)),B(ue.length,1),ue=[X["$-@"](),X,se],F(x,"[]=",j(ue)),B(ue.length,1),a(Z)?w.$push(k.$__send__(ae,le,w,le["$[]"](0))):w.$push(k.$__send__(ae,le,w)),ee.$push(Y),a(k.yydebug)&&k.$racc_reduce(_e,Y,ee,w),$e=B(Y,V),a(re=ne["$[]"]($e))&&(re=A(re,x["$[]"](-1)),a(u(re,0))&&a(O=ie["$[]"](re))&&o(te["$[]"](re),$e))?O:ce["$[]"]($e)},2),G($,"$on_error",function(q,H,_){var k,K=this;return K.$raise(E("ParseError"),K.$sprintf("\nparse error on value %s (%s)",H.$inspect(),a(k=K.$token_to_str(q))?k:"?"))},3),G($,"$yyerror",function(){return this.$throw("racc_jump",1)},0),G($,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),G($,"$yyerrok",function(){return this.racc_error_status=0},0),G($,"$racc_read_token",function(q,H,_){var K=this;return K.racc_debug_out.$print("read    "),K.racc_debug_out.$print(H.$inspect(),"(",K.$racc_token2str(q),") "),K.racc_debug_out.$puts(_.$inspect()),K.racc_debug_out.$puts()},3),G($,"$racc_shift",function(q,H,_){var K=this;return K.racc_debug_out.$puts("shift   "+K.$racc_token2str(q)),K.$racc_print_stacks(H,_),K.racc_debug_out.$puts()},3),G($,"$racc_reduce",function(q,H,_,K){var k=this,J=e;return(J=k.racc_debug_out).$print("reduce "),a(q["$empty?"]())?J.$print(" <none>"):F(q,"each",[],function ie(te){return null==te&&(te=e),J.$print(" ",(null==ie.$$s?this:ie.$$s).$racc_token2str(te))},{$$arity:1,$$s:k}),J.$puts(" --\x3e "+k.$racc_token2str(H)),k.$racc_print_stacks(_,K),k.racc_debug_out.$puts()},4),G($,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),G($,"$racc_e_pop",function(q,H,_){var K=this;return K.racc_debug_out.$puts("error recovering mode: pop token"),K.$racc_print_states(q),K.$racc_print_stacks(H,_),K.racc_debug_out.$puts()},3),G($,"$racc_next_state",function(q,H){var _=this;return _.racc_debug_out.$puts("goto    "+q),_.$racc_print_states(H),_.racc_debug_out.$puts()},2),G($,"$racc_print_stacks",function(q,H){var K=e;return(K=this.racc_debug_out).$print("        ["),F(q,"each_index",[],function k(J){return null==J&&(J=e),K.$print(" (",(null==k.$$s?this:k.$$s).$racc_token2str(q["$[]"](J))," ",H["$[]"](J).$inspect(),")")},{$$arity:1,$$s:this}),K.$puts(" ]")},2),G($,"$racc_print_states",function(q){var _=e;return(_=this.racc_debug_out).$print("        ["),F(q,"each",[],function(k){return null==k&&(k=e),_.$print(" ",k)},1),_.$puts(" ]")},1),G($,"$racc_token2str",function(q){var _;return a(_=g(this.$class(),"Racc_token_to_s_table")["$[]"](q))?_:this.$raise("[Racc Bug] can't convert token "+q+" to string")},1),G($,"$token_to_str",function(q){return g(this.$class(),"Racc_token_to_s_table")["$[]"](q)},1)}(t[0],t)},Opal.modules["bcdice/arithmetic/node"]=function(r){var G,o,L,l,s,m,y,D,U,M=[],t=r.nil,v=r.$$$,e=r.module,g=r.klass,S=r.def,I=r.send2,a=r.find_super,P=r.eqeq,W=r.const_set,z=r.eqeqeq,C=r.rb_divide,F=r.truthy,j=r.alias;return G=M,o=U=[e(M[0],"BCDice")].concat(G),L=D=[e(U[0],"Arithmetic")].concat(o),m=[e(D[0],"Node")].concat(L),y=r.$r(m),(s=(l=g(m[0],null,"BinaryOp")).$$prototype).lhs=s.rhs=s.op=t,S(l,"$initialize",function(i,n,$){var f=this;return f.lhs=i,f.op=n,f.rhs=$},3),S(l,"$eval",function(i){var f,n=this,$=t;return $=n.lhs.$eval(i),f=n.rhs.$eval(i),$.$send(n.op,f)},1),S(l,"$output",function(){var i=this;return""+i.lhs.$output()+i.op+i.rhs.$output()},0),S(l,"$s_exp",function(){var i=this;return"("+i.$op_for_s_exp()+" "+i.lhs.$s_exp()+" "+i.rhs.$s_exp()+")"},0),S(l,"$op_for_s_exp",function(){return this.op},0),function(p,d,l){var s=g(p,d,"DivideBase"),c=[s].concat(l),i=r.$r(c),n=s.$$prototype;n.lhs=n.rhs=n.op=t,S(s,"$initialize",function $(f,E){return delete $.$$p,I(this,a(this,"initialize",$,!1,!0),"initialize",[f,"/",E],null)},2),S(s,"$eval",function(f){var h,R,E=this;return h=E.lhs.$eval(f),R=E.rhs.$eval(f),P(R,0)&&E.$raise(i("ZeroDivisionError")),E.$divide_and_round(h,R,f)},1),S(s,"$output",function $(){var f=$.$$p||t,E=this;return delete $.$$p,""+I(E,a(E,"output",$,!1,!0),"output",[],f)+E.$rounding_method()},0),s.$private(),S(s,"$rounding_method",function(){return v(this.$class(),"ROUNDING_METHOD")},0),S(s,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),S(s,"$divide_and_round",function(f,E,h){return this.$raise(i("NotImplementedError"))},3)}(m[0],y("BinaryOp"),m),function(p,d,l){var s=g(p,d,"DivideWithGameSystemDefault"),c=[s].concat(l),i=r.$r(c);W(c[0],"ROUNDING_METHOD",""),s.$private(),S(s,"$divide_and_round",function($,f,E){var h,R=t;return z(v(i("RoundType"),"CEIL"),h=E)?C($.$to_f(),f).$ceil():z(v(i("RoundType"),"ROUND"),h)?(R=C($.$to_f(),f),F(R["$negative?"]())?R.$abs().$round()["$-@"]():R.$round()):C($,f).$floor()},3)}(m[0],y("DivideBase"),m),function(p,d,l){var s=g(p,d,"DivideWithCeil"),c=[s].concat(l);W(c[0],"ROUNDING_METHOD","C"),s.$private(),S(s,"$divide_and_round",function(n,$,f){return C(n.$to_f(),$).$ceil()},3)}(m[0],y("DivideBase"),m),function(p,d,l){var s=g(p,d,"DivideWithRound"),c=[s].concat(l);W(c[0],"ROUNDING_METHOD","R"),s.$private(),S(s,"$divide_and_round",function(n,$,f){var E=t;return E=C(n.$to_f(),$),F(E["$negative?"]())?E.$abs().$round()["$-@"]():E.$round()},3)}(m[0],y("DivideBase"),m),function(p,d,l){var s=g(p,d,"DivideWithFloor"),c=[s].concat(l);W(c[0],"ROUNDING_METHOD","F"),s.$private(),S(s,"$divide_and_round",function(n,$,f){return C(n,$).$floor()},3)}(m[0],y("DivideBase"),m),function(p,d){var l=g(p,null,"Negative");l.$$prototype.body=t,S(l,"$initialize",function(i){return this.body=i},1),S(l,"$eval",function(i){return this.body.$eval(i)["$-@"]()},1),S(l,"$output",function(){return"-"+this.body.$output()},0),S(l,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(m[0]),function(p,d){var l=g(p,null,"Parenthesis");l.$$prototype.expr=t,S(l,"$initialize",function(i){return this.expr=i},1),S(l,"$eval",function(i){return this.expr.$eval(i)},1),S(l,"$output",function(){return"("+this.expr.$output()+")"},0),S(l,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(m[0]),function(p,d){var l=g(p,null,"Number");return l.$$prototype.value=t,S(l,"$initialize",function(i){return this.value=i},1),S(l,"$eval",function(i){return this.value},1),S(l,"$output",function(){return this.value.$to_s()},0),j(l,"s_exp","output")}(m[0])},Opal.modules.strscan=function(r){var j,B,G,Q,U,M=[],t=r.nil,e=r.def,g=r.truthy,S=r.eqeqeq,I=r.Opal,a=r.send,P=r.to_a,W=r.rb_minus,z=r.alias;return j=M,G=[B=(0,r.klass)(M[0],null,"StringScanner")].concat(j),Q=r.$r(G),(U=B.$$prototype).pos=U.string=U.working=U.matched=U.prev_pos=U.match=t,B.$attr_reader("pos","matched"),e(B,"$initialize",function(o){var u=this;return u.string=o,u.pos=0,u.matched=t,u.working=o,u.match=[]},1),B.$attr_reader("string"),e(B,"$beginning_of_line?",function(){var o=this;return 0===o.pos||"\n"===o.string.charAt(o.pos-1)},0),e(B,"$scan",function(o){var u=this,D=(o=u.$anchor(o)).exec(u.working);return null==D?u.matched=t:"object"==typeof D?(u.prev_pos=u.pos,u.pos+=D[0].length,u.working=u.working.substring(D[0].length),u.matched=D[0],u.match=D,D[0]):"string"==typeof D?(u.pos+=D.length,u.working=u.working.substring(D.length),D):t},1),e(B,"$scan_until",function(o){var u=this;o=u.$anchor(o);for(var L,D=u.pos,N=u.working;;){if(L=o.exec(N),D+=1,N=N.substr(1),null!=L)return u.matched=u.string.substr(u.pos,D-u.pos-1+L[0].length),u.match=L,u.prev_pos=D-1,u.pos=D,u.working=N.substr(L[0].length),u.matched;if(0===N.length)return u.match=[],u.matched=t}},1),e(B,"$[]",function(o){var D;if(g(this.match["$empty?"]()))return t;S(Q("Symbol"),D=o)?o=o.$to_s():S(Q("String"),D)||(o=I["$coerce_to!"](o,Q("Integer"),"to_int"));var N=this.match;return o<0&&(o+=N.length),o<0||o>=N.length||null==N[o]?t:N[o]},1),e(B,"$check",function(o){var u=this,D=(o=u.$anchor(o)).exec(u.working);return u.matched=null==D?t:D[0]},1),e(B,"$check_until",function(o){var u=this,D=u.prev_pos,N=u.pos,L=u.$scan_until(o);return L!==t&&(u.matched=L.substr(-1),u.working=u.string.substr(N)),u.prev_pos=D,u.pos=N,L},1),e(B,"$peek",function(o){return this.working.substring(0,o)},1),e(B,"$eos?",function(){return 0===this.working.length},0),e(B,"$exist?",function(o){var D=o.exec(this.working);return null==D?t:0==D.index?0:D.index+1},1),e(B,"$skip",function(o){var u=this,D=(o=u.$anchor(o)).exec(u.working);if(null==D)return u.match=[],u.matched=t;var N=D[0],L=N.length;return u.matched=N,u.match=D,u.prev_pos=u.pos,u.pos+=L,u.working=u.working.substring(L),L},1),e(B,"$skip_until",function(o){var D=this.$scan_until(o);return D===t?t:(this.matched=D.substr(-1),D.length)},1),e(B,"$get_byte",function(){var o=this,u=t;return o.pos<o.string.length?(o.prev_pos=o.pos,o.pos+=1,u=o.matched=o.working.substring(0,1),o.working=o.working.substring(1)):o.matched=t,u},0),e(B,"$match?",function(o){var u=this,D=(o=u.$anchor(o)).exec(u.working);return null==D?t:(u.prev_pos=u.pos,D[0].length)},1),e(B,"$pos=",function(o){var u=this;return o<0&&(o+=u.string.$length()),u.pos=o,u.working=u.string.slice(o)},1),e(B,"$matched_size",function(){return this.matched===t?t:this.matched.length},0),e(B,"$post_match",function(){var o=this;return o.matched===t?t:o.string.substr(o.pos)},0),e(B,"$pre_match",function(){var o=this;return o.matched===t?t:o.string.substr(0,o.prev_pos)},0),e(B,"$reset",function(){var o=this;return o.working=o.string,o.matched=t,o.pos=0},0),e(B,"$rest",function(){return this.working},0),e(B,"$rest?",function(){return 0!==this.working.length},0),e(B,"$rest_size",function(){return this.$rest().$size()},0),e(B,"$terminate",function(){var u,o=this;return o.match=t,u=[o.string.$length()],a(o,"pos=",P(u)),u[W(u.length,1)]},0),e(B,"$unscan",function(){var o=this;return o.pos=o.prev_pos,o.prev_pos=t,o.match=t,o},0),z(B,"bol?","beginning_of_line?"),z(B,"getch","get_byte"),B.$private(),e(B,"$anchor",function(o){var u=o.toString().match(/\/([^\/]+)$/);return u=u?u[1]:void 0,new RegExp("^(?:"+o.source+")",u)},1)},Opal.modules["bcdice/normalize"]=function(r){var a,C,W,M=[],t=r.nil,v=r.module,e=r.eqeqeq,g=r.def,S=r.eqeq;return a=M,W=[v(M[0],"BCDice")].concat(a),(C=v(W[0],"Normalize")).$module_function(),g(C,"$comparison_operator",function(j){var B;return e(/<=|=</,B=j)?"<=":e(/>=|=>/,B)?">=":e(/<>|!=|=!/,B)?"!=":e(/</,B)?"<":e(/>/,B)?">":e(/=/,B)?"==":t},1),g(C,"$target_number",function(j){return S(j,"?")?j:j.$to_i()},1)},Opal.modules["bcdice/command/lexer"]=function(r){var C,G,u,D,N,L,b,U,j,M=r.top,t=[],v=r.nil,e=r.module,g=r.klass,S=r.const_set,I=r.hash2,a=r.truthy,P=r.send,W=r.def;return M.$require("strscan"),M.$require("bcdice/normalize"),C=t,G=j=[e(t[0],"BCDice")].concat(C),u=U=[e(j[0],"Command")].concat(G),N=[D=g(U[0],null,"Lexer")].concat(u),L=r.$r(N),(b=D.$$prototype).scanner=b.notations=v,S(N[0],"SYMBOLS",I(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),W(D,"$initialize",function(y,p){var d,l,c;return y=a(c=(l=(d=y)===v||null==d?v:P(d,"split",[" ",2]))===v||null==l?v:P(l,"first",[]))?c:"",this.scanner=L("StringScanner").$new(y),this.notations=P(p,"map",[],function(n){return null==n&&(n=v),a(n["$is_a?"](L("String")))?L("Regexp").$new(n):n},1)},2),W(D,"$next_token",function(){try{var y=this,p=v,d=v,s=v,c=v;return a(y.scanner["$eos?"]())?[!1,"$"]:(P(y.notations,"each",[],function i(n){var f,$=null==i.$$s?this:i.$$s;if(null==$.scanner&&($.scanner=v),null==n&&(n=v),f=$.scanner.$scan(n),!a(f))return v;r.ret(["NOTATION",f])},{$$arity:1,$$s:y}),a(p=y.scanner.$scan(/\d+/))?["NUMBER",p.$to_i()]:a(d=y.scanner.$scan(/[<>!=]+/))?(d=L("Normalize").$comparison_operator(d),[a(d)?"CMP_OP":"ILLEGAL",d]):(s=y.scanner.$getch().$upcase(),[a(c=L("SYMBOLS")["$[]"](s))?c:s.$to_sym(),s]))}catch(i){if(i===r.returner)return i.$v;throw i}},0),W(D,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/command/parsed"]=function(r){var P,F,U,A,o,u,D,B,z,M=[],t=r.nil,v=r.module,e=r.klass,g=r.def,S=r.truthy,I=r.eqeqeq;return P=M,F=z=[v(M[0],"BCDice")].concat(P),U=B=[v(z[0],"Command")].concat(F),o=[A=e(B[0],null,"Parsed")].concat(U),u=r.$r(o),(D=A.$$prototype).question_target=D.critical=D.fumble=D.dollar=D.modify_number=D.target_number=D.prefix_number=D.command=D.suffix_number=D.cmp_op=t,A.$attr_accessor("command"),A.$attr_accessor("prefix_number"),A.$attr_accessor("suffix_number"),A.$attr_accessor("critical"),A.$attr_accessor("fumble"),A.$attr_accessor("dollar"),A.$attr_accessor("modify_number"),A.$attr_accessor("cmp_op"),A.$attr_accessor("target_number"),A.$attr_writer("question_target"),g(A,"$initialize",function(){var L=this;return L.prefix_number=t,L.suffix_number=t,L.critical=t,L.fumble=t,L.dollar=t,L.cmp_op=t,L.target_number=t,L.question_target=!1},0),g(A,"$question_target?",function(){return this.question_target},0),g(A,"$to_s",function(L){var s,b=this,m=t,y=t,p=t,d=t,l=t;return null==L&&(L="after_command"),m=S(b.critical)?"@"+b.critical:t,y=S(b.fumble)?"#"+b.fumble:t,p=S(b.dollar)?"$"+b.dollar:t,d=u("Format").$modifier(b.modify_number),l=S(b.question_target)?"?":b.target_number,I("after_command",s=L)?[b.prefix_number,b.command,b.suffix_number,m,y,p,d,b.cmp_op,l].$join():I("after_modify_number",s)?[b.prefix_number,b.command,b.suffix_number,d,m,y,p,b.cmp_op,l].$join():I("after_target_number",s)?[b.prefix_number,b.command,b.suffix_number,d,b.cmp_op,l,m,y,p].$join():t},-1)},Opal.modules["bcdice/command/parser"]=function(r){var u,b,s,$,f,E,h,R,q,H,_,K,ie,c,i,n,ne,y,p,N,M=r.top,t=[],v=r.$r(t),e=r.nil,g=r.$$$,S=r.klass,I=r.module,a=r.hash2,P=r.send2,W=r.find_super,z=r.def,C=r.send,F=r.to_a,j=r.rb_minus,B=r.eqeq,G=r.hash,Q=r.const_set,U=r.truthy,A=r.to_ary;return M.$require("racc/parser.rb"),M.$require("bcdice/arithmetic/node"),M.$require("bcdice/command/lexer"),M.$require("bcdice/command/parsed"),S(g(v("BCDice"),"Command"),g(v("Racc"),"Parser"),"Parser"),u=t,b=N=[I(t[0],"BCDice")].concat(u),y=[I(N[0],"Command")].concat(b),p=r.$r(y),s=y,i=[c=S(y[0],g(p("Racc"),"Parser"),"Parser")].concat(s),n=r.$r(i),(ne=c.$$prototype).notations=ne.lexer=ne.modifier=ne.suffix_number=ne.prefix_number=ne.need_suffix_number=ne.need_prefix_number=ne.critical=ne.fumble=ne.dollar=ne.allowed_cmp_op=ne.question_target=e,z(c,"$initialize",function V(T,Z){var x,w,ee,re,Y=this;if(delete V.$$p,x=r.slice.call(arguments),null==(w=r.extract_kwargs(x)))w=a([],{});else if(!w.$$is_hash)throw r.ArgumentError.$new("expected kwargs");if(ee=x,!r.hasOwnProperty.call(w.$$smap,"round_type"))throw r.ArgumentError.$new("missing keyword: round_type");return re=w.$$smap.round_type,P(Y,W(Y,"initialize",V,!1,!0),"initialize",[],null),Y.notations=ee,Y.round_type=re,Y.prefix_number=!1,Y.suffix_number=!1,Y.need_prefix_number=!1,Y.need_suffix_number=!1,Y.modifier=!0,Y.critical=!1,Y.fumble=!1,Y.dollar=!1,Y.allowed_cmp_op=[e,">=",">","<=","<","==","!="],Y.question_target=!1},-2),z(c,"$disable_modifier",function(){return this.modifier=!1,this},0),z(c,"$enable_prefix_number",function(){return this.prefix_number=!0,this},0),z(c,"$enable_suffix_number",function(){return this.suffix_number=!0,this},0),z(c,"$has_prefix_number",function(){var T=this;return T.prefix_number=!0,T.need_prefix_number=!0,T},0),z(c,"$has_suffix_number",function(){var T=this;return T.suffix_number=!0,T.need_suffix_number=!0,T},0),z(c,"$enable_critical",function(){return this.critical=!0,this},0),z(c,"$enable_fumble",function(){return this.fumble=!0,this},0),z(c,"$enable_dollar",function(){return this.dollar=!0,this},0),z(c,"$restrict_cmp_op_to",function(T){var Z,w=this;return Z=r.slice.call(arguments),w.allowed_cmp_op=Z,w},-1),z(c,"$enable_question_target",function(){return this.question_target=!0,this},0),z(c,"$parse",function(T){var Z=this;try{return Z.lexer=n("Lexer").$new(T,Z.notations),Z.$do_parse()}catch(x){if(!r.rescue(x,[n("ParseError"),n("ZeroDivisionError")]))throw x;try{return e}finally{r.pop_exception()}}},1),c.$private(),z(c,"$parsed",function(T,Z,x,w){return C(n("Parsed").$new(),"tap",[],function re(X){var Y,ae,se,_e,le,ue,$e=null==re.$$s?this:re.$$s,O=e;return null==$e.round_type&&($e.round_type=e),null==X&&(X=e),O=[T["$[]"]("command")],C(X,"command=",F(O)),j(O.length,1),O=[(Y=T["$[]"]("prefix"),Y===e||null==Y?e:C(Y,"eval",[$e.round_type]))],C(X,"prefix_number=",F(O)),j(O.length,1),O=[(ae=T["$[]"]("suffix"),ae===e||null==ae?e:C(ae,"eval",[$e.round_type]))],C(X,"suffix_number=",F(O)),j(O.length,1),O=[(se=Z["$[]"]("critical"),se===e||null==se?e:C(se,"eval",[$e.round_type]))],C(X,"critical=",F(O)),j(O.length,1),O=[(_e=Z["$[]"]("fumble"),_e===e||null==_e?e:C(_e,"eval",[$e.round_type]))],C(X,"fumble=",F(O)),j(O.length,1),O=[(le=Z["$[]"]("dollar"),le===e||null==le?e:C(le,"eval",[$e.round_type]))],C(X,"dollar=",F(O)),j(O.length,1),O=[x.$eval($e.round_type)],C(X,"modify_number=",F(O)),j(O.length,1),O=[w["$[]"]("cmp_op")],C(X,"cmp_op=",F(O)),j(O.length,1),B(w["$[]"]("target"),"?")?(C(X,"question_target=",F(O=[!0])),j(O.length,1),C(X,"target_number=",F(O=[0])),O[j(O.length,1)]):(C(X,"question_target=",F(O=[!1])),j(O.length,1),O=[(ue=w["$[]"]("target"),ue===e||null==ue?e:C(ue,"eval",[$e.round_type]))],C(X,"target_number=",F(O)),O[j(O.length,1)])},{$$arity:1,$$s:this})},4),z(c,"$next_token",function(){return this.lexer.$next_token()},0),$=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,33,34,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,e,e,17,18,6,e,5,e,e,17,18,e,e,5,23,24,25,26,56,54,55,57],f=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,e,17,15,15,18,18,23,e,18,30,30,23,23,24,e,23,31,31,24,24,25,e,24,44,44,25,25,28,e,25,47,47,28,28,29,e,28,48,48,29,29,33,e,29,49,49,33,33,34,e,33,50,50,34,34,36,e,34,e,e,36,36,37,e,36,e,e,37,37,e,e,37,27,27,27,27,52,52,52,52],E=[-2,4,16,-3,-1,11,e,33,13,35,23,30,1,e,28,40,e,37,44,e,e,-2,e,51,58,65,0,106,72,79,47,54,e,86,93,e,100,107,e,e,e,e,e,e,63,e,e,68,75,82,89,e,120,e,e,e,e,e],h=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],R=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,e,e,21,47,48,40,51,52,49,50,44,46,3,e,e,e,13,e,e,e,e,e,e,e,32],q=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,e,e,4,8,8,5,7,7,8,8,9,5,6,e,e,e,6,e,e,e,e,e,e,e,6],H=[e,6,13,3,9,-1,27,-15,-10,-1,-38],_=[e,e,e,e,e,e,19,16,15,e,e],K=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],ie=G(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),Q(i[0],"Racc_arg",[$,f,h,E,R,q,_,H,19,K,ie,58,35,!0]),Q(i[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),Q(i[0],"Racc_debug_parser",!1),z(c,"$_reduce_1",function(T,Z,x){var w;return U(this.modifier)||this.$raise(n("ParseError")),w=A(T),this.$parsed(null==w[0]?e:w[0],null==w[1]?e:w[1],null==w[2]?e:w[2],null==w[3]?e:w[3])},3),z(c,"$_reduce_2",function(T,Z,x){var w;return U(this.modifier)||this.$raise(n("ParseError")),w=A(T),this.$parsed(null==w[0]?e:w[0],null==w[2]?e:w[2],null==w[1]?e:w[1],null==w[3]?e:w[3])},3),z(c,"$_reduce_3",function(T,Z,x){var w,ae;return ae=null==(w=A(T))[2]?e:w[2],this.$parsed(null==w[0]?e:w[0],null==w[1]?e:w[1],g(g(n("Arithmetic"),"Node"),"Number").$new(0),ae)},3),z(c,"$_reduce_4",function(T,Z,x){var w=this;return U(w.prefix_number)&&U(w.suffix_number)||w.$raise(n("ParseError")),a(["command","prefix","suffix"],{command:T["$[]"](1),prefix:T["$[]"](0),suffix:T["$[]"](2)})},3),z(c,"$_reduce_5",function(T,Z,x){var w=this;return U(w.prefix_number)||w.$raise(n("ParseError")),U(w.need_suffix_number)&&w.$raise(n("ParseError")),a(["command","prefix"],{command:T["$[]"](1),prefix:T["$[]"](0)})},3),z(c,"$_reduce_6",function(T,Z,x){var w=this;return U(w.suffix_number)||w.$raise(n("ParseError")),U(w.need_prefix_number)&&w.$raise(n("ParseError")),a(["command","suffix"],{command:T["$[]"](0),suffix:T["$[]"](1)})},3),z(c,"$_reduce_7",function(T,Z,x){var w=this;return(U(w.need_prefix_number)||U(w.need_suffix_number))&&w.$raise(n("ParseError")),a(["command"],{command:T["$[]"](0)})},3),z(c,"$_reduce_8",function(T,Z,x){return a([],{})},3),z(c,"$_reduce_9",function(T,Z,x){var w,ae,se,X=e;return X=null==(w=A(T))[0]?e:w[0],ae=null==w[2]?e:w[2],U(this.critical)&&U(X["$[]"]("critical")["$nil?"]())||this.$raise(n("ParseError")),C(X,"[]=",F(se=["critical",ae])),j(se.length,1),X},3),z(c,"$_reduce_10",function(T,Z,x){var w,ae,se,X=e;return X=null==(w=A(T))[0]?e:w[0],ae=null==w[2]?e:w[2],U(this.fumble)&&U(X["$[]"]("fumble")["$nil?"]())||this.$raise(n("ParseError")),C(X,"[]=",F(se=["fumble",ae])),j(se.length,1),X},3),z(c,"$_reduce_11",function(T,Z,x){var w,ae,se,X=e;return X=null==(w=A(T))[0]?e:w[0],ae=null==w[2]?e:w[2],U(this.dollar)&&U(X["$[]"]("dollar")["$nil?"]())||this.$raise(n("ParseError")),C(X,"[]=",F(se=["dollar",ae])),j(se.length,1),X},3),z(c,"$_reduce_12",function(T,Z,x){return T["$[]"](1)},3),z(c,"$_reduce_13",function(T,Z,x){return g(g(n("Arithmetic"),"Node"),"Negative").$new(T["$[]"](1))},3),z(c,"$_reduce_14",function(T,Z,x){return g(g(n("Arithmetic"),"Node"),"BinaryOp").$new(T["$[]"](0),"+",T["$[]"](2))},3),z(c,"$_reduce_15",function(T,Z,x){return g(g(n("Arithmetic"),"Node"),"BinaryOp").$new(T["$[]"](0),"-",T["$[]"](2))},3),z(c,"$_reduce_16",function(T,Z,x){return U(this.allowed_cmp_op["$include?"](e))||this.$raise(n("ParseError")),a([],{})},3),z(c,"$_reduce_17",function(T,Z,x){var w,X,Y;return Y=null==(w=A(T))[1]?e:w[1],U(this.allowed_cmp_op["$include?"](X=null==w[0]?e:w[0]))||this.$raise(n("ParseError")),a(["cmp_op","target"],{cmp_op:X,target:Y})},3),z(c,"$_reduce_18",function(T,Z,x){var ee,w=this;return ee=T["$[]"](0),U(w.question_target)||w.$raise(n("ParseError")),U(w.allowed_cmp_op["$include?"](ee))||w.$raise(n("ParseError")),a(["cmp_op","target"],{cmp_op:ee,target:"?"})},3),z(c,"$_reduce_19",function(T,Z,x){return g(g(n("Arithmetic"),"Node"),"BinaryOp").$new(T["$[]"](0),"+",T["$[]"](2))},3),z(c,"$_reduce_20",function(T,Z,x){return g(g(n("Arithmetic"),"Node"),"BinaryOp").$new(T["$[]"](0),"-",T["$[]"](2))},3),z(c,"$_reduce_22",function(T,Z,x){return g(g(n("Arithmetic"),"Node"),"BinaryOp").$new(T["$[]"](0),"*",T["$[]"](2))},3),z(c,"$_reduce_23",function(T,Z,x){return T["$[]"](3).$new(T["$[]"](0),T["$[]"](2))},3),z(c,"$_reduce_25",function(T,Z,x){return g(g(n("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),z(c,"$_reduce_26",function(T,Z,x){return g(g(n("Arithmetic"),"Node"),"DivideWithCeil")},3),z(c,"$_reduce_27",function(T,Z,x){return g(g(n("Arithmetic"),"Node"),"DivideWithCeil")},3),z(c,"$_reduce_28",function(T,Z,x){return g(g(n("Arithmetic"),"Node"),"DivideWithRound")},3),z(c,"$_reduce_29",function(T,Z,x){return g(g(n("Arithmetic"),"Node"),"DivideWithFloor")},3),z(c,"$_reduce_30",function(T,Z,x){return T["$[]"](1)},3),z(c,"$_reduce_31",function(T,Z,x){return g(g(n("Arithmetic"),"Node"),"Negative").$new(T["$[]"](1))},3),z(c,"$_reduce_33",function(T,Z,x){return T["$[]"](1)},3),z(c,"$_reduce_34",function(T,Z,x){return g(g(n("Arithmetic"),"Node"),"Number").$new(T["$[]"](0))},3),z(c,"$_reduce_none",function(T,Z,x){return T["$[]"](0)},3)},Opal.modules["bcdice/deprecated/checker"]=function(r){var P,F,Q,U,A,o,B,z,M=[],t=r.nil,v=r.module,e=r.send,g=r.eqeqeq,S=r.truthy,I=r.def;return P=M,F=z=[v(M[0],"BCDice")].concat(P),Q=B=[v(z[0],"Deprecated")].concat(F),A=[U=v(B[0],"Checker")].concat(Q),o=r.$r(A),U.$private(),I(U,"$check_result_legacy",function(D,N,L,b){var d,m=this,y=t,p=t,l=t,s=t;return y=e(N,"map",[],"sides".$to_proc()),d=(p=e(N,"map",[],"value".$to_proc())).$sum(),l=g([100],s=y)?m.$check_1D100(D,d,L,b):g([20],s)?m.$check_1D20(D,d,L,b):g([6,6],s)?m.$check_2D6(D,d,p,L,b):t,(S(l["$nil?"]())||S(l["$empty?"]()))&&(l=g([10],s=y.$uniq())?m.$check_nD10(D,d,p,L,b):g([6],s)?m.$check_nD6(D,d,p,L,b):t,S(l["$nil?"]())||S(l["$empty?"]()))?t:o("Result").$new(l.$delete_prefix(" \uff1e "))},4),I(U,"$check_1D100",function(D,N,L,b){return t},4),I(U,"$check_1D20",function(D,N,L,b){return t},4),I(U,"$check_nD10",function(D,N,L,b,m){return t},5),I(U,"$check_2D6",function(D,N,L,b,m){return t},5),I(U,"$check_nD6",function(D,N,L,b,m){return t},5)},Opal.modules["bcdice/base"]=function(r){var N,p,i,$,f,d,l,s,c,b,M=r.top,t=[],v=r.$r(t),e=r.nil,g=r.$$$,S=r.module,I=r.klass,a=r.truthy,P=r.def,W=r.regexp,z=r.rb_plus,C=r.send,F=r.to_a,j=r.rb_minus,B=r.eqeqeq,G=r.eqeq,Q=r.range,U=r.rb_divide,A=r.rb_times,o=r.rb_ge,u=e;return M.$require("i18n"),M.$require("i18n/backend/fallbacks"),M.$require("bcdice/randomizer"),M.$require("bcdice/dice_table"),M.$require("bcdice/enum"),M.$require("bcdice/translate"),M.$require("bcdice/result"),M.$require("bcdice/command/parser"),M.$require("bcdice/deprecated/checker"),N=t,p=b=[S(t[0],"BCDice")].concat(N),l=[d=I(b[0],null,"Base")].concat(p),s=r.$r(l),(c=d.$$prototype).sort_add_dice=c.sort_barabara_dice=c.enabled_d9=c.raw_input=c.randomizer=c.enabled_upcase_input=c.debug=e,$=[i=r.get_singleton_class(d)].concat(l),f=r.$r($),i.$attr_reader("prefixes"),P(i,"$register_prefix",function(h){var q,H=this,_=e;return null==H.prefixes&&(H.prefixes=e),q=r.slice.call(arguments),H.prefixes=a(_=H.prefixes)?_:[],H.prefixes.$concat(q.$flatten())},-1),P(i,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())},0),P(i,"$prefixes_pattern",function(){var h=this,R=e;return null==h.prefixes_pattern&&(h.prefixes_pattern=e),null==h.prefixes&&(h.prefixes=e),h.prefixes_pattern=a(R=h.prefixes_pattern)?R:e,a(h.prefixes_pattern)?h.prefixes_pattern:(h.prefixes=a(R=h.prefixes)?R:[],h.prefixes.$freeze(),h.prefixes_pattern=(a(h.prefixes["$empty?"]())?/(?!)/:W(["^(S)?(",h.prefixes.$join("|"),")"],"i")).$freeze())},0),P(i,"$command_pattern",function(){var h=this,R=e,q=e;return null==h.command_pattern&&(h.command_pattern=e),null==h.prefixes&&(h.prefixes=e),h.command_pattern=a(R=h.command_pattern)?R:e,a(h.command_pattern)?h.command_pattern:(h.prefixes=a(R=h.prefixes)?R:[],h.prefixes.$freeze(),q=z(C(g(f("CommonCommand"),"COMMANDS"),"map",[],function(_){return null==_&&(_=e),g(_,"PREFIX_PATTERN").$source()},1),h.prefixes),h.command_pattern=W(["^S?(",q.$join("|"),")"],"i").$freeze())},0),P(i,"$eval",function(h){return this.$new(h).$eval()},1),d.$include(s("Translate")),d.$include(g(s("Deprecated"),"Checker")),P(d,"$initialize",function(n){var $=this;return $.raw_input=n,$.sort_add_dice=!1,$.sort_barabara_dice=!1,$.d66_sort_type=g(s("D66SortType"),"NO_SORT"),$.enabled_d9=!1,$.round_type=g(s("RoundType"),"FLOOR"),$.sides_implicit_d=6,$.upper_dice_reroll_threshold=e,$.reroll_dice_reroll_threshold=e,$.default_cmp_op=e,$.default_target_number=e,$.enabled_upcase_input=!0,$.locale="ja_jp",$.randomizer=g(s("BCDice"),"Randomizer").$new(),$.debug=!1},1),d.$attr_accessor("randomizer"),d.$attr_reader("d66_sort_type"),d.$attr_reader("round_type"),d.$attr_reader("sides_implicit_d"),d.$attr_reader("upper_dice_reroll_threshold"),d.$attr_reader("reroll_dice_reroll_threshold"),d.$attr_reader("default_cmp_op"),d.$attr_reader("default_target_number"),P(d,"$sort_add_dice?",function(){return this.sort_add_dice},0),P(d,"$sort_barabara_dice?",function(){return this.sort_barabara_dice},0),P(d,"$enabled_d9?",function(){return this.enabled_d9},0),P(d,"$enable_debug",function(){return this.debug=!0},0),P(d,"$eval",function(){var $,f,E,n=this,h=e;return $=g(s("BCDice"),"Preprocessor").$process(n.raw_input,n),f=a(E=n.$dice_command($))?E:n.$eval_common_command(n.raw_input),a(f)?(h=[n.randomizer.$rand_results()],C(f,"rands=",F(h)),j(h.length,1),h=[n.randomizer.$detailed_rand_results()],C(f,"detailed_rands=",F(h)),j(h.length,1),f):e},0),P(d,"$change_text",function(n){return n},1),P(d,"$check_result",function(n,$,f,E){var h=this,R=e,q=e,H=e,_=e,K=e;return R=h.$check_result_legacy(n,$,f,E),a(R)?R:(q=C($,"map",[],"sides".$to_proc()),_=(H=C($,"map",[],"value".$to_proc())).$sum(),R=B([100],K=q)?h.$result_1d100(n,_,f,E):B([20],K)?h.$result_1d20(n,_,f,E):B([6,6],K)?h.$result_2d6(n,_,H,f,E):e,G(R,s("Result").$nothing())?e:a(R)?R:(R=B([10],K=q.$uniq())?h.$result_nd10(n,_,H,f,E):B([6],K)?h.$result_nd6(n,_,H,f,E):e,G(R,s("Result").$nothing())?e:a(R)?R:h.$result_ndx(n,f,E)))},4),P(d,"$grich_text",function(n,$,f){return e},3),d.$private(),P(d,"$eval_common_command",function(n){try{return n=this.$change_text(n),C(g(s("CommonCommand"),"COMMANDS"),"each",[],function f(E){var R,h=null==f.$$s?this:f.$$s;if(null==h.randomizer&&(h.randomizer=e),null==E&&(E=e),R=E.$eval(n,h,h.randomizer),!a(R))return e;r.ret(R)},{$$arity:1,$$s:this}),e}catch(f){if(f===r.returner)return f.$v;throw f}},1),P(d,"$dice_command",function(n){var $=this,f=e,E=e,h=e,R=e,q=e;return a($.enabled_upcase_input)&&(n=n.$upcase()),f=$.$class().$prefixes_pattern().$match(n),a(f)?(E=f["$[]"](1)["$nil?"]()["$!"](),a(E)&&(n=n["$[]"](Q(1,-1,!1))),h=$.$eval_game_system_specific_command(n),a(h["$is_a?"](s("Result")))?(R=[a(q=h["$secret?"]())?q:E],C(h,"secret=",F(R)),j(R.length,1),h):a(h["$nil?"]())||a(h["$empty?"]())||G(h,"1")?e:C(s("Result").$new(),"tap",[],function(_){return null==_&&(_=e),R=[h.$to_s()],C(_,"text=",F(R)),j(R.length,1),C(_,"secret=",F(R=[E])),R[j(R.length,1)]},1)):e},1),P(d,"$eval_game_system_specific_command",function(n){return e},1),P(d,"$result_ndx",function(n,$,f){return a(f["$is_a?"](s("String")))?e:a(n.$send($,f))?s("Result").$success(this.$translate("success")):s("Result").$failure(this.$translate("failure"))},3),P(d,"$result_1d100",function(n,$,f,E){return e},4),P(d,"$result_1d20",function(n,$,f,E){return e},4),P(d,"$result_nd10",function(n,$,f,E,h){return e},5),P(d,"$result_2d6",function(n,$,f,E,h){return e},5),P(d,"$result_nd6",function(n,$,f,E,h){return e},5),P(d,"$get_table_by_2d6",function(n){return this.$get_table_by_nD6(n,2)},1),P(d,"$get_table_by_1d6",function(n){return this.$get_table_by_nD6(n,1)},1),P(d,"$get_table_by_nD6",function(n,$){return this.$get_table_by_nDx(n,$,6)},2),P(d,"$get_table_by_nDx",function(n,$,f){var h,R=e;return h=this.randomizer.$roll_sum($,f),R=this.$get_table_value(n["$[]"](j(h,$))),a(R["$nil?"]())?["1",0]:[R,h]},3),P(d,"$get_table_by_1d3",function(n){var E,h,$=this,R=e;return $.$debug("get_table_by_1d3"),E=$.randomizer.$roll_sum(1,6),$.$debug("num",E),h=U(j(E,1),2).$to_i(),$.$debug("index",h),R=n["$[]"](h),a(R["$nil?"]())?["1",0]:[R,E]},1),P(d,"$get_table_by_d66_swap",function(n){var f;return f=this.randomizer.$roll_d66(g(s("D66SortType"),"ASC")),[this.$get_table_by_number(f,n),f]},1),P(d,"$get_table_by_d66",function(n){var f,E,h,q,R=e;return f=this.randomizer.$roll_once(6),E=this.randomizer.$roll_once(6),h=z(A(j(f,1),6),j(E,1)),R=n["$[]"](h),q=""+f+E,a(R["$nil?"]())?["1",q]:[R,q]},1),P(d,"$get_table_by_number",function(n,$,f){try{return null==f&&(f="1"),C($,"each",[],function h(R){var H,q=null==h.$$s?this:h.$$s;if(null==R&&(R=e),H=R["$[]"](0),!a(o(H,n)))return e;r.ret(q.$get_table_value(R["$[]"](1)))},{$$arity:1,$$s:this}),this.$get_table_value(f)}catch(h){if(h===r.returner)return h.$v;throw h}},-3),P(d,"$get_table_value",function(n){return a(n["$is_a?"](s("Proc")))?n.$call():n},1),P(d,"$roll_tables",function(n,$){var E=e;return E=$["$[]"](n),a(E)?E.$roll(this.randomizer).$to_s():e},2),P(d,"$debug",function(n,$){var E,h=this,R=e,q=e;return E=r.slice.call(arguments,1),a(h.debug)?(R=a(n["$is_a?"](s("String")))?n:n.$inspect(),a(E["$empty?"]())?h.$warn(R):(q=C(E,"map",[],function(_){return null==_&&(_=e),a(_["$is_a?"](s("String")))?'"'+_+'"':_.$inspect()},1),h.$warn(R+": "+q.$join(", ")))):e},-2),g(g(v("I18n"),"Backend"),"Simple").$include(g(g(v("I18n"),"Backend"),"Fallbacks")),v("I18n").$load_path()["$<<"](v("Dir")["$[]"](v("File").$join("bcdice","../../i18n/**/*.yml"))),u=["ja_jp"],C(v("I18n"),"default_locale=",F(u)),j(u.length,1),u=[["ja_jp"]],C(v("I18n").$fallbacks(),"defaults=",F(u)),u[j(u.length,1)]},Opal.queue(function(r){var N,y,i,n,$,f,d,l,b,t=[],v=r.nil,e=r.$$$,g=r.module,S=r.klass,I=r.const_set,a=r.hash2,P=r.send2,W=r.find_super,z=r.def,C=r.truthy,F=r.to_ary,j=r.rb_plus,B=r.range,G=r.neqeq,Q=r.eqeq,U=r.rb_ge,A=r.send,o=r.to_a,u=r.rb_minus;return r.top.$require("bcdice/base"),N=t,y=b=[g(t[0],"BCDice")].concat(N),d=[g(b[0],"GameSystem")].concat(y),l=r.$r(d),i=d,$=[n=S(d[0],l("Base"),"DesperateRun")].concat(i),f=r.$r($),n.$$prototype.randomizer=v,I($[0],"ID","DesperateRun"),I($[0],"NAME","Desperate Run TRPG"),I($[0],"SORT_KEY","\u3066\u3059\u3078\u308c\u3044\u3068\u3089\u3093TRPG"),I($[0],"HELP_MESSAGE","\u30fb\u96e3\u6613\u5ea6\u7b97\u51fa\u30b3\u30de\u30f3\u30c9\u3000DDC\n\u30fb\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\u3000RCx\u3000or\u3000RCx+y\u3000or\u3000RCx-y\uff08x\uff1d\u96e3\u6613\u5ea6\u3001y=\u4fee\u6b63\u5024\uff08\u7701\u7565\u53ef\u80fd\uff09\uff09\n\u30fb\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u8868\u3000ACT\n\u30fb\u521d\u671f\u30a2\u30a4\u30c6\u30e0\u8868\u3000ITEMT\n\u30fb\u52d5\u6a5f\u8868\u3000DOUKIT\n\u30fb\u6b7b\u4ea1\u30d5\u30e9\u30b0\u53f0\u8a5e\u8868\u3000FLAGT\n\u30fb\u9014\u4e2d\u53c2\u52a0\u52d5\u6a5f\u8868\u3000ENTRYT\n\u30fb\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868\u3000ROADT\n"),I($[0],"TABLES",a(["ACT","ITEMT","DOUKIT","FLAGT","ENTRYT","ROADT"],{ACT:e(f("DiceTable"),"Table").$new("\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u8868","1D6",["PC\u5168\u54e1\u3001\u968a\u5217\u30921D6\u3067\u6c7a\u3081\u308b\uff0812\uff1a\u524d\u5217\u300134\uff1a\u4e2d\u5217\u300156\uff1a\u5f8c\u5217\uff09","1\u30bf\u30fc\u30f3\u3001\u30e2\u30f3\u30b9\u30bf\u30fc\u5074\u306e\u307f\u884c\u52d5\u3059\u308b\u3002","\u3053\u306e\u6226\u95d8\u306e\u884c\u52d5\u9806\u304c\u3001PC\u2192\u30e2\u30f3\u30b9\u30bf\u30fc\u3001\u304b\u3089\u3001\u30e2\u30f3\u30b9\u30bf\u30fc\u2192PC\u306b\u5909\u308f\u308b\u3002","PC\u5168\u54e1\u3001\u30a2\u30a4\u30c6\u30e01\u3064\u3092\u9078\u3093\u3067\u5931\u3046\u3002","PC\u5168\u54e11D6\u3092\u632f\u308b\u3002\u3053\u306e\u6226\u95d8\u4e2d\u3001\u305d\u306e\u51fa\u76ee\u306f\u30ce\u30fc\u30d7\u30e9\u30f3\u306b\u306a\u308b\u3002","PC\u5168\u54e1\u3001Flag\u304c1\u5897\u52a0\u3059\u308b\u3002"]),ITEMT:e(f("DiceTable"),"Table").$new("\u521d\u671f\u30a2\u30a4\u30c6\u30e0\u8868","2D6",["\u30ed\u30b1\u30c3\u30c8\u30e9\u30f3\u30c1\u30e3\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30de\u30ab\u30d6\u30ebLv+3\u3000\u56de\u6570\uff1a\u653b\u64831\u56de","\u30ad\u30fc\u30d4\u30c3\u30af\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30e0\u30fc\u30d6\u30b7\u30fc\u30f3\u3067\u4f7f\u7528\u53ef\u3002\u5224\u5b9a\u306e\u51fa\u76ee\u306e\u5408\u8a08+1\u3000\u56de\u6570\uff1a2\u56de","\u30ec\u30fc\u30c0\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30ce\u30fc\u30d7\u30e9\u30f3\u3000\u88c5\u5099\u6642\u3001\u300c\u5371\u967a\u300d\u30921\u6e1b\u3089\u3059\u3053\u3068\u304c\u51fa\u6765\u308b\u3000\u56de\u6570\uff1a\u5371\u967a\u6e1b\u5c112\u56de","\u98df\u6599\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30e0\u30fc\u30d6\u30b7\u30fc\u30f3\u3067\u4f7f\u7528\u53ef\u3002Life3\u56de\u5fa9\u3000\u56de\u6570\uff1a1\u56de","\u5fdc\u6025\u30ad\u30c3\u30c8\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30e1\u30c7\u30a3\u30ab\u30ebLv+1\u3000\u56de\u6570\uff1a\u56de\u5fa93\u56de","\u5203\u7269\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30a2\u30bf\u30c3\u30afLv+1\u3000\u56de\u6570\uff1a\u653b\u64836\u56de","\u9283\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30b7\u30e5\u30fc\u30c8Lv+1\u3000\u56de\u6570\uff1a\u653b\u64836\u56de","\u30c9\u30e9\u30c3\u30b0\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u3044\u3064\u3067\u3082\u4f7f\u7528\u53ef\u3002Brave1\u56de\u5fa9\u3000\u56de\u6570\uff1a1\u56de","\u91d1\u5238\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30a2\u30d5\u30bf\u30fc\u30d7\u30ec\u30a4\u3067\u4f7f\u7528\u53ef\u3002\u7d4c\u9a13\u70b9+2\u3000\u56de\u6570\uff1a1\u56de","\u30d7\u30ed\u30c6\u30af\u30bf\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30ac\u30fc\u30c9Lv+1\u3000\u56de\u6570\uff1a\u9632\u5fa15\u56de","\u30c8\u30df\u30fc\u30ac\u30f3\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30c1\u30a7\u30fc\u30f3Lv+5\u3000\u56de\u6570\uff1a\u653b\u64831\u56de"]),DOUKIT:e(f("DiceTable"),"Table").$new("\u52d5\u6a5f\u8868","1D6",["\u96b7\u5c5e\u3002\u4f55\u304b\u5f31\u307f\u306b\u4ed8\u3051\u8fbc\u307e\u308c\u3001\u5acc\u3005\u306a\u304c\u3089\u3082\u53c2\u52a0\u3059\u308b\u3053\u3068\u3068\u306a\u308b\u3002\u5f8c\u308d\u3081\u305f\u3044\u4e8b\u3001\u501f\u91d1\u3001\u306a\u3069\u3002","\u732e\u8eab\u3002\u3053\u306e\u756a\u7d44\u306f\u8ab0\u304b\u306e\u305f\u3081\u306b\u51fa\u3066\u3044\u308b\u3002\u75c5\u6c17\u306e\u5bb6\u65cf\u3092\u6551\u3046\u305f\u3081\u3001\u53c2\u52a0\u8005\u306e\u4e00\u4eba\u304c\u604b\u4eba\u3067\u3042\u308b\u3001\u306a\u3069\u3002","\u6210\u884c\u3002\u671b\u3093\u3067\u3044\u306a\u3044\u306e\u306b\u53c2\u52a0\u3059\u308b\u3053\u3068\u3068\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u3002\u8ab0\u304b\u304c\u52dd\u624b\u306b\u7533\u3057\u8fbc\u3093\u3060\u3001\u7d1b\u308c\u8fbc\u3093\u3067\u3057\u307e\u3063\u305f\u3001\u306a\u3069\u3002","\u6e07\u671b\u3002\u3068\u306b\u304b\u304f\u4f55\u304b\u3092\u6b32\u3057\u3066\u53c2\u52a0\u3057\u3066\u3044\u308b\u3002\u91d1\u3001\u30b9\u30ea\u30eb\u3001\u91d1\u3067\u624b\u306b\u5165\u308b\u3082\u306e\u3001\u306a\u3069\u3002","\u5947\u4eba\u3002\u597d\u304d\u597d\u3093\u3067\u3053\u306e\u756a\u7d44\u306b\u51fa\u3066\u3044\u308b\u3002\u6bba\u4eba\u7656\u3001\u30ca\u30eb\u30b7\u30b9\u30c8\u3001\u81ea\u6bba\u9858\u671b\u3001\u5316\u3051\u7269\u30de\u30cb\u30a2\u3001\u306a\u3069\u3002","\u4ed5\u4e8b\u3002\u3053\u306e\u756a\u7d44\u306b\u51fa\u308b\u306e\u306f\u4ed5\u4e8b\u3060\u304b\u3089\u3060\u3002\u8cde\u91d1\u7a3c\u304e\u3001\u82b8\u80fd\u4eba\u3001\u8a18\u8005\u3001\u756a\u7d44\u30b9\u30bf\u30c3\u30d5\u3001\u306a\u3069\u3002"]),FLAGT:e(f("DiceTable"),"Table").$new("\u6b7b\u4ea1\u30d5\u30e9\u30b0\u53f0\u8a5e\u8868","1D6",["\u5e0c\u671b\u3002\u300c\u3053\u308c\u304c\u7d42\u308f\u3063\u305f\u3089\u3001\u4e00\u7dd2\u306b\u9152\u3067\u3082\u98f2\u3082\u3046\u3084\u300d\u300c\u3082\u3046\u4f55\u3082\u6016\u304f\u306a\u3044\u300d\u306a\u3069\u3002","\u671b\u90f7\u3002\u300c\u304f\u305d\u3063\u3001\u3001\u3001\u4ffa\u306b\u306f\u3001\u5e30\u308a\u3092\u5f85\u3064\u4eba\u304c\u3001\u3001\u3001\u3063\uff01\u300d\u300c\u3042\u3042\u3001\u6545\u90f7\u306e\u30de\u30eb\u30b2\u30ea\u30fc\u30bf\u3092\u3082\u3046\u4e00\u5ea6\u98df\u3079\u305f\u304b\u3063\u305f\u3001\u3001\u3001\u300d\u306a\u3069\u3002","\u72c2\u4e71\u3002\u300c\u304a\u524d\u3092\u3001\u6bba\u305b\u3070\u3001\u4ffa\u306f\u3001\u5104\u4e07\u9577\u8005\u306a\u3093\u3060\u3088\u3049\u3049\u3049\u304a\uff01\uff01\u300d\u300c\u30d2\u30cf\u30c3\u3001\u6b7b\u306d\u6b7b\u306d\u6b7b\u306d\u6b7b\u306d\u3047\u3047\u3047\u3047\u300d\u306a\u3069\u3002","\u7d76\u671b\u3002\u300c\u3082\u3046\u3060\u3081\u3060\u3041\u3001\u3001\u3001\u304a\u3057\u307e\u3044\u3060\u3041\u3001\u3001\u3001\u300d\u300c\u304f\u3001\u304f\u308b\u306a\u3063\u3001\u304f\u308b\u306a\u3041\u3041\u3041\u3041\uff01\uff01\u300d\u306a\u3069\u3002","\u6162\u5fc3\u3002\u300c\u306a\u3093\u3060\u3001\u3053\u3093\u306a\u3084\u3064\u3001\u4ffa\u3060\u3051\u3067\u5341\u5206\u3060\u300d\u300c\u5927\u4e08\u592b\u3060\u3001\u554f\u984c\u306a\u3044\u300d\u306a\u3069\u3002","\u72a0\u7272\u3002\u300c\u3075\u3075\u3001\u4ffa\u306a\u3089\u5927\u4e08\u592b\u3060\u3001\u3001\u3001\u6c17\u306b\u3059\u308b\u306a\u300d\u300c\u304a\u524d\u3089\u4e0b\u304c\u308c\u3063\uff01\u3053\u3053\u306f\u4ffa\u306b\u4efb\u305b\u308d\uff01\u300d\u306a\u3069\u3002"]),ENTRYT:e(f("DiceTable"),"Table").$new("\u9014\u4e2d\u53c2\u52a0\u52d5\u6a5f\u8868","1D6",["\u9045\u523b\u3002\u3082\u3068\u3082\u3068\u53c2\u52a0\u3059\u308b\u4e88\u5b9a\u3060\u3063\u305f\u306e\u3060\u304c\u9045\u308c\u3066\u3057\u307e\u3063\u305f\u3002\u4eca\u304b\u3089\u3067\u3082\u8d70\u308c\u3068\u7121\u7406\u77e2\u7406\u53c2\u52a0\u3002","\u73fe\u4f4f\u3002\u3082\u3068\u3082\u3068\u3053\u3053\u306b\u4f4f\u3093\u3067\u3044\u305f\u3002\u4f55\uff1f\u756a\u7d44\uff1f\u3048\uff1f\u3042\u3001\u304a\u91d1\u3082\u3089\u3048\u3093\u306e\uff1f\u30a4\u30a4\u30cd\uff01","\u7a81\u767a\u3002\u3082\u3068\u3082\u3068\u8996\u8074\u8005\u3068\u3057\u3066\u30b9\u30bf\u30b8\u30aa\u306b\u5c45\u305f\u3093\u3060\u3051\u3069\u3001\u53f8\u4f1a\u306b\u3046\u307e\u304f\u4e57\u305b\u3089\u308c\u3066\u30fb\u30fb\u30fb","\u4e71\u5165\u3002\u4f55\u304b\u76ee\u7684\u304c\u3042\u3063\u3066\u4e71\u5165\u3057\u305f\u3002\u4eca\u56de\u306e\u30b9\u30c6\u30fc\u30b8\u304c\u7c21\u5358\u306b\u898b\u3048\u305f\u308a\u3001\u53c2\u52a0\u8005\u306b\u5927\u4e8b\u306a\u4eba\u304c\u3044\u305f\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002","\u795e\u96a0\u3002\u4eca\u56de\u3088\u308a\u524d\u306e\u756a\u7d44\u306b\u53c2\u52a0\u3057\u3066\u3044\u305f\u304c\u884c\u65b9\u4e0d\u660e\u30fb\u6b7b\u3093\u3060\u3068\u601d\u308f\u308c\u3066\u3044\u305f\u3002\u304c\u3002\u541b\u306f\u307e\u3060\u3053\u3053\u306b\u3044\u308b\u3002","\u8077\u54e1\u3002\u3042\u308c\u3001\u9003\u3052\u9045\u308c\u307e\u3057\u305f\uff1f\u3042\u3089\u3042\u3089\u3001\u5927\u5909\u3067\u3059\u306d\u3001\u3057\u3087\u3046\u304c\u306a\u3044\u304b\u3089\u53c2\u52a0\u8005\u3055\u3093\u3068\u4e00\u7dd2\u306b\u8d70\u3063\u3066\u304f\u3060\u3055\u3044\u3002"]),ROADT:e(f("DiceTable"),"Table").$new("\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868","1D6",["\u6b7b\u7dda\u3002\u6b7b\u306c\u304b\u3068\u601d\u3063\u305f\u3002Flag+1","\u602a\u6211\u3002\u75db\u3044\u3002Life-1","\u5931\u610f\u3002\u3069\u3046\u3057\u3066\u3053\u3046\u306a\u3063\u305f\u3002Brave-1\u3002\u6e1b\u3089\u305b\u306a\u3044\u5834\u5408\u3001Flag+1","\u7d1b\u5931\u3002\u3069\u3063\u304b\u3044\u3063\u305f\u3002Item\u3092\u3069\u308c\u304b1\u3064\u6368\u3066\u308b\u3002\u6368\u3066\u308c\u306a\u3044\u5834\u5408\u3001Flag+1","\u8ffd\u5c3e\u3002\u5f8c\u308d\uff01\u5f8c\u308d\u30fc\u3063\uff01\u53c2\u52a0\u958b\u59cb\u90e8\u5c4b\u306e\u5371\u967a+1","\u8ff7\u5b50\u3002\u3042\u308c\u3001\u3053\u3053\u3069\u3053\u3060\uff1f\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868\u3092\u632f\u308b\u56de\u6570+2"])}).$freeze()),n.$register_prefix("RC","DDC",f("TABLES").$keys()),z(n,"$initialize",function h(R){var H=this;return delete h.$$p,P(H,W(H,"initialize",h,!1,!0),"initialize",[R],null),H.sort_add_dice=!0,H.d66_sort_type=e(f("D66SortType"),"ASC")},1),n.$private(),z(n,"$eval_game_system_specific_command",function(R){var H,_,q=this;return C(H=C(_=q.$check_roll(R))?_:q.$ddc_table(R))?H:q.$roll_tables(R,e(q.$class(),"TABLES"))},1),z(n,"$check_roll",function(R){var q,H,k=v,J=v,ie=v,te=v,ce=v,ne=v,V=v,T=v,x=v;return k=e(f("Command"),"Parser").$new(/RC\d+/,a(["round_type"],{round_type:this.$round_type()})).$restrict_cmp_op_to(v).$parse(R),C(k)?(H=this.randomizer.$roll_barabara(2,6),q=F(H),te=j(J=null==q[0]?v:q[0],ie=null==q[1]?v:q[1]),ce=j(j(J,ie),k.$modify_number()),ne=k.$command()["$[]"](B(2,-1,!1)).$to_i(),G(k.$modify_number(),0)&&(V="\u3000\u4fee\u6b63\u5024\uff1a"+k.$modify_number()),x=[["\u5224\u5b9a\u3000\u96e3\u6613\u5ea6\uff1a"+ne+V,"\u51fa\u76ee\uff1a"+J+"\u3001"+ie,(T=Q(J,ie)?f("Result").$critical("\u30be\u30ed\u76ee\uff01\u3010Critical\u3011"):Q(te,7)?f("Result").$fumble("\u30c0\u30a4\u30b9\u306e\u51fa\u76ee\u304c\u8868\u88cf\uff01\u3010Fumble\u3011"):C(U(ce,ne))?f("Result").$success(ce+"\u3001\u96e3\u6613\u5ea6\u4ee5\u4e0a\uff01\u3010Success\u3011"):f("Result").$failure(ce+"\u3001\u96e3\u6613\u5ea6\u672a\u6e80\uff01\u3010Miss\u3011")).$text()].$join(" \uff1e ")],A(T,"text=",o(x)),u(x.length,1),T):v},1),z(n,"$ddc_table",function(R){var q,H,K=v,k=v,J=v,ie=v,te=v;return G(R,"DDC")?v:(H=this.randomizer.$roll_barabara(2,6),H=[K=null==(q=F(H))[0]?v:q[0],k=null==q[1]?v:q[1]].$sort(),"\u96e3\u6613\u5ea6\u6c7a\u5b9a \uff1e \u51fa\u76ee\uff1a"+K+"\u3001"+k+" \uff1e "+(ie=null==(q=F(H))[1]?v:q[1])+"-"+(J=null==q[0]?v:q[0])+"="+(te=u(ie,J))+" \uff1e \u96e3\u6613\u5ea6"+j(5,te))},1)})}}]);