(self.webpackChunkudonarium_lily=self.webpackChunkudonarium_lily||[]).push([[7400],{7400:function(V,X,U){var e,h,g,j,w,_,R,S,a,l,t,E,d,F;U(4656),Opal.modules["bcdice/normalize"]=function(e){var a,x,S,p,F,h,l=[],W=e.nil,E=e.module;return F=l,a=h=[E(l[0],"BCDice")].concat(F),[p=E(h[0],"Normalize")].concat(a),p.$module_function(),e.def(p,"$comparison_operator",x=function(N){var _;return/<=|=</["$==="](_=N)?"<=":/>=|=>/["$==="](_)?">=":/<>|!=|=!/["$==="](_)?"!=":/</["$==="](_)?"<":/>/["$==="](_)?">":/=/["$==="](_)?"==":W},x.$$arity=1),void e.def(p,"$target_number",S=function(N){return N["$=="]("?")?N:N.$to_i()},S.$$arity=1)},Opal.modules["bcdice/format"]=function(e){var h,g,P,N,x,S,a,W=[],M=e.nil,E=e.$$,d=e.module,F=e.truthy;return h=W,g=a=[d(W[0],"BCDice")].concat(h),x=d(a[0],"Format"),S=[x].concat(g),x.$module_function(),e.def(x,"$comparison_operator",P=function(_){var w;return"=="["$==="](w=_)?"=":"!="["$==="](w)?"<>":E(S,"Symbol")["$==="](w)?_.$to_s():M},P.$$arity=1),void e.def(x,"$modifier",N=function(_){return F(_["$nil?"]())?M:_["$=="](0)?"":F("number"==typeof(v=_)?v>0:v["$>"](0))?"+"+_:_.$to_s();var v},N.$$arity=1)},Opal.modules["bcdice/game_system/NightWizard"]=function(e){function y(p,g){return"number"==typeof p&&"number"==typeof g?p+g:p["$+"](g)}function l(p,g){return"number"==typeof p&&"number"==typeof g?p-g:p["$-"](g)}var g,N,R,w,G,C,D,T,H,I,K,L,Y,z,u,$,o,i,n,r,s,b,c,_,S,W=e.top,M=[],t=e.nil,d=e.$$,F=e.module,v=e.klass,h=e.send2,m=e.truthy,a=e.send;return W.$require("bcdice/normalize"),W.$require("bcdice/format"),g=M,N=S=[F(M[0],"BCDice")].concat(g),R=(_=[F(S[0],"GameSystem")].concat(N))[0],w=d(_,"Base"),G=_,b=v(R,w,"NightWizard"),c=[b].concat(G),b.$$prototype.nw_command=b.$$prototype.randomizer=b.$$prototype.total=b.$$prototype.interim_expr=b.$$prototype.status=b.$$prototype.fumble_numbers=b.$$prototype.critical_numbers=t,e.const_set(c[0],"ID","NightWizard"),e.const_set(c[0],"NAME","\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 2nd Edition"),e.const_set(c[0],"SORT_KEY","\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30682"),e.const_set(c[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\u7528\u30b3\u30de\u30f3\u30c9\u3000(aNW+b@x#y$z+c)\n\u3000\u3000a : \u57fa\u672c\u5024\n\u3000\u3000b : \u5e38\u6642\u306b\u6e96\u3058\u308b\u7279\u6280\u306b\u3088\u308b\u88dc\u6b63\n\u3000\u3000c : \u5e38\u6642\u4ee5\u5916\u306e\u7279\u6280\u3001\u304a\u3088\u3073\u652f\u63f4\u52b9\u679c\u306b\u3088\u308b\u88dc\u6b63\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u3000x : \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 10\uff09\n\u3000\u3000y : \u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 5\uff09\n\u3000\u3000z : \u30d7\u30e9\u30fc\u30ca\u306b\u3088\u308b\u9054\u6210\u5024\u88dc\u6b63\u306e\u30d7\u30e9\u30fc\u30ca\u6d88\u8cbb\u6570\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u304c\u7121\u3044\u5834\u5408\u306f1\u308413\u306a\u3069\u306e\u3042\u308a\u5f97\u306a\u3044\u6570\u5024\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u4f8b\uff0912NW-5@7#2$3 1NW 50nw+5@7,10#2,5 50nw-5+10@7,10#2,5+15+25\n"),b.$register_prefix("([-+]?\\d+)?NW","2R6"),e.def(b,"$initialize",C=function(u){var s=this;return C.$$p&&(C.$$p=null),h(s,e.find_super_dispatcher(s,"initialize",C,!1,!0),"initialize",[u],null),s.nw_command="NW"},C.$$arity=1),e.def(b,"$eval_game_system_specific_command",D=function(u){var $,r,i,s=this,o=t,n=t,k=t,f=t,A=t;return o=m(i=s.$parse_nw(u))?i:s.$parse_2r6(u),m(o)?(r=s.$roll_nw(o),n=null==($=e.to_ary(r))[0]?t:$[0],k=null==$[1]?t:$[1],f=null==$[2]?t:$[2],A=m(o.$cmp_op())?m(n.$send(o.$cmp_op(),o.$target_number()))?"\u6210\u529f":"\u5931\u6557":t,["("+o+")",k,f,n.$to_s(),A].$compact().$join(" \uff1e ")):t},D.$$arity=1),b.$private(),function(z,u,$){var r=v(z,null,"Parsed");[r].concat($),r.$attr_accessor("critical_numbers"),r.$attr_accessor("fumble_numbers"),r.$attr_accessor("prana"),r.$attr_accessor("active_modify_number"),r.$attr_accessor("cmp_op"),r.$attr_accessor("target_number")}(c[0],0,c),z=c[0],u=d(c,"Parsed"),$=c,r=v(z,u,"ParsedNW"),s=[r].concat($),r.$$prototype.base=r.$$prototype.modify_number=r.$$prototype.active_modify_number=r.$$prototype.prana=r.$$prototype.command=r.$$prototype.critical_numbers=r.$$prototype.fumble_numbers=r.$$prototype.cmp_op=r.$$prototype.target_number=t,r.$attr_accessor("base"),r.$attr_accessor("modify_number"),e.def(r,"$initialize",o=function(f){var q=this;return o.$$p&&(o.$$p=null),h(q,e.find_super_dispatcher(q,"initialize",o,!1,!0),"initialize",[],null),q.command=f},o.$$arity=1),e.def(r,"$passive_modify_number",i=function(){return y(this.base,this.modify_number)},i.$$arity=0),e.def(r,"$to_s",n=function(){var A,B,q,J,Q,f=this;return A=m(f.base["$zero?"]())?t:f.base,B=d(s,"Format").$modifier(f.modify_number),q=d(s,"Format").$modifier(f.active_modify_number),J=m(Q=f.prana)?"$"+f.prana:Q,""+A+f.command+B+"@"+f.critical_numbers.$join(",")+"#"+f.fumble_numbers.$join(",")+J+q+f.cmp_op+f.target_number},n.$$arity=0),function(z,u,$){var o,r=v(z,u,"Parsed2R6");[r].concat($),r.$$prototype.passive_modify_number=r.$$prototype.active_modify_number=r.$$prototype.critical_numbers=r.$$prototype.fumble_numbers=r.$$prototype.cmp_op=r.$$prototype.target_number=t,r.$attr_accessor("passive_modify_number"),e.def(r,"$to_s",o=function(){var n=this;return"2R6M["+n.passive_modify_number+","+n.active_modify_number+"]C["+n.critical_numbers.$join(",")+"]F["+n.fumble_numbers.$join(",")+"]"+n.cmp_op+n.target_number},o.$$arity=0)}(c[0],d(c,"Parsed"),c),e.def(b,"$parse_nw",T=function(u){var $,r,o=t,i=t,n=t;return o=e.regexp(["^([-+]?\\d+)?",this.nw_command,"((?:[-+]\\d+)+)?(?:@(\\d+(?:,\\d+)*))?(?:#(\\d+(?:,\\d+)*))?(?:\\$(\\d+(?:,\\d+)*))?((?:[-+]\\d+)+)?(?:([>=]+)(\\d+))?$"]).$match(u),m(o)?(i=d(c,"ParsedNW").$new(this.nw_command),n=[o["$[]"](1).$to_i()],a(i,"base=",e.to_a(n)),l(n.length,1),n=[d(c,"ArithmeticEvaluator").$eval(o["$[]"](2))],a(i,"modify_number=",e.to_a(n)),l(n.length,1),n=[m(o["$[]"](3))?a(o["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]],a(i,"critical_numbers=",e.to_a(n)),l(n.length,1),n=[m(o["$[]"](4))?a(o["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]],a(i,"fumble_numbers=",e.to_a(n)),l(n.length,1),n=[($=o["$[]"](5),$===t||null==$?t:a($,"to_i",[]))],a(i,"prana=",e.to_a(n)),l(n.length,1),n=[d(c,"ArithmeticEvaluator").$eval(o["$[]"](6))],a(i,"active_modify_number=",e.to_a(n)),l(n.length,1),n=[d(c,"Normalize").$comparison_operator(o["$[]"](7))],a(i,"cmp_op=",e.to_a(n)),l(n.length,1),n=[(r=o["$[]"](8),r===t||null==r?t:a(r,"to_i",[]))],a(i,"target_number=",e.to_a(n)),l(n.length,1),i):t},T.$$arity=1),e.def(b,"$parse_2r6",H=function(u){var $,s=t,o=t,i=t;return s=/^2R6m\[([-+]?\d+(?:[-+]\d+)*)(?:,([-+]?\d+(?:[-+]\d+)*))?\](?:c\[(\d+(?:,\d+)*)\])?(?:f\[(\d+(?:,\d+)*)\])?(?:([>=]+)(\d+))?/i.$match(u),m(s)?(o=d(c,"Parsed2R6").$new(),i=[d(c,"ArithmeticEvaluator").$eval(s["$[]"](1))],a(o,"passive_modify_number=",e.to_a(i)),l(i.length,1),i=[d(c,"ArithmeticEvaluator").$eval(s["$[]"](2))],a(o,"active_modify_number=",e.to_a(i)),l(i.length,1),i=[m(s["$[]"](3))?a(s["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]],a(o,"critical_numbers=",e.to_a(i)),l(i.length,1),i=[m(s["$[]"](4))?a(s["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]],a(o,"fumble_numbers=",e.to_a(i)),l(i.length,1),i=[d(c,"Normalize").$comparison_operator(s["$[]"](5))],a(o,"cmp_op=",e.to_a(i)),l(i.length,1),i=[($=s["$[]"](6),$===t||null==$?t:a($,"to_i",[]))],a(o,"target_number=",e.to_a(i)),l(i.length,1),o):t},H.$$arity=1),e.def(b,"$roll_nw",I=function(u){var o,r=this,s=t,i=t,n=t,k=t,f=t;for(r.critical_numbers=u.$critical_numbers(),r.fumble_numbers=u.$fumble_numbers(),r.total=0,r.interim_expr="",r.status=t,s=r.$roll_once_first();s["$=="]("critical");)s=r.$roll_once();return m(m(o=s["$!="]("fumble"))?u.$prana():o)&&(n=(i=r.randomizer.$roll_barabara(u.$prana(),6)).$sum(),k=i.$join(","),r.total=y(r.total,n),r.interim_expr=y(r.interim_expr,"+"+n+"["+k+"]")),f=s["$=="]("fumble")?r.$fumble_base_number(u):y(u.$passive_modify_number(),u.$active_modify_number()),r.total=y(r.total,f),r.interim_expr=y(f.$to_s(),r.interim_expr),[r.total,r.interim_expr,r.status]},I.$$arity=1),e.def(b,"$roll_once",K=function(u){var s,o,i,$=this,r=t;return null==u&&(u=!1),s=(r=$.randomizer.$roll_barabara(2,6)).$sum(),o=r.$join(","),m(m(i=u)?$.fumble_numbers["$include?"](s):i)?($.total=l($.total,10),$.interim_expr=y($.interim_expr,"-10["+o+"]"),$.status="\u30d5\u30a1\u30f3\u30d6\u30eb","fumble"):m($.critical_numbers["$include?"](s))?($.total=y($.total,10),$.interim_expr=y($.interim_expr,"+10["+o+"]"),$.status="\u30af\u30ea\u30c6\u30a3\u30ab\u30eb","critical"):($.total=y($.total,s),$.interim_expr=y($.interim_expr,"+"+s+"["+o+"]"),t)},K.$$arity=-1),e.def(b,"$roll_once_first",L=function(){return this.$roll_once(!0)},L.$$arity=0),void e.def(b,"$fumble_base_number",Y=function(u){return u.$passive_modify_number()},Y.$$arity=1)},l=[],t=(e=Opal).$$,E=e.module,d=e.klass,F=e.send2,e.top.$require("bcdice/game_system/NightWizard"),h=l,g=a=[E(l[0],"BCDice")].concat(h),j=S=[E(a[0],"GameSystem")].concat(g),R=[_=d(S[0],t(S,"NightWizard"),"SevenFortressMobius")].concat(j),e.const_set(R[0],"ID","SevenFortressMobius"),e.const_set(R[0],"NAME","\u30bb\u30d6\u30f3\uff1d\u30d5\u30a9\u30fc\u30c8\u30ec\u30b9 \u30e1\u30d3\u30a6\u30b9"),e.const_set(R[0],"SORT_KEY","\u305b\u3075\u3093\u3075\u304a\u304a\u3068\u308c\u3059\u3081\u3072\u3046\u3059"),e.const_set(R[0],"HELP_MESSAGE",'\u30fb\u5224\u5b9a\u7528\u30b3\u30de\u30f3\u30c9\u3000(nSFM+m@x#y)\n\u3000"(\u57fa\u672c\u5024)SFM(\u5e38\u6642\u304a\u3088\u3073\u5e38\u6642\u306b\u6e96\u3058\u308b\u7279\u6280\u7b49\u53ca\u3073\u72b6\u614b\u7570\u5e38\uff08\u7701\u7565\u53ef\uff09)@(\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024)#(\u30d5\u30a1\u30f3\u30d6\u30eb\u5024)\uff08\u5e38\u6642\u4ee5\u5916\u306e\u7279\u6280\u7b49\u53ca\u3073\u5473\u65b9\u306e\u652f\u63f4\u52b9\u679c\u7b49\u306e\u5f71\u97ff\uff08\u7701\u7565\u53ef\uff09\uff09"\u3067\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u3000R\u30b3\u30de\u30f3\u30c9(2R6m[n,m]c[x]f[y]>=t t\u306f\u76ee\u6a19\u5024)\u306b\u8aad\u66ff\u3055\u308c\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u304c\u7121\u3044\u5834\u5408\u306f1\u308413\u306a\u3069\u306e\u3042\u308a\u5f97\u306a\u3044\u6570\u5024\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u4f8b\uff0912SFM-5@7#2\u3000\u30001SFM\u3000\u300050SFM+5@7,10#2,5\u300050SFM-5+10@7,10#2,5+15+25\n'),_.$register_prefix("([-+]?\\d+)?SFM","2R6"),e.def(_,"$initialize",w=function(b){var D=this;return w.$$p&&(w.$$p=null),F(D,e.find_super_dispatcher(D,"initialize",w,!1,!0),"initialize",[b],null),D.nw_command="SFM"},w.$$arity=1)}}]);