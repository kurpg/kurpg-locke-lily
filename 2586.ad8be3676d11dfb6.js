(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[2586],{2586:(de,me,fe)=>{fe(9993),Opal.modules["i18n/backend/fallbacks"]=function(r){var W,u,z,N,E,_,U=[],t=r.nil,v=r.$$$,e=r.module,p=r.class_variable_set,w=r.truthy,P=r.class_variable_get,s=r.def,B=r.send,K=r.to_a,C=r.rb_minus,A=r.send2,G=r.find_super,H=r.hash2,F=r.find_block_super,j=r.neqeq;return W=U,_=[E=e(U[0],"I18n")].concat(W),p(_[0],"@@fallbacks",t),u=r.get_singleton_class(E),z=[u].concat(_),N=r.$r(z),s(u,"$fallbacks",function(){var x=t;return p(z[1],"@@fallbacks",w(null!=z[1].$$cvars["@@fallbacks"]?"class variable":t)&&w(x=P(z[1],"@@fallbacks",!1))?x:v(v(N("I18n"),"Locale"),"Fallbacks").$new()),w(x=N("Thread").$current()["$[]"]("i18n_fallbacks"))?x:P(z[1],"@@fallbacks",!1)},0),s(u,"$fallbacks=",function(d){var x;return p(z[1],"@@fallbacks",w(d["$is_a?"](N("Array")))?v(v(N("I18n"),"Locale"),"Fallbacks").$new(d):d),x=["i18n_fallbacks",P(z[1],"@@fallbacks",!1)],B(N("Thread").$current(),"[]=",K(x)),x[C(x.length,1)]},1),function(u,R){var d,x,y,f,N=[e(u,"Backend")].concat(R);return d=N,y=[x=e(N[0],"Fallbacks")].concat(d),f=r.$r(y),s(x,"$translate",function o(a,c,$){try{var n=o.$$p||t,i=this,m=t,L=t;return delete o.$$p,null==$&&($=f("EMPTY_HASH")),w($.$fetch("fallback",!0))?w($["$[]"]("fallback_in_progress"))?A(i,G(i,"translate",o,!1,!0),"translate",[a,c,$],n):(w($["$[]"]("default"))&&(m=i["$extract_non_symbol_default!"]($)),L=$.$merge(H(["fallback_in_progress"],{fallback_in_progress:!0})),B(f("I18n").$fallbacks()["$[]"](a),"each",[],function g(k){var M=null==g.$$s?this:g.$$s;null==k&&(k=t);try{return B(M,"catch",["exception"],function h(){var l=null==h.$$s?this:h.$$s,I=t;if(I=A(l,F(l,"translate",h.$$def||g.$$def||o,!1,!1),"translate",[k,c,L],null),w(I["$nil?"]()))return t;j(a.$to_s(),k.$to_s())&&l.$on_fallback(a,k,c,$),r.ret(I)},{$$arity:0,$$s:M})}catch(h){if(!r.rescue(h,[v(f("I18n"),"InvalidLocale")]))throw h;try{return t}finally{r.pop_exception()}}},{$$arity:1,$$s:i}),w($["$key?"]("default"))&&w($["$[]"]("default")["$nil?"]())?t:w(m)?A(i,G(i,"translate",o,!1,!0),"translate",[a,t,$.$merge(H(["default"],{default:m}))],null):i.$throw("exception",v(f("I18n"),"MissingTranslation").$new(a,c,$))):A(i,G(i,"translate",o,!1,!0),"translate",[a,c,$],n)}catch(g){if(g===r.returner)return g.$v;throw g}},-3),s(x,"$extract_non_symbol_default!",function(a){var $,c=t,n=t;return c=[a["$[]"]("default")].$flatten(),$=B(c,"detect",[],function(m){return null==m&&(m=t),m["$is_a?"](f("Symbol"))["$!"]()},1),w($)&&(n=["default",c["$[]"](0,c.$index($))],B(a,"[]=",K(n)),C(n.length,1)),$},1),s(x,"$exists?",function o(a,c,$){try{var n=o.$$p||t,i=this;return delete o.$$p,null==$&&($=f("EMPTY_HASH")),w($.$fetch("fallback",!0))?(B(f("I18n").$fallbacks()["$[]"](a),"each",[],function m(L){var g=null==m.$$s?this:m.$$s;null==L&&(L=t);try{if(!w(A(g,F(g,"exists?",m.$$def||o,!1,!1),"exists?",[L,c],null)))return t;r.ret(!0)}catch(k){if(!r.rescue(k,[v(f("I18n"),"InvalidLocale")]))throw k;try{return t}finally{r.pop_exception()}}},{$$arity:1,$$s:i}),!1):A(i,G(i,"exists?",o,!1,!0),"exists?",[a,c,$],n)}catch(m){if(m===r.returner)return m.$v;throw m}},-3),x.$private(),s(x,"$on_fallback",function(a,c,$,n){return t},4)}(_[0],_)},Opal.modules["bcdice/randomizer"]=function(r){var E,T,d,x,y,f,u,R,U=[],t=r.nil,v=r.$$$,p=r.klass,w=r.const_set,P=r.def,s=r.truthy,B=r.rb_gt,K=r.rb_plus,C=r.rb_le,A=r.send,G=r.rb_minus,H=r.eqeq,F=r.rb_times,j=r.eqeqeq,Z=r.rb_ge;return E=U,u=[(0,r.module)(U[0],"BCDice")].concat(E),R=r.$r(u),T=u,x=[d=p(u[0],null,"Randomizer")].concat(T),y=r.$r(x),(f=d.$$prototype).rand_results=f.detailed_rand_results=t,w(x[0],"UPPER_LIMIT_DICE_TIMES",200),w(x[0],"UPPER_LIMIT_DICE_SIDES",1e4),w(x[0],"UPPER_LIMIT_RANDS",1e4),P(d,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]},0),d.$attr_reader("rand_results"),d.$attr_reader("detailed_rand_results"),w(x[0],"DetailedRandResult",y("Struct").$new("kind","sides","value")),P(d,"$roll_barabara",function(a,c){var $=this;return s(B(K($.rand_results.$size(),a),y("UPPER_LIMIT_RANDS")))&&$.$raise(y("TooManyRandsError")),s(C(a,0))||s(B(a,y("UPPER_LIMIT_DICE_TIMES")))?[]:A(y("Array"),"new",[a],function n(){return(null==n.$$s?this:n.$$s).$roll_once(c)},{$$arity:0,$$s:$})},2),P(d,"$roll_sum",function(a,c){return this.$roll_barabara(a,c).$sum()},2),P(d,"$roll_once",function(a){var $=t;return s(C(a,0))||s(B(a,y("UPPER_LIMIT_DICE_SIDES")))?0:($=this.$rand_inner(a),this.$push_to_detail("normal",a,$),$)},1),P(d,"$roll_index",function(a){return G(this.$roll_once(a),1)},1),P(d,"$roll_tens_d10",function(){var $,c=t;return c=this.$rand_inner(10),H(c,10)&&(c=0),$=F(c,10),this.$push_to_detail("tens_d10",10,$),$},0),P(d,"$roll_d9",function(){var c;return c=G(this.$rand_inner(10),1),this.$push_to_detail("d9",10,c),c},0),P(d,"$roll_d66",function(a){var n,$=t;return $=A(y("Array"),"new",[2],function i(){return(null==i.$$s?this:i.$$s).$roll_once(6)},{$$arity:0,$$s:this}),j(v(y("D66SortType"),"ASC"),n=a)?$["$sort!"]():j(v(y("D66SortType"),"DESC"),n)&&$["$sort!"]()["$reverse!"](),K(F($["$[]"](0),10),$["$[]"](1))},1),d.$private(),P(d,"$rand_inner",function(a){var $,c=this;return s(Z(c.rand_results.$size(),y("UPPER_LIMIT_RANDS")))&&c.$raise(y("TooManyRandsError")),$=c.$random(a),c.rand_results["$<<"]([$,a]),$},1),P(d,"$random",function(a){return K(y("Kernel").$rand(a),1)},1),P(d,"$push_to_detail",function(a,c,$){var i;return i=y("DetailedRandResult").$new(a,c,$),this.detailed_rand_results.$push(i)},3),p(u[0],R("StandardError"),"TooManyRandsError"),t},Opal.modules["bcdice/dice_table/roll_result"]=function(r){var s,A,Z,W,E,_,u,H,K,U=[],t=r.nil,v=r.module,e=r.klass,p=r.def,w=r.truthy;return s=U,A=K=[v(U[0],"BCDice")].concat(s),Z=H=[v(K[0],"DiceTable")].concat(A),E=[W=e(H[0],null,"RollResult")].concat(Z),_=r.$r(E),(u=W.$$prototype).table_name=u.value=u.body=t,p(W,"$initialize",function(z,N,T){var d=this;return d.table_name=z,d.value=N,d.body=T},3),W.$attr_reader("table_name"),W.$attr_reader("value"),W.$attr_reader("body"),p(W,"$to_s",function(){var z=this;return z.table_name+"("+z.value+") \uff1e "+z.body},0),p(W,"$last_body",function(){var z=this;return w(z.body["$is_a?"](_("RollResult")))?z.body.$last_body():z.body},0),p(W,"$empty?",function(){return!1},0)},Opal.modules["bcdice/dice_table/chain_table"]=function(r){var B,G,W,E,_,u,R,F,C,U=[],t=r.nil,v=r.module,e=r.klass,p=r.truthy,w=r.def,P=r.rb_minus;return B=U,G=C=[v(U[0],"BCDice")].concat(B),W=F=[v(C[0],"DiceTable")].concat(G),_=[E=e(F[0],null,"ChainTable")].concat(W),u=r.$r(_),(R=E.$$prototype).times=R.sides=R.items=R.name=t,w(E,"$initialize",function(N,T,d){var x=this,y=t;return x.name=N,x.items=d.$freeze(),y=/(\d+)D(\d+)/i.$match(T),p(y)||x.$raise(u("ArgumentError"),"Unexpected table type: "+T),x.times=y["$[]"](1).$to_i(),x.sides=y["$[]"](2).$to_i()},3),w(E,"$roll",function(N){var d,x,T=this,y=t;return d=N.$roll_sum(T.times,T.sides),x=P(d,T.times),y=T.items["$[]"](x),p(y["$respond_to?"]("roll"))&&(y=y.$roll(N)),u("RollResult").$new(T.name,d,y)},1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(r){var A,j,u,R,z,N,T,W,H,U=[],t=r.nil,v=r.module,e=r.klass,p=r.hash2,w=r.defs,P=r.def,s=r.rb_plus,B=r.rb_times,K=r.rb_minus;return A=U,j=H=[v(U[0],"BCDice")].concat(A),u=W=[v(H[0],"DiceTable")].concat(j),z=[R=e(W[0],null,"D66GridTable")].concat(u),N=r.$r(z),(T=R.$$prototype).name=T.items=t,w(R,"$from_i18n",function(x,y){var o=t;return o=N("I18n").$t(x,p(["locale","raise"],{locale:y,raise:!0})),this.$new(o["$[]"]("name"),o["$[]"]("items"))},2),P(R,"$initialize",function(x,y){return this.name=x,this.items=y.$freeze()},2),P(R,"$roll",function(x){var f,o,a,c,$;return f=x.$roll_once(6),o=x.$roll_once(6),a=s(B(f,10),o),c=K(f,1),$=K(o,1),N("RollResult").$new(this.name,a,this.items["$[]"](c)["$[]"]($))},1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(r){var K,H,_,u,R,z,j,Z,A,t=[],v=r.nil,e=r.module,p=r.klass,w=r.hash2,P=r.defs,s=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),K=t,H=A=[e(t[0],"BCDice")].concat(K),j=[e(A[0],"DiceTable")].concat(H),Z=r.$r(j),_=j,R=[u=p(j[0],Z("D66GridTable"),"D66HalfGridTable")].concat(_),z=r.$r(R),P(u,"$from_i18n",function(T,d){var y=v;return y=z("I18n").$t(T,w(["locale","raise"],{locale:d,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items_1_2_3"),y["$[]"]("items_4_5_6"))},2),s(u,"$initialize",function(T,d,x){return this.name=T,this.items=[d,d,d,x,x,x].$freeze()},3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(r){var K,H,_,u,R,z,j,Z,A,t=[],v=r.nil,e=r.module,p=r.klass,w=r.hash2,P=r.defs,s=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),K=t,H=A=[e(t[0],"BCDice")].concat(K),j=[e(A[0],"DiceTable")].concat(H),Z=r.$r(j),_=j,R=[u=p(j[0],Z("D66GridTable"),"D66OneThirdTable")].concat(_),z=r.$r(R),P(u,"$from_i18n",function(T,d){var y=v;return y=z("I18n").$t(T,w(["locale","raise"],{locale:d,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items_1_2"),y["$[]"]("items_3_4"),y["$[]"]("items_5_6"))},2),s(u,"$initialize",function(T,d,x,y){return this.name=T,this.items=[d,d,x,x,y,y].$freeze()},4)},Opal.modules["bcdice/dice_table/d66_table"]=function(r){var H,W,z,N,T,d,x,_,j,U=[],t=r.nil,v=r.$$$,e=r.module,p=r.klass,w=r.hash2,P=r.defs,s=r.def,B=r.eqeqeq,K=r.rb_plus,C=r.rb_times,A=r.truthy;return H=U,W=j=[e(U[0],"BCDice")].concat(H),z=_=[e(j[0],"DiceTable")].concat(W),T=[N=p(_[0],null,"D66Table")].concat(z),d=r.$r(T),(x=N.$$prototype).sort_type=x.items=x.name=t,P(N,"$from_i18n",function(f,o){var $,c=t;return c=d("I18n").$t(f,w(["locale"],{locale:o})),$=d("D66SortType").$const_get(c["$[]"]("d66_sort_type")),this.$new(c["$[]"]("name"),$,c["$[]"]("items"))},2),s(N,"$initialize",function(f,o,a){var c=this;return c.name=f,c.sort_type=o,c.items=a.$freeze()},3),s(N,"$roll",function(f){var o=this,a=t,c=t,$=t,n=t;return a=f.$roll_barabara(2,6),B(v(d("D66SortType"),"ASC"),c=o.sort_type)?a["$sort!"]():B(v(d("D66SortType"),"DESC"),c)&&a["$sort!"]()["$reverse!"](),$=K(C(a["$[]"](0),10),a["$[]"](1)),n=A(c=o.items["$[]"]($))?c:o.items["$[]"]($.$to_s()),A(n["$respond_to?"]("roll"))&&(n=n.$roll(f)),d("RollResult").$new(o.name,$,n)},1),s(N,"$choice",function(f){return d("RollResult").$new(this.name,f,this.items["$[]"](f))},1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(r){var Z,u,z,N,E,t=[],v=r.nil,e=r.module,p=r.klass,w=r.hash2,P=r.send,s=r.to_ary,B=r.rb_plus,K=r.rb_times,C=r.to_a,A=r.rb_minus,G=r.send2,H=r.find_super,F=r.def;return r.top.$require("bcdice/dice_table/d66_table"),Z=t,u=E=[e(t[0],"BCDice")].concat(Z),z=[e(E[0],"DiceTable")].concat(u),N=r.$r(z),F(p(z[0],N("D66Table"),"D66LeftRangeTable"),"$initialize",function y(f,o,a){var n;return delete y.$$p,n=w([],{}),P(a,"each",[],function(m){var L,M;return null==m&&(m=v),L=s(m),M=null==L[1]?v:L[1],P(null==L[0]?v:L[0],"each",[],function(l){return null==l&&(l=v),P(M,"each_with_index",[],function(b,O){var re,V;return null==b&&(b=v),null==O&&(O=v),re=B(K(l,10),B(O,1)),P(n,"[]=",C(V=[re,b])),V[A(V.length,1)]},2)},1)},1),G(this,H(this,"initialize",y,!1,!0),"initialize",[f,o,n],null)},3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(r){var G,Z,R,z,N,T,d,E,F,U=[],t=r.nil,v=r.module,e=r.klass,p=r.hash2,w=r.defs,P=r.def,s=r.truthy,B=r.rb_minus,K=r.rb_plus,C=r.rb_times;return G=U,Z=F=[v(U[0],"BCDice")].concat(G),R=E=[v(F[0],"DiceTable")].concat(Z),N=[z=e(E[0],null,"D66ParityTable")].concat(R),T=r.$r(N),(d=z.$$prototype).odd=d.even=d.name=t,w(z,"$from_i18n",function(y,f){var a=t;return a=T("I18n").$t(y,p(["locale","raise"],{locale:f,raise:!0})),this.$new(a["$[]"]("name"),a["$[]"]("odd"),a["$[]"]("even"))},2),P(z,"$initialize",function(y,f,o){var a=this;return a.name=y,a.odd=f.$freeze(),a.even=o.$freeze()},3),P(z,"$roll",function(y){var a,$,n,f=this,o=t;return o=y.$roll_once(6),a=y.$roll_once(6),$=(s(o["$odd?"]())?f.odd:f.even)["$[]"](B(a,1)),n=K(C(o,10),a),T("RollResult").$new(f.name,n,$)},1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(r){var K,H,E,_,u,R,z,j,A,U=[],t=r.nil,v=r.module,e=r.klass,p=r.def,w=r.rb_plus,P=r.rb_times,s=r.send;return K=U,H=A=[v(U[0],"BCDice")].concat(K),E=j=[v(A[0],"DiceTable")].concat(H),u=[_=e(j[0],null,"D66RangeTable")].concat(E),R=r.$r(u),(z=_.$$prototype).items=z.name=t,p(_,"$initialize",function(T,d){return this.name=T,this.items=d.$freeze()},2),p(_,"$roll",function(T){var x,y,f,o=t;return x=T.$roll_once(6),y=T.$roll_once(6),f=w(P(x,10),y),o=s(this.items,"find",[],function(c){return null==c&&(c=t),c["$[]"](0)["$include?"](f)},1),R("RollResult").$new(this.name,f,o["$[]"](1))},1)},Opal.modules["bcdice/dice_table/range_table"]=function(r){var F,E,N,T,d,x,y,u,Z,U=[],t=r.nil,v=r.module,e=r.klass,p=r.const_set,w=r.send,P=r.truthy,s=r.def,B=r.to_a,K=r.rb_minus,C=r.eqeqeq,A=r.rb_times,G=r.rb_plus;return F=U,E=Z=[v(U[0],"BCDice")].concat(F),N=u=[v(Z[0],"DiceTable")].concat(E),d=[T=e(u[0],null,"RangeTable")].concat(N),x=r.$r(d),(y=T.$$prototype).name=y.items=y.num_of_dice=y.num_of_sides=y.formatter=t,p(d[0],"RollResult",w(x("Struct"),"new",["sum","values","content","formatted"],function f(){return(null==f.$$s?this:f.$$s).$alias_method("to_s","formatted")},{$$arity:0,$$s:T})),p(d[0],"Item",x("Struct").$new("range","content")),p(d[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),p(d[0],"DEFAULT_FORMATTER",w(T,"lambda",[],function(o,a){return null==o&&(o=t),null==a&&(a=t),o.$name()+"("+a.$sum()+") \uff1e "+a.$content()},2)),T.$attr_reader("name"),T.$attr_reader("num_of_dice"),T.$attr_reader("num_of_sides"),s(T,"$initialize",function f(o,a,c){var i,$=f.$$p||t,n=this,m=t;return delete f.$$p,n.name=o.$freeze(),n.formatter=P(i=$)?i:x("DEFAULT_FORMATTER"),m=x("DICE_ROLL_METHOD_RE").$match(a),P(m)||n.$raise(x("ArgumentError"),n.name+": invalid dice roll method: "+a),n.num_of_dice=m["$[]"](1).$to_i(),n.num_of_sides=m["$[]"](2).$to_i(),n.$store(c)},3),s(T,"$fetch",function(o){var c,a=this;return c=w(a.items,"find",[],function(n){return null==n&&(n=t),n.$range()["$include?"](o)},1),P(c)||a.$raise(x("RangeError"),a.name+": value is out of range: "+o),c},1),s(T,"$roll",function(o){var $,n,i,a=this,c=t;return $=(c=o.$roll_barabara(a.num_of_dice,a.num_of_sides)).$sum(),n=x("RollResult").$new($,c,a.$fetch($).$content()),i=[a.formatter["$[]"](a,n)],w(n,"formatted=",B(i)),K(i.length,1),n},1),T.$private(),s(T,"$store",function(o){var c,$,a=this;return c=w(o,"map",[],function n(i,m){return null==i&&(i=t),null==m&&(m=t),[(null==n.$$s?this:n.$$s).$coerce_to_int_range(i),m]},{$$arity:2,$$s:a}),$=w(c,"sort_by",[],function(i,m){return null==i&&(i=t),null==m&&(m=t),i.$min()},2),a.$assert_min_sum_is_covered($),a.$assert_max_sum_is_covered($),a.$assert_no_gap_or_overlap_in_ranges($),a.items=w($,"map",[],function(i,m){return null==i&&(i=t),null==m&&(m=t),x("Item").$new(i,m.$freeze()).$freeze()},2).$freeze(),a},1),s(T,"$coerce_to_int_range",function(o){var c;return C(x("Integer"),c=o)?x("Range").$new(o,o):C(x("Range"),c)&&P(o.$begin()["$is_a?"](x("Integer")))&&P(o.$end()["$is_a?"](x("Integer")))?o:this.$raise(x("TypeError"),this.name+": "+o+" ("+o.$class()+") must be an Integer or a Range with Integers ")},1),s(T,"$assert_min_sum_is_covered",function(o){var c,a=this,$=t;return c=a.num_of_dice,$=o.$first()["$[]"](0),P($["$include?"](c))||a.$raise(x("RangeError"),a.name+": min value ("+c+") is not covered: "+$),a},1),s(T,"$assert_max_sum_is_covered",function(o){var c,a=this,$=t;return c=A(a.num_of_dice,a.num_of_sides),$=o.$last()["$[]"](0),P($["$include?"](c))||a.$raise(x("RangeError"),a.name+": max value ("+c+") is not covered: "+$),a},1),s(T,"$assert_no_gap_or_overlap_in_ranges",function(o){return w(o,"each_cons",[2],function c($,n){var g,k,i=null==c.$$s?this:c.$$s,m=t,L=t;return null==i.name&&(i.name=t),null==$&&($=t),null==n&&(n=t),m=$["$[]"](0),L=n["$[]"](0),g=m.$max(),k=G(g,1),P(L["$include?"](g))&&i.$raise(x("RangeError"),i.name+": Range overlap: "+m+" and "+L),P(L["$include?"](k))?t:i.$raise(x("RangeError"),i.name+": Range gap: "+m+" and "+L)},{$$arity:2,$$s:this}),this},1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(r){var K,H,E,N,T,d,x,u,j,A,U=[],t=r.nil,v=r.$$$,e=r.module,p=r.klass,w=r.send,P=r.def,s=r.rb_minus;return K=U,H=A=[e(U[0],"BCDice")].concat(K),E=j=[e(A[0],"DiceTable")].concat(H),N=u=[p(j[0],null,"SaiFicSkillTable")].concat(E),d=[T=p(u[0],null,"Category")].concat(N),x=r.$r(d),T.$$prototype.name=t,P(T,"$initialize",function(o,a,c,$){var n=this;return n.name=o,n.skills=w(a.$map(),"with_index",[2],function(m,L){return null==m&&(m=t),null==L&&(L=t),v(x("SaiFicSkillTable"),"Skill").$new(o,m,c,L,$)},2),n.dice=c},4),P(T,"$roll",function(o){return this.$skills()["$[]"](s(o.$roll_sum(2,6),2))},1),P(T,"$to_s",function(){return this.name},0),T.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(r){var s,A,Z,R,z,E,H,K,U=[],t=r.nil,v=r.module,e=r.klass,p=r.def,w=r.hash2;return s=U,A=K=[v(U[0],"BCDice")].concat(s),Z=H=[v(K[0],"DiceTable")].concat(A),E=[e(H[0],null,"SaiFicSkillTable")].concat(Z),(z=(R=e(E[0],null,"Skill")).$$prototype).s_format=z.category_dice=z.row_dice=z.category_name=z.name=t,p(R,"$initialize",function(T,d,x,y,f){var o=this;return o.category_name=T,o.name=d,o.category_dice=x,o.row_dice=y,o.s_format=f},5),p(R,"$to_s",function(){var T=this;return T.$format(T.s_format,w(["category_dice","row_dice","category_name","skill_name"],{category_dice:T.category_dice,row_dice:T.row_dice,category_name:T.category_name,skill_name:T.name}))},0),R.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(r){var W,R,x,y,f,o,a,N,_,U=r.top,t=[],v=r.nil,e=r.$$$,p=r.module,w=r.klass,P=r.hash2,s=r.send,K=r.defs,C=r.const_set,A=r.to_ary,G=r.def,H=r.truthy,F=r.rb_minus,j=r.rb_plus;return U.$require("bcdice/dice_table/sai_fic_skill_table/category"),U.$require("bcdice/dice_table/sai_fic_skill_table/skill"),W=t,R=_=[p(t[0],"BCDice")].concat(W),x=N=[p(_[0],"DiceTable")].concat(R),f=[y=w(N[0],null,"SaiFicSkillTable")].concat(x),o=r.$r(f),(a=y.$$prototype).rtt=a.rtt_format=a.rct=a.rct_format=a.rttn=a.rttn_format=a.categories=v,K(y,"$from_i18n",function($,n,i){var m,L,g,l,h=v;if(null==i)i=P([],{});else if(!i.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(m=i.$$smap.rtt)&&(m=v),null==(L=i.$$smap.rct)&&(L=v),null==(g=i.$$smap.rttn)&&(g=v),l=(h=o("I18n").$t("RTT",P(["locale","raise","default"],{locale:n,raise:!1,default:P([],{})})).$merge(o("I18n").$t($,P(["locale","raise"],{locale:n,raise:!0}))))["$[]"]("items"),h=s(h,"select",[],function(b,O){return null==b&&(b=v),null==O&&(O=v),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](b)},2),this.$new(l,r.to_hash(h).$merge(P(["rtt","rct","rttn"],{rtt:m,rct:L,rttn:g})))},-3),C(f[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),C(f[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),C(f[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),C(f[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),G(y,"$initialize",function($,n){var i,m,L,g,k,M,h,l=this;if(null==n)n=P([],{});else if(!n.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(i=n.$$smap.rtt)&&(i=v),null==(m=n.$$smap.rct)&&(m=v),null==(L=n.$$smap.rttn)&&(L=v),null==(g=n.$$smap.rtt_format)&&(g=o("DEFAULT_RTT")),null==(k=n.$$smap.rct_format)&&(k=o("DEFAULT_RCT")),null==(M=n.$$smap.rttn_format)&&(M=o("DEFAULT_RTTN")),null==(h=n.$$smap.s_format)&&(h=o("DEFAULT_S")),l.categories=s($.$map(),"with_index",[1],function(b,O){var re,ie,Q;return null==b&&(b=v),null==O&&(O=v),ie=null==(re=A(b))[0]?v:re[0],Q=null==re[1]?v:re[1],e(o("SaiFicSkillTable"),"Category").$new(ie,Q,O,h)},{$$arity:2,$$has_top_level_mlhs_arg:!0}),l.rtt=i,l.rct=m,l.rttn=L.$to_a(),l.rtt_format=g,l.rct_format=k,l.rttn_format=M},-2),C(f[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),y.$attr_reader("categories"),G(y,"$roll_command",function($,n){var m,i=this,L=v,g=v;return H(["RTT",i.rtt]["$include?"](m=n))?i.$format_skill(i.rtt_format,i.$roll_skill($)):H(["RCT",i.rct]["$include?"](m))?(L=i.$roll_category($),i.$format(i.rct_format,P(["category_dice","category_name"],{category_dice:L.$dice(),category_name:L.$name()}))):H(g=o("RTTN").$index(m))||H(g=i.rttn.$index(m))?i.$format_skill(i.rttn_format,i.categories["$[]"](g).$roll($)):v},2),G(y,"$roll_category",function($){return this.categories["$[]"](F($.$roll_once(6),1))},1),G(y,"$roll_skill",function($){return this.$roll_category($).$roll($)},1),G(y,"$prefixes",function(){var $=this;return j(["RTT[1-6]?","RCT",$.rtt,$.rct],$.rttn).$compact()},0),y.$private(),G(y,"$format_skill",function($,n){return this.$format($,P(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:n.$category_dice(),row_dice:n.$row_dice(),category_name:n.$category_name(),skill_name:n.$name(),text:n.$to_s()}))},2)},Opal.modules["bcdice/dice_table/table"]=function(r){var C,F,_,u,R,z,N,Z,G,U=[],t=r.nil,v=r.module,e=r.klass,p=r.hash2,w=r.defs,P=r.truthy,s=r.def,B=r.rb_minus;return C=U,F=G=[v(U[0],"BCDice")].concat(C),_=Z=[v(G[0],"DiceTable")].concat(F),R=[u=e(Z[0],null,"Table")].concat(_),z=r.$r(R),(N=u.$$prototype).times=N.sides=N.name=N.items=t,w(u,"$from_i18n",function(d,x){var f=t;return f=z("I18n").$t(d,p(["locale"],{locale:x})),this.$new(f["$[]"]("name"),f["$[]"]("type"),f["$[]"]("items"))},2),s(u,"$initialize",function(d,x,y){var f=this,o=t;return f.name=d,f.items=y.$freeze(),o=/(\d+)D(\d+)/i.$match(x),P(o)||f.$raise(z("ArgumentError"),"Unexpected table type: "+x),f.times=o["$[]"](1).$to_i(),f.sides=o["$[]"](2).$to_i()},3),s(u,"$roll",function(d){var y,x=this;return y=d.$roll_sum(x.times,x.sides),x.$choice(y)},1),s(u,"$choice",function(d){var y,x=this;return y=B(d,x.times),z("RollResult").$new(x.name,d,x.items["$[]"](y))},1)},Opal.modules["bcdice/dice_table"]=function(r){var U=r.top;return U.$require("bcdice/dice_table/roll_result"),U.$require("bcdice/dice_table/chain_table"),U.$require("bcdice/dice_table/d66_grid_table"),U.$require("bcdice/dice_table/d66_half_grid_table"),U.$require("bcdice/dice_table/d66_one_third_table"),U.$require("bcdice/dice_table/d66_left_range_table"),U.$require("bcdice/dice_table/d66_parity_table"),U.$require("bcdice/dice_table/d66_range_table"),U.$require("bcdice/dice_table/d66_table"),U.$require("bcdice/dice_table/range_table"),U.$require("bcdice/dice_table/sai_fic_skill_table"),U.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(r){var w,K,A,s,U=[],v=r.module,e=r.const_set;return w=U,K=s=[v(U[0],"BCDice")].concat(w),A=[v(s[0],"D66SortType")].concat(K),e(A[0],"NO_SORT","no_sort"),e(A[0],"ASC","asc"),e(A[0],"DESC","desc"),function(B,K){var A=[v(B,"RoundType")].concat(K);return e(A[0],"CEIL","ceil"),e(A[0],"FLOOR","floor"),e(A[0],"ROUND","round")}(s[0],s)},Opal.modules["bcdice/translate"]=function(r){var s,A,G,H,F,K,U=[],t=r.nil,v=r.module,e=r.hash2,w=r.def;return s=U,A=K=[v(U[0],"BCDice")].concat(s),H=[G=v(K[0],"Translate")].concat(A),F=r.$r(H),w(G,"$translate",function(Z,W){var E,_=this;if(null==_.locale&&(_.locale=t),null==W)W=e([],{});else if(!W.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return E=r.kwrestargs(W,{}),F("I18n").$translate(Z,e(["locale","raise"],{locale:_.locale,raise:!0}).$merge(r.to_hash(E)))},-2)},Opal.modules["bcdice/result"]=function(r){var K,F,E,j,W,A,U=[],t=r.nil,e=r.klass,p=r.send,w=r.to_a,P=r.rb_minus,s=r.def;return K=U,F=A=[(0,r.module)(U[0],"BCDice")].concat(K),[j=e(A[0],null,"Result")].concat(F),(W=j.$$prototype).secret=W.success=W.failure=W.critical=W.fumble=t,s(E=r.get_singleton_class(j),"$success",function(R){return p(this.$new(),"tap",[],function(T){var d=t;return null==T&&(T=t),p(T,"text=",w(d=[R])),P(d.length,1),p(T,"success=",w(d=[!0])),d[P(d.length,1)]},1)},1),s(E,"$failure",function(R){return p(this.$new(),"tap",[],function(T){var d=t;return null==T&&(T=t),p(T,"text=",w(d=[R])),P(d.length,1),p(T,"failure=",w(d=[!0])),d[P(d.length,1)]},1)},1),s(E,"$critical",function(R){return p(this.$new(),"tap",[],function(T){var d=t;return null==T&&(T=t),p(T,"text=",w(d=[R])),P(d.length,1),p(T,"critical=",w(d=[!0])),P(d.length,1),p(T,"success=",w(d=[!0])),d[P(d.length,1)]},1)},1),s(E,"$fumble",function(R){return p(this.$new(),"tap",[],function(T){var d=t;return null==T&&(T=t),p(T,"text=",w(d=[R])),P(d.length,1),p(T,"fumble=",w(d=[!0])),P(d.length,1),p(T,"failure=",w(d=[!0])),d[P(d.length,1)]},1)},1),s(E,"$nothing",function(){return"nothing"},0),s(j,"$initialize",function(_){var u=this;return null==_&&(_=t),u.text=_,u.rands=t,u.detailed_rands=t,u.secret=!1,u.success=!1,u.failure=!1,u.critical=!1,u.fumble=!1},-1),j.$attr_accessor("text","rands","detailed_rands"),j.$attr_writer("secret","success","failure","critical","fumble"),s(j,"$secret?",function(){return this.secret},0),s(j,"$success?",function(){return this.success},0),s(j,"$failure?",function(){return this.failure},0),s(j,"$critical?",function(){return this.critical},0),s(j,"$fumble?",function(){return this.fumble},0),s(j,"$condition=",function(_){return this.success=_,this.failure=_["$!"]()},1)},Opal.modules["racc/parser"]=function(r){var x,f,o,t=[],v=r.$r(t),e=r.nil,p=r.$$$,w=r.module,P=r.klass,s=r.truthy,B=r.const_set,K=r.defs,C=r.gvars,A=r.rb_lt,G=r.send,H=r.to_a,F=r.rb_minus,j=r.def,Z=r.to_ary,W=r.neqeq,E=r.rb_plus,_=r.eqeq,u=r.rb_ge,R=r.rb_gt,z=r.eqeqeq,N=r.rb_le,T=r.rb_times;return x=t,f=[w(t[0],"Racc")].concat(x),o=r.$r(f),P(f[0],o("StandardError"),"ParseError"),s(p("::","ParseError","skip_raise")?"constant":e)||B(t[0],"ParseError",p(v("Racc"),"ParseError")),function(d,x){var n,i,m,L,g,o=[w(d,"Racc")].concat(x),a=r.$r(o);return s(a("Racc_No_Extensions","skip_raise")?"constant":e)||B(o[0],"Racc_No_Extensions",!1),n=o,m=[i=P(o[0],null,"Parser")].concat(n),L=r.$r(m),(g=i.$$prototype).yydebug=g.racc_debug_out=g.racc_error_status=g.racc_t=g.racc_vstack=g.racc_val=g.racc_state=g.racc_tstack=e,B(m[0],"Racc_Runtime_Version","1.4.6"),B(m[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),B(m[0],"Racc_Runtime_Core_Version_R","1.4.6"),B(m[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),B(m[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),B(m[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),B(m[0],"Racc_Runtime_Core_Version",L("Racc_Runtime_Core_Version_R")),B(m[0],"Racc_Runtime_Core_Revision",L("Racc_Runtime_Core_Revision_R")),B(m[0],"Racc_Runtime_Type","ruby"),K(L("Parser"),"$racc_runtime_type",function(){return L("Racc_Runtime_Type")},0),j(i,"$_racc_setup",function(){var M,h,l=this,I=e,b=e,O=e;return null==C.stderr&&(C.stderr=e),s(p(l.$class(),"Racc_debug_parser"))||(l.yydebug=!1),s(null!=(M=l.yydebug)&&M!==e?"instance-variable":e)||(l.yydebug=!1),s(l.yydebug)&&(s(null!=(h=l.racc_debug_out)&&h!==e?"instance-variable":e)||(l.racc_debug_out=C.stderr),l.racc_debug_out=s(I=l.racc_debug_out)?I:C.stderr),b=p(l.$class(),"Racc_arg"),s(A(b.$size(),14))&&(G(b,"[]=",H(O=[13,!0])),F(O.length,1)),b},0),j(i,"$_racc_init_sysvars",function(){var M=this;return M.racc_state=[0],M.racc_tstack=[],M.racc_vstack=[],M.racc_t=e,M.racc_val=e,M.racc_read_next=!0,M.racc_user_yyerror=!1,M.racc_error_status=0},0),j(i,"$do_parse",function(){return this.$__send__(L("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),j(i,"$next_token",function(){return this.$raise(L("NotImplementedError"),this.$class()+"#next_token is not defined")},0),j(i,"$_racc_do_parse_rb",function(M,h){var l,b=this,O=e,re=e,V=e,ie=e,X=e,S=e,J=e,D=e;return l=Z(M),O=null==l[0]?e:l[0],re=null==l[1]?e:l[1],V=null==l[2]?e:l[2],ie=null==l[3]?e:l[3],X=null==l[10]?e:l[10],b.$_racc_init_sysvars(),S=J=D=e,G(b,"catch",["racc_end_parse"],function q(){var $e,ee,Y=null==q.$$s?this:q.$$s,ce=e;for(null==Y.racc_state&&(Y.racc_state=e),null==Y.racc_read_next&&(Y.racc_read_next=e),null==Y.racc_t&&(Y.racc_t=e),null==Y.yydebug&&(Y.yydebug=e),null==Y.racc_val&&(Y.racc_val=e);s(!0);)for(s(D=ie["$[]"](Y.racc_state["$[]"](-1)))?(s(Y.racc_read_next)&&W(Y.racc_t,0)&&(ee=Y.$next_token(),$e=Z(ee),S=null==$e[0]?e:$e[0],Y.racc_val=null==$e[1]?e:$e[1],Y.racc_t=s(S)?s(ce=X["$[]"](S))?ce:1:0,s(Y.yydebug)&&Y.$racc_read_token(Y.racc_t,S,Y.racc_val),Y.racc_read_next=!1),D=E(D,Y.racc_t),s(u(D,0))&&s(J=O["$[]"](D))&&_(re["$[]"](D),Y.racc_state["$[]"](-1))||(J=V["$[]"](Y.racc_state["$[]"](-1)))):J=V["$[]"](Y.racc_state["$[]"](-1));s(J=Y.$_racc_evalact(J,M)););},{$$arity:0,$$s:b})},2),j(i,"$yyparse",function(M,h){return this.$__send__(L("Racc_YY_Parse_Method"),M,h,this.$_racc_setup(),!0)},2),j(i,"$_racc_yyparse_rb",function(M,h,l,I){var b,V=e,ie=e,Q=e,X=e,J=e,D=e,q=e;return b=Z(l),V=null==b[0]?e:b[0],ie=null==b[1]?e:b[1],Q=null==b[2]?e:b[2],X=null==b[3]?e:b[3],J=null==b[10]?e:b[10],this.$_racc_init_sysvars(),D=e,q=e,G(this,"catch",["racc_end_parse"],function ne(){var Y=null==ne.$$s?this:ne.$$s;for(null==Y.racc_state&&(Y.racc_state=e);!s(q=X["$[]"](Y.racc_state["$[]"](-1)));)for(;s(D=Y.$_racc_evalact(Q["$[]"](Y.racc_state["$[]"](-1)),l)););return G(M,"__send__",[h],function ce(se,le){var ae=null==ce.$$s?this:ce.$$s,te=e,oe=e;for(null==ae.racc_t&&(ae.racc_t=e),null==ae.racc_state&&(ae.racc_state=e),null==ae.racc_read_next&&(ae.racc_read_next=e),null==se&&(se=e),null==le&&(le=e),ae.racc_t=s(se)?s(te=J["$[]"](se))?te:1:0,ae.racc_val=le,ae.racc_read_next=!1,q=E(q,ae.racc_t),s(u(q,0))&&s(D=V["$[]"](q))&&_(ie["$[]"](q),ae.racc_state["$[]"](-1))||(D=Q["$[]"](ae.racc_state["$[]"](-1)));s(D=ae.$_racc_evalact(D,l)););for(;s(s(te=s(oe=(q=X["$[]"](ae.racc_state["$[]"](-1)))["$!"]())?oe:ae.racc_read_next["$!"]())?te:ae.racc_t["$=="](0));)for(s(q)&&s(q=E(q,ae.racc_t))&&s(u(q,0))&&s(D=V["$[]"](q))&&_(ie["$[]"](q),ae.racc_state["$[]"](-1))||(D=Q["$[]"](ae.racc_state["$[]"](-1)));s(D=ae.$_racc_evalact(D,l)););},{$$arity:2,$$s:Y})},{$$arity:0,$$s:this})},4),j(i,"$_racc_evalact",function(M,h){var l,Q,b=this,O=e,re=e,ie=e,X=e,S=e,J=e,D=e;if(O=null==(l=Z(h))[0]?e:l[0],re=null==l[1]?e:l[1],ie=null==l[3]?e:l[3],Q=null==l[11]?e:l[11],X=null==l[12]?e:l[12],s(R(M,0))&&s(A(M,Q)))s(R(b.racc_error_status,0))&&(_(b.racc_t,1)||(b.racc_error_status=F(b.racc_error_status,1))),b.racc_vstack.$push(b.racc_val),b.racc_state.$push(M),b.racc_read_next=!0,s(b.yydebug)&&(b.racc_tstack.$push(b.racc_t),b.$racc_shift(b.racc_t,b.racc_tstack,b.racc_vstack));else if(s(A(M,0))&&s(R(M,X["$-@"]()))){if(S=G(b,"catch",["racc_jump"],function q(){var ne=null==q.$$s?this:q.$$s;return null==ne.racc_state&&(ne.racc_state=e),ne.racc_state.$push(ne.$_racc_do_reduce(h,M)),!1},{$$arity:0,$$s:b}),s(S)){if(z(1,J=S))return b.racc_user_yyerror=!0,X["$-@"]();if(z(2,J))return Q;b.$raise("[Racc Bug] unknown jump code")}}else if(_(M,Q))s(b.yydebug)&&b.$racc_accept(),b.$throw("racc_end_parse",b.racc_vstack["$[]"](0));else{if(_(M,X["$-@"]())){for(z(0,J=b.racc_error_status)?s(h["$[]"](21))||b.$on_error(b.racc_t,b.racc_val,b.racc_vstack):z(3,J)&&(_(b.racc_t,0)&&b.$throw("racc_end_parse",e),b.racc_read_next=!0),b.racc_user_yyerror=!1,b.racc_error_status=3;s(!0)&&!(s(D=ie["$[]"](b.racc_state["$[]"](-1)))&&(D=E(D,1),s(u(D,0))&&s(M=O["$[]"](D))&&_(re["$[]"](D),b.racc_state["$[]"](-1))));)s(N(b.racc_state.$size(),1))&&b.$throw("racc_end_parse",e),b.racc_state.$pop(),b.racc_vstack.$pop(),s(b.yydebug)&&(b.racc_tstack.$pop(),b.$racc_e_pop(b.racc_state,b.racc_tstack,b.racc_vstack));return M}b.$raise("[Racc Bug] unknown action "+M.$inspect())}return s(b.yydebug)&&b.$racc_next_state(b.racc_state["$[]"](-1),b.racc_state),e},2),j(i,"$_racc_do_reduce",function(M,h){var l,X,J,Y,ce,se,ae,b=this,re=e,V=e,ie=e,Q=e,S=e,D=e,q=e,ne=e,$e=e,ee=e,le=e,_e=e,ue=e,te=e;return re=null==(l=Z(M))[4]?e:l[4],V=null==l[5]?e:l[5],ie=null==l[6]?e:l[6],Q=null==l[7]?e:l[7],X=null==l[8]?e:l[8],S=null==l[9]?e:l[9],J=null==l[13]?e:l[13],D=b.racc_state,q=b.racc_vstack,ne=b.racc_tstack,$e=T(h,-3),ee=S["$[]"]($e),Y=S["$[]"](E($e,1)),ce=S["$[]"](E($e,2)),se=[],s(b.yydebug)&&(le=ne["$[]"](ee["$-@"](),ee)),_e=q["$[]"](ee["$-@"](),ee),s(b.yydebug)&&(ue=[ee["$-@"](),ee,se],G(ne,"[]=",H(ue)),F(ue.length,1)),ue=[ee["$-@"](),ee,se],G(q,"[]=",H(ue)),F(ue.length,1),ue=[ee["$-@"](),ee,se],G(D,"[]=",H(ue)),F(ue.length,1),s(J)?q.$push(b.$__send__(ce,_e,q,_e["$[]"](0))):q.$push(b.$__send__(ce,_e,q)),ne.$push(Y),s(b.yydebug)&&b.$racc_reduce(le,Y,ne,q),ae=F(Y,X),s($e=Q["$[]"](ae))&&($e=E($e,D["$[]"](-1)),s(u($e,0))&&s(te=re["$[]"]($e))&&_(V["$[]"]($e),ae))?te:ie["$[]"](ae)},2),j(i,"$on_error",function(M,h,l){var b,I=this;return I.$raise(L("ParseError"),I.$sprintf("\nparse error on value %s (%s)",h.$inspect(),s(b=I.$token_to_str(M))?b:"?"))},3),j(i,"$yyerror",function(){return this.$throw("racc_jump",1)},0),j(i,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),j(i,"$yyerrok",function(){return this.racc_error_status=0},0),j(i,"$racc_read_token",function(M,h,l){var I=this;return I.racc_debug_out.$print("read    "),I.racc_debug_out.$print(h.$inspect(),"(",I.$racc_token2str(M),") "),I.racc_debug_out.$puts(l.$inspect()),I.racc_debug_out.$puts()},3),j(i,"$racc_shift",function(M,h,l){var I=this;return I.racc_debug_out.$puts("shift   "+I.$racc_token2str(M)),I.$racc_print_stacks(h,l),I.racc_debug_out.$puts()},3),j(i,"$racc_reduce",function(M,h,l,I){var b=this,O=e;return(O=b.racc_debug_out).$print("reduce "),s(M["$empty?"]())?O.$print(" <none>"):G(M,"each",[],function re(V){return null==V&&(V=e),O.$print(" ",(null==re.$$s?this:re.$$s).$racc_token2str(V))},{$$arity:1,$$s:b}),O.$puts(" --\x3e "+b.$racc_token2str(h)),b.$racc_print_stacks(l,I),b.racc_debug_out.$puts()},4),j(i,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),j(i,"$racc_e_pop",function(M,h,l){var I=this;return I.racc_debug_out.$puts("error recovering mode: pop token"),I.$racc_print_states(M),I.$racc_print_stacks(h,l),I.racc_debug_out.$puts()},3),j(i,"$racc_next_state",function(M,h){var l=this;return l.racc_debug_out.$puts("goto    "+M),l.$racc_print_states(h),l.racc_debug_out.$puts()},2),j(i,"$racc_print_stacks",function(M,h){var I=e;return(I=this.racc_debug_out).$print("        ["),G(M,"each_index",[],function b(O){return null==O&&(O=e),I.$print(" (",(null==b.$$s?this:b.$$s).$racc_token2str(M["$[]"](O))," ",h["$[]"](O).$inspect(),")")},{$$arity:1,$$s:this}),I.$puts(" ]")},2),j(i,"$racc_print_states",function(M){var l=e;return(l=this.racc_debug_out).$print("        ["),G(M,"each",[],function(b){return null==b&&(b=e),l.$print(" ",b)},1),l.$puts(" ]")},1),j(i,"$racc_token2str",function(M){var l;return s(l=p(this.$class(),"Racc_token_to_s_table")["$[]"](M))?l:this.$raise("[Racc Bug] can't convert token "+M+" to string")},1),j(i,"$token_to_str",function(M){return p(this.$class(),"Racc_token_to_s_table")["$[]"](M)},1)}(t[0],t)},Opal.modules["bcdice/arithmetic/node"]=function(r){var j,_,N,o,a,d,x,R,W,U=[],t=r.nil,v=r.$$$,e=r.module,p=r.klass,w=r.def,P=r.send2,s=r.find_super,B=r.eqeq,K=r.const_set,C=r.eqeqeq,A=r.rb_divide,G=r.truthy,H=r.alias;return j=U,_=W=[e(U[0],"BCDice")].concat(j),N=R=[e(W[0],"Arithmetic")].concat(_),d=[e(R[0],"Node")].concat(N),x=r.$r(d),(a=(o=p(d[0],null,"BinaryOp")).$$prototype).lhs=a.rhs=a.op=t,w(o,"$initialize",function($,n,i){var m=this;return m.lhs=$,m.op=n,m.rhs=i},3),w(o,"$eval",function($){var m,n=this,i=t;return i=n.lhs.$eval($),m=n.rhs.$eval($),i.$send(n.op,m)},1),w(o,"$output",function(){var $=this;return""+$.lhs.$output()+$.op+$.rhs.$output()},0),w(o,"$s_exp",function(){var $=this;return"("+$.$op_for_s_exp()+" "+$.lhs.$s_exp()+" "+$.rhs.$s_exp()+")"},0),w(o,"$op_for_s_exp",function(){return this.op},0),function(y,f,o){var a=p(y,f,"DivideBase"),c=[a].concat(o),$=r.$r(c),n=a.$$prototype;n.lhs=n.rhs=n.op=t,w(a,"$initialize",function i(m,L){return delete i.$$p,P(this,s(this,"initialize",i,!1,!0),"initialize",[m,"/",L],null)},2),w(a,"$eval",function(m){var g,k,L=this;return g=L.lhs.$eval(m),k=L.rhs.$eval(m),B(k,0)&&L.$raise($("ZeroDivisionError")),L.$divide_and_round(g,k,m)},1),w(a,"$output",function i(){var m=i.$$p||t,L=this;return delete i.$$p,""+P(L,s(L,"output",i,!1,!0),"output",[],m)+L.$rounding_method()},0),a.$private(),w(a,"$rounding_method",function(){return v(this.$class(),"ROUNDING_METHOD")},0),w(a,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),w(a,"$divide_and_round",function(m,L,g){return this.$raise($("NotImplementedError"))},3)}(d[0],x("BinaryOp"),d),function(y,f,o){var a=p(y,f,"DivideWithGameSystemDefault"),c=[a].concat(o),$=r.$r(c);K(c[0],"ROUNDING_METHOD",""),a.$private(),w(a,"$divide_and_round",function(i,m,L){var g,k=t;return C(v($("RoundType"),"CEIL"),g=L)?A(i.$to_f(),m).$ceil():C(v($("RoundType"),"ROUND"),g)?(k=A(i.$to_f(),m),G(k["$negative?"]())?k.$abs().$round()["$-@"]():k.$round()):A(i,m).$floor()},3)}(d[0],x("DivideBase"),d),function(y,f,o){var a=p(y,f,"DivideWithCeil"),c=[a].concat(o);K(c[0],"ROUNDING_METHOD","C"),a.$private(),w(a,"$divide_and_round",function(n,i,m){return A(n.$to_f(),i).$ceil()},3)}(d[0],x("DivideBase"),d),function(y,f,o){var a=p(y,f,"DivideWithRound"),c=[a].concat(o);K(c[0],"ROUNDING_METHOD","R"),a.$private(),w(a,"$divide_and_round",function(n,i,m){var L=t;return L=A(n.$to_f(),i),G(L["$negative?"]())?L.$abs().$round()["$-@"]():L.$round()},3)}(d[0],x("DivideBase"),d),function(y,f,o){var a=p(y,f,"DivideWithFloor"),c=[a].concat(o);K(c[0],"ROUNDING_METHOD","F"),a.$private(),w(a,"$divide_and_round",function(n,i,m){return A(n,i).$floor()},3)}(d[0],x("DivideBase"),d),function(y,f){var o=p(y,null,"Negative");o.$$prototype.body=t,w(o,"$initialize",function($){return this.body=$},1),w(o,"$eval",function($){return this.body.$eval($)["$-@"]()},1),w(o,"$output",function(){return"-"+this.body.$output()},0),w(o,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(d[0]),function(y,f){var o=p(y,null,"Parenthesis");o.$$prototype.expr=t,w(o,"$initialize",function($){return this.expr=$},1),w(o,"$eval",function($){return this.expr.$eval($)},1),w(o,"$output",function(){return"("+this.expr.$output()+")"},0),w(o,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(d[0]),function(y,f){var o=p(y,null,"Number");return o.$$prototype.value=t,w(o,"$initialize",function($){return this.value=$},1),w(o,"$eval",function($){return this.value},1),w(o,"$output",function(){return this.value.$to_s()},0),H(o,"s_exp","output")}(d[0])},Opal.modules.strscan=function(r){var H,F,j,Z,W,U=[],t=r.nil,e=r.def,p=r.truthy,w=r.eqeqeq,P=r.Opal,s=r.send,B=r.to_a,K=r.rb_minus,C=r.alias;return H=U,j=[F=(0,r.klass)(U[0],null,"StringScanner")].concat(H),Z=r.$r(j),(W=F.$$prototype).pos=W.string=W.working=W.matched=W.prev_pos=W.match=t,F.$attr_reader("pos","matched"),e(F,"$initialize",function(_){var u=this;return u.string=_,u.pos=0,u.matched=t,u.working=_,u.match=[]},1),F.$attr_reader("string"),e(F,"$beginning_of_line?",function(){var _=this;return 0===_.pos||"\n"===_.string.charAt(_.pos-1)},0),e(F,"$scan",function(_){var u=this,R=(_=u.$anchor(_)).exec(u.working);return null==R?u.matched=t:"object"==typeof R?(u.prev_pos=u.pos,u.pos+=R[0].length,u.working=u.working.substring(R[0].length),u.matched=R[0],u.match=R,R[0]):"string"==typeof R?(u.pos+=R.length,u.working=u.working.substring(R.length),R):t},1),e(F,"$scan_until",function(_){var u=this;_=u.$anchor(_);for(var N,R=u.pos,z=u.working;;){if(N=_.exec(z),R+=1,z=z.substr(1),null!=N)return u.matched=u.string.substr(u.pos,R-u.pos-1+N[0].length),u.match=N,u.prev_pos=R-1,u.pos=R,u.working=z.substr(N[0].length),u.matched;if(0===z.length)return u.match=[],u.matched=t}},1),e(F,"$[]",function(_){var R;if(p(this.match["$empty?"]()))return t;w(Z("Symbol"),R=_)?_=_.$to_s():w(Z("String"),R)||(_=P["$coerce_to!"](_,Z("Integer"),"to_int"));var z=this.match;return _<0&&(_+=z.length),_<0||_>=z.length||null==z[_]?t:z[_]},1),e(F,"$check",function(_){var u=this,R=(_=u.$anchor(_)).exec(u.working);return u.matched=null==R?t:R[0]},1),e(F,"$check_until",function(_){var u=this,R=u.prev_pos,z=u.pos,N=u.$scan_until(_);return N!==t&&(u.matched=N.substr(-1),u.working=u.string.substr(z)),u.prev_pos=R,u.pos=z,N},1),e(F,"$peek",function(_){return this.working.substring(0,_)},1),e(F,"$eos?",function(){return 0===this.working.length},0),e(F,"$exist?",function(_){var R=_.exec(this.working);return null==R?t:0==R.index?0:R.index+1},1),e(F,"$skip",function(_){var u=this,R=(_=u.$anchor(_)).exec(u.working);if(null==R)return u.match=[],u.matched=t;var z=R[0],N=z.length;return u.matched=z,u.match=R,u.prev_pos=u.pos,u.pos+=N,u.working=u.working.substring(N),N},1),e(F,"$skip_until",function(_){var R=this.$scan_until(_);return R===t?t:(this.matched=R.substr(-1),R.length)},1),e(F,"$get_byte",function(){var _=this,u=t;return _.pos<_.string.length?(_.prev_pos=_.pos,_.pos+=1,u=_.matched=_.working.substring(0,1),_.working=_.working.substring(1)):_.matched=t,u},0),e(F,"$match?",function(_){var u=this,R=(_=u.$anchor(_)).exec(u.working);return null==R?t:(u.prev_pos=u.pos,R[0].length)},1),e(F,"$pos=",function(_){var u=this;return _<0&&(_+=u.string.$length()),u.pos=_,u.working=u.string.slice(_)},1),e(F,"$matched_size",function(){return this.matched===t?t:this.matched.length},0),e(F,"$post_match",function(){var _=this;return _.matched===t?t:_.string.substr(_.pos)},0),e(F,"$pre_match",function(){var _=this;return _.matched===t?t:_.string.substr(0,_.prev_pos)},0),e(F,"$reset",function(){var _=this;return _.working=_.string,_.matched=t,_.pos=0},0),e(F,"$rest",function(){return this.working},0),e(F,"$rest?",function(){return 0!==this.working.length},0),e(F,"$rest_size",function(){return this.$rest().$size()},0),e(F,"$terminate",function(){var u,_=this;return _.match=t,u=[_.string.$length()],s(_,"pos=",B(u)),u[K(u.length,1)]},0),e(F,"$unscan",function(){var _=this;return _.pos=_.prev_pos,_.prev_pos=t,_.match=t,_},0),C(F,"bol?","beginning_of_line?"),C(F,"getch","get_byte"),F.$private(),e(F,"$anchor",function(_){var u=_.toString().match(/\/([^\/]+)$/);return u=u?u[1]:void 0,new RegExp("^(?:"+_.source+")",u)},1)},Opal.modules["bcdice/normalize"]=function(r){var s,A,K,U=[],t=r.nil,v=r.module,e=r.eqeqeq,p=r.def,w=r.eqeq;return s=U,K=[v(U[0],"BCDice")].concat(s),(A=v(K[0],"Normalize")).$module_function(),p(A,"$comparison_operator",function(H){var F;return e(/<=|=</,F=H)?"<=":e(/>=|=>/,F)?">=":e(/<>|!=|=!/,F)?"!=":e(/</,F)?"<":e(/>/,F)?">":e(/=/,F)?"==":t},1),p(A,"$target_number",function(H){return w(H,"?")?H:H.$to_i()},1)},Opal.modules["bcdice/command/lexer"]=function(r){var A,j,u,R,z,N,T,W,H,U=r.top,t=[],v=r.nil,e=r.module,p=r.klass,w=r.const_set,P=r.hash2,s=r.truthy,B=r.send,K=r.def;return U.$require("strscan"),U.$require("bcdice/normalize"),A=t,j=H=[e(t[0],"BCDice")].concat(A),u=W=[e(H[0],"Command")].concat(j),z=[R=p(W[0],null,"Lexer")].concat(u),N=r.$r(z),(T=R.$$prototype).scanner=T.notations=v,w(z[0],"SYMBOLS",P(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),K(R,"$initialize",function(x,y){var f,o,c;return x=s(c=(o=(f=x)===v||null==f?v:B(f,"split",[" ",2]))===v||null==o?v:B(o,"first",[]))?c:"",this.scanner=N("StringScanner").$new(x),this.notations=B(y,"map",[],function(n){return null==n&&(n=v),s(n["$is_a?"](N("String")))?N("Regexp").$new(n):n},1)},2),K(R,"$next_token",function(){try{var x=this,y=v,f=v,a=v,c=v;return s(x.scanner["$eos?"]())?[!1,"$"]:(B(x.notations,"each",[],function $(n){var m,i=null==$.$$s?this:$.$$s;if(null==i.scanner&&(i.scanner=v),null==n&&(n=v),m=i.scanner.$scan(n),!s(m))return v;r.ret(["NOTATION",m])},{$$arity:1,$$s:x}),s(y=x.scanner.$scan(/\d+/))?["NUMBER",y.$to_i()]:s(f=x.scanner.$scan(/[<>!=]+/))?(f=N("Normalize").$comparison_operator(f),[s(f)?"CMP_OP":"ILLEGAL",f]):(a=x.scanner.$getch().$upcase(),[s(c=N("SYMBOLS")["$[]"](a))?c:a.$to_sym(),a]))}catch($){if($===r.returner)return $.$v;throw $}},0),K(R,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/command/parsed"]=function(r){var B,G,W,E,_,u,R,F,C,U=[],t=r.nil,v=r.module,e=r.klass,p=r.def,w=r.truthy,P=r.eqeqeq;return B=U,G=C=[v(U[0],"BCDice")].concat(B),W=F=[v(C[0],"Command")].concat(G),_=[E=e(F[0],null,"Parsed")].concat(W),u=r.$r(_),(R=E.$$prototype).question_target=R.critical=R.fumble=R.dollar=R.modify_number=R.target_number=R.prefix_number=R.command=R.suffix_number=R.cmp_op=t,E.$attr_accessor("command"),E.$attr_accessor("prefix_number"),E.$attr_accessor("suffix_number"),E.$attr_accessor("critical"),E.$attr_accessor("fumble"),E.$attr_accessor("dollar"),E.$attr_accessor("modify_number"),E.$attr_accessor("cmp_op"),E.$attr_accessor("target_number"),E.$attr_writer("question_target"),p(E,"$initialize",function(){var N=this;return N.prefix_number=t,N.suffix_number=t,N.critical=t,N.fumble=t,N.dollar=t,N.cmp_op=t,N.target_number=t,N.question_target=!1},0),p(E,"$question_target?",function(){return this.question_target},0),p(E,"$to_s",function(N){var a,T=this,d=t,x=t,y=t,f=t,o=t;return null==N&&(N="after_command"),d=w(T.critical)?"@"+T.critical:t,x=w(T.fumble)?"#"+T.fumble:t,y=w(T.dollar)?"$"+T.dollar:t,f=u("Format").$modifier(T.modify_number),o=w(T.question_target)?"?":T.target_number,P("after_command",a=N)?[T.prefix_number,T.command,T.suffix_number,d,x,y,f,T.cmp_op,o].$join():P("after_modify_number",a)?[T.prefix_number,T.command,T.suffix_number,f,d,x,y,T.cmp_op,o].$join():P("after_target_number",a)?[T.prefix_number,T.command,T.suffix_number,f,T.cmp_op,o,d,x,y].$join():t},-1)},Opal.modules["bcdice/command/parser"]=function(r){var u,T,a,i,m,L,g,k,M,h,l,I,re,c,$,n,Q,x,y,z,U=r.top,t=[],v=r.$r(t),e=r.nil,p=r.$$$,w=r.klass,P=r.module,s=r.hash2,B=r.send2,K=r.find_super,C=r.def,A=r.send,G=r.to_a,H=r.rb_minus,F=r.eqeq,j=r.hash,Z=r.const_set,W=r.truthy,E=r.to_ary;return U.$require("racc/parser.rb"),U.$require("bcdice/arithmetic/node"),U.$require("bcdice/command/lexer"),U.$require("bcdice/command/parsed"),w(p(v("BCDice"),"Command"),p(v("Racc"),"Parser"),"Parser"),u=t,T=z=[P(t[0],"BCDice")].concat(u),x=[P(z[0],"Command")].concat(T),y=r.$r(x),a=x,$=[c=w(x[0],p(y("Racc"),"Parser"),"Parser")].concat(a),n=r.$r($),(Q=c.$$prototype).notations=Q.lexer=Q.modifier=Q.suffix_number=Q.prefix_number=Q.need_suffix_number=Q.need_prefix_number=Q.critical=Q.fumble=Q.dollar=Q.allowed_cmp_op=Q.question_target=e,C(c,"$initialize",function X(S,J){var D,q,ne,$e,Y=this;if(delete X.$$p,D=r.slice.call(arguments),null==(q=r.extract_kwargs(D)))q=s([],{});else if(!q.$$is_hash)throw r.ArgumentError.$new("expected kwargs");if(ne=D,!r.hasOwnProperty.call(q.$$smap,"round_type"))throw r.ArgumentError.$new("missing keyword: round_type");return $e=q.$$smap.round_type,B(Y,K(Y,"initialize",X,!1,!0),"initialize",[],null),Y.notations=ne,Y.round_type=$e,Y.prefix_number=!1,Y.suffix_number=!1,Y.need_prefix_number=!1,Y.need_suffix_number=!1,Y.modifier=!0,Y.critical=!1,Y.fumble=!1,Y.dollar=!1,Y.allowed_cmp_op=[e,">=",">","<=","<","==","!="],Y.question_target=!1},-2),C(c,"$disable_modifier",function(){return this.modifier=!1,this},0),C(c,"$enable_prefix_number",function(){return this.prefix_number=!0,this},0),C(c,"$enable_suffix_number",function(){return this.suffix_number=!0,this},0),C(c,"$has_prefix_number",function(){var S=this;return S.prefix_number=!0,S.need_prefix_number=!0,S},0),C(c,"$has_suffix_number",function(){var S=this;return S.suffix_number=!0,S.need_suffix_number=!0,S},0),C(c,"$enable_critical",function(){return this.critical=!0,this},0),C(c,"$enable_fumble",function(){return this.fumble=!0,this},0),C(c,"$enable_dollar",function(){return this.dollar=!0,this},0),C(c,"$restrict_cmp_op_to",function(S){var J,q=this;return J=r.slice.call(arguments),q.allowed_cmp_op=J,q},-1),C(c,"$enable_question_target",function(){return this.question_target=!0,this},0),C(c,"$parse",function(S){var J=this;try{return J.lexer=n("Lexer").$new(S,J.notations),J.$do_parse()}catch(D){if(!r.rescue(D,[n("ParseError"),n("ZeroDivisionError")]))throw D;try{return e}finally{r.pop_exception()}}},1),c.$private(),C(c,"$parsed",function(S,J,D,q){return A(n("Parsed").$new(),"tap",[],function $e(ee){var Y,ce,se,le,_e,ue,ae=null==$e.$$s?this:$e.$$s,te=e;return null==ae.round_type&&(ae.round_type=e),null==ee&&(ee=e),te=[S["$[]"]("command")],A(ee,"command=",G(te)),H(te.length,1),te=[(Y=S["$[]"]("prefix"),Y===e||null==Y?e:A(Y,"eval",[ae.round_type]))],A(ee,"prefix_number=",G(te)),H(te.length,1),te=[(ce=S["$[]"]("suffix"),ce===e||null==ce?e:A(ce,"eval",[ae.round_type]))],A(ee,"suffix_number=",G(te)),H(te.length,1),te=[(se=J["$[]"]("critical"),se===e||null==se?e:A(se,"eval",[ae.round_type]))],A(ee,"critical=",G(te)),H(te.length,1),te=[(le=J["$[]"]("fumble"),le===e||null==le?e:A(le,"eval",[ae.round_type]))],A(ee,"fumble=",G(te)),H(te.length,1),te=[(_e=J["$[]"]("dollar"),_e===e||null==_e?e:A(_e,"eval",[ae.round_type]))],A(ee,"dollar=",G(te)),H(te.length,1),te=[D.$eval(ae.round_type)],A(ee,"modify_number=",G(te)),H(te.length,1),te=[q["$[]"]("cmp_op")],A(ee,"cmp_op=",G(te)),H(te.length,1),F(q["$[]"]("target"),"?")?(A(ee,"question_target=",G(te=[!0])),H(te.length,1),A(ee,"target_number=",G(te=[0])),te[H(te.length,1)]):(A(ee,"question_target=",G(te=[!1])),H(te.length,1),te=[(ue=q["$[]"]("target"),ue===e||null==ue?e:A(ue,"eval",[ae.round_type]))],A(ee,"target_number=",G(te)),te[H(te.length,1)])},{$$arity:1,$$s:this})},4),C(c,"$next_token",function(){return this.lexer.$next_token()},0),i=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,33,34,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,e,e,17,18,6,e,5,e,e,17,18,e,e,5,23,24,25,26,56,54,55,57],m=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,e,17,15,15,18,18,23,e,18,30,30,23,23,24,e,23,31,31,24,24,25,e,24,44,44,25,25,28,e,25,47,47,28,28,29,e,28,48,48,29,29,33,e,29,49,49,33,33,34,e,33,50,50,34,34,36,e,34,e,e,36,36,37,e,36,e,e,37,37,e,e,37,27,27,27,27,52,52,52,52],L=[-2,4,16,-3,-1,11,e,33,13,35,23,30,1,e,28,40,e,37,44,e,e,-2,e,51,58,65,0,106,72,79,47,54,e,86,93,e,100,107,e,e,e,e,e,e,63,e,e,68,75,82,89,e,120,e,e,e,e,e],g=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],k=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,e,e,21,47,48,40,51,52,49,50,44,46,3,e,e,e,13,e,e,e,e,e,e,e,32],M=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,e,e,4,8,8,5,7,7,8,8,9,5,6,e,e,e,6,e,e,e,e,e,e,e,6],h=[e,6,13,3,9,-1,27,-15,-10,-1,-38],l=[e,e,e,e,e,e,19,16,15,e,e],I=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],re=j(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),Z($[0],"Racc_arg",[i,m,g,L,k,M,l,h,19,I,re,58,35,!0]),Z($[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),Z($[0],"Racc_debug_parser",!1),C(c,"$_reduce_1",function(S,J,D){var q;return W(this.modifier)||this.$raise(n("ParseError")),q=E(S),this.$parsed(null==q[0]?e:q[0],null==q[1]?e:q[1],null==q[2]?e:q[2],null==q[3]?e:q[3])},3),C(c,"$_reduce_2",function(S,J,D){var q;return W(this.modifier)||this.$raise(n("ParseError")),q=E(S),this.$parsed(null==q[0]?e:q[0],null==q[2]?e:q[2],null==q[1]?e:q[1],null==q[3]?e:q[3])},3),C(c,"$_reduce_3",function(S,J,D){var q,ce;return ce=null==(q=E(S))[2]?e:q[2],this.$parsed(null==q[0]?e:q[0],null==q[1]?e:q[1],p(p(n("Arithmetic"),"Node"),"Number").$new(0),ce)},3),C(c,"$_reduce_4",function(S,J,D){var q=this;return W(q.prefix_number)&&W(q.suffix_number)||q.$raise(n("ParseError")),s(["command","prefix","suffix"],{command:S["$[]"](1),prefix:S["$[]"](0),suffix:S["$[]"](2)})},3),C(c,"$_reduce_5",function(S,J,D){var q=this;return W(q.prefix_number)||q.$raise(n("ParseError")),W(q.need_suffix_number)&&q.$raise(n("ParseError")),s(["command","prefix"],{command:S["$[]"](1),prefix:S["$[]"](0)})},3),C(c,"$_reduce_6",function(S,J,D){var q=this;return W(q.suffix_number)||q.$raise(n("ParseError")),W(q.need_prefix_number)&&q.$raise(n("ParseError")),s(["command","suffix"],{command:S["$[]"](0),suffix:S["$[]"](1)})},3),C(c,"$_reduce_7",function(S,J,D){var q=this;return(W(q.need_prefix_number)||W(q.need_suffix_number))&&q.$raise(n("ParseError")),s(["command"],{command:S["$[]"](0)})},3),C(c,"$_reduce_8",function(S,J,D){return s([],{})},3),C(c,"$_reduce_9",function(S,J,D){var q,ce,se,ee=e;return ee=null==(q=E(S))[0]?e:q[0],ce=null==q[2]?e:q[2],W(this.critical)&&W(ee["$[]"]("critical")["$nil?"]())||this.$raise(n("ParseError")),A(ee,"[]=",G(se=["critical",ce])),H(se.length,1),ee},3),C(c,"$_reduce_10",function(S,J,D){var q,ce,se,ee=e;return ee=null==(q=E(S))[0]?e:q[0],ce=null==q[2]?e:q[2],W(this.fumble)&&W(ee["$[]"]("fumble")["$nil?"]())||this.$raise(n("ParseError")),A(ee,"[]=",G(se=["fumble",ce])),H(se.length,1),ee},3),C(c,"$_reduce_11",function(S,J,D){var q,ce,se,ee=e;return ee=null==(q=E(S))[0]?e:q[0],ce=null==q[2]?e:q[2],W(this.dollar)&&W(ee["$[]"]("dollar")["$nil?"]())||this.$raise(n("ParseError")),A(ee,"[]=",G(se=["dollar",ce])),H(se.length,1),ee},3),C(c,"$_reduce_12",function(S,J,D){return S["$[]"](1)},3),C(c,"$_reduce_13",function(S,J,D){return p(p(n("Arithmetic"),"Node"),"Negative").$new(S["$[]"](1))},3),C(c,"$_reduce_14",function(S,J,D){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(S["$[]"](0),"+",S["$[]"](2))},3),C(c,"$_reduce_15",function(S,J,D){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(S["$[]"](0),"-",S["$[]"](2))},3),C(c,"$_reduce_16",function(S,J,D){return W(this.allowed_cmp_op["$include?"](e))||this.$raise(n("ParseError")),s([],{})},3),C(c,"$_reduce_17",function(S,J,D){var q,ee,Y;return Y=null==(q=E(S))[1]?e:q[1],W(this.allowed_cmp_op["$include?"](ee=null==q[0]?e:q[0]))||this.$raise(n("ParseError")),s(["cmp_op","target"],{cmp_op:ee,target:Y})},3),C(c,"$_reduce_18",function(S,J,D){var ne,q=this;return ne=S["$[]"](0),W(q.question_target)||q.$raise(n("ParseError")),W(q.allowed_cmp_op["$include?"](ne))||q.$raise(n("ParseError")),s(["cmp_op","target"],{cmp_op:ne,target:"?"})},3),C(c,"$_reduce_19",function(S,J,D){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(S["$[]"](0),"+",S["$[]"](2))},3),C(c,"$_reduce_20",function(S,J,D){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(S["$[]"](0),"-",S["$[]"](2))},3),C(c,"$_reduce_22",function(S,J,D){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(S["$[]"](0),"*",S["$[]"](2))},3),C(c,"$_reduce_23",function(S,J,D){return S["$[]"](3).$new(S["$[]"](0),S["$[]"](2))},3),C(c,"$_reduce_25",function(S,J,D){return p(p(n("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),C(c,"$_reduce_26",function(S,J,D){return p(p(n("Arithmetic"),"Node"),"DivideWithCeil")},3),C(c,"$_reduce_27",function(S,J,D){return p(p(n("Arithmetic"),"Node"),"DivideWithCeil")},3),C(c,"$_reduce_28",function(S,J,D){return p(p(n("Arithmetic"),"Node"),"DivideWithRound")},3),C(c,"$_reduce_29",function(S,J,D){return p(p(n("Arithmetic"),"Node"),"DivideWithFloor")},3),C(c,"$_reduce_30",function(S,J,D){return S["$[]"](1)},3),C(c,"$_reduce_31",function(S,J,D){return p(p(n("Arithmetic"),"Node"),"Negative").$new(S["$[]"](1))},3),C(c,"$_reduce_33",function(S,J,D){return S["$[]"](1)},3),C(c,"$_reduce_34",function(S,J,D){return p(p(n("Arithmetic"),"Node"),"Number").$new(S["$[]"](0))},3),C(c,"$_reduce_none",function(S,J,D){return S["$[]"](0)},3)},Opal.modules["bcdice/deprecated/checker"]=function(r){var B,G,Z,W,E,_,F,C,U=[],t=r.nil,v=r.module,e=r.send,p=r.eqeqeq,w=r.truthy,P=r.def;return B=U,G=C=[v(U[0],"BCDice")].concat(B),Z=F=[v(C[0],"Deprecated")].concat(G),E=[W=v(F[0],"Checker")].concat(Z),_=r.$r(E),W.$private(),P(W,"$check_result_legacy",function(R,z,N,T){var f,d=this,x=t,y=t,o=t,a=t;return x=e(z,"map",[],"sides".$to_proc()),f=(y=e(z,"map",[],"value".$to_proc())).$sum(),o=p([100],a=x)?d.$check_1D100(R,f,N,T):p([20],a)?d.$check_1D20(R,f,N,T):p([6,6],a)?d.$check_2D6(R,f,y,N,T):t,(w(o["$nil?"]())||w(o["$empty?"]()))&&(o=p([10],a=x.$uniq())?d.$check_nD10(R,f,y,N,T):p([6],a)?d.$check_nD6(R,f,y,N,T):t,w(o["$nil?"]())||w(o["$empty?"]()))?t:_("Result").$new(o.$delete_prefix(" \uff1e "))},4),P(W,"$check_1D100",function(R,z,N,T){return t},4),P(W,"$check_1D20",function(R,z,N,T){return t},4),P(W,"$check_nD10",function(R,z,N,T,d){return t},5),P(W,"$check_2D6",function(R,z,N,T,d){return t},5),P(W,"$check_nD6",function(R,z,N,T,d){return t},5)},Opal.modules["bcdice/base"]=function(r){var z,y,$,i,m,f,o,a,c,T,U=r.top,t=[],v=r.$r(t),e=r.nil,p=r.$$$,w=r.module,P=r.klass,s=r.truthy,B=r.def,K=r.regexp,C=r.rb_plus,A=r.send,G=r.to_a,H=r.rb_minus,F=r.eqeqeq,j=r.eqeq,Z=r.range,W=r.rb_divide,E=r.rb_times,_=r.rb_ge,u=e;return U.$require("i18n"),U.$require("i18n/backend/fallbacks"),U.$require("bcdice/randomizer"),U.$require("bcdice/dice_table"),U.$require("bcdice/enum"),U.$require("bcdice/translate"),U.$require("bcdice/result"),U.$require("bcdice/command/parser"),U.$require("bcdice/deprecated/checker"),z=t,y=T=[w(t[0],"BCDice")].concat(z),o=[f=P(T[0],null,"Base")].concat(y),a=r.$r(o),(c=f.$$prototype).sort_add_dice=c.sort_barabara_dice=c.enabled_d9=c.raw_input=c.randomizer=c.enabled_upcase_input=c.debug=e,i=[$=r.get_singleton_class(f)].concat(o),m=r.$r(i),$.$attr_reader("prefixes"),B($,"$register_prefix",function(g){var M,h=this,l=e;return null==h.prefixes&&(h.prefixes=e),M=r.slice.call(arguments),h.prefixes=s(l=h.prefixes)?l:[],h.prefixes.$concat(M.$flatten())},-1),B($,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())},0),B($,"$prefixes_pattern",function(){var g=this,k=e;return null==g.prefixes_pattern&&(g.prefixes_pattern=e),null==g.prefixes&&(g.prefixes=e),g.prefixes_pattern=s(k=g.prefixes_pattern)?k:e,s(g.prefixes_pattern)?g.prefixes_pattern:(g.prefixes=s(k=g.prefixes)?k:[],g.prefixes.$freeze(),g.prefixes_pattern=(s(g.prefixes["$empty?"]())?/(?!)/:K(["^(S)?(",g.prefixes.$join("|"),")"],"i")).$freeze())},0),B($,"$command_pattern",function(){var g=this,k=e,M=e;return null==g.command_pattern&&(g.command_pattern=e),null==g.prefixes&&(g.prefixes=e),g.command_pattern=s(k=g.command_pattern)?k:e,s(g.command_pattern)?g.command_pattern:(g.prefixes=s(k=g.prefixes)?k:[],g.prefixes.$freeze(),M=C(A(p(m("CommonCommand"),"COMMANDS"),"map",[],function(l){return null==l&&(l=e),p(l,"PREFIX_PATTERN").$source()},1),g.prefixes),g.command_pattern=K(["^S?(",M.$join("|"),")"],"i").$freeze())},0),B($,"$eval",function(g){return this.$new(g).$eval()},1),f.$include(a("Translate")),f.$include(p(a("Deprecated"),"Checker")),B(f,"$initialize",function(n){var i=this;return i.raw_input=n,i.sort_add_dice=!1,i.sort_barabara_dice=!1,i.d66_sort_type=p(a("D66SortType"),"NO_SORT"),i.enabled_d9=!1,i.round_type=p(a("RoundType"),"FLOOR"),i.sides_implicit_d=6,i.upper_dice_reroll_threshold=e,i.reroll_dice_reroll_threshold=e,i.default_cmp_op=e,i.default_target_number=e,i.enabled_upcase_input=!0,i.locale="ja_jp",i.randomizer=p(a("BCDice"),"Randomizer").$new(),i.debug=!1},1),f.$attr_accessor("randomizer"),f.$attr_reader("d66_sort_type"),f.$attr_reader("round_type"),f.$attr_reader("sides_implicit_d"),f.$attr_reader("upper_dice_reroll_threshold"),f.$attr_reader("reroll_dice_reroll_threshold"),f.$attr_reader("default_cmp_op"),f.$attr_reader("default_target_number"),B(f,"$sort_add_dice?",function(){return this.sort_add_dice},0),B(f,"$sort_barabara_dice?",function(){return this.sort_barabara_dice},0),B(f,"$enabled_d9?",function(){return this.enabled_d9},0),B(f,"$enable_debug",function(){return this.debug=!0},0),B(f,"$eval",function(){var i,m,L,n=this,g=e;return i=p(a("BCDice"),"Preprocessor").$process(n.raw_input,n),m=s(L=n.$dice_command(i))?L:n.$eval_common_command(n.raw_input),s(m)?(g=[n.randomizer.$rand_results()],A(m,"rands=",G(g)),H(g.length,1),g=[n.randomizer.$detailed_rand_results()],A(m,"detailed_rands=",G(g)),H(g.length,1),m):e},0),B(f,"$change_text",function(n){return n},1),B(f,"$check_result",function(n,i,m,L){var g=this,k=e,M=e,h=e,l=e,I=e;return k=g.$check_result_legacy(n,i,m,L),s(k)?k:(M=A(i,"map",[],"sides".$to_proc()),l=(h=A(i,"map",[],"value".$to_proc())).$sum(),k=F([100],I=M)?g.$result_1d100(n,l,m,L):F([20],I)?g.$result_1d20(n,l,m,L):F([6,6],I)?g.$result_2d6(n,l,h,m,L):e,j(k,a("Result").$nothing())?e:s(k)?k:(k=F([10],I=M.$uniq())?g.$result_nd10(n,l,h,m,L):F([6],I)?g.$result_nd6(n,l,h,m,L):e,j(k,a("Result").$nothing())?e:s(k)?k:g.$result_ndx(n,m,L)))},4),B(f,"$grich_text",function(n,i,m){return e},3),f.$private(),B(f,"$eval_common_command",function(n){try{return n=this.$change_text(n),A(p(a("CommonCommand"),"COMMANDS"),"each",[],function m(L){var k,g=null==m.$$s?this:m.$$s;if(null==g.randomizer&&(g.randomizer=e),null==L&&(L=e),k=L.$eval(n,g,g.randomizer),!s(k))return e;r.ret(k)},{$$arity:1,$$s:this}),e}catch(m){if(m===r.returner)return m.$v;throw m}},1),B(f,"$dice_command",function(n){var i=this,m=e,L=e,g=e,k=e,M=e;return s(i.enabled_upcase_input)&&(n=n.$upcase()),m=i.$class().$prefixes_pattern().$match(n),s(m)?(L=m["$[]"](1)["$nil?"]()["$!"](),s(L)&&(n=n["$[]"](Z(1,-1,!1))),g=i.$eval_game_system_specific_command(n),s(g["$is_a?"](a("Result")))?(k=[s(M=g["$secret?"]())?M:L],A(g,"secret=",G(k)),H(k.length,1),g):s(g["$nil?"]())||s(g["$empty?"]())||j(g,"1")?e:A(a("Result").$new(),"tap",[],function(l){return null==l&&(l=e),k=[g.$to_s()],A(l,"text=",G(k)),H(k.length,1),A(l,"secret=",G(k=[L])),k[H(k.length,1)]},1)):e},1),B(f,"$eval_game_system_specific_command",function(n){return e},1),B(f,"$result_ndx",function(n,i,m){return s(m["$is_a?"](a("String")))?e:s(n.$send(i,m))?a("Result").$success(this.$translate("success")):a("Result").$failure(this.$translate("failure"))},3),B(f,"$result_1d100",function(n,i,m,L){return e},4),B(f,"$result_1d20",function(n,i,m,L){return e},4),B(f,"$result_nd10",function(n,i,m,L,g){return e},5),B(f,"$result_2d6",function(n,i,m,L,g){return e},5),B(f,"$result_nd6",function(n,i,m,L,g){return e},5),B(f,"$get_table_by_2d6",function(n){return this.$get_table_by_nD6(n,2)},1),B(f,"$get_table_by_1d6",function(n){return this.$get_table_by_nD6(n,1)},1),B(f,"$get_table_by_nD6",function(n,i){return this.$get_table_by_nDx(n,i,6)},2),B(f,"$get_table_by_nDx",function(n,i,m){var g,k=e;return g=this.randomizer.$roll_sum(i,m),k=this.$get_table_value(n["$[]"](H(g,i))),s(k["$nil?"]())?["1",0]:[k,g]},3),B(f,"$get_table_by_1d3",function(n){var L,g,i=this,k=e;return i.$debug("get_table_by_1d3"),L=i.randomizer.$roll_sum(1,6),i.$debug("num",L),g=W(H(L,1),2).$to_i(),i.$debug("index",g),k=n["$[]"](g),s(k["$nil?"]())?["1",0]:[k,L]},1),B(f,"$get_table_by_d66_swap",function(n){var m;return m=this.randomizer.$roll_d66(p(a("D66SortType"),"ASC")),[this.$get_table_by_number(m,n),m]},1),B(f,"$get_table_by_d66",function(n){var m,L,g,M,k=e;return m=this.randomizer.$roll_once(6),L=this.randomizer.$roll_once(6),g=C(E(H(m,1),6),H(L,1)),k=n["$[]"](g),M=""+m+L,s(k["$nil?"]())?["1",M]:[k,M]},1),B(f,"$get_table_by_number",function(n,i,m){try{return null==m&&(m="1"),A(i,"each",[],function g(k){var h,M=null==g.$$s?this:g.$$s;if(null==k&&(k=e),h=k["$[]"](0),!s(_(h,n)))return e;r.ret(M.$get_table_value(k["$[]"](1)))},{$$arity:1,$$s:this}),this.$get_table_value(m)}catch(g){if(g===r.returner)return g.$v;throw g}},-3),B(f,"$get_table_value",function(n){return s(n["$is_a?"](a("Proc")))?n.$call():n},1),B(f,"$roll_tables",function(n,i){var L=e;return L=i["$[]"](n),s(L)?L.$roll(this.randomizer).$to_s():e},2),B(f,"$debug",function(n,i){var L,g=this,k=e,M=e;return L=r.slice.call(arguments,1),s(g.debug)?(k=s(n["$is_a?"](a("String")))?n:n.$inspect(),s(L["$empty?"]())?g.$warn(k):(M=A(L,"map",[],function(l){return null==l&&(l=e),s(l["$is_a?"](a("String")))?'"'+l+'"':l.$inspect()},1),g.$warn(k+": "+M.$join(", ")))):e},-2),p(p(v("I18n"),"Backend"),"Simple").$include(p(p(v("I18n"),"Backend"),"Fallbacks")),v("I18n").$load_path()["$<<"](v("Dir")["$[]"](v("File").$join("bcdice","../../i18n/**/*.yml"))),u=["ja_jp"],A(v("I18n"),"default_locale=",G(u)),H(u.length,1),u=[["ja_jp"]],A(v("I18n").$fallbacks(),"defaults=",G(u)),u[H(u.length,1)]},Opal.modules["bcdice/game_system/MagicaLogia"]=function(r){var z,x,a,c,$,M,h,l,I,b,n,i,m,f,o,T,t=[],v=r.nil,e=r.$$$,p=r.module,w=r.klass,P=r.const_set,s=r.send2,B=r.find_super,K=r.def,C=r.eqeq,A=r.truthy,G=r.rb_le,H=r.rb_ge,F=r.rb_plus,j=r.send,Z=r.to_a,W=r.rb_minus,E=r.hash2,_=r.defs,u=r.to_ary;return r.top.$require("bcdice/base"),z=t,x=T=[p(t[0],"BCDice")].concat(z),f=[p(T[0],"GameSystem")].concat(x),o=r.$r(f),a=f[0],c=o("Base"),$=f,i=[n=w(a,c,"MagicaLogia")].concat($),m=r.$r(i),n.$$prototype.randomizer=v,P(i[0],"ID","MagicaLogia"),P(i[0],"NAME","\u30de\u30ae\u30ab\u30ed\u30ae\u30a2"),P(i[0],"SORT_KEY","\u307e\u304d\u304b\u308d\u304d\u3042"),P(i[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\n\u30b9\u30da\u30b7\u30e3\u30eb\uff0f\u30d5\u30a1\u30f3\u30d6\u30eb\uff0f\u6210\u529f\uff0f\u5931\u6557\u3092\u5224\u5b9a\n\u30fb\u5404\u7a2e\u8868\n\u7d4c\u6b74\u8868\u3000BGT/\u521d\u671f\u30a2\u30f3\u30ab\u30fc\u8868\u3000DAT/\u904b\u547d\u5c5e\u6027\u8868\u3000FAT\n\u9858\u3044\u8868\u3000WIT/\u30d7\u30e9\u30a4\u30ba\u8868\u3000PT\n\u6642\u306e\u6d41\u308c\u8868\u3000TPT/\u5927\u5224\u6642\u306e\u6d41\u308c\u8868\u3000TPTB\n\u4e8b\u4ef6\u8868\u3000AT\n\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000FT\uff0f\u5909\u8abf\u8868\u3000WT\n\u904b\u547d\u5909\u8ee2\u8868\u3000FCT\n\u3000\u5178\u578b\u7684\u707d\u5384 TCT\uff0f\u7269\u7406\u7684\u707d\u5384 PCT\uff0f\u7cbe\u795e\u7684\u707d\u5384 MCT\uff0f\u72c2\u6c17\u7684\u707d\u5384 ICT\n\u3000\u793e\u4f1a\u7684\u707d\u5384 SCT\uff0f\u8d85\u5e38\u7684\u707d\u5384 XCT\uff0f\u4e0d\u601d\u8b70\u7cfb\u707d\u5384 WCT\uff0f\u30b3\u30df\u30ab\u30eb\u7cfb\u707d\u5384 CCT\n\u3000\u9b54\u6cd5\u4f7f\u3044\u306e\u707d\u5384 MGCT\n\u30b7\u30fc\u30f3\u8868\u3000ST\uff0f\u5927\u5224\u30b7\u30fc\u30f3\u8868\u3000STB\n\u3000\u6975\u9650\u74b0\u5883 XEST\uff0f\u5185\u9762\u4e16\u754c IWST\uff0f\u9b54\u6cd5\u90fd\u5e02 MCST\n\u3000\u6b7b\u5f8c\u4e16\u754c WDST\uff0f\u8ff7\u5bae\u4e16\u754c LWST\n\u3000\u9b54\u6cd5\u66f8\u67b6 MBST\uff0f\u9b54\u6cd5\u5b66\u9662 MAST\uff0f\u30af\u30ec\u30c9\u306e\u5854 TCST\n\u3000\u4e26\u884c\u4e16\u754c PWST\uff0f\u7d42\u672b\u3000\u3000 PAST\uff0f\u7570\u4e16\u754c\u9152\u5834 GBST\n\u3000\u307b\u3057\u304b\u3052 SLST\uff0f\u65e7\u56f3\u66f8\u9928 OLST\n\u4e16\u754c\u6cd5\u5247\u8ffd\u52a0\u8868 WLAT/\u3055\u307e\u3088\u3046\u602a\u7269\u8868 WMT\n\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868\u3000RCT\n\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868\u3000RTT\n\u3000\u661f\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTS, RTT1\n\u3000\u7363\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTB, RTT2\n\u3000\u529b\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTF, RTT3\n\u3000\u6b4c\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTP, RTT4\n\u3000\u5922\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTD, RTT5\n\u3000\u95c7\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTN, RTT6\n\u30d6\u30e9\u30f3\u30af\u79d8\u5bc6\u8868\u3000BST/\n\u3000\u5bbf\u6575\u8868\u3000MIT/\u8b00\u7565\u8868\u3000MOT/\u56e0\u7e01\u8868\u3000MAT\n\u3000\u5947\u4eba\u8868\u3000MUT/\u529b\u5834\u8868\u3000MFT/\u540c\u76df\u8868\u3000MLT\n\u843d\u82b1\u8868\u3000FFT\n\u305d\u306e\u5f8c\u8868 FLT\n\u30fbD66\u30c0\u30a4\u30b9\u3042\u308a\n"),K(n,"$initialize",function g(k){var h=this;return delete g.$$p,s(h,B(h,"initialize",g,!1,!0),"initialize",[k],null),h.sort_add_dice=!0,h.sort_barabara_dice=!0,h.d66_sort_type=e(m("D66SortType"),"ASC")},1),K(n,"$result_2d6",function(k,M,h,l,I){var b=this,O=v,re=v;return C(I,"?")||!C(l,">=")?v:(O=A(G(M,2))?m("Result").$fumble(b.$translate("fumble")):A(H(M,12))?m("Result").$critical(b.$translate("MagicaLogia.special")):A(H(k,I))?m("Result").$success(b.$translate("success")):m("Result").$failure(b.$translate("failure")),re=[F(O.$text(),b.$gain_magic_element(h["$[]"](0),h["$[]"](1)))],j(O,"text=",Z(re)),W(re.length,1),O)},5),K(n,"$eval_game_system_specific_command",function(k){var h,M=this;return A(h=e(M.$class(),"SKILL_TABLE").$roll_command(M.randomizer,k))?h:M.$roll_tables(k,e(M.$class(),"TABLES"))},1),n.$private(),K(n,"$gain_magic_element",function(k,M){var h=this,l=v;return C(k,M)?(l=h.$translate("MagicaLogia.elements.items")["$[]"](W(k,1)),F(" \uff1e ",h.$format(h.$translate("MagicaLogia.elements.format"),E(["text"],{text:l})))):""},2),M=i,l=[h=w(i[0],null,"SkillExpandTable")].concat(M),I=r.$r(l),(b=h.$$prototype).times=b.sides=b.items=b.name=b.skill_table=v,_(h,"$from_i18n",function(re,V,ie){var X=v;return X=I("I18n").$t(re,E(["locale","raise"],{locale:V,raise:!1})),this.$new(X["$[]"]("name"),X["$[]"]("type"),X["$[]"]("items"),ie)},3),K(h,"$initialize",function(re,V,ie,Q){var X=this,S=v;return X.name=re,X.items=ie.$freeze(),X.skill_table=Q,S=/(\d+)D(\d+)/i.$match(V),A(S)||X.$raise(I("ArgumentError"),"Unexpected table type: "+V),X.times=S["$[]"](1).$to_i(),X.sides=S["$[]"](2).$to_i()},4),K(h,"$roll",function(re){var ie,Q,V=this;return ie=re.$roll_sum(V.times,V.sides),Q=V.$expand(V.items["$[]"](W(ie,V.times)),re),e(I("DiceTable"),"RollResult").$new(V.name,ie,Q)},1),h.$private(),K(h,"$expand",function(re,V){return j(re,"gsub",[/%{([a-z]+)}/],function Q(){var J,X=null==Q.$$s?this:Q.$$s;return J=I("Regexp").$last_match()["$[]"](1).$to_sym(),X.$roll_skill(J,V)},{$$arity:0,$$s:this})},2),P(l[0],"CATEGORIES",["star","beast","force","poem","dream","night"].$freeze()),K(h,"$roll_skill",function(re,V){var Q=v;return C(re,"skill")?this.skill_table.$roll_skill(V):C(re,"element")?this.skill_table.$roll_category(V):(Q=I("CATEGORIES").$index(re),A(Q)||this.$raise(I("ArgumentError")),this.skill_table.$categories()["$[]"](Q).$roll(V).$name())},2),function(g,k,M){var h=w(g,null,"FallenAfterTable"),l=[h].concat(M),I=r.$r(l),b=h.$$prototype;b.lower=b.higher=b.name=v,_(h,"$from_i18n",function(re,V){var Q=v;return Q=I("I18n").$t(re,E(["locale","raise"],{locale:V,raise:!0})),this.$new(Q["$[]"]("name"),Q["$[]"]("items_lower"),Q["$[]"]("items_higher"))},2),K(h,"$initialize",function(re,V,ie){var Q=this;return Q.name=re,Q.lower=V,Q.higher=ie},3),K(h,"$roll",function(re){var V,ie,X,S,Q=this,J=v;return ie=re.$roll_barabara(2,6),S=null==(V=u(ie))[1]?v:V[1],J=A(G(X=null==V[0]?v:V[0],3))?Q.lower:Q.higher,Q.name+"("+X+","+S+") \uff1e "+J["$[]"](W(S,1))},1)}(i[0],0,i),function(g,k){var M=[g].concat(k),h=r.$r(M);g.$private(),K(g,"$translate_skill_table",function(I){return e(h("DiceTable"),"SaiFicSkillTable").$from_i18n("MagicaLogia.skill_table",I,E(["rttn"],{rttn:["RTS","RTB","RTF","RTP","RTD","RTN"]}))},1),K(g,"$translate_tables",function(I,b){var O,re,V,ie,Q,X;return O=h("SkillExpandTable").$from_i18n("MagicaLogia.inveterate_enemy_table",I,b),re=e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.conspiracy_table",I),V=e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.fate_table",I),ie=e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.cueball_table",I),Q=e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.force_field_table",I),X=h("SkillExpandTable").$from_i18n("MagicaLogia.alliance_table",I,b),E(["TPT","ST","FT","WT","FCT","AT","BGT","DAT","FAT","WIT","TCT","PCT","MCT","ICT","SCT","XCT","WCT","CCT","MIT","MOT","MAT","MUT","MFT","MLT","BST","PT","XEST","IWST","MCST","WDST","LWST","STB","MGCT","MBST","MAST","TCST","PWST","PAST","GBST","SLST","WLAT","WMT","FFT","OLST","TPTB","FLT"],{TPT:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.TPT",I,b),ST:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.ST",I,b),FT:e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FT",I),WT:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.WT",I,b),FCT:e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FCT",I),AT:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.AT",I,b),BGT:e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.BGT",I),DAT:e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.DAT",I),FAT:e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FAT",I),WIT:e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WIT",I),TCT:e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.TCT",I),PCT:e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.PCT",I),MCT:e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.MCT",I),ICT:e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.ICT",I),SCT:e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.SCT",I),XCT:e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.XCT",I),WCT:e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WCT",I),CCT:e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.CCT",I),MIT:O,MOT:re,MAT:V,MUT:ie,MFT:Q,MLT:X,BST:e(h("DiceTable"),"ChainTable").$new(h("I18n").$translate("MagicaLogia.tables.BST.name",E(["raise","locale"],{raise:!0,locale:I})),"1D6",[O,re,V,ie,Q,X]),PT:e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.PT",I),XEST:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.XEST",I,b),IWST:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.IWST",I,b),MCST:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.MCST",I,b),WDST:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.WDST",I,b),LWST:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.LWST",I,b),STB:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.STB",I,b),MGCT:e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.MGCT",I),MBST:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.MBST",I,b),MAST:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.MAST",I,b),TCST:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.TCST",I,b),PWST:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.PWST",I,b),PAST:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.PAST",I,b),GBST:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.GBST",I,b),SLST:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.SLST",I,b),WLAT:e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WLAT",I),WMT:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.WMT",I,b),FFT:e(h("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FFT",I),OLST:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.OLST",I,b),TPTB:h("SkillExpandTable").$from_i18n("MagicaLogia.tables.TPTB",I,b),FLT:h("FallenAfterTable").$from_i18n("MagicaLogia.tables.FLT",I)})},2)}(r.get_singleton_class(n),i),P(i[0],"SKILL_TABLE",n.$translate_skill_table("ja_jp")),P(i[0],"TABLES",n.$translate_tables("ja_jp",m("SKILL_TABLE"))),n.$register_prefix(m("SKILL_TABLE").$prefixes()),n.$register_prefix(m("TABLES").$keys())},Opal.queue(function(r){var C,F,u,R,z,N,Z,W,G,t=[],e=r.module,p=r.klass,w=r.const_set,P=r.send2,s=r.find_super,B=r.def;return r.top.$require("bcdice/game_system/MagicaLogia"),C=t,F=G=[e(t[0],"BCDice")].concat(C),Z=[e(G[0],"GameSystem")].concat(F),W=r.$r(Z),u=Z,z=[R=p(Z[0],W("MagicaLogia"),"MagicaLogia_Korean")].concat(u),N=r.$r(z),w(z[0],"ID","MagicaLogia:Korean"),w(z[0],"NAME","\ub9c8\uae30\uce74\ub85c\uae30\uc544"),w(z[0],"SORT_KEY","\u56fd\u969b\u5316:Korean:\ub9c8\uae30\uce74\ub85c\uae30\uc544"),w(z[0],"HELP_MESSAGE","\u30fb\ud310\uc815\n\uc2a4\ud398\uc15c\uff0f\ud38c\ube14\uff0f\uc131\uacf5\uff0f\uc2e4\ud328\n\u30fb\uac01\uc885 \ud45c\n\uacbd\ub825 \ud45c BGT/ \ucd08\uae30 \uc575\ucee4 \ud45c DAT/ \uc6b4\uba85 \uc18d\uc131 \ud45c FAT\n\uc18c\uc6d0 \ud45c WIT/ \ud504\ub77c\uc774\uc988 \ud45c PT\n\uc2dc\uac04\uc758 \ud750\ub984 \ud45c(\uad6c\ud310) TPT/ \ub300\ud615\ud310 \uc2dc\uac04\uc758 \ud750\ub984 \ud45c TPTB\n\uc0ac\uac74 \ud45c AT\n\ud38c\ube14 \ud45c FT/ \uc0c1\ud0dc\uc774\uc0c1 \ud45c WT\n\uc6b4\uba85 \ubcc0\uc804 \ud45c FCT\n\u3000\uc804\ud615\uc801 \uc7ac\uc561 TCT\uff0f\ubb3c\ub9ac\uacc4 \uc7ac\uc561 PCT\uff0f\uc815\uc2e0\uacc4 \uc7ac\uc561 MCT\uff0f\uad11\uae30\uacc4 \uc7ac\uc561 ICT\n\u3000\uc0ac\ud68c\uacc4 \uc7ac\uc561 SCT\uff0f\ucd08\uc790\uc5f0\uacc4 \uc7ac\uc561 XCT\uff0f\ubd88\uac00\uc0ac\uc758\uacc4 \uc7ac\uc561 WCT\uff0f\ucf54\ubbf9\uacc4 \uc7ac\uc561 CCT\n\u3000\ub9c8\ubc95\uc0ac \uc7ac\uc561 MGCT\n\uc7a5\uba74\ud45c ST\uff0f\ub300\ud615\ud310 \uc7a5\uba74\ud45c STB\n\u3000\uadf9\ud55c \ud658\uacbd XEST\uff0f\ub0b4\uba74 \uc138\uacc4 IWST\uff0f\ub9c8\ubc95 \ub3c4\uc2dc MCST\n\u3000\uc0ac\ud6c4 \uc138\uacc4 WDST\uff0f\ubbf8\uad81 \uc138\uacc4 LWST\n\u3000\ub9c8\ubc95 \uc11c\uac00 MBST\uff0f\ub9c8\ubc95 \ud559\uc6d0 MAST\uff0f\ud06c\ub808\ub3c4\uc758 \ud0d1 TCST\n\u3000\ubcd1\ud589 \uc138\uacc4 PWST\uff0f\uc885\ub9d0 PAST\uff0f\uc774\uc138\uacc4 \uc220\uc9d1 GBST\n\u3000\ubcc4\ube5b SLST\uff0f\uad6c \ub3c4\uc11c\uad00 OLST\n\uc138\uacc4 \ubc95\uce59 \ucd94\uac00 \ud45c WLAT\uff0f\ub5a0\ub3cc\uc774 \uad34\ubb3c \ud45c WMT\n\ub79c\ub364 \ubd84\uc57c \ud45c RCT\n\ub79c\ub364 \ud2b9\uae30 \ud45c RTT\n\u3000\ubcc4 \ubd84\uc57c \ub79c\ub364 \ud2b9\uae30 \ud45c  RTS, RTT1\n\u3000\uc9d0\uc2b9 \ubd84\uc57c \ub79c\ub364 \ud2b9\uae30 \ud45c  RTB, RTT2\n\u3000\ud798 \ubd84\uc57c \ub79c\ub364 \ud2b9\uae30 \ud45c  RTF, RTT3\n\u3000\ub178\ub798 \ubd84\uc57c \ub79c\ub364 \ud2b9\uae30 \ud45c  RTP, RTT4\n\u3000\uafc8 \ubd84\uc57c \ub79c\ub364 \ud2b9\uae30 \ud45c  RTD, RTT5\n\u3000\uc5b4\ub460 \ubd84\uc57c \ub79c\ub364 \ud2b9\uae30 \ud45c  RTN, RTT6\n\ubc31\uc9c0 \ube44\ubc00 \ud45c\u3000BST/\n\u3000\uc219\uc801\ud45c\u3000MIT/\ubaa8\ub7b5 \ud45c\u3000MOT/\uc778\uc5f0 \ud45c\u3000MAT\n\u3000\uae30\uc778\ud45c\u3000MUT/\uc5ed\uc7a5 \ud45c\u3000MFT/\ub3d9\ub9f9 \ud45c\u3000MLT\n\ub099\ud654 \ud45c\u3000FFT\n\uadf8 \ud6c4\uc758 \uc804\uac1c \ud45c FLT\n\u30fbD66 \ub2e4\uc774\uc2a4 \uc788\uc74c.\n"),R.$register_prefix_from_super_class(),B(R,"$initialize",function T(d){var y=this;return delete T.$$p,P(y,s(y,"initialize",T,!1,!0),"initialize",[d],null),y.locale="ko_kr"},1),w(z[0],"SKILL_TABLE",R.$translate_skill_table("ko_kr")),w(z[0],"TABLES",R.$translate_tables("ko_kr",N("SKILL_TABLE")))})}}]);