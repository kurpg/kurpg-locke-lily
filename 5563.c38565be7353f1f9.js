(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[5563],{5563:(de,me,fe)=>{fe(9993),Opal.modules["i18n/backend/fallbacks"]=function(r){var W,u,B,N,M,_,U=[],t=r.nil,v=r.$$$,e=r.module,p=r.class_variable_set,L=r.truthy,I=r.class_variable_get,c=r.def,P=r.send,X=r.to_a,C=r.rb_minus,A=r.send2,G=r.find_super,H=r.hash2,F=r.find_block_super,j=r.neqeq;return W=U,_=[M=e(U[0],"I18n")].concat(W),p(_[0],"@@fallbacks",t),u=r.get_singleton_class(M),B=[u].concat(_),N=r.$r(B),c(u,"$fallbacks",function(){var R=t;return p(B[1],"@@fallbacks",L(null!=B[1].$$cvars["@@fallbacks"]?"class variable":t)&&L(R=I(B[1],"@@fallbacks",!1))?R:v(v(N("I18n"),"Locale"),"Fallbacks").$new()),L(R=N("Thread").$current()["$[]"]("i18n_fallbacks"))?R:I(B[1],"@@fallbacks",!1)},0),c(u,"$fallbacks=",function(m){var R;return p(B[1],"@@fallbacks",L(m["$is_a?"](N("Array")))?v(v(N("I18n"),"Locale"),"Fallbacks").$new(m):m),R=["i18n_fallbacks",I(B[1],"@@fallbacks",!1)],P(N("Thread").$current(),"[]=",X(R)),R[C(R.length,1)]},1),function(u,D){var m,R,y,f,N=[e(u,"Backend")].concat(D);return m=N,y=[R=e(N[0],"Fallbacks")].concat(m),f=r.$r(y),c(R,"$translate",function o(a,s,$){try{var n=o.$$p||t,i=this,d=t,q=t;return delete o.$$p,null==$&&($=f("EMPTY_HASH")),L($.$fetch("fallback",!0))?L($["$[]"]("fallback_in_progress"))?A(i,G(i,"translate",o,!1,!0),"translate",[a,s,$],n):(L($["$[]"]("default"))&&(d=i["$extract_non_symbol_default!"]($)),q=$.$merge(H(["fallback_in_progress"],{fallback_in_progress:!0})),P(f("I18n").$fallbacks()["$[]"](a),"each",[],function h(x){var E=null==h.$$s?this:h.$$s;null==x&&(x=t);try{return P(E,"catch",["exception"],function g(){var l=null==g.$$s?this:g.$$s,z=t;if(z=A(l,F(l,"translate",g.$$def||h.$$def||o,!1,!1),"translate",[x,s,q],null),L(z["$nil?"]()))return t;j(a.$to_s(),x.$to_s())&&l.$on_fallback(a,x,s,$),r.ret(z)},{$$arity:0,$$s:E})}catch(g){if(!r.rescue(g,[v(f("I18n"),"InvalidLocale")]))throw g;try{return t}finally{r.pop_exception()}}},{$$arity:1,$$s:i}),L($["$key?"]("default"))&&L($["$[]"]("default")["$nil?"]())?t:L(d)?A(i,G(i,"translate",o,!1,!0),"translate",[a,t,$.$merge(H(["default"],{default:d}))],null):i.$throw("exception",v(f("I18n"),"MissingTranslation").$new(a,s,$))):A(i,G(i,"translate",o,!1,!0),"translate",[a,s,$],n)}catch(h){if(h===r.returner)return h.$v;throw h}},-3),c(R,"$extract_non_symbol_default!",function(a){var $,s=t,n=t;return s=[a["$[]"]("default")].$flatten(),$=P(s,"detect",[],function(d){return null==d&&(d=t),d["$is_a?"](f("Symbol"))["$!"]()},1),L($)&&(n=["default",s["$[]"](0,s.$index($))],P(a,"[]=",X(n)),C(n.length,1)),$},1),c(R,"$exists?",function o(a,s,$){try{var n=o.$$p||t,i=this;return delete o.$$p,null==$&&($=f("EMPTY_HASH")),L($.$fetch("fallback",!0))?(P(f("I18n").$fallbacks()["$[]"](a),"each",[],function d(q){var h=null==d.$$s?this:d.$$s;null==q&&(q=t);try{if(!L(A(h,F(h,"exists?",d.$$def||o,!1,!1),"exists?",[q,s],null)))return t;r.ret(!0)}catch(x){if(!r.rescue(x,[v(f("I18n"),"InvalidLocale")]))throw x;try{return t}finally{r.pop_exception()}}},{$$arity:1,$$s:i}),!1):A(i,G(i,"exists?",o,!1,!0),"exists?",[a,s,$],n)}catch(d){if(d===r.returner)return d.$v;throw d}},-3),R.$private(),c(R,"$on_fallback",function(a,s,$,n){return t},4)}(_[0],_)},Opal.modules["bcdice/randomizer"]=function(r){var M,T,m,R,y,f,u,D,U=[],t=r.nil,v=r.$$$,p=r.klass,L=r.const_set,I=r.def,c=r.truthy,P=r.rb_gt,X=r.rb_plus,C=r.rb_le,A=r.send,G=r.rb_minus,H=r.eqeq,F=r.rb_times,j=r.eqeqeq,O=r.rb_ge;return M=U,u=[(0,r.module)(U[0],"BCDice")].concat(M),D=r.$r(u),T=u,R=[m=p(u[0],null,"Randomizer")].concat(T),y=r.$r(R),(f=m.$$prototype).rand_results=f.detailed_rand_results=t,L(R[0],"UPPER_LIMIT_DICE_TIMES",200),L(R[0],"UPPER_LIMIT_DICE_SIDES",1e4),L(R[0],"UPPER_LIMIT_RANDS",1e4),I(m,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]},0),m.$attr_reader("rand_results"),m.$attr_reader("detailed_rand_results"),L(R[0],"DetailedRandResult",y("Struct").$new("kind","sides","value")),I(m,"$roll_barabara",function(a,s){var $=this;return c(P(X($.rand_results.$size(),a),y("UPPER_LIMIT_RANDS")))&&$.$raise(y("TooManyRandsError")),c(C(a,0))||c(P(a,y("UPPER_LIMIT_DICE_TIMES")))?[]:A(y("Array"),"new",[a],function n(){return(null==n.$$s?this:n.$$s).$roll_once(s)},{$$arity:0,$$s:$})},2),I(m,"$roll_sum",function(a,s){return this.$roll_barabara(a,s).$sum()},2),I(m,"$roll_once",function(a){var $=t;return c(C(a,0))||c(P(a,y("UPPER_LIMIT_DICE_SIDES")))?0:($=this.$rand_inner(a),this.$push_to_detail("normal",a,$),$)},1),I(m,"$roll_index",function(a){return G(this.$roll_once(a),1)},1),I(m,"$roll_tens_d10",function(){var $,s=t;return s=this.$rand_inner(10),H(s,10)&&(s=0),$=F(s,10),this.$push_to_detail("tens_d10",10,$),$},0),I(m,"$roll_d9",function(){var s;return s=G(this.$rand_inner(10),1),this.$push_to_detail("d9",10,s),s},0),I(m,"$roll_d66",function(a){var n,$=t;return $=A(y("Array"),"new",[2],function i(){return(null==i.$$s?this:i.$$s).$roll_once(6)},{$$arity:0,$$s:this}),j(v(y("D66SortType"),"ASC"),n=a)?$["$sort!"]():j(v(y("D66SortType"),"DESC"),n)&&$["$sort!"]()["$reverse!"](),X(F($["$[]"](0),10),$["$[]"](1))},1),m.$private(),I(m,"$rand_inner",function(a){var $,s=this;return c(O(s.rand_results.$size(),y("UPPER_LIMIT_RANDS")))&&s.$raise(y("TooManyRandsError")),$=s.$random(a),s.rand_results["$<<"]([$,a]),$},1),I(m,"$random",function(a){return X(y("Kernel").$rand(a),1)},1),I(m,"$push_to_detail",function(a,s,$){var i;return i=y("DetailedRandResult").$new(a,s,$),this.detailed_rand_results.$push(i)},3),p(u[0],D("StandardError"),"TooManyRandsError"),t},Opal.modules["bcdice/dice_table/roll_result"]=function(r){var c,A,O,W,M,_,u,H,X,U=[],t=r.nil,v=r.module,e=r.klass,p=r.def,L=r.truthy;return c=U,A=X=[v(U[0],"BCDice")].concat(c),O=H=[v(X[0],"DiceTable")].concat(A),M=[W=e(H[0],null,"RollResult")].concat(O),_=r.$r(M),(u=W.$$prototype).table_name=u.value=u.body=t,p(W,"$initialize",function(B,N,T){var m=this;return m.table_name=B,m.value=N,m.body=T},3),W.$attr_reader("table_name"),W.$attr_reader("value"),W.$attr_reader("body"),p(W,"$to_s",function(){var B=this;return B.table_name+"("+B.value+") \uff1e "+B.body},0),p(W,"$last_body",function(){var B=this;return L(B.body["$is_a?"](_("RollResult")))?B.body.$last_body():B.body},0),p(W,"$empty?",function(){return!1},0)},Opal.modules["bcdice/dice_table/chain_table"]=function(r){var P,G,W,M,_,u,D,F,C,U=[],t=r.nil,v=r.module,e=r.klass,p=r.truthy,L=r.def,I=r.rb_minus;return P=U,G=C=[v(U[0],"BCDice")].concat(P),W=F=[v(C[0],"DiceTable")].concat(G),_=[M=e(F[0],null,"ChainTable")].concat(W),u=r.$r(_),(D=M.$$prototype).times=D.sides=D.items=D.name=t,L(M,"$initialize",function(N,T,m){var R=this,y=t;return R.name=N,R.items=m.$freeze(),y=/(\d+)D(\d+)/i.$match(T),p(y)||R.$raise(u("ArgumentError"),"Unexpected table type: "+T),R.times=y["$[]"](1).$to_i(),R.sides=y["$[]"](2).$to_i()},3),L(M,"$roll",function(N){var m,R,T=this,y=t;return m=N.$roll_sum(T.times,T.sides),R=I(m,T.times),y=T.items["$[]"](R),p(y["$respond_to?"]("roll"))&&(y=y.$roll(N)),u("RollResult").$new(T.name,m,y)},1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(r){var A,j,u,D,B,N,T,W,H,U=[],t=r.nil,v=r.module,e=r.klass,p=r.hash2,L=r.defs,I=r.def,c=r.rb_plus,P=r.rb_times,X=r.rb_minus;return A=U,j=H=[v(U[0],"BCDice")].concat(A),u=W=[v(H[0],"DiceTable")].concat(j),B=[D=e(W[0],null,"D66GridTable")].concat(u),N=r.$r(B),(T=D.$$prototype).name=T.items=t,L(D,"$from_i18n",function(R,y){var o=t;return o=N("I18n").$t(R,p(["locale","raise"],{locale:y,raise:!0})),this.$new(o["$[]"]("name"),o["$[]"]("items"))},2),I(D,"$initialize",function(R,y){return this.name=R,this.items=y.$freeze()},2),I(D,"$roll",function(R){var f,o,a,s,$;return f=R.$roll_once(6),o=R.$roll_once(6),a=c(P(f,10),o),s=X(f,1),$=X(o,1),N("RollResult").$new(this.name,a,this.items["$[]"](s)["$[]"]($))},1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(r){var X,H,_,u,D,B,j,O,A,t=[],v=r.nil,e=r.module,p=r.klass,L=r.hash2,I=r.defs,c=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),X=t,H=A=[e(t[0],"BCDice")].concat(X),j=[e(A[0],"DiceTable")].concat(H),O=r.$r(j),_=j,D=[u=p(j[0],O("D66GridTable"),"D66HalfGridTable")].concat(_),B=r.$r(D),I(u,"$from_i18n",function(T,m){var y=v;return y=B("I18n").$t(T,L(["locale","raise"],{locale:m,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items_1_2_3"),y["$[]"]("items_4_5_6"))},2),c(u,"$initialize",function(T,m,R){return this.name=T,this.items=[m,m,m,R,R,R].$freeze()},3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(r){var X,H,_,u,D,B,j,O,A,t=[],v=r.nil,e=r.module,p=r.klass,L=r.hash2,I=r.defs,c=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),X=t,H=A=[e(t[0],"BCDice")].concat(X),j=[e(A[0],"DiceTable")].concat(H),O=r.$r(j),_=j,D=[u=p(j[0],O("D66GridTable"),"D66OneThirdTable")].concat(_),B=r.$r(D),I(u,"$from_i18n",function(T,m){var y=v;return y=B("I18n").$t(T,L(["locale","raise"],{locale:m,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items_1_2"),y["$[]"]("items_3_4"),y["$[]"]("items_5_6"))},2),c(u,"$initialize",function(T,m,R,y){return this.name=T,this.items=[m,m,R,R,y,y].$freeze()},4)},Opal.modules["bcdice/dice_table/d66_table"]=function(r){var H,W,B,N,T,m,R,_,j,U=[],t=r.nil,v=r.$$$,e=r.module,p=r.klass,L=r.hash2,I=r.defs,c=r.def,P=r.eqeqeq,X=r.rb_plus,C=r.rb_times,A=r.truthy;return H=U,W=j=[e(U[0],"BCDice")].concat(H),B=_=[e(j[0],"DiceTable")].concat(W),T=[N=p(_[0],null,"D66Table")].concat(B),m=r.$r(T),(R=N.$$prototype).sort_type=R.items=R.name=t,I(N,"$from_i18n",function(f,o){var $,s=t;return s=m("I18n").$t(f,L(["locale"],{locale:o})),$=m("D66SortType").$const_get(s["$[]"]("d66_sort_type")),this.$new(s["$[]"]("name"),$,s["$[]"]("items"))},2),c(N,"$initialize",function(f,o,a){var s=this;return s.name=f,s.sort_type=o,s.items=a.$freeze()},3),c(N,"$roll",function(f){var o=this,a=t,s=t,$=t,n=t;return a=f.$roll_barabara(2,6),P(v(m("D66SortType"),"ASC"),s=o.sort_type)?a["$sort!"]():P(v(m("D66SortType"),"DESC"),s)&&a["$sort!"]()["$reverse!"](),$=X(C(a["$[]"](0),10),a["$[]"](1)),n=A(s=o.items["$[]"]($))?s:o.items["$[]"]($.$to_s()),A(n["$respond_to?"]("roll"))&&(n=n.$roll(f)),m("RollResult").$new(o.name,$,n)},1),c(N,"$choice",function(f){return m("RollResult").$new(this.name,f,this.items["$[]"](f))},1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(r){var O,u,B,N,M,t=[],v=r.nil,e=r.module,p=r.klass,L=r.hash2,I=r.send,c=r.to_ary,P=r.rb_plus,X=r.rb_times,C=r.to_a,A=r.rb_minus,G=r.send2,H=r.find_super,F=r.def;return r.top.$require("bcdice/dice_table/d66_table"),O=t,u=M=[e(t[0],"BCDice")].concat(O),B=[e(M[0],"DiceTable")].concat(u),N=r.$r(B),F(p(B[0],N("D66Table"),"D66LeftRangeTable"),"$initialize",function y(f,o,a){var n;return delete y.$$p,n=L([],{}),I(a,"each",[],function(d){var q,E;return null==d&&(d=v),q=c(d),E=null==q[1]?v:q[1],I(null==q[0]?v:q[0],"each",[],function(l){return null==l&&(l=v),I(E,"each_with_index",[],function(b,J){var re,V;return null==b&&(b=v),null==J&&(J=v),re=P(X(l,10),P(J,1)),I(n,"[]=",C(V=[re,b])),V[A(V.length,1)]},2)},1)},1),G(this,H(this,"initialize",y,!1,!0),"initialize",[f,o,n],null)},3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(r){var G,O,D,B,N,T,m,M,F,U=[],t=r.nil,v=r.module,e=r.klass,p=r.hash2,L=r.defs,I=r.def,c=r.truthy,P=r.rb_minus,X=r.rb_plus,C=r.rb_times;return G=U,O=F=[v(U[0],"BCDice")].concat(G),D=M=[v(F[0],"DiceTable")].concat(O),N=[B=e(M[0],null,"D66ParityTable")].concat(D),T=r.$r(N),(m=B.$$prototype).odd=m.even=m.name=t,L(B,"$from_i18n",function(y,f){var a=t;return a=T("I18n").$t(y,p(["locale","raise"],{locale:f,raise:!0})),this.$new(a["$[]"]("name"),a["$[]"]("odd"),a["$[]"]("even"))},2),I(B,"$initialize",function(y,f,o){var a=this;return a.name=y,a.odd=f.$freeze(),a.even=o.$freeze()},3),I(B,"$roll",function(y){var a,$,n,f=this,o=t;return o=y.$roll_once(6),a=y.$roll_once(6),$=(c(o["$odd?"]())?f.odd:f.even)["$[]"](P(a,1)),n=X(C(o,10),a),T("RollResult").$new(f.name,n,$)},1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(r){var X,H,M,_,u,D,B,j,A,U=[],t=r.nil,v=r.module,e=r.klass,p=r.def,L=r.rb_plus,I=r.rb_times,c=r.send;return X=U,H=A=[v(U[0],"BCDice")].concat(X),M=j=[v(A[0],"DiceTable")].concat(H),u=[_=e(j[0],null,"D66RangeTable")].concat(M),D=r.$r(u),(B=_.$$prototype).items=B.name=t,p(_,"$initialize",function(T,m){return this.name=T,this.items=m.$freeze()},2),p(_,"$roll",function(T){var R,y,f,o=t;return R=T.$roll_once(6),y=T.$roll_once(6),f=L(I(R,10),y),o=c(this.items,"find",[],function(s){return null==s&&(s=t),s["$[]"](0)["$include?"](f)},1),D("RollResult").$new(this.name,f,o["$[]"](1))},1)},Opal.modules["bcdice/dice_table/range_table"]=function(r){var F,M,N,T,m,R,y,u,O,U=[],t=r.nil,v=r.module,e=r.klass,p=r.const_set,L=r.send,I=r.truthy,c=r.def,P=r.to_a,X=r.rb_minus,C=r.eqeqeq,A=r.rb_times,G=r.rb_plus;return F=U,M=O=[v(U[0],"BCDice")].concat(F),N=u=[v(O[0],"DiceTable")].concat(M),m=[T=e(u[0],null,"RangeTable")].concat(N),R=r.$r(m),(y=T.$$prototype).name=y.items=y.num_of_dice=y.num_of_sides=y.formatter=t,p(m[0],"RollResult",L(R("Struct"),"new",["sum","values","content","formatted"],function f(){return(null==f.$$s?this:f.$$s).$alias_method("to_s","formatted")},{$$arity:0,$$s:T})),p(m[0],"Item",R("Struct").$new("range","content")),p(m[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),p(m[0],"DEFAULT_FORMATTER",L(T,"lambda",[],function(o,a){return null==o&&(o=t),null==a&&(a=t),o.$name()+"("+a.$sum()+") \uff1e "+a.$content()},2)),T.$attr_reader("name"),T.$attr_reader("num_of_dice"),T.$attr_reader("num_of_sides"),c(T,"$initialize",function f(o,a,s){var i,$=f.$$p||t,n=this,d=t;return delete f.$$p,n.name=o.$freeze(),n.formatter=I(i=$)?i:R("DEFAULT_FORMATTER"),d=R("DICE_ROLL_METHOD_RE").$match(a),I(d)||n.$raise(R("ArgumentError"),n.name+": invalid dice roll method: "+a),n.num_of_dice=d["$[]"](1).$to_i(),n.num_of_sides=d["$[]"](2).$to_i(),n.$store(s)},3),c(T,"$fetch",function(o){var s,a=this;return s=L(a.items,"find",[],function(n){return null==n&&(n=t),n.$range()["$include?"](o)},1),I(s)||a.$raise(R("RangeError"),a.name+": value is out of range: "+o),s},1),c(T,"$roll",function(o){var $,n,i,a=this,s=t;return $=(s=o.$roll_barabara(a.num_of_dice,a.num_of_sides)).$sum(),n=R("RollResult").$new($,s,a.$fetch($).$content()),i=[a.formatter["$[]"](a,n)],L(n,"formatted=",P(i)),X(i.length,1),n},1),T.$private(),c(T,"$store",function(o){var s,$,a=this;return s=L(o,"map",[],function n(i,d){return null==i&&(i=t),null==d&&(d=t),[(null==n.$$s?this:n.$$s).$coerce_to_int_range(i),d]},{$$arity:2,$$s:a}),$=L(s,"sort_by",[],function(i,d){return null==i&&(i=t),null==d&&(d=t),i.$min()},2),a.$assert_min_sum_is_covered($),a.$assert_max_sum_is_covered($),a.$assert_no_gap_or_overlap_in_ranges($),a.items=L($,"map",[],function(i,d){return null==i&&(i=t),null==d&&(d=t),R("Item").$new(i,d.$freeze()).$freeze()},2).$freeze(),a},1),c(T,"$coerce_to_int_range",function(o){var s;return C(R("Integer"),s=o)?R("Range").$new(o,o):C(R("Range"),s)&&I(o.$begin()["$is_a?"](R("Integer")))&&I(o.$end()["$is_a?"](R("Integer")))?o:this.$raise(R("TypeError"),this.name+": "+o+" ("+o.$class()+") must be an Integer or a Range with Integers ")},1),c(T,"$assert_min_sum_is_covered",function(o){var s,a=this,$=t;return s=a.num_of_dice,$=o.$first()["$[]"](0),I($["$include?"](s))||a.$raise(R("RangeError"),a.name+": min value ("+s+") is not covered: "+$),a},1),c(T,"$assert_max_sum_is_covered",function(o){var s,a=this,$=t;return s=A(a.num_of_dice,a.num_of_sides),$=o.$last()["$[]"](0),I($["$include?"](s))||a.$raise(R("RangeError"),a.name+": max value ("+s+") is not covered: "+$),a},1),c(T,"$assert_no_gap_or_overlap_in_ranges",function(o){return L(o,"each_cons",[2],function s($,n){var h,x,i=null==s.$$s?this:s.$$s,d=t,q=t;return null==i.name&&(i.name=t),null==$&&($=t),null==n&&(n=t),d=$["$[]"](0),q=n["$[]"](0),h=d.$max(),x=G(h,1),I(q["$include?"](h))&&i.$raise(R("RangeError"),i.name+": Range overlap: "+d+" and "+q),I(q["$include?"](x))?t:i.$raise(R("RangeError"),i.name+": Range gap: "+d+" and "+q)},{$$arity:2,$$s:this}),this},1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(r){var X,H,M,N,T,m,R,u,j,A,U=[],t=r.nil,v=r.$$$,e=r.module,p=r.klass,L=r.send,I=r.def,c=r.rb_minus;return X=U,H=A=[e(U[0],"BCDice")].concat(X),M=j=[e(A[0],"DiceTable")].concat(H),N=u=[p(j[0],null,"SaiFicSkillTable")].concat(M),m=[T=p(u[0],null,"Category")].concat(N),R=r.$r(m),T.$$prototype.name=t,I(T,"$initialize",function(o,a,s,$){var n=this;return n.name=o,n.skills=L(a.$map(),"with_index",[2],function(d,q){return null==d&&(d=t),null==q&&(q=t),v(R("SaiFicSkillTable"),"Skill").$new(o,d,s,q,$)},2),n.dice=s},4),I(T,"$roll",function(o){return this.$skills()["$[]"](c(o.$roll_sum(2,6),2))},1),I(T,"$to_s",function(){return this.name},0),T.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(r){var c,A,O,D,B,M,H,X,U=[],t=r.nil,v=r.module,e=r.klass,p=r.def,L=r.hash2;return c=U,A=X=[v(U[0],"BCDice")].concat(c),O=H=[v(X[0],"DiceTable")].concat(A),M=[e(H[0],null,"SaiFicSkillTable")].concat(O),(B=(D=e(M[0],null,"Skill")).$$prototype).s_format=B.category_dice=B.row_dice=B.category_name=B.name=t,p(D,"$initialize",function(T,m,R,y,f){var o=this;return o.category_name=T,o.name=m,o.category_dice=R,o.row_dice=y,o.s_format=f},5),p(D,"$to_s",function(){var T=this;return T.$format(T.s_format,L(["category_dice","row_dice","category_name","skill_name"],{category_dice:T.category_dice,row_dice:T.row_dice,category_name:T.category_name,skill_name:T.name}))},0),D.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(r){var W,D,R,y,f,o,a,N,_,U=r.top,t=[],v=r.nil,e=r.$$$,p=r.module,L=r.klass,I=r.hash2,c=r.send,X=r.defs,C=r.const_set,A=r.to_ary,G=r.def,H=r.truthy,F=r.rb_minus,j=r.rb_plus;return U.$require("bcdice/dice_table/sai_fic_skill_table/category"),U.$require("bcdice/dice_table/sai_fic_skill_table/skill"),W=t,D=_=[p(t[0],"BCDice")].concat(W),R=N=[p(_[0],"DiceTable")].concat(D),f=[y=L(N[0],null,"SaiFicSkillTable")].concat(R),o=r.$r(f),(a=y.$$prototype).rtt=a.rtt_format=a.rct=a.rct_format=a.rttn=a.rttn_format=a.categories=v,X(y,"$from_i18n",function($,n,i){var d,q,h,l,g=v;if(null==i)i=I([],{});else if(!i.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(d=i.$$smap.rtt)&&(d=v),null==(q=i.$$smap.rct)&&(q=v),null==(h=i.$$smap.rttn)&&(h=v),l=(g=o("I18n").$t("RTT",I(["locale","raise","default"],{locale:n,raise:!1,default:I([],{})})).$merge(o("I18n").$t($,I(["locale","raise"],{locale:n,raise:!0}))))["$[]"]("items"),g=c(g,"select",[],function(b,J){return null==b&&(b=v),null==J&&(J=v),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](b)},2),this.$new(l,r.to_hash(g).$merge(I(["rtt","rct","rttn"],{rtt:d,rct:q,rttn:h})))},-3),C(f[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),C(f[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),C(f[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),C(f[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),G(y,"$initialize",function($,n){var i,d,q,h,x,E,g,l=this;if(null==n)n=I([],{});else if(!n.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(i=n.$$smap.rtt)&&(i=v),null==(d=n.$$smap.rct)&&(d=v),null==(q=n.$$smap.rttn)&&(q=v),null==(h=n.$$smap.rtt_format)&&(h=o("DEFAULT_RTT")),null==(x=n.$$smap.rct_format)&&(x=o("DEFAULT_RCT")),null==(E=n.$$smap.rttn_format)&&(E=o("DEFAULT_RTTN")),null==(g=n.$$smap.s_format)&&(g=o("DEFAULT_S")),l.categories=c($.$map(),"with_index",[1],function(b,J){var re,ie,Q;return null==b&&(b=v),null==J&&(J=v),ie=null==(re=A(b))[0]?v:re[0],Q=null==re[1]?v:re[1],e(o("SaiFicSkillTable"),"Category").$new(ie,Q,J,g)},{$$arity:2,$$has_top_level_mlhs_arg:!0}),l.rtt=i,l.rct=d,l.rttn=q.$to_a(),l.rtt_format=h,l.rct_format=x,l.rttn_format=E},-2),C(f[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),y.$attr_reader("categories"),G(y,"$roll_command",function($,n){var d,i=this,q=v,h=v;return H(["RTT",i.rtt]["$include?"](d=n))?i.$format_skill(i.rtt_format,i.$roll_skill($)):H(["RCT",i.rct]["$include?"](d))?(q=i.$roll_category($),i.$format(i.rct_format,I(["category_dice","category_name"],{category_dice:q.$dice(),category_name:q.$name()}))):H(h=o("RTTN").$index(d))||H(h=i.rttn.$index(d))?i.$format_skill(i.rttn_format,i.categories["$[]"](h).$roll($)):v},2),G(y,"$roll_category",function($){return this.categories["$[]"](F($.$roll_once(6),1))},1),G(y,"$roll_skill",function($){return this.$roll_category($).$roll($)},1),G(y,"$prefixes",function(){var $=this;return j(["RTT[1-6]?","RCT",$.rtt,$.rct],$.rttn).$compact()},0),y.$private(),G(y,"$format_skill",function($,n){return this.$format($,I(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:n.$category_dice(),row_dice:n.$row_dice(),category_name:n.$category_name(),skill_name:n.$name(),text:n.$to_s()}))},2)},Opal.modules["bcdice/dice_table/table"]=function(r){var C,F,_,u,D,B,N,O,G,U=[],t=r.nil,v=r.module,e=r.klass,p=r.hash2,L=r.defs,I=r.truthy,c=r.def,P=r.rb_minus;return C=U,F=G=[v(U[0],"BCDice")].concat(C),_=O=[v(G[0],"DiceTable")].concat(F),D=[u=e(O[0],null,"Table")].concat(_),B=r.$r(D),(N=u.$$prototype).times=N.sides=N.name=N.items=t,L(u,"$from_i18n",function(m,R){var f=t;return f=B("I18n").$t(m,p(["locale"],{locale:R})),this.$new(f["$[]"]("name"),f["$[]"]("type"),f["$[]"]("items"))},2),c(u,"$initialize",function(m,R,y){var f=this,o=t;return f.name=m,f.items=y.$freeze(),o=/(\d+)D(\d+)/i.$match(R),I(o)||f.$raise(B("ArgumentError"),"Unexpected table type: "+R),f.times=o["$[]"](1).$to_i(),f.sides=o["$[]"](2).$to_i()},3),c(u,"$roll",function(m){var y,R=this;return y=m.$roll_sum(R.times,R.sides),R.$choice(y)},1),c(u,"$choice",function(m){var y,R=this;return y=P(m,R.times),B("RollResult").$new(R.name,m,R.items["$[]"](y))},1)},Opal.modules["bcdice/dice_table"]=function(r){var U=r.top;return U.$require("bcdice/dice_table/roll_result"),U.$require("bcdice/dice_table/chain_table"),U.$require("bcdice/dice_table/d66_grid_table"),U.$require("bcdice/dice_table/d66_half_grid_table"),U.$require("bcdice/dice_table/d66_one_third_table"),U.$require("bcdice/dice_table/d66_left_range_table"),U.$require("bcdice/dice_table/d66_parity_table"),U.$require("bcdice/dice_table/d66_range_table"),U.$require("bcdice/dice_table/d66_table"),U.$require("bcdice/dice_table/range_table"),U.$require("bcdice/dice_table/sai_fic_skill_table"),U.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(r){var L,X,A,c,U=[],v=r.module,e=r.const_set;return L=U,X=c=[v(U[0],"BCDice")].concat(L),A=[v(c[0],"D66SortType")].concat(X),e(A[0],"NO_SORT","no_sort"),e(A[0],"ASC","asc"),e(A[0],"DESC","desc"),function(P,X){var A=[v(P,"RoundType")].concat(X);return e(A[0],"CEIL","ceil"),e(A[0],"FLOOR","floor"),e(A[0],"ROUND","round")}(c[0],c)},Opal.modules["bcdice/translate"]=function(r){var c,A,G,H,F,X,U=[],t=r.nil,v=r.module,e=r.hash2,L=r.def;return c=U,A=X=[v(U[0],"BCDice")].concat(c),H=[G=v(X[0],"Translate")].concat(A),F=r.$r(H),L(G,"$translate",function(O,W){var M,_=this;if(null==_.locale&&(_.locale=t),null==W)W=e([],{});else if(!W.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return M=r.kwrestargs(W,{}),F("I18n").$translate(O,e(["locale","raise"],{locale:_.locale,raise:!0}).$merge(r.to_hash(M)))},-2)},Opal.modules["bcdice/result"]=function(r){var X,F,M,j,W,A,U=[],t=r.nil,e=r.klass,p=r.send,L=r.to_a,I=r.rb_minus,c=r.def;return X=U,F=A=[(0,r.module)(U[0],"BCDice")].concat(X),[j=e(A[0],null,"Result")].concat(F),(W=j.$$prototype).secret=W.success=W.failure=W.critical=W.fumble=t,c(M=r.get_singleton_class(j),"$success",function(D){return p(this.$new(),"tap",[],function(T){var m=t;return null==T&&(T=t),p(T,"text=",L(m=[D])),I(m.length,1),p(T,"success=",L(m=[!0])),m[I(m.length,1)]},1)},1),c(M,"$failure",function(D){return p(this.$new(),"tap",[],function(T){var m=t;return null==T&&(T=t),p(T,"text=",L(m=[D])),I(m.length,1),p(T,"failure=",L(m=[!0])),m[I(m.length,1)]},1)},1),c(M,"$critical",function(D){return p(this.$new(),"tap",[],function(T){var m=t;return null==T&&(T=t),p(T,"text=",L(m=[D])),I(m.length,1),p(T,"critical=",L(m=[!0])),I(m.length,1),p(T,"success=",L(m=[!0])),m[I(m.length,1)]},1)},1),c(M,"$fumble",function(D){return p(this.$new(),"tap",[],function(T){var m=t;return null==T&&(T=t),p(T,"text=",L(m=[D])),I(m.length,1),p(T,"fumble=",L(m=[!0])),I(m.length,1),p(T,"failure=",L(m=[!0])),m[I(m.length,1)]},1)},1),c(M,"$nothing",function(){return"nothing"},0),c(j,"$initialize",function(_){var u=this;return null==_&&(_=t),u.text=_,u.rands=t,u.detailed_rands=t,u.secret=!1,u.success=!1,u.failure=!1,u.critical=!1,u.fumble=!1},-1),j.$attr_accessor("text","rands","detailed_rands"),j.$attr_writer("secret","success","failure","critical","fumble"),c(j,"$secret?",function(){return this.secret},0),c(j,"$success?",function(){return this.success},0),c(j,"$failure?",function(){return this.failure},0),c(j,"$critical?",function(){return this.critical},0),c(j,"$fumble?",function(){return this.fumble},0),c(j,"$condition=",function(_){return this.success=_,this.failure=_["$!"]()},1)},Opal.modules["racc/parser"]=function(r){var R,f,o,t=[],v=r.$r(t),e=r.nil,p=r.$$$,L=r.module,I=r.klass,c=r.truthy,P=r.const_set,X=r.defs,C=r.gvars,A=r.rb_lt,G=r.send,H=r.to_a,F=r.rb_minus,j=r.def,O=r.to_ary,W=r.neqeq,M=r.rb_plus,_=r.eqeq,u=r.rb_ge,D=r.rb_gt,B=r.eqeqeq,N=r.rb_le,T=r.rb_times;return R=t,f=[L(t[0],"Racc")].concat(R),o=r.$r(f),I(f[0],o("StandardError"),"ParseError"),c(p("::","ParseError","skip_raise")?"constant":e)||P(t[0],"ParseError",p(v("Racc"),"ParseError")),function(m,R){var n,i,d,q,h,o=[L(m,"Racc")].concat(R),a=r.$r(o);return c(a("Racc_No_Extensions","skip_raise")?"constant":e)||P(o[0],"Racc_No_Extensions",!1),n=o,d=[i=I(o[0],null,"Parser")].concat(n),q=r.$r(d),(h=i.$$prototype).yydebug=h.racc_debug_out=h.racc_error_status=h.racc_t=h.racc_vstack=h.racc_val=h.racc_state=h.racc_tstack=e,P(d[0],"Racc_Runtime_Version","1.4.6"),P(d[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),P(d[0],"Racc_Runtime_Core_Version_R","1.4.6"),P(d[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),P(d[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),P(d[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),P(d[0],"Racc_Runtime_Core_Version",q("Racc_Runtime_Core_Version_R")),P(d[0],"Racc_Runtime_Core_Revision",q("Racc_Runtime_Core_Revision_R")),P(d[0],"Racc_Runtime_Type","ruby"),X(q("Parser"),"$racc_runtime_type",function(){return q("Racc_Runtime_Type")},0),j(i,"$_racc_setup",function(){var E,g,l=this,z=e,b=e,J=e;return null==C.stderr&&(C.stderr=e),c(p(l.$class(),"Racc_debug_parser"))||(l.yydebug=!1),c(null!=(E=l.yydebug)&&E!==e?"instance-variable":e)||(l.yydebug=!1),c(l.yydebug)&&(c(null!=(g=l.racc_debug_out)&&g!==e?"instance-variable":e)||(l.racc_debug_out=C.stderr),l.racc_debug_out=c(z=l.racc_debug_out)?z:C.stderr),b=p(l.$class(),"Racc_arg"),c(A(b.$size(),14))&&(G(b,"[]=",H(J=[13,!0])),F(J.length,1)),b},0),j(i,"$_racc_init_sysvars",function(){var E=this;return E.racc_state=[0],E.racc_tstack=[],E.racc_vstack=[],E.racc_t=e,E.racc_val=e,E.racc_read_next=!0,E.racc_user_yyerror=!1,E.racc_error_status=0},0),j(i,"$do_parse",function(){return this.$__send__(q("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),j(i,"$next_token",function(){return this.$raise(q("NotImplementedError"),this.$class()+"#next_token is not defined")},0),j(i,"$_racc_do_parse_rb",function(E,g){var l,b=this,J=e,re=e,V=e,ie=e,K=e,k=e,Z=e,S=e;return l=O(E),J=null==l[0]?e:l[0],re=null==l[1]?e:l[1],V=null==l[2]?e:l[2],ie=null==l[3]?e:l[3],K=null==l[10]?e:l[10],b.$_racc_init_sysvars(),k=Z=S=e,G(b,"catch",["racc_end_parse"],function w(){var $e,ee,Y=null==w.$$s?this:w.$$s,ce=e;for(null==Y.racc_state&&(Y.racc_state=e),null==Y.racc_read_next&&(Y.racc_read_next=e),null==Y.racc_t&&(Y.racc_t=e),null==Y.yydebug&&(Y.yydebug=e),null==Y.racc_val&&(Y.racc_val=e);c(!0);)for(c(S=ie["$[]"](Y.racc_state["$[]"](-1)))?(c(Y.racc_read_next)&&W(Y.racc_t,0)&&(ee=Y.$next_token(),$e=O(ee),k=null==$e[0]?e:$e[0],Y.racc_val=null==$e[1]?e:$e[1],Y.racc_t=c(k)?c(ce=K["$[]"](k))?ce:1:0,c(Y.yydebug)&&Y.$racc_read_token(Y.racc_t,k,Y.racc_val),Y.racc_read_next=!1),S=M(S,Y.racc_t),c(u(S,0))&&c(Z=J["$[]"](S))&&_(re["$[]"](S),Y.racc_state["$[]"](-1))||(Z=V["$[]"](Y.racc_state["$[]"](-1)))):Z=V["$[]"](Y.racc_state["$[]"](-1));c(Z=Y.$_racc_evalact(Z,E)););},{$$arity:0,$$s:b})},2),j(i,"$yyparse",function(E,g){return this.$__send__(q("Racc_YY_Parse_Method"),E,g,this.$_racc_setup(),!0)},2),j(i,"$_racc_yyparse_rb",function(E,g,l,z){var b,V=e,ie=e,Q=e,K=e,Z=e,S=e,w=e;return b=O(l),V=null==b[0]?e:b[0],ie=null==b[1]?e:b[1],Q=null==b[2]?e:b[2],K=null==b[3]?e:b[3],Z=null==b[10]?e:b[10],this.$_racc_init_sysvars(),S=e,w=e,G(this,"catch",["racc_end_parse"],function ne(){var Y=null==ne.$$s?this:ne.$$s;for(null==Y.racc_state&&(Y.racc_state=e);!c(w=K["$[]"](Y.racc_state["$[]"](-1)));)for(;c(S=Y.$_racc_evalact(Q["$[]"](Y.racc_state["$[]"](-1)),l)););return G(E,"__send__",[g],function ce(se,le){var ae=null==ce.$$s?this:ce.$$s,te=e,oe=e;for(null==ae.racc_t&&(ae.racc_t=e),null==ae.racc_state&&(ae.racc_state=e),null==ae.racc_read_next&&(ae.racc_read_next=e),null==se&&(se=e),null==le&&(le=e),ae.racc_t=c(se)?c(te=Z["$[]"](se))?te:1:0,ae.racc_val=le,ae.racc_read_next=!1,w=M(w,ae.racc_t),c(u(w,0))&&c(S=V["$[]"](w))&&_(ie["$[]"](w),ae.racc_state["$[]"](-1))||(S=Q["$[]"](ae.racc_state["$[]"](-1)));c(S=ae.$_racc_evalact(S,l)););for(;c(c(te=c(oe=(w=K["$[]"](ae.racc_state["$[]"](-1)))["$!"]())?oe:ae.racc_read_next["$!"]())?te:ae.racc_t["$=="](0));)for(c(w)&&c(w=M(w,ae.racc_t))&&c(u(w,0))&&c(S=V["$[]"](w))&&_(ie["$[]"](w),ae.racc_state["$[]"](-1))||(S=Q["$[]"](ae.racc_state["$[]"](-1)));c(S=ae.$_racc_evalact(S,l)););},{$$arity:2,$$s:Y})},{$$arity:0,$$s:this})},4),j(i,"$_racc_evalact",function(E,g){var l,Q,b=this,J=e,re=e,ie=e,K=e,k=e,Z=e,S=e;if(J=null==(l=O(g))[0]?e:l[0],re=null==l[1]?e:l[1],ie=null==l[3]?e:l[3],Q=null==l[11]?e:l[11],K=null==l[12]?e:l[12],c(D(E,0))&&c(A(E,Q)))c(D(b.racc_error_status,0))&&(_(b.racc_t,1)||(b.racc_error_status=F(b.racc_error_status,1))),b.racc_vstack.$push(b.racc_val),b.racc_state.$push(E),b.racc_read_next=!0,c(b.yydebug)&&(b.racc_tstack.$push(b.racc_t),b.$racc_shift(b.racc_t,b.racc_tstack,b.racc_vstack));else if(c(A(E,0))&&c(D(E,K["$-@"]()))){if(k=G(b,"catch",["racc_jump"],function w(){var ne=null==w.$$s?this:w.$$s;return null==ne.racc_state&&(ne.racc_state=e),ne.racc_state.$push(ne.$_racc_do_reduce(g,E)),!1},{$$arity:0,$$s:b}),c(k)){if(B(1,Z=k))return b.racc_user_yyerror=!0,K["$-@"]();if(B(2,Z))return Q;b.$raise("[Racc Bug] unknown jump code")}}else if(_(E,Q))c(b.yydebug)&&b.$racc_accept(),b.$throw("racc_end_parse",b.racc_vstack["$[]"](0));else{if(_(E,K["$-@"]())){for(B(0,Z=b.racc_error_status)?c(g["$[]"](21))||b.$on_error(b.racc_t,b.racc_val,b.racc_vstack):B(3,Z)&&(_(b.racc_t,0)&&b.$throw("racc_end_parse",e),b.racc_read_next=!0),b.racc_user_yyerror=!1,b.racc_error_status=3;c(!0)&&!(c(S=ie["$[]"](b.racc_state["$[]"](-1)))&&(S=M(S,1),c(u(S,0))&&c(E=J["$[]"](S))&&_(re["$[]"](S),b.racc_state["$[]"](-1))));)c(N(b.racc_state.$size(),1))&&b.$throw("racc_end_parse",e),b.racc_state.$pop(),b.racc_vstack.$pop(),c(b.yydebug)&&(b.racc_tstack.$pop(),b.$racc_e_pop(b.racc_state,b.racc_tstack,b.racc_vstack));return E}b.$raise("[Racc Bug] unknown action "+E.$inspect())}return c(b.yydebug)&&b.$racc_next_state(b.racc_state["$[]"](-1),b.racc_state),e},2),j(i,"$_racc_do_reduce",function(E,g){var l,K,Z,Y,ce,se,ae,b=this,re=e,V=e,ie=e,Q=e,k=e,S=e,w=e,ne=e,$e=e,ee=e,le=e,_e=e,ue=e,te=e;return re=null==(l=O(E))[4]?e:l[4],V=null==l[5]?e:l[5],ie=null==l[6]?e:l[6],Q=null==l[7]?e:l[7],K=null==l[8]?e:l[8],k=null==l[9]?e:l[9],Z=null==l[13]?e:l[13],S=b.racc_state,w=b.racc_vstack,ne=b.racc_tstack,$e=T(g,-3),ee=k["$[]"]($e),Y=k["$[]"](M($e,1)),ce=k["$[]"](M($e,2)),se=[],c(b.yydebug)&&(le=ne["$[]"](ee["$-@"](),ee)),_e=w["$[]"](ee["$-@"](),ee),c(b.yydebug)&&(ue=[ee["$-@"](),ee,se],G(ne,"[]=",H(ue)),F(ue.length,1)),ue=[ee["$-@"](),ee,se],G(w,"[]=",H(ue)),F(ue.length,1),ue=[ee["$-@"](),ee,se],G(S,"[]=",H(ue)),F(ue.length,1),c(Z)?w.$push(b.$__send__(ce,_e,w,_e["$[]"](0))):w.$push(b.$__send__(ce,_e,w)),ne.$push(Y),c(b.yydebug)&&b.$racc_reduce(le,Y,ne,w),ae=F(Y,K),c($e=Q["$[]"](ae))&&($e=M($e,S["$[]"](-1)),c(u($e,0))&&c(te=re["$[]"]($e))&&_(V["$[]"]($e),ae))?te:ie["$[]"](ae)},2),j(i,"$on_error",function(E,g,l){var b,z=this;return z.$raise(q("ParseError"),z.$sprintf("\nparse error on value %s (%s)",g.$inspect(),c(b=z.$token_to_str(E))?b:"?"))},3),j(i,"$yyerror",function(){return this.$throw("racc_jump",1)},0),j(i,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),j(i,"$yyerrok",function(){return this.racc_error_status=0},0),j(i,"$racc_read_token",function(E,g,l){var z=this;return z.racc_debug_out.$print("read    "),z.racc_debug_out.$print(g.$inspect(),"(",z.$racc_token2str(E),") "),z.racc_debug_out.$puts(l.$inspect()),z.racc_debug_out.$puts()},3),j(i,"$racc_shift",function(E,g,l){var z=this;return z.racc_debug_out.$puts("shift   "+z.$racc_token2str(E)),z.$racc_print_stacks(g,l),z.racc_debug_out.$puts()},3),j(i,"$racc_reduce",function(E,g,l,z){var b=this,J=e;return(J=b.racc_debug_out).$print("reduce "),c(E["$empty?"]())?J.$print(" <none>"):G(E,"each",[],function re(V){return null==V&&(V=e),J.$print(" ",(null==re.$$s?this:re.$$s).$racc_token2str(V))},{$$arity:1,$$s:b}),J.$puts(" --\x3e "+b.$racc_token2str(g)),b.$racc_print_stacks(l,z),b.racc_debug_out.$puts()},4),j(i,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),j(i,"$racc_e_pop",function(E,g,l){var z=this;return z.racc_debug_out.$puts("error recovering mode: pop token"),z.$racc_print_states(E),z.$racc_print_stacks(g,l),z.racc_debug_out.$puts()},3),j(i,"$racc_next_state",function(E,g){var l=this;return l.racc_debug_out.$puts("goto    "+E),l.$racc_print_states(g),l.racc_debug_out.$puts()},2),j(i,"$racc_print_stacks",function(E,g){var z=e;return(z=this.racc_debug_out).$print("        ["),G(E,"each_index",[],function b(J){return null==J&&(J=e),z.$print(" (",(null==b.$$s?this:b.$$s).$racc_token2str(E["$[]"](J))," ",g["$[]"](J).$inspect(),")")},{$$arity:1,$$s:this}),z.$puts(" ]")},2),j(i,"$racc_print_states",function(E){var l=e;return(l=this.racc_debug_out).$print("        ["),G(E,"each",[],function(b){return null==b&&(b=e),l.$print(" ",b)},1),l.$puts(" ]")},1),j(i,"$racc_token2str",function(E){var l;return c(l=p(this.$class(),"Racc_token_to_s_table")["$[]"](E))?l:this.$raise("[Racc Bug] can't convert token "+E+" to string")},1),j(i,"$token_to_str",function(E){return p(this.$class(),"Racc_token_to_s_table")["$[]"](E)},1)}(t[0],t)},Opal.modules["bcdice/arithmetic/node"]=function(r){var j,_,N,o,a,m,R,D,W,U=[],t=r.nil,v=r.$$$,e=r.module,p=r.klass,L=r.def,I=r.send2,c=r.find_super,P=r.eqeq,X=r.const_set,C=r.eqeqeq,A=r.rb_divide,G=r.truthy,H=r.alias;return j=U,_=W=[e(U[0],"BCDice")].concat(j),N=D=[e(W[0],"Arithmetic")].concat(_),m=[e(D[0],"Node")].concat(N),R=r.$r(m),(a=(o=p(m[0],null,"BinaryOp")).$$prototype).lhs=a.rhs=a.op=t,L(o,"$initialize",function($,n,i){var d=this;return d.lhs=$,d.op=n,d.rhs=i},3),L(o,"$eval",function($){var d,n=this,i=t;return i=n.lhs.$eval($),d=n.rhs.$eval($),i.$send(n.op,d)},1),L(o,"$output",function(){var $=this;return""+$.lhs.$output()+$.op+$.rhs.$output()},0),L(o,"$s_exp",function(){var $=this;return"("+$.$op_for_s_exp()+" "+$.lhs.$s_exp()+" "+$.rhs.$s_exp()+")"},0),L(o,"$op_for_s_exp",function(){return this.op},0),function(y,f,o){var a=p(y,f,"DivideBase"),s=[a].concat(o),$=r.$r(s),n=a.$$prototype;n.lhs=n.rhs=n.op=t,L(a,"$initialize",function i(d,q){return delete i.$$p,I(this,c(this,"initialize",i,!1,!0),"initialize",[d,"/",q],null)},2),L(a,"$eval",function(d){var h,x,q=this;return h=q.lhs.$eval(d),x=q.rhs.$eval(d),P(x,0)&&q.$raise($("ZeroDivisionError")),q.$divide_and_round(h,x,d)},1),L(a,"$output",function i(){var d=i.$$p||t,q=this;return delete i.$$p,""+I(q,c(q,"output",i,!1,!0),"output",[],d)+q.$rounding_method()},0),a.$private(),L(a,"$rounding_method",function(){return v(this.$class(),"ROUNDING_METHOD")},0),L(a,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),L(a,"$divide_and_round",function(d,q,h){return this.$raise($("NotImplementedError"))},3)}(m[0],R("BinaryOp"),m),function(y,f,o){var a=p(y,f,"DivideWithGameSystemDefault"),s=[a].concat(o),$=r.$r(s);X(s[0],"ROUNDING_METHOD",""),a.$private(),L(a,"$divide_and_round",function(i,d,q){var h,x=t;return C(v($("RoundType"),"CEIL"),h=q)?A(i.$to_f(),d).$ceil():C(v($("RoundType"),"ROUND"),h)?(x=A(i.$to_f(),d),G(x["$negative?"]())?x.$abs().$round()["$-@"]():x.$round()):A(i,d).$floor()},3)}(m[0],R("DivideBase"),m),function(y,f,o){var a=p(y,f,"DivideWithCeil"),s=[a].concat(o);X(s[0],"ROUNDING_METHOD","C"),a.$private(),L(a,"$divide_and_round",function(n,i,d){return A(n.$to_f(),i).$ceil()},3)}(m[0],R("DivideBase"),m),function(y,f,o){var a=p(y,f,"DivideWithRound"),s=[a].concat(o);X(s[0],"ROUNDING_METHOD","R"),a.$private(),L(a,"$divide_and_round",function(n,i,d){var q=t;return q=A(n.$to_f(),i),G(q["$negative?"]())?q.$abs().$round()["$-@"]():q.$round()},3)}(m[0],R("DivideBase"),m),function(y,f,o){var a=p(y,f,"DivideWithFloor"),s=[a].concat(o);X(s[0],"ROUNDING_METHOD","F"),a.$private(),L(a,"$divide_and_round",function(n,i,d){return A(n,i).$floor()},3)}(m[0],R("DivideBase"),m),function(y,f){var o=p(y,null,"Negative");o.$$prototype.body=t,L(o,"$initialize",function($){return this.body=$},1),L(o,"$eval",function($){return this.body.$eval($)["$-@"]()},1),L(o,"$output",function(){return"-"+this.body.$output()},0),L(o,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(m[0]),function(y,f){var o=p(y,null,"Parenthesis");o.$$prototype.expr=t,L(o,"$initialize",function($){return this.expr=$},1),L(o,"$eval",function($){return this.expr.$eval($)},1),L(o,"$output",function(){return"("+this.expr.$output()+")"},0),L(o,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(m[0]),function(y,f){var o=p(y,null,"Number");return o.$$prototype.value=t,L(o,"$initialize",function($){return this.value=$},1),L(o,"$eval",function($){return this.value},1),L(o,"$output",function(){return this.value.$to_s()},0),H(o,"s_exp","output")}(m[0])},Opal.modules.strscan=function(r){var H,F,j,O,W,U=[],t=r.nil,e=r.def,p=r.truthy,L=r.eqeqeq,I=r.Opal,c=r.send,P=r.to_a,X=r.rb_minus,C=r.alias;return H=U,j=[F=(0,r.klass)(U[0],null,"StringScanner")].concat(H),O=r.$r(j),(W=F.$$prototype).pos=W.string=W.working=W.matched=W.prev_pos=W.match=t,F.$attr_reader("pos","matched"),e(F,"$initialize",function(_){var u=this;return u.string=_,u.pos=0,u.matched=t,u.working=_,u.match=[]},1),F.$attr_reader("string"),e(F,"$beginning_of_line?",function(){var _=this;return 0===_.pos||"\n"===_.string.charAt(_.pos-1)},0),e(F,"$scan",function(_){var u=this,D=(_=u.$anchor(_)).exec(u.working);return null==D?u.matched=t:"object"==typeof D?(u.prev_pos=u.pos,u.pos+=D[0].length,u.working=u.working.substring(D[0].length),u.matched=D[0],u.match=D,D[0]):"string"==typeof D?(u.pos+=D.length,u.working=u.working.substring(D.length),D):t},1),e(F,"$scan_until",function(_){var u=this;_=u.$anchor(_);for(var N,D=u.pos,B=u.working;;){if(N=_.exec(B),D+=1,B=B.substr(1),null!=N)return u.matched=u.string.substr(u.pos,D-u.pos-1+N[0].length),u.match=N,u.prev_pos=D-1,u.pos=D,u.working=B.substr(N[0].length),u.matched;if(0===B.length)return u.match=[],u.matched=t}},1),e(F,"$[]",function(_){var D;if(p(this.match["$empty?"]()))return t;L(O("Symbol"),D=_)?_=_.$to_s():L(O("String"),D)||(_=I["$coerce_to!"](_,O("Integer"),"to_int"));var B=this.match;return _<0&&(_+=B.length),_<0||_>=B.length||null==B[_]?t:B[_]},1),e(F,"$check",function(_){var u=this,D=(_=u.$anchor(_)).exec(u.working);return u.matched=null==D?t:D[0]},1),e(F,"$check_until",function(_){var u=this,D=u.prev_pos,B=u.pos,N=u.$scan_until(_);return N!==t&&(u.matched=N.substr(-1),u.working=u.string.substr(B)),u.prev_pos=D,u.pos=B,N},1),e(F,"$peek",function(_){return this.working.substring(0,_)},1),e(F,"$eos?",function(){return 0===this.working.length},0),e(F,"$exist?",function(_){var D=_.exec(this.working);return null==D?t:0==D.index?0:D.index+1},1),e(F,"$skip",function(_){var u=this,D=(_=u.$anchor(_)).exec(u.working);if(null==D)return u.match=[],u.matched=t;var B=D[0],N=B.length;return u.matched=B,u.match=D,u.prev_pos=u.pos,u.pos+=N,u.working=u.working.substring(N),N},1),e(F,"$skip_until",function(_){var D=this.$scan_until(_);return D===t?t:(this.matched=D.substr(-1),D.length)},1),e(F,"$get_byte",function(){var _=this,u=t;return _.pos<_.string.length?(_.prev_pos=_.pos,_.pos+=1,u=_.matched=_.working.substring(0,1),_.working=_.working.substring(1)):_.matched=t,u},0),e(F,"$match?",function(_){var u=this,D=(_=u.$anchor(_)).exec(u.working);return null==D?t:(u.prev_pos=u.pos,D[0].length)},1),e(F,"$pos=",function(_){var u=this;return _<0&&(_+=u.string.$length()),u.pos=_,u.working=u.string.slice(_)},1),e(F,"$matched_size",function(){return this.matched===t?t:this.matched.length},0),e(F,"$post_match",function(){var _=this;return _.matched===t?t:_.string.substr(_.pos)},0),e(F,"$pre_match",function(){var _=this;return _.matched===t?t:_.string.substr(0,_.prev_pos)},0),e(F,"$reset",function(){var _=this;return _.working=_.string,_.matched=t,_.pos=0},0),e(F,"$rest",function(){return this.working},0),e(F,"$rest?",function(){return 0!==this.working.length},0),e(F,"$rest_size",function(){return this.$rest().$size()},0),e(F,"$terminate",function(){var u,_=this;return _.match=t,u=[_.string.$length()],c(_,"pos=",P(u)),u[X(u.length,1)]},0),e(F,"$unscan",function(){var _=this;return _.pos=_.prev_pos,_.prev_pos=t,_.match=t,_},0),C(F,"bol?","beginning_of_line?"),C(F,"getch","get_byte"),F.$private(),e(F,"$anchor",function(_){var u=_.toString().match(/\/([^\/]+)$/);return u=u?u[1]:void 0,new RegExp("^(?:"+_.source+")",u)},1)},Opal.modules["bcdice/normalize"]=function(r){var c,A,X,U=[],t=r.nil,v=r.module,e=r.eqeqeq,p=r.def,L=r.eqeq;return c=U,X=[v(U[0],"BCDice")].concat(c),(A=v(X[0],"Normalize")).$module_function(),p(A,"$comparison_operator",function(H){var F;return e(/<=|=</,F=H)?"<=":e(/>=|=>/,F)?">=":e(/<>|!=|=!/,F)?"!=":e(/</,F)?"<":e(/>/,F)?">":e(/=/,F)?"==":t},1),p(A,"$target_number",function(H){return L(H,"?")?H:H.$to_i()},1)},Opal.modules["bcdice/command/lexer"]=function(r){var A,j,u,D,B,N,T,W,H,U=r.top,t=[],v=r.nil,e=r.module,p=r.klass,L=r.const_set,I=r.hash2,c=r.truthy,P=r.send,X=r.def;return U.$require("strscan"),U.$require("bcdice/normalize"),A=t,j=H=[e(t[0],"BCDice")].concat(A),u=W=[e(H[0],"Command")].concat(j),B=[D=p(W[0],null,"Lexer")].concat(u),N=r.$r(B),(T=D.$$prototype).scanner=T.notations=v,L(B[0],"SYMBOLS",I(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),X(D,"$initialize",function(R,y){var f,o,s;return R=c(s=(o=(f=R)===v||null==f?v:P(f,"split",[" ",2]))===v||null==o?v:P(o,"first",[]))?s:"",this.scanner=N("StringScanner").$new(R),this.notations=P(y,"map",[],function(n){return null==n&&(n=v),c(n["$is_a?"](N("String")))?N("Regexp").$new(n):n},1)},2),X(D,"$next_token",function(){try{var R=this,y=v,f=v,a=v,s=v;return c(R.scanner["$eos?"]())?[!1,"$"]:(P(R.notations,"each",[],function $(n){var d,i=null==$.$$s?this:$.$$s;if(null==i.scanner&&(i.scanner=v),null==n&&(n=v),d=i.scanner.$scan(n),!c(d))return v;r.ret(["NOTATION",d])},{$$arity:1,$$s:R}),c(y=R.scanner.$scan(/\d+/))?["NUMBER",y.$to_i()]:c(f=R.scanner.$scan(/[<>!=]+/))?(f=N("Normalize").$comparison_operator(f),[c(f)?"CMP_OP":"ILLEGAL",f]):(a=R.scanner.$getch().$upcase(),[c(s=N("SYMBOLS")["$[]"](a))?s:a.$to_sym(),a]))}catch($){if($===r.returner)return $.$v;throw $}},0),X(D,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/command/parsed"]=function(r){var P,G,W,M,_,u,D,F,C,U=[],t=r.nil,v=r.module,e=r.klass,p=r.def,L=r.truthy,I=r.eqeqeq;return P=U,G=C=[v(U[0],"BCDice")].concat(P),W=F=[v(C[0],"Command")].concat(G),_=[M=e(F[0],null,"Parsed")].concat(W),u=r.$r(_),(D=M.$$prototype).question_target=D.critical=D.fumble=D.dollar=D.modify_number=D.target_number=D.prefix_number=D.command=D.suffix_number=D.cmp_op=t,M.$attr_accessor("command"),M.$attr_accessor("prefix_number"),M.$attr_accessor("suffix_number"),M.$attr_accessor("critical"),M.$attr_accessor("fumble"),M.$attr_accessor("dollar"),M.$attr_accessor("modify_number"),M.$attr_accessor("cmp_op"),M.$attr_accessor("target_number"),M.$attr_writer("question_target"),p(M,"$initialize",function(){var N=this;return N.prefix_number=t,N.suffix_number=t,N.critical=t,N.fumble=t,N.dollar=t,N.cmp_op=t,N.target_number=t,N.question_target=!1},0),p(M,"$question_target?",function(){return this.question_target},0),p(M,"$to_s",function(N){var a,T=this,m=t,R=t,y=t,f=t,o=t;return null==N&&(N="after_command"),m=L(T.critical)?"@"+T.critical:t,R=L(T.fumble)?"#"+T.fumble:t,y=L(T.dollar)?"$"+T.dollar:t,f=u("Format").$modifier(T.modify_number),o=L(T.question_target)?"?":T.target_number,I("after_command",a=N)?[T.prefix_number,T.command,T.suffix_number,m,R,y,f,T.cmp_op,o].$join():I("after_modify_number",a)?[T.prefix_number,T.command,T.suffix_number,f,m,R,y,T.cmp_op,o].$join():I("after_target_number",a)?[T.prefix_number,T.command,T.suffix_number,f,T.cmp_op,o,m,R,y].$join():t},-1)},Opal.modules["bcdice/command/parser"]=function(r){var u,T,a,i,d,q,h,x,E,g,l,z,re,s,$,n,Q,R,y,B,U=r.top,t=[],v=r.$r(t),e=r.nil,p=r.$$$,L=r.klass,I=r.module,c=r.hash2,P=r.send2,X=r.find_super,C=r.def,A=r.send,G=r.to_a,H=r.rb_minus,F=r.eqeq,j=r.hash,O=r.const_set,W=r.truthy,M=r.to_ary;return U.$require("racc/parser.rb"),U.$require("bcdice/arithmetic/node"),U.$require("bcdice/command/lexer"),U.$require("bcdice/command/parsed"),L(p(v("BCDice"),"Command"),p(v("Racc"),"Parser"),"Parser"),u=t,T=B=[I(t[0],"BCDice")].concat(u),R=[I(B[0],"Command")].concat(T),y=r.$r(R),a=R,$=[s=L(R[0],p(y("Racc"),"Parser"),"Parser")].concat(a),n=r.$r($),(Q=s.$$prototype).notations=Q.lexer=Q.modifier=Q.suffix_number=Q.prefix_number=Q.need_suffix_number=Q.need_prefix_number=Q.critical=Q.fumble=Q.dollar=Q.allowed_cmp_op=Q.question_target=e,C(s,"$initialize",function K(k,Z){var S,w,ne,$e,Y=this;if(delete K.$$p,S=r.slice.call(arguments),null==(w=r.extract_kwargs(S)))w=c([],{});else if(!w.$$is_hash)throw r.ArgumentError.$new("expected kwargs");if(ne=S,!r.hasOwnProperty.call(w.$$smap,"round_type"))throw r.ArgumentError.$new("missing keyword: round_type");return $e=w.$$smap.round_type,P(Y,X(Y,"initialize",K,!1,!0),"initialize",[],null),Y.notations=ne,Y.round_type=$e,Y.prefix_number=!1,Y.suffix_number=!1,Y.need_prefix_number=!1,Y.need_suffix_number=!1,Y.modifier=!0,Y.critical=!1,Y.fumble=!1,Y.dollar=!1,Y.allowed_cmp_op=[e,">=",">","<=","<","==","!="],Y.question_target=!1},-2),C(s,"$disable_modifier",function(){return this.modifier=!1,this},0),C(s,"$enable_prefix_number",function(){return this.prefix_number=!0,this},0),C(s,"$enable_suffix_number",function(){return this.suffix_number=!0,this},0),C(s,"$has_prefix_number",function(){var k=this;return k.prefix_number=!0,k.need_prefix_number=!0,k},0),C(s,"$has_suffix_number",function(){var k=this;return k.suffix_number=!0,k.need_suffix_number=!0,k},0),C(s,"$enable_critical",function(){return this.critical=!0,this},0),C(s,"$enable_fumble",function(){return this.fumble=!0,this},0),C(s,"$enable_dollar",function(){return this.dollar=!0,this},0),C(s,"$restrict_cmp_op_to",function(k){var Z,w=this;return Z=r.slice.call(arguments),w.allowed_cmp_op=Z,w},-1),C(s,"$enable_question_target",function(){return this.question_target=!0,this},0),C(s,"$parse",function(k){var Z=this;try{return Z.lexer=n("Lexer").$new(k,Z.notations),Z.$do_parse()}catch(S){if(!r.rescue(S,[n("ParseError"),n("ZeroDivisionError")]))throw S;try{return e}finally{r.pop_exception()}}},1),s.$private(),C(s,"$parsed",function(k,Z,S,w){return A(n("Parsed").$new(),"tap",[],function $e(ee){var Y,ce,se,le,_e,ue,ae=null==$e.$$s?this:$e.$$s,te=e;return null==ae.round_type&&(ae.round_type=e),null==ee&&(ee=e),te=[k["$[]"]("command")],A(ee,"command=",G(te)),H(te.length,1),te=[(Y=k["$[]"]("prefix"),Y===e||null==Y?e:A(Y,"eval",[ae.round_type]))],A(ee,"prefix_number=",G(te)),H(te.length,1),te=[(ce=k["$[]"]("suffix"),ce===e||null==ce?e:A(ce,"eval",[ae.round_type]))],A(ee,"suffix_number=",G(te)),H(te.length,1),te=[(se=Z["$[]"]("critical"),se===e||null==se?e:A(se,"eval",[ae.round_type]))],A(ee,"critical=",G(te)),H(te.length,1),te=[(le=Z["$[]"]("fumble"),le===e||null==le?e:A(le,"eval",[ae.round_type]))],A(ee,"fumble=",G(te)),H(te.length,1),te=[(_e=Z["$[]"]("dollar"),_e===e||null==_e?e:A(_e,"eval",[ae.round_type]))],A(ee,"dollar=",G(te)),H(te.length,1),te=[S.$eval(ae.round_type)],A(ee,"modify_number=",G(te)),H(te.length,1),te=[w["$[]"]("cmp_op")],A(ee,"cmp_op=",G(te)),H(te.length,1),F(w["$[]"]("target"),"?")?(A(ee,"question_target=",G(te=[!0])),H(te.length,1),A(ee,"target_number=",G(te=[0])),te[H(te.length,1)]):(A(ee,"question_target=",G(te=[!1])),H(te.length,1),te=[(ue=w["$[]"]("target"),ue===e||null==ue?e:A(ue,"eval",[ae.round_type]))],A(ee,"target_number=",G(te)),te[H(te.length,1)])},{$$arity:1,$$s:this})},4),C(s,"$next_token",function(){return this.lexer.$next_token()},0),i=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,33,34,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,e,e,17,18,6,e,5,e,e,17,18,e,e,5,23,24,25,26,56,54,55,57],d=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,e,17,15,15,18,18,23,e,18,30,30,23,23,24,e,23,31,31,24,24,25,e,24,44,44,25,25,28,e,25,47,47,28,28,29,e,28,48,48,29,29,33,e,29,49,49,33,33,34,e,33,50,50,34,34,36,e,34,e,e,36,36,37,e,36,e,e,37,37,e,e,37,27,27,27,27,52,52,52,52],q=[-2,4,16,-3,-1,11,e,33,13,35,23,30,1,e,28,40,e,37,44,e,e,-2,e,51,58,65,0,106,72,79,47,54,e,86,93,e,100,107,e,e,e,e,e,e,63,e,e,68,75,82,89,e,120,e,e,e,e,e],h=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],x=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,e,e,21,47,48,40,51,52,49,50,44,46,3,e,e,e,13,e,e,e,e,e,e,e,32],E=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,e,e,4,8,8,5,7,7,8,8,9,5,6,e,e,e,6,e,e,e,e,e,e,e,6],g=[e,6,13,3,9,-1,27,-15,-10,-1,-38],l=[e,e,e,e,e,e,19,16,15,e,e],z=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],re=j(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),O($[0],"Racc_arg",[i,d,h,q,x,E,l,g,19,z,re,58,35,!0]),O($[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),O($[0],"Racc_debug_parser",!1),C(s,"$_reduce_1",function(k,Z,S){var w;return W(this.modifier)||this.$raise(n("ParseError")),w=M(k),this.$parsed(null==w[0]?e:w[0],null==w[1]?e:w[1],null==w[2]?e:w[2],null==w[3]?e:w[3])},3),C(s,"$_reduce_2",function(k,Z,S){var w;return W(this.modifier)||this.$raise(n("ParseError")),w=M(k),this.$parsed(null==w[0]?e:w[0],null==w[2]?e:w[2],null==w[1]?e:w[1],null==w[3]?e:w[3])},3),C(s,"$_reduce_3",function(k,Z,S){var w,ce;return ce=null==(w=M(k))[2]?e:w[2],this.$parsed(null==w[0]?e:w[0],null==w[1]?e:w[1],p(p(n("Arithmetic"),"Node"),"Number").$new(0),ce)},3),C(s,"$_reduce_4",function(k,Z,S){var w=this;return W(w.prefix_number)&&W(w.suffix_number)||w.$raise(n("ParseError")),c(["command","prefix","suffix"],{command:k["$[]"](1),prefix:k["$[]"](0),suffix:k["$[]"](2)})},3),C(s,"$_reduce_5",function(k,Z,S){var w=this;return W(w.prefix_number)||w.$raise(n("ParseError")),W(w.need_suffix_number)&&w.$raise(n("ParseError")),c(["command","prefix"],{command:k["$[]"](1),prefix:k["$[]"](0)})},3),C(s,"$_reduce_6",function(k,Z,S){var w=this;return W(w.suffix_number)||w.$raise(n("ParseError")),W(w.need_prefix_number)&&w.$raise(n("ParseError")),c(["command","suffix"],{command:k["$[]"](0),suffix:k["$[]"](1)})},3),C(s,"$_reduce_7",function(k,Z,S){var w=this;return(W(w.need_prefix_number)||W(w.need_suffix_number))&&w.$raise(n("ParseError")),c(["command"],{command:k["$[]"](0)})},3),C(s,"$_reduce_8",function(k,Z,S){return c([],{})},3),C(s,"$_reduce_9",function(k,Z,S){var w,ce,se,ee=e;return ee=null==(w=M(k))[0]?e:w[0],ce=null==w[2]?e:w[2],W(this.critical)&&W(ee["$[]"]("critical")["$nil?"]())||this.$raise(n("ParseError")),A(ee,"[]=",G(se=["critical",ce])),H(se.length,1),ee},3),C(s,"$_reduce_10",function(k,Z,S){var w,ce,se,ee=e;return ee=null==(w=M(k))[0]?e:w[0],ce=null==w[2]?e:w[2],W(this.fumble)&&W(ee["$[]"]("fumble")["$nil?"]())||this.$raise(n("ParseError")),A(ee,"[]=",G(se=["fumble",ce])),H(se.length,1),ee},3),C(s,"$_reduce_11",function(k,Z,S){var w,ce,se,ee=e;return ee=null==(w=M(k))[0]?e:w[0],ce=null==w[2]?e:w[2],W(this.dollar)&&W(ee["$[]"]("dollar")["$nil?"]())||this.$raise(n("ParseError")),A(ee,"[]=",G(se=["dollar",ce])),H(se.length,1),ee},3),C(s,"$_reduce_12",function(k,Z,S){return k["$[]"](1)},3),C(s,"$_reduce_13",function(k,Z,S){return p(p(n("Arithmetic"),"Node"),"Negative").$new(k["$[]"](1))},3),C(s,"$_reduce_14",function(k,Z,S){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(k["$[]"](0),"+",k["$[]"](2))},3),C(s,"$_reduce_15",function(k,Z,S){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(k["$[]"](0),"-",k["$[]"](2))},3),C(s,"$_reduce_16",function(k,Z,S){return W(this.allowed_cmp_op["$include?"](e))||this.$raise(n("ParseError")),c([],{})},3),C(s,"$_reduce_17",function(k,Z,S){var w,ee,Y;return Y=null==(w=M(k))[1]?e:w[1],W(this.allowed_cmp_op["$include?"](ee=null==w[0]?e:w[0]))||this.$raise(n("ParseError")),c(["cmp_op","target"],{cmp_op:ee,target:Y})},3),C(s,"$_reduce_18",function(k,Z,S){var ne,w=this;return ne=k["$[]"](0),W(w.question_target)||w.$raise(n("ParseError")),W(w.allowed_cmp_op["$include?"](ne))||w.$raise(n("ParseError")),c(["cmp_op","target"],{cmp_op:ne,target:"?"})},3),C(s,"$_reduce_19",function(k,Z,S){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(k["$[]"](0),"+",k["$[]"](2))},3),C(s,"$_reduce_20",function(k,Z,S){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(k["$[]"](0),"-",k["$[]"](2))},3),C(s,"$_reduce_22",function(k,Z,S){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(k["$[]"](0),"*",k["$[]"](2))},3),C(s,"$_reduce_23",function(k,Z,S){return k["$[]"](3).$new(k["$[]"](0),k["$[]"](2))},3),C(s,"$_reduce_25",function(k,Z,S){return p(p(n("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),C(s,"$_reduce_26",function(k,Z,S){return p(p(n("Arithmetic"),"Node"),"DivideWithCeil")},3),C(s,"$_reduce_27",function(k,Z,S){return p(p(n("Arithmetic"),"Node"),"DivideWithCeil")},3),C(s,"$_reduce_28",function(k,Z,S){return p(p(n("Arithmetic"),"Node"),"DivideWithRound")},3),C(s,"$_reduce_29",function(k,Z,S){return p(p(n("Arithmetic"),"Node"),"DivideWithFloor")},3),C(s,"$_reduce_30",function(k,Z,S){return k["$[]"](1)},3),C(s,"$_reduce_31",function(k,Z,S){return p(p(n("Arithmetic"),"Node"),"Negative").$new(k["$[]"](1))},3),C(s,"$_reduce_33",function(k,Z,S){return k["$[]"](1)},3),C(s,"$_reduce_34",function(k,Z,S){return p(p(n("Arithmetic"),"Node"),"Number").$new(k["$[]"](0))},3),C(s,"$_reduce_none",function(k,Z,S){return k["$[]"](0)},3)},Opal.modules["bcdice/deprecated/checker"]=function(r){var P,G,O,W,M,_,F,C,U=[],t=r.nil,v=r.module,e=r.send,p=r.eqeqeq,L=r.truthy,I=r.def;return P=U,G=C=[v(U[0],"BCDice")].concat(P),O=F=[v(C[0],"Deprecated")].concat(G),M=[W=v(F[0],"Checker")].concat(O),_=r.$r(M),W.$private(),I(W,"$check_result_legacy",function(D,B,N,T){var f,m=this,R=t,y=t,o=t,a=t;return R=e(B,"map",[],"sides".$to_proc()),f=(y=e(B,"map",[],"value".$to_proc())).$sum(),o=p([100],a=R)?m.$check_1D100(D,f,N,T):p([20],a)?m.$check_1D20(D,f,N,T):p([6,6],a)?m.$check_2D6(D,f,y,N,T):t,(L(o["$nil?"]())||L(o["$empty?"]()))&&(o=p([10],a=R.$uniq())?m.$check_nD10(D,f,y,N,T):p([6],a)?m.$check_nD6(D,f,y,N,T):t,L(o["$nil?"]())||L(o["$empty?"]()))?t:_("Result").$new(o.$delete_prefix(" \uff1e "))},4),I(W,"$check_1D100",function(D,B,N,T){return t},4),I(W,"$check_1D20",function(D,B,N,T){return t},4),I(W,"$check_nD10",function(D,B,N,T,m){return t},5),I(W,"$check_2D6",function(D,B,N,T,m){return t},5),I(W,"$check_nD6",function(D,B,N,T,m){return t},5)},Opal.modules["bcdice/base"]=function(r){var B,y,$,i,d,f,o,a,s,T,U=r.top,t=[],v=r.$r(t),e=r.nil,p=r.$$$,L=r.module,I=r.klass,c=r.truthy,P=r.def,X=r.regexp,C=r.rb_plus,A=r.send,G=r.to_a,H=r.rb_minus,F=r.eqeqeq,j=r.eqeq,O=r.range,W=r.rb_divide,M=r.rb_times,_=r.rb_ge,u=e;return U.$require("i18n"),U.$require("i18n/backend/fallbacks"),U.$require("bcdice/randomizer"),U.$require("bcdice/dice_table"),U.$require("bcdice/enum"),U.$require("bcdice/translate"),U.$require("bcdice/result"),U.$require("bcdice/command/parser"),U.$require("bcdice/deprecated/checker"),B=t,y=T=[L(t[0],"BCDice")].concat(B),o=[f=I(T[0],null,"Base")].concat(y),a=r.$r(o),(s=f.$$prototype).sort_add_dice=s.sort_barabara_dice=s.enabled_d9=s.raw_input=s.randomizer=s.enabled_upcase_input=s.debug=e,i=[$=r.get_singleton_class(f)].concat(o),d=r.$r(i),$.$attr_reader("prefixes"),P($,"$register_prefix",function(h){var E,g=this,l=e;return null==g.prefixes&&(g.prefixes=e),E=r.slice.call(arguments),g.prefixes=c(l=g.prefixes)?l:[],g.prefixes.$concat(E.$flatten())},-1),P($,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())},0),P($,"$prefixes_pattern",function(){var h=this,x=e;return null==h.prefixes_pattern&&(h.prefixes_pattern=e),null==h.prefixes&&(h.prefixes=e),h.prefixes_pattern=c(x=h.prefixes_pattern)?x:e,c(h.prefixes_pattern)?h.prefixes_pattern:(h.prefixes=c(x=h.prefixes)?x:[],h.prefixes.$freeze(),h.prefixes_pattern=(c(h.prefixes["$empty?"]())?/(?!)/:X(["^(S)?(",h.prefixes.$join("|"),")"],"i")).$freeze())},0),P($,"$command_pattern",function(){var h=this,x=e,E=e;return null==h.command_pattern&&(h.command_pattern=e),null==h.prefixes&&(h.prefixes=e),h.command_pattern=c(x=h.command_pattern)?x:e,c(h.command_pattern)?h.command_pattern:(h.prefixes=c(x=h.prefixes)?x:[],h.prefixes.$freeze(),E=C(A(p(d("CommonCommand"),"COMMANDS"),"map",[],function(l){return null==l&&(l=e),p(l,"PREFIX_PATTERN").$source()},1),h.prefixes),h.command_pattern=X(["^S?(",E.$join("|"),")"],"i").$freeze())},0),P($,"$eval",function(h){return this.$new(h).$eval()},1),f.$include(a("Translate")),f.$include(p(a("Deprecated"),"Checker")),P(f,"$initialize",function(n){var i=this;return i.raw_input=n,i.sort_add_dice=!1,i.sort_barabara_dice=!1,i.d66_sort_type=p(a("D66SortType"),"NO_SORT"),i.enabled_d9=!1,i.round_type=p(a("RoundType"),"FLOOR"),i.sides_implicit_d=6,i.upper_dice_reroll_threshold=e,i.reroll_dice_reroll_threshold=e,i.default_cmp_op=e,i.default_target_number=e,i.enabled_upcase_input=!0,i.locale="ja_jp",i.randomizer=p(a("BCDice"),"Randomizer").$new(),i.debug=!1},1),f.$attr_accessor("randomizer"),f.$attr_reader("d66_sort_type"),f.$attr_reader("round_type"),f.$attr_reader("sides_implicit_d"),f.$attr_reader("upper_dice_reroll_threshold"),f.$attr_reader("reroll_dice_reroll_threshold"),f.$attr_reader("default_cmp_op"),f.$attr_reader("default_target_number"),P(f,"$sort_add_dice?",function(){return this.sort_add_dice},0),P(f,"$sort_barabara_dice?",function(){return this.sort_barabara_dice},0),P(f,"$enabled_d9?",function(){return this.enabled_d9},0),P(f,"$enable_debug",function(){return this.debug=!0},0),P(f,"$eval",function(){var i,d,q,n=this,h=e;return i=p(a("BCDice"),"Preprocessor").$process(n.raw_input,n),d=c(q=n.$dice_command(i))?q:n.$eval_common_command(n.raw_input),c(d)?(h=[n.randomizer.$rand_results()],A(d,"rands=",G(h)),H(h.length,1),h=[n.randomizer.$detailed_rand_results()],A(d,"detailed_rands=",G(h)),H(h.length,1),d):e},0),P(f,"$change_text",function(n){return n},1),P(f,"$check_result",function(n,i,d,q){var h=this,x=e,E=e,g=e,l=e,z=e;return x=h.$check_result_legacy(n,i,d,q),c(x)?x:(E=A(i,"map",[],"sides".$to_proc()),l=(g=A(i,"map",[],"value".$to_proc())).$sum(),x=F([100],z=E)?h.$result_1d100(n,l,d,q):F([20],z)?h.$result_1d20(n,l,d,q):F([6,6],z)?h.$result_2d6(n,l,g,d,q):e,j(x,a("Result").$nothing())?e:c(x)?x:(x=F([10],z=E.$uniq())?h.$result_nd10(n,l,g,d,q):F([6],z)?h.$result_nd6(n,l,g,d,q):e,j(x,a("Result").$nothing())?e:c(x)?x:h.$result_ndx(n,d,q)))},4),P(f,"$grich_text",function(n,i,d){return e},3),f.$private(),P(f,"$eval_common_command",function(n){try{return n=this.$change_text(n),A(p(a("CommonCommand"),"COMMANDS"),"each",[],function d(q){var x,h=null==d.$$s?this:d.$$s;if(null==h.randomizer&&(h.randomizer=e),null==q&&(q=e),x=q.$eval(n,h,h.randomizer),!c(x))return e;r.ret(x)},{$$arity:1,$$s:this}),e}catch(d){if(d===r.returner)return d.$v;throw d}},1),P(f,"$dice_command",function(n){var i=this,d=e,q=e,h=e,x=e,E=e;return c(i.enabled_upcase_input)&&(n=n.$upcase()),d=i.$class().$prefixes_pattern().$match(n),c(d)?(q=d["$[]"](1)["$nil?"]()["$!"](),c(q)&&(n=n["$[]"](O(1,-1,!1))),h=i.$eval_game_system_specific_command(n),c(h["$is_a?"](a("Result")))?(x=[c(E=h["$secret?"]())?E:q],A(h,"secret=",G(x)),H(x.length,1),h):c(h["$nil?"]())||c(h["$empty?"]())||j(h,"1")?e:A(a("Result").$new(),"tap",[],function(l){return null==l&&(l=e),x=[h.$to_s()],A(l,"text=",G(x)),H(x.length,1),A(l,"secret=",G(x=[q])),x[H(x.length,1)]},1)):e},1),P(f,"$eval_game_system_specific_command",function(n){return e},1),P(f,"$result_ndx",function(n,i,d){return c(d["$is_a?"](a("String")))?e:c(n.$send(i,d))?a("Result").$success(this.$translate("success")):a("Result").$failure(this.$translate("failure"))},3),P(f,"$result_1d100",function(n,i,d,q){return e},4),P(f,"$result_1d20",function(n,i,d,q){return e},4),P(f,"$result_nd10",function(n,i,d,q,h){return e},5),P(f,"$result_2d6",function(n,i,d,q,h){return e},5),P(f,"$result_nd6",function(n,i,d,q,h){return e},5),P(f,"$get_table_by_2d6",function(n){return this.$get_table_by_nD6(n,2)},1),P(f,"$get_table_by_1d6",function(n){return this.$get_table_by_nD6(n,1)},1),P(f,"$get_table_by_nD6",function(n,i){return this.$get_table_by_nDx(n,i,6)},2),P(f,"$get_table_by_nDx",function(n,i,d){var h,x=e;return h=this.randomizer.$roll_sum(i,d),x=this.$get_table_value(n["$[]"](H(h,i))),c(x["$nil?"]())?["1",0]:[x,h]},3),P(f,"$get_table_by_1d3",function(n){var q,h,i=this,x=e;return i.$debug("get_table_by_1d3"),q=i.randomizer.$roll_sum(1,6),i.$debug("num",q),h=W(H(q,1),2).$to_i(),i.$debug("index",h),x=n["$[]"](h),c(x["$nil?"]())?["1",0]:[x,q]},1),P(f,"$get_table_by_d66_swap",function(n){var d;return d=this.randomizer.$roll_d66(p(a("D66SortType"),"ASC")),[this.$get_table_by_number(d,n),d]},1),P(f,"$get_table_by_d66",function(n){var d,q,h,E,x=e;return d=this.randomizer.$roll_once(6),q=this.randomizer.$roll_once(6),h=C(M(H(d,1),6),H(q,1)),x=n["$[]"](h),E=""+d+q,c(x["$nil?"]())?["1",E]:[x,E]},1),P(f,"$get_table_by_number",function(n,i,d){try{return null==d&&(d="1"),A(i,"each",[],function h(x){var g,E=null==h.$$s?this:h.$$s;if(null==x&&(x=e),g=x["$[]"](0),!c(_(g,n)))return e;r.ret(E.$get_table_value(x["$[]"](1)))},{$$arity:1,$$s:this}),this.$get_table_value(d)}catch(h){if(h===r.returner)return h.$v;throw h}},-3),P(f,"$get_table_value",function(n){return c(n["$is_a?"](a("Proc")))?n.$call():n},1),P(f,"$roll_tables",function(n,i){var q=e;return q=i["$[]"](n),c(q)?q.$roll(this.randomizer).$to_s():e},2),P(f,"$debug",function(n,i){var q,h=this,x=e,E=e;return q=r.slice.call(arguments,1),c(h.debug)?(x=c(n["$is_a?"](a("String")))?n:n.$inspect(),c(q["$empty?"]())?h.$warn(x):(E=A(q,"map",[],function(l){return null==l&&(l=e),c(l["$is_a?"](a("String")))?'"'+l+'"':l.$inspect()},1),h.$warn(x+": "+E.$join(", ")))):e},-2),p(p(v("I18n"),"Backend"),"Simple").$include(p(p(v("I18n"),"Backend"),"Fallbacks")),v("I18n").$load_path()["$<<"](v("Dir")["$[]"](v("File").$join("bcdice","../../i18n/**/*.yml"))),u=["ja_jp"],A(v("I18n"),"default_locale=",G(u)),H(u.length,1),u=[["ja_jp"]],A(v("I18n").$fallbacks(),"defaults=",G(u)),u[H(u.length,1)]},Opal.queue(function(r){var B,R,a,s,$,E,g,l,z,b,n,i,d,f,o,T,t=[],v=r.nil,e=r.$$$,p=r.module,L=r.klass,I=r.const_set,c=r.send2,P=r.find_super,X=r.def,C=r.eqeq,A=r.truthy,G=r.rb_le,H=r.rb_ge,F=r.rb_plus,j=r.send,O=r.to_a,W=r.rb_minus,M=r.hash2,_=r.defs,u=r.to_ary;return r.top.$require("bcdice/base"),B=t,R=T=[p(t[0],"BCDice")].concat(B),f=[p(T[0],"GameSystem")].concat(R),o=r.$r(f),a=f[0],s=o("Base"),$=f,i=[n=L(a,s,"MagicaLogia")].concat($),d=r.$r(i),n.$$prototype.randomizer=v,I(i[0],"ID","MagicaLogia"),I(i[0],"NAME","\u30de\u30ae\u30ab\u30ed\u30ae\u30a2"),I(i[0],"SORT_KEY","\u307e\u304d\u304b\u308d\u304d\u3042"),I(i[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\n\u30b9\u30da\u30b7\u30e3\u30eb\uff0f\u30d5\u30a1\u30f3\u30d6\u30eb\uff0f\u6210\u529f\uff0f\u5931\u6557\u3092\u5224\u5b9a\n\u30fb\u5404\u7a2e\u8868\n\u7d4c\u6b74\u8868\u3000BGT/\u521d\u671f\u30a2\u30f3\u30ab\u30fc\u8868\u3000DAT/\u904b\u547d\u5c5e\u6027\u8868\u3000FAT\n\u9858\u3044\u8868\u3000WIT/\u30d7\u30e9\u30a4\u30ba\u8868\u3000PT\n\u6642\u306e\u6d41\u308c\u8868\u3000TPT/\u5927\u5224\u6642\u306e\u6d41\u308c\u8868\u3000TPTB\n\u4e8b\u4ef6\u8868\u3000AT\n\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000FT\uff0f\u5909\u8abf\u8868\u3000WT\n\u904b\u547d\u5909\u8ee2\u8868\u3000FCT\n\u3000\u5178\u578b\u7684\u707d\u5384 TCT\uff0f\u7269\u7406\u7684\u707d\u5384 PCT\uff0f\u7cbe\u795e\u7684\u707d\u5384 MCT\uff0f\u72c2\u6c17\u7684\u707d\u5384 ICT\n\u3000\u793e\u4f1a\u7684\u707d\u5384 SCT\uff0f\u8d85\u5e38\u7684\u707d\u5384 XCT\uff0f\u4e0d\u601d\u8b70\u7cfb\u707d\u5384 WCT\uff0f\u30b3\u30df\u30ab\u30eb\u7cfb\u707d\u5384 CCT\n\u3000\u9b54\u6cd5\u4f7f\u3044\u306e\u707d\u5384 MGCT\n\u30b7\u30fc\u30f3\u8868\u3000ST\uff0f\u5927\u5224\u30b7\u30fc\u30f3\u8868\u3000STB\n\u3000\u6975\u9650\u74b0\u5883 XEST\uff0f\u5185\u9762\u4e16\u754c IWST\uff0f\u9b54\u6cd5\u90fd\u5e02 MCST\n\u3000\u6b7b\u5f8c\u4e16\u754c WDST\uff0f\u8ff7\u5bae\u4e16\u754c LWST\n\u3000\u9b54\u6cd5\u66f8\u67b6 MBST\uff0f\u9b54\u6cd5\u5b66\u9662 MAST\uff0f\u30af\u30ec\u30c9\u306e\u5854 TCST\n\u3000\u4e26\u884c\u4e16\u754c PWST\uff0f\u7d42\u672b\u3000\u3000 PAST\uff0f\u7570\u4e16\u754c\u9152\u5834 GBST\n\u3000\u307b\u3057\u304b\u3052 SLST\uff0f\u65e7\u56f3\u66f8\u9928 OLST\n\u4e16\u754c\u6cd5\u5247\u8ffd\u52a0\u8868 WLAT/\u3055\u307e\u3088\u3046\u602a\u7269\u8868 WMT\n\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868\u3000RCT\n\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868\u3000RTT\n\u3000\u661f\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTS, RTT1\n\u3000\u7363\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTB, RTT2\n\u3000\u529b\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTF, RTT3\n\u3000\u6b4c\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTP, RTT4\n\u3000\u5922\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTD, RTT5\n\u3000\u95c7\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTN, RTT6\n\u30d6\u30e9\u30f3\u30af\u79d8\u5bc6\u8868\u3000BST/\n\u3000\u5bbf\u6575\u8868\u3000MIT/\u8b00\u7565\u8868\u3000MOT/\u56e0\u7e01\u8868\u3000MAT\n\u3000\u5947\u4eba\u8868\u3000MUT/\u529b\u5834\u8868\u3000MFT/\u540c\u76df\u8868\u3000MLT\n\u843d\u82b1\u8868\u3000FFT\n\u305d\u306e\u5f8c\u8868 FLT\n\u30fbD66\u30c0\u30a4\u30b9\u3042\u308a\n"),X(n,"$initialize",function h(x){var g=this;return delete h.$$p,c(g,P(g,"initialize",h,!1,!0),"initialize",[x],null),g.sort_add_dice=!0,g.sort_barabara_dice=!0,g.d66_sort_type=e(d("D66SortType"),"ASC")},1),X(n,"$result_2d6",function(x,E,g,l,z){var b=this,J=v,re=v;return C(z,"?")||!C(l,">=")?v:(J=A(G(E,2))?d("Result").$fumble(b.$translate("fumble")):A(H(E,12))?d("Result").$critical(b.$translate("MagicaLogia.special")):A(H(x,z))?d("Result").$success(b.$translate("success")):d("Result").$failure(b.$translate("failure")),re=[F(J.$text(),b.$gain_magic_element(g["$[]"](0),g["$[]"](1)))],j(J,"text=",O(re)),W(re.length,1),J)},5),X(n,"$eval_game_system_specific_command",function(x){var g,E=this;return A(g=e(E.$class(),"SKILL_TABLE").$roll_command(E.randomizer,x))?g:E.$roll_tables(x,e(E.$class(),"TABLES"))},1),n.$private(),X(n,"$gain_magic_element",function(x,E){var g=this,l=v;return C(x,E)?(l=g.$translate("MagicaLogia.elements.items")["$[]"](W(x,1)),F(" \uff1e ",g.$format(g.$translate("MagicaLogia.elements.format"),M(["text"],{text:l})))):""},2),E=i,l=[g=L(i[0],null,"SkillExpandTable")].concat(E),z=r.$r(l),(b=g.$$prototype).times=b.sides=b.items=b.name=b.skill_table=v,_(g,"$from_i18n",function(re,V,ie){var K=v;return K=z("I18n").$t(re,M(["locale","raise"],{locale:V,raise:!1})),this.$new(K["$[]"]("name"),K["$[]"]("type"),K["$[]"]("items"),ie)},3),X(g,"$initialize",function(re,V,ie,Q){var K=this,k=v;return K.name=re,K.items=ie.$freeze(),K.skill_table=Q,k=/(\d+)D(\d+)/i.$match(V),A(k)||K.$raise(z("ArgumentError"),"Unexpected table type: "+V),K.times=k["$[]"](1).$to_i(),K.sides=k["$[]"](2).$to_i()},4),X(g,"$roll",function(re){var ie,Q,V=this;return ie=re.$roll_sum(V.times,V.sides),Q=V.$expand(V.items["$[]"](W(ie,V.times)),re),e(z("DiceTable"),"RollResult").$new(V.name,ie,Q)},1),g.$private(),X(g,"$expand",function(re,V){return j(re,"gsub",[/%{([a-z]+)}/],function Q(){var Z,K=null==Q.$$s?this:Q.$$s;return Z=z("Regexp").$last_match()["$[]"](1).$to_sym(),K.$roll_skill(Z,V)},{$$arity:0,$$s:this})},2),I(l[0],"CATEGORIES",["star","beast","force","poem","dream","night"].$freeze()),X(g,"$roll_skill",function(re,V){var Q=v;return C(re,"skill")?this.skill_table.$roll_skill(V):C(re,"element")?this.skill_table.$roll_category(V):(Q=z("CATEGORIES").$index(re),A(Q)||this.$raise(z("ArgumentError")),this.skill_table.$categories()["$[]"](Q).$roll(V).$name())},2),function(h,x,E){var g=L(h,null,"FallenAfterTable"),l=[g].concat(E),z=r.$r(l),b=g.$$prototype;b.lower=b.higher=b.name=v,_(g,"$from_i18n",function(re,V){var Q=v;return Q=z("I18n").$t(re,M(["locale","raise"],{locale:V,raise:!0})),this.$new(Q["$[]"]("name"),Q["$[]"]("items_lower"),Q["$[]"]("items_higher"))},2),X(g,"$initialize",function(re,V,ie){var Q=this;return Q.name=re,Q.lower=V,Q.higher=ie},3),X(g,"$roll",function(re){var V,ie,K,k,Q=this,Z=v;return ie=re.$roll_barabara(2,6),k=null==(V=u(ie))[1]?v:V[1],Z=A(G(K=null==V[0]?v:V[0],3))?Q.lower:Q.higher,Q.name+"("+K+","+k+") \uff1e "+Z["$[]"](W(k,1))},1)}(i[0],0,i),function(h,x){var E=[h].concat(x),g=r.$r(E);h.$private(),X(h,"$translate_skill_table",function(z){return e(g("DiceTable"),"SaiFicSkillTable").$from_i18n("MagicaLogia.skill_table",z,M(["rttn"],{rttn:["RTS","RTB","RTF","RTP","RTD","RTN"]}))},1),X(h,"$translate_tables",function(z,b){var J,re,V,ie,Q,K;return J=g("SkillExpandTable").$from_i18n("MagicaLogia.inveterate_enemy_table",z,b),re=e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.conspiracy_table",z),V=e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.fate_table",z),ie=e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.cueball_table",z),Q=e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.force_field_table",z),K=g("SkillExpandTable").$from_i18n("MagicaLogia.alliance_table",z,b),M(["TPT","ST","FT","WT","FCT","AT","BGT","DAT","FAT","WIT","TCT","PCT","MCT","ICT","SCT","XCT","WCT","CCT","MIT","MOT","MAT","MUT","MFT","MLT","BST","PT","XEST","IWST","MCST","WDST","LWST","STB","MGCT","MBST","MAST","TCST","PWST","PAST","GBST","SLST","WLAT","WMT","FFT","OLST","TPTB","FLT"],{TPT:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.TPT",z,b),ST:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.ST",z,b),FT:e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FT",z),WT:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.WT",z,b),FCT:e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FCT",z),AT:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.AT",z,b),BGT:e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.BGT",z),DAT:e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.DAT",z),FAT:e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FAT",z),WIT:e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WIT",z),TCT:e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.TCT",z),PCT:e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.PCT",z),MCT:e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.MCT",z),ICT:e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.ICT",z),SCT:e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.SCT",z),XCT:e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.XCT",z),WCT:e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WCT",z),CCT:e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.CCT",z),MIT:J,MOT:re,MAT:V,MUT:ie,MFT:Q,MLT:K,BST:e(g("DiceTable"),"ChainTable").$new(g("I18n").$translate("MagicaLogia.tables.BST.name",M(["raise","locale"],{raise:!0,locale:z})),"1D6",[J,re,V,ie,Q,K]),PT:e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.PT",z),XEST:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.XEST",z,b),IWST:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.IWST",z,b),MCST:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.MCST",z,b),WDST:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.WDST",z,b),LWST:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.LWST",z,b),STB:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.STB",z,b),MGCT:e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.MGCT",z),MBST:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.MBST",z,b),MAST:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.MAST",z,b),TCST:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.TCST",z,b),PWST:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.PWST",z,b),PAST:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.PAST",z,b),GBST:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.GBST",z,b),SLST:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.SLST",z,b),WLAT:e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WLAT",z),WMT:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.WMT",z,b),FFT:e(g("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FFT",z),OLST:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.OLST",z,b),TPTB:g("SkillExpandTable").$from_i18n("MagicaLogia.tables.TPTB",z,b),FLT:g("FallenAfterTable").$from_i18n("MagicaLogia.tables.FLT",z)})},2)}(r.get_singleton_class(n),i),I(i[0],"SKILL_TABLE",n.$translate_skill_table("ja_jp")),I(i[0],"TABLES",n.$translate_tables("ja_jp",d("SKILL_TABLE"))),n.$register_prefix(d("SKILL_TABLE").$prefixes()),n.$register_prefix(d("TABLES").$keys())})}}]);