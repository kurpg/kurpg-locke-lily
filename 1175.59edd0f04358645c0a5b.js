(self.webpackChunkudonarium_lily=self.webpackChunkudonarium_lily||[]).push([[1175],{1175:function(Xe,Je,Ze){Ze(4656),Opal.modules["i18n/backend/fallbacks"]=function(e){function j(C,i){return"number"==typeof C&&"number"==typeof i?C-i:C["$-"](i)}var i,f,U,S,H,A,V,w=[],r=e.nil,x=e.$$$,$=e.$$,Q=e.module,u=e.truthy,N=e.send,B=e.send2,t=e.hash2;return i=w,V=[A=Q(w[0],"I18n")].concat(i),e.class_variable_set(V[0],"@@fallbacks",r),f=e.get_singleton_class(A),H=[f].concat(V),e.def(f,"$fallbacks",U=function(){var L,n,l;return e.class_variable_set(H[1],"@@fallbacks",u(l=null==(L=H[1].$$cvars["@@fallbacks"])?r:L)?l:x(x($(H,"I18n"),"Locale"),"Fallbacks").$new()),u(n=$(H,"Thread").$current()["$[]"]("i18n_fallbacks"))?n:null==(L=H[1].$$cvars["@@fallbacks"])?r:L},U.$$arity=0),e.def(f,"$fallbacks=",S=function(L){var z,n;return e.class_variable_set(H[1],"@@fallbacks",u(L["$is_a?"]($(H,"Array")))?x(x($(H,"I18n"),"Locale"),"Fallbacks").$new(L):L),n=["i18n_fallbacks",null==(z=H[1].$$cvars["@@fallbacks"])?r:z],N($(H,"Thread").$current(),"[]=",e.to_a(n)),n[j(n.length,1)]},S.$$arity=1),void function(f,D){var U=[Q(f,"Backend")].concat(D);!function(S,Y){var l,n,m,c,L=Q(S,"Fallbacks"),z=[L].concat(Y);e.def(L,"$translate",l=function(p,v,h){try{var y,E=l.$$p,b=this,_=r,o=r,g=r,R=r,I=r,a=r;for(E&&(l.$$p=null),I=0,a=arguments.length,R=new Array(a);I<a;I++)R[I]=arguments[I];return null==h&&(h=$(z,"EMPTY_HASH")),!u(h.$fetch("fallback",!0))||u(h["$[]"]("fallback_in_progress"))?B(b,e.find_super_dispatcher(b,"translate",l,!1,!0),"translate",R,E):(u(h["$[]"]("default"))&&(_=b["$extract_non_symbol_default!"](h)),o=h.$merge(t(["fallback_in_progress"],{fallback_in_progress:!0})),N($(z,"I18n").$fallbacks()["$[]"](p),"each",[],((y=function(K){var $e,te=null==y.$$s?this:y.$$s;null==K&&(K=r);try{return N(te,"catch",["exception"],(($e=function(){var ge=null==$e.$$s?this:$e.$$s,Te=r;if(Te=B(ge,e.find_iter_super_dispatcher(ge,"translate",$e.$$def||y.$$def||l,!1,!1),"translate",[K,v,o],null),u(Te["$nil?"]()))return r;u(p.$to_s()["$!="](K.$to_s()))&&ge.$on_fallback(p,K,v,h),e.ret(Te)}).$$s=te,$e.$$arity=0,$e))}catch(ye){if(!e.rescue(ye,[x($(z,"I18n"),"InvalidLocale")]))throw ye;try{return r}finally{e.pop_exception()}}}).$$s=b,y.$$arity=1,y)),u(u(g=h["$key?"]("default"))?h["$[]"]("default")["$nil?"]():g)?r:u(_)?B(b,e.find_super_dispatcher(b,"translate",l,!1,!0),"translate",[p,r,h.$merge(t(["default"],{default:_}))],null):b.$throw("exception",x($(z,"I18n"),"MissingTranslation").$new(p,v,h)))}catch(T){if(T===e.returner)return T.$v;throw T}},l.$$arity=-3),e.def(L,"$extract_non_symbol_default!",n=function(p){var v,E,y=r,W=r;return y=[p["$[]"]("default")].$flatten(),E=N(y,"detect",[],((v=function(_){return null==_&&(_=r),_["$is_a?"]($(z,"Symbol"))["$!"]()}).$$s=this,v.$$arity=1,v)),u(E)&&(W=["default",y["$[]"](0,y.$index(E))],N(p,"[]=",e.to_a(W)),j(W.length,1)),E},n.$$arity=1),e.def(L,"$exists?",m=function(p,v,h){try{var y,E=m.$$p,b=this,_=r,o=r,g=r;for(E&&(m.$$p=null),o=0,g=arguments.length,_=new Array(g);o<g;o++)_[o]=arguments[o];return null==h&&(h=$(z,"EMPTY_HASH")),u(h.$fetch("fallback",!0))?(N($(z,"I18n").$fallbacks()["$[]"](p),"each",[],((y=function(I){var a=null==y.$$s?this:y.$$s;null==I&&(I=r);try{if(!u(B(a,e.find_iter_super_dispatcher(a,"exists?",y.$$def||m,!1,!1),"exists?",[I,v],null)))return r;e.ret(!0)}catch(T){if(!e.rescue(T,[x($(z,"I18n"),"InvalidLocale")]))throw T;try{return r}finally{e.pop_exception()}}}).$$s=b,y.$$arity=1,y)),!1):B(b,e.find_super_dispatcher(b,"exists?",m,!1,!0),"exists?",_,E)}catch(R){if(R===e.returner)return R.$v;throw R}},m.$$arity=-3),L.$private(),e.def(L,"$on_fallback",c=function(p,v,h,y){return r},c.$$arity=4)}(U[0],U)}(V[0],V)},Opal.modules["bcdice/randomizer"]=function(e){function j(f,D){return"number"==typeof f&&"number"==typeof D?f>D:f["$>"](D)}function X(f,D){return"number"==typeof f&&"number"==typeof D?f+D:f["$+"](D)}function w(f,D){return"number"==typeof f&&"number"==typeof D?f<=D:f["$<="](D)}function r(f,D){return"number"==typeof f&&"number"==typeof D?f-D:f["$-"](D)}function x(f,D){return"number"==typeof f&&"number"==typeof D?f*D:f["$*"](D)}var D,L,n,m,c,d,p,v,h,y,E,W,b,z,l,U,u=[],N=e.nil,B=e.$$$,t=e.$$,i=e.klass,A=e.truthy,V=e.send;return D=u,L=U=[(0,e.module)(u[0],"BCDice")].concat(D),z=i(U[0],null,"Randomizer"),l=[z].concat(L),z.$$prototype.rand_results=z.$$prototype.detailed_rand_results=N,e.const_set(l[0],"UPPER_LIMIT_DICE_TIMES",200),e.const_set(l[0],"UPPER_LIMIT_DICE_SIDES",1e3),e.const_set(l[0],"UPPER_LIMIT_RANDS",1e4),e.def(z,"$initialize",n=function(){return this.rand_results=[],this.detailed_rand_results=[]},n.$$arity=0),z.$attr_reader("rand_results"),z.$attr_reader("detailed_rand_results"),e.const_set(l[0],"DetailedRandResult",t(l,"Struct").$new("kind","sides","value")),e.def(z,"$roll_barabara",m=function(o,g){var R,a,I=this;return A(j(X(I.rand_results.$size(),o),t(l,"UPPER_LIMIT_RANDS")))&&I.$raise(t(l,"TooManyRandsError")),A(A(a=w(o,0))?a:j(o,t(l,"UPPER_LIMIT_DICE_TIMES")))?[]:V(t(l,"Array"),"new",[o],((R=function(){return(null==R.$$s?this:R.$$s).$roll_once(g)}).$$s=I,R.$$arity=0,R))},m.$$arity=2),e.def(z,"$roll_sum",c=function(o,g){return this.$roll_barabara(o,g).$sum()},c.$$arity=2),e.def(z,"$roll_once",d=function(o){var R,I=N;return A(A(R=w(o,0))?R:j(o,t(l,"UPPER_LIMIT_DICE_SIDES")))?0:(I=this.$rand_inner(o),this.$push_to_detail("normal",o,I),I)},d.$$arity=1),e.def(z,"$roll_index",p=function(o){return r(this.$roll_once(o),1)},p.$$arity=1),e.def(z,"$roll_tens_d10",v=function(){var R,g=N;return(g=this.$rand_inner(10))["$=="](10)&&(g=0),R=x(g,10),this.$push_to_detail("tens_d10",10,R),R},v.$$arity=0),e.def(z,"$roll_d9",h=function(){var g;return g=r(this.$rand_inner(10),1),this.$push_to_detail("d9",10,g),g},h.$$arity=0),e.def(z,"$roll_d66",y=function(o){var g,a,I=N;return I=V(t(l,"Array"),"new",[2],((g=function(){return(null==g.$$s?this:g.$$s).$roll_once(6)}).$$s=this,g.$$arity=0,g)),a=o,B(t(l,"D66SortType"),"ASC")["$==="](a)?I["$sort!"]():B(t(l,"D66SortType"),"DESC")["$==="](a)&&I["$sort!"]()["$reverse!"](),X(x(I["$[]"](0),10),I["$[]"](1))},y.$$arity=1),z.$private(),e.def(z,"$rand_inner",E=function(o){var R,g=this;return A(function(f,D){return"number"==typeof f&&"number"==typeof D?f>=D:f["$>="](D)}(g.rand_results.$size(),t(l,"UPPER_LIMIT_RANDS")))&&g.$raise(t(l,"TooManyRandsError")),R=g.$random(o),g.rand_results["$<<"]([R,o]),R},E.$$arity=1),e.def(z,"$random",W=function(o){return X(t(l,"Kernel").$rand(o),1)},W.$$arity=1),e.def(z,"$push_to_detail",b=function(o,g,R){var a;return a=t(l,"DetailedRandResult").$new(o,g,R),this.detailed_rand_results.$push(a)},b.$$arity=3),void function(S,Y,L){[i(S,Y,"TooManyRandsError")].concat(L)}(U[0],t(U,"StandardError"),U)},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var B,A,U,L,z,l,n,S,Y,f,C,X=[],w=e.nil,x=e.$$,$=e.module,Q=e.klass,u=e.truthy;return B=X,A=C=[$(X[0],"BCDice")].concat(B),U=f=[$(C[0],"DiceTable")].concat(A),S=Q(f[0],null,"RollResult"),Y=[S].concat(U),S.$$prototype.table_name=S.$$prototype.value=S.$$prototype.body=w,e.def(S,"$initialize",L=function(c,d,p){var v=this;return v.table_name=c,v.value=d,v.body=p},L.$$arity=3),S.$attr_reader("table_name"),S.$attr_reader("value"),S.$attr_reader("body"),e.def(S,"$to_s",z=function(){var c=this;return c.table_name+"("+c.value+") \uff1e "+c.body},z.$$arity=0),e.def(S,"$last_body",l=function(){var c=this;return u(c.body["$is_a?"](x(Y,"RollResult")))?c.body.$last_body():c.body},l.$$arity=0),void e.def(S,"$empty?",n=function(){return!1},n.$$arity=0)},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var t,V,S,z,l,Y,L,D,i,w=[],r=e.nil,$=e.$$,Q=e.module,u=e.klass,N=e.truthy;return t=w,V=i=[Q(w[0],"BCDice")].concat(t),S=D=[Q(i[0],"DiceTable")].concat(V),Y=u(D[0],null,"ChainTable"),L=[Y].concat(S),Y.$$prototype.times=Y.$$prototype.sides=Y.$$prototype.items=Y.$$prototype.name=r,e.def(Y,"$initialize",z=function(m,c,d){var p=this,v=r;return p.name=m,p.items=d.$freeze(),v=/(\d+)D(\d+)/i.$match(c),N(v)||p.$raise($(L,"ArgumentError"),"Unexpected table type: "+c),p.times=v["$[]"](1).$to_i(),p.sides=v["$[]"](2).$to_i()},z.$$arity=3),void e.def(Y,"$roll",l=function(m){var d,p,c=this,v=r;return p=function(B,t){return"number"==typeof B&&"number"==typeof t?B-t:B["$-"](t)}(d=m.$roll_sum(c.times,c.sides),c.times),v=c.items["$[]"](p),N(v["$respond_to?"]("roll"))&&(v=v.$roll(m)),$(L,"RollResult").$new(c.name,d,v)},l.$$arity=1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){function w(C,i){return"number"==typeof C&&"number"==typeof i?C-i:C["$-"](i)}var i,D,L,n,m,c,z,l,U,V,x=[],$=e.nil,u=e.$$,N=e.module,B=e.klass,t=e.hash2;return i=x,D=V=[N(x[0],"BCDice")].concat(i),L=U=[N(V[0],"DiceTable")].concat(D),z=B(U[0],null,"D66GridTable"),l=[z].concat(L),z.$$prototype.name=z.$$prototype.items=$,e.defs(z,"$from_i18n",n=function(p,v){var y=$;return y=u(l,"I18n").$t(p,t(["locale","raise"],{locale:v,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items"))},n.$$arity=2),e.def(z,"$initialize",m=function(p,v){return this.name=p,this.items=v.$freeze()},m.$$arity=2),void e.def(z,"$roll",c=function(p){var h,y,E,W,b,C;return h=p.$roll_once(6),y=p.$roll_once(6),E=function(C,i){return"number"==typeof C&&"number"==typeof i?C+i:C["$+"](i)}("number"==typeof(C=h)?10*C:C["$*"](10),y),W=w(h,1),b=w(y,1),u(l,"RollResult").$new(this.name,E,this.items["$[]"](W)["$[]"](b))},c.$$arity=1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var B,A,U,L,z,S,Y,f,C,X=[],w=e.nil,x=e.$$,$=e.module,Q=e.klass,u=e.hash2;return e.top.$require("bcdice/dice_table/d66_grid_table"),B=X,A=C=[$(X[0],"BCDice")].concat(B),U=f=[$(C[0],"DiceTable")].concat(A),S=Q(f[0],x(f,"D66GridTable"),"D66HalfGridTable"),Y=[S].concat(U),e.defs(S,"$from_i18n",L=function(n,m){var d=w;return d=x(Y,"I18n").$t(n,u(["locale","raise"],{locale:m,raise:!0})),this.$new(d["$[]"]("name"),d["$[]"]("items_1_2_3"),d["$[]"]("items_4_5_6"))},L.$$arity=2),void e.def(S,"$initialize",z=function(n,m,c){return this.name=n,this.items=[m,m,m,c,c,c].$freeze()},z.$$arity=3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var B,A,U,L,z,S,Y,f,C,X=[],w=e.nil,x=e.$$,$=e.module,Q=e.klass,u=e.hash2;return e.top.$require("bcdice/dice_table/d66_grid_table"),B=X,A=C=[$(X[0],"BCDice")].concat(B),U=f=[$(C[0],"DiceTable")].concat(A),S=Q(f[0],x(f,"D66GridTable"),"D66OneThirdTable"),Y=[S].concat(U),e.defs(S,"$from_i18n",L=function(n,m){var d=w;return d=x(Y,"I18n").$t(n,u(["locale","raise"],{locale:m,raise:!0})),this.$new(d["$[]"]("name"),d["$[]"]("items_1_2"),d["$[]"]("items_3_4"),d["$[]"]("items_5_6"))},L.$$arity=2),void e.def(S,"$initialize",z=function(n,m,c,d){return this.name=n,this.items=[m,m,c,c,d,d].$freeze()},z.$$arity=4)},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var i,D,L,n,m,c,d,z,l,U,V,r=[],x=e.nil,$=e.$$$,Q=e.$$,u=e.module,N=e.klass,B=e.hash2,t=e.truthy;return i=r,D=V=[u(r[0],"BCDice")].concat(i),L=U=[u(V[0],"DiceTable")].concat(D),z=N(U[0],null,"D66Table"),l=[z].concat(L),z.$$prototype.sort_type=z.$$prototype.items=z.$$prototype.name=x,e.defs(z,"$from_i18n",n=function(v,h){var W,E=x;return E=Q(l,"I18n").$t(v,B(["locale"],{locale:h})),W=Q(l,"D66SortType").$const_get(E["$[]"]("d66_sort_type")),this.$new(E["$[]"]("name"),W,E["$[]"]("items"))},n.$$arity=2),e.def(z,"$initialize",m=function(v,h,y){var E=this;return E.name=v,E.sort_type=h,E.items=y.$freeze()},m.$$arity=3),e.def(z,"$roll",c=function(v){var E,_,C,h=this,y=x,W=x,b=x;return y=v.$roll_barabara(2,6),E=h.sort_type,$(Q(l,"D66SortType"),"ASC")["$==="](E)?y["$sort!"]():$(Q(l,"D66SortType"),"DESC")["$==="](E)&&y["$sort!"]()["$reverse!"](),W=function(C,i){return"number"==typeof C&&"number"==typeof i?C+i:C["$+"](i)}("number"==typeof(C=y["$[]"](0))?10*C:C["$*"](10),y["$[]"](1)),b=t(_=h.items["$[]"](W))?_:h.items["$[]"](W.$to_s()),t(b["$respond_to?"]("roll"))&&(b=b.$roll(v)),Q(l,"RollResult").$new(h.name,W,b)},c.$$arity=1),void e.def(z,"$choice",d=function(v){return Q(l,"RollResult").$new(this.name,v,this.items["$[]"](v))},d.$$arity=1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){function j(A,V){return"number"==typeof A&&"number"==typeof V?A+V:A["$+"](V)}var V,l,c,n,U,Y,D,x=[],$=e.nil,u=e.$$,N=e.module,B=e.klass,t=e.hash2,C=e.send,i=e.send2;return e.top.$require("bcdice/dice_table/d66_table"),V=x,U=D=[N(x[0],"BCDice")].concat(V),l=Y=[N(D[0],"DiceTable")].concat(U),[n=B(Y[0],u(Y,"D66Table"),"D66LeftRangeTable")].concat(l),void e.def(n,"$initialize",c=function(p,v,h){var y,_,b=this;return c.$$p&&(c.$$p=null),_=t([],{}),C(h,"each",[],((y=function(o){function g(R){return o.apply(this,arguments)}return g.toString=function(){return o.toString()},g}(function(o){var R,a,K,g=null==y.$$s?this:y.$$s;return null==o&&(o=$),R=e.to_ary(o),K=null==R[1]?$:R[1],C(null==R[0]?$:R[0],"each",[],((a=function($e){var ge;return null==$e&&($e=$),C(K,"each_with_index",[],((ge=function(Be,ze){var Ae,fe,A;return null==Be&&(Be=$),null==ze&&(ze=$),Ae=j("number"==typeof(A=$e)?10*A:A["$*"](10),j(ze,1)),C(_,"[]=",e.to_a(fe=[Ae,Be])),fe[function(A,V){return"number"==typeof A?A-1:A["$-"](1)}(fe.length)]}).$$s=null==a.$$s?this:a.$$s,ge.$$arity=2,ge))}).$$s=g,a.$$arity=1,a))})).$$s=b,y.$$arity=1,y)),i(b,e.find_super_dispatcher(b,"initialize",c,!1,!0),"initialize",[p,v,_],null)},c.$$arity=3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var i,D,L,n,m,z,l,U,V,x=[],$=e.nil,u=e.$$,N=e.module,B=e.klass,t=e.truthy;return i=x,D=V=[N(x[0],"BCDice")].concat(i),L=U=[N(V[0],"DiceTable")].concat(D),z=B(U[0],null,"D66ParityTable"),l=[z].concat(L),z.$$prototype.odd=z.$$prototype.even=z.$$prototype.name=$,e.def(z,"$initialize",n=function(d,p,v){var h=this;return h.name=d,h.odd=p.$freeze(),h.even=v.$freeze()},n.$$arity=3),void e.def(z,"$roll",m=function(d){var h,E,W,C,p=this,v=$;return v=d.$roll_once(6),h=d.$roll_once(6),E=(t(v["$odd?"]())?p.odd:p.even)["$[]"]("number"==typeof(C=h)?C-1:C["$-"](1)),W=function(C,i){return"number"==typeof C&&"number"==typeof i?C+i:C["$+"](i)}(function(C,i){return"number"==typeof C?10*C:C["$*"](10)}(v),h),u(l,"RollResult").$new(p.name,W,E)},m.$$arity=1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var C,f,Y,l,n,L,z,H,A,r=[],x=e.nil,Q=e.$$,u=e.module,N=e.klass,B=e.send;return C=r,f=A=[u(r[0],"BCDice")].concat(C),Y=H=[u(A[0],"DiceTable")].concat(f),L=N(H[0],null,"D66RangeTable"),z=[L].concat(Y),L.$$prototype.items=L.$$prototype.name=x,e.def(L,"$initialize",l=function(c,d){return this.name=c,this.items=d.$freeze()},l.$$arity=2),void e.def(L,"$roll",n=function(c){var d,v,h,y,t,p=this,E=x;return v=c.$roll_once(6),h=c.$roll_once(6),y=function(t,C){return"number"==typeof t&&"number"==typeof C?t+C:t["$+"](C)}("number"==typeof(t=v)?10*t:t["$*"](10),h),E=B(p.items,"find",[],((d=function(b){return null==b&&(b=x),b["$[]"](0)["$include?"](y)}).$$s=p,d.$$arity=1,d)),Q(z,"RollResult").$new(p.name,y,E["$[]"](1))},n.$$arity=1)},Opal.modules["bcdice/dice_table/range_table"]=function(e){var A,H,z,m,c,d,p,v,h,y,E,W,l,n,S,f,x=[],$=e.nil,u=e.$$,N=e.module,B=e.klass,t=e.send,C=e.truthy;return A=x,H=f=[N(x[0],"BCDice")].concat(A),z=S=[N(f[0],"DiceTable")].concat(H),l=B(S[0],null,"RangeTable"),n=[l].concat(z),l.$$prototype.name=l.$$prototype.items=l.$$prototype.num_of_dice=l.$$prototype.num_of_sides=l.$$prototype.formatter=$,e.const_set(n[0],"RollResult",t(u(n,"Struct"),"new",["sum","values","content","formatted"],((m=function(){return(null==m.$$s?this:m.$$s).$alias_method("to_s","formatted")}).$$s=l,m.$$arity=0,m))),e.const_set(n[0],"Item",u(n,"Struct").$new("range","content")),e.const_set(n[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),e.const_set(n[0],"DEFAULT_FORMATTER",t(l,"lambda",[],($$2=function(b){function _(o,g){return b.apply(this,arguments)}return _.toString=function(){return b.toString()},_}(function(b,_){return null==$$2.$$s||$$2,null==b&&(b=$),null==_&&(_=$),b.$name()+"("+_.$sum()+") \uff1e "+_.$content()}),$$2.$$s=l,$$2.$$arity=2,$$2))),l.$attr_reader("name"),l.$attr_reader("num_of_dice"),l.$attr_reader("num_of_sides"),e.def(l,"$initialize",c=function(_,o,g){var T,R=c.$$p,I=R||$,a=this,K=$;return R&&(c.$$p=null),R&&(c.$$p=null),a.name=_.$freeze(),a.formatter=C(T=I)?T:u(n,"DEFAULT_FORMATTER"),K=u(n,"DICE_ROLL_METHOD_RE").$match(o),C(K)||a.$raise(u(n,"ArgumentError"),a.name+": invalid dice roll method: "+o),a.num_of_dice=K["$[]"](1).$to_i(),a.num_of_sides=K["$[]"](2).$to_i(),a.$store(g)},c.$$arity=3),e.def(l,"$fetch",d=function(_){var o,R,g=this;return R=t(g.items,"find",[],((o=function(a){return null==a&&(a=$),a.$range()["$include?"](_)}).$$s=g,o.$$arity=1,o)),C(R)||g.$raise(u(n,"RangeError"),g.name+": value is out of range: "+_),R},d.$$arity=1),e.def(l,"$roll",p=function(_){var R,I,a,i,o=this,g=$;return R=(g=_.$roll_barabara(o.num_of_dice,o.num_of_sides)).$sum(),I=u(n,"RollResult").$new(R,g,o.$fetch(R).$content()),a=[o.formatter["$[]"](o,I)],t(I,"formatted=",e.to_a(a)),"number"==typeof(i=a.length)||i["$-"](1),I},p.$$arity=1),l.$private(),e.def(l,"$store",v=function(_){var o,g,R,a,T,I=this;return a=t(_,"map",[],((o=function(te,$e){return null==te&&(te=$),null==$e&&($e=$),[(null==o.$$s?this:o.$$s).$coerce_to_int_range(te),$e]}).$$s=I,o.$$arity=2,o)),T=t(a,"sort_by",[],((g=function(te,$e){return null==te&&(te=$),null==$e&&($e=$),te.$min()}).$$s=I,g.$$arity=2,g)),I.$assert_min_sum_is_covered(T),I.$assert_max_sum_is_covered(T),I.$assert_no_gap_or_overlap_in_ranges(T),I.items=t(T,"map",[],(R=function(te,$e){return null==te&&(te=$),null==$e&&($e=$),u(n,"Item").$new(te,$e.$freeze()).$freeze()},R.$$s=I,R.$$arity=2,R)).$freeze(),I},v.$$arity=1),e.def(l,"$coerce_to_int_range",h=function(_){var g,R=$;return g=_,u(n,"Integer")["$==="](g)?u(n,"Range").$new(_,_):u(n,"Range")["$==="](g)&&C(C(R=_.$begin()["$is_a?"](u(n,"Integer")))?_.$end()["$is_a?"](u(n,"Integer")):R)?_:this.$raise(u(n,"TypeError"),this.name+": "+_+" ("+_.$class()+") must be an Integer or a Range with Integers ")},h.$$arity=1),e.def(l,"$assert_min_sum_is_covered",y=function(_){var g,o=this,R=$;return g=o.num_of_dice,R=_.$first()["$[]"](0),C(R["$include?"](g))||o.$raise(u(n,"RangeError"),o.name+": min value ("+g+") is not covered: "+R),o},y.$$arity=1),e.def(l,"$assert_max_sum_is_covered",E=function(_){var g,o=this,R=$;return g=function(i,A){return"number"==typeof i&&"number"==typeof A?i*A:i["$*"](A)}(o.num_of_dice,o.num_of_sides),R=_.$last()["$[]"](0),C(R["$include?"](g))||o.$raise(u(n,"RangeError"),o.name+": max value ("+g+") is not covered: "+R),o},E.$$arity=1),void e.def(l,"$assert_no_gap_or_overlap_in_ranges",W=function(_){var o;return t(_,"each_cons",[2],((o=function(I,a){var $e,ye,i,T=null==o.$$s?this:o.$$s,K=$,te=$;return null==T.name&&(T.name=$),null==I&&(I=$),null==a&&(a=$),K=I["$[]"](0),te=a["$[]"](0),ye="number"==typeof(i=$e=K.$max())?i+1:i["$+"](1),C(te["$include?"]($e))&&T.$raise(u(n,"RangeError"),T.name+": Range overlap: "+K+" and "+te),C(te["$include?"](ye))?$:T.$raise(u(n,"RangeError"),T.name+": Range gap: "+K+" and "+te)}).$$s=this,o.$$arity=2,o)),this},W.$$arity=1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var t,V,S,n,d,p,v,m,c,L,D,i,w=[],r=e.nil,x=e.$$$,$=e.$$,Q=e.module,u=e.klass,N=e.send;return t=w,V=i=[Q(w[0],"BCDice")].concat(t),S=D=[Q(i[0],"DiceTable")].concat(V),n=L=[u(D[0],null,"SaiFicSkillTable")].concat(S),m=u(L[0],null,"Category"),c=[m].concat(n),m.$$prototype.name=r,e.def(m,"$initialize",d=function(y,E,W,b){var _,o=this;return o.name=y,o.skills=N(E.$map(),"with_index",[2],((_=function(g){function R(I,a){return g.apply(this,arguments)}return R.toString=function(){return g.toString()},R}(function(g,R){return null==g&&(g=r),null==R&&(R=r),x($(c,"SaiFicSkillTable"),"Skill").$new(y,g,W,R,b)})).$$s=o,_.$$arity=2,_)),o.dice=W},d.$$arity=4),e.def(m,"$roll",p=function(y){return this.$skills()["$[]"]("number"==typeof(B=y.$roll_sum(2,6))?B-2:B["$-"](2));var B},p.$$arity=1),e.def(m,"$to_s",v=function(){return this.name},v.$$arity=0),void m.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var B,A,l,c,d,n,U,Y,f,C,X=[],w=e.nil,$=e.module,Q=e.klass,u=e.hash2;return B=X,A=C=[$(X[0],"BCDice")].concat(B),U=f=[$(C[0],"DiceTable")].concat(A),l=Y=[Q(f[0],null,"SaiFicSkillTable")].concat(U),[n=Q(Y[0],null,"Skill")].concat(l),n.$$prototype.s_format=n.$$prototype.category_dice=n.$$prototype.row_dice=n.$$prototype.category_name=n.$$prototype.name=w,e.def(n,"$initialize",c=function(v,h,y,E,W){var b=this;return b.category_name=v,b.name=h,b.category_dice=y,b.row_dice=E,b.s_format=W},c.$$arity=5),e.def(n,"$to_s",d=function(){var v=this;return v.$format(v.s_format,u(["category_dice","row_dice","category_name","skill_name"],{category_dice:v.category_dice,row_dice:v.row_dice,category_name:v.category_name,skill_name:v.name}))},d.$$arity=0),void n.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var V,U,l,c,d,p,v,h,y,E,n,m,Y,D,w=e.top,r=[],x=e.nil,$=e.$$$,Q=e.$$,u=e.module,N=e.klass,B=e.hash2,t=e.send,i=e.truthy;return w.$require("bcdice/dice_table/sai_fic_skill_table/category"),w.$require("bcdice/dice_table/sai_fic_skill_table/skill"),V=r,U=D=[u(r[0],"BCDice")].concat(V),l=Y=[u(D[0],"DiceTable")].concat(U),n=N(Y[0],null,"SaiFicSkillTable"),m=[n].concat(l),n.$$prototype.rtt=n.$$prototype.rtt_format=n.$$prototype.rct=n.$$prototype.rct_format=n.$$prototype.rttn=n.$$prototype.rttn_format=n.$$prototype.categories=x,e.defs(n,"$from_i18n",c=function(b,_,o){var g,R,I,a,$e,te=x;if(null==o)o=B([],{});else if(!o.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(g=o.$$smap.rtt)&&(g=x),null==(R=o.$$smap.rct)&&(R=x),null==(I=o.$$smap.rttn)&&(I=x),$e=(te=Q(m,"I18n").$t("RTT",B(["locale","raise","default"],{locale:_,raise:!1,default:B([],{})})).$merge(Q(m,"I18n").$t(b,B(["locale","raise"],{locale:_,raise:!0}))))["$[]"]("items"),te=t(te,"select",[],((a=function(ye){function ge(Te,Be){return ye.apply(this,arguments)}return ge.toString=function(){return ye.toString()},ge}(function(ye,ge){return null==ye&&(ye=x),null==ge&&(ge=x),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](ye)})).$$s=this,a.$$arity=2,a)),this.$new($e,e.to_hash(te).$merge(B(["rtt","rct","rttn"],{rtt:g,rct:R,rttn:I})))},c.$$arity=-3),e.const_set(m[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),e.const_set(m[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),e.const_set(m[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),e.const_set(m[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),e.def(n,"$initialize",d=function(b,_){var o,g,R,I,a,T,K,te,$e=this;if(null==_)_=B([],{});else if(!_.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(o=_.$$smap.rtt)&&(o=x),null==(g=_.$$smap.rct)&&(g=x),null==(R=_.$$smap.rttn)&&(R=x),null==(I=_.$$smap.rtt_format)&&(I=Q(m,"DEFAULT_RTT")),null==(a=_.$$smap.rct_format)&&(a=Q(m,"DEFAULT_RCT")),null==(T=_.$$smap.rttn_format)&&(T=Q(m,"DEFAULT_RTTN")),null==(K=_.$$smap.s_format)&&(K=Q(m,"DEFAULT_S")),$e.categories=t(b.$map(),"with_index",[1],((te=function(ge,Te){var ze,Ae,fe;return null==ge&&(ge=x),null==Te&&(Te=x),Ae=null==(ze=e.to_ary(ge))[0]?x:ze[0],fe=null==ze[1]?x:ze[1],$(Q(m,"SaiFicSkillTable"),"Category").$new(Ae,fe,Te,K)}).$$s=$e,te.$$arity=2,te.$$has_top_level_mlhs_arg=!0,te)),$e.rtt=o,$e.rct=g,$e.rttn=R.$to_a(),$e.rtt_format=I,$e.rct_format=a,$e.rttn_format=T},d.$$arity=-2),e.const_set(m[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),n.$attr_reader("categories"),e.def(n,"$roll_command",p=function(b,_){var g,o=this,R=x,I=x,a=x;return i(["RTT",o.rtt]["$include?"](g=_))?o.$format_skill(o.rtt_format,o.$roll_skill(b)):i(["RCT",o.rct]["$include?"](g))?(R=o.$roll_category(b),o.$format(o.rct_format,B(["category_dice","category_name"],{category_dice:R.$dice(),category_name:R.$name()}))):i(i(I=a=Q(m,"RTTN").$index(g))?I:a=o.rttn.$index(g))?o.$format_skill(o.rttn_format,o.categories["$[]"](a).$roll(b)):x},p.$$arity=2),e.def(n,"$roll_category",v=function(b){return this.categories["$[]"]("number"==typeof(A=b.$roll_once(6))?A-1:A["$-"](1));var A},v.$$arity=1),e.def(n,"$roll_skill",h=function(b){return this.$roll_category(b).$roll(b)},h.$$arity=1),e.def(n,"$prefixes",y=function(){var b=this;return function(A,V){return"number"==typeof A&&"number"==typeof V?A+V:A["$+"](V)}(["RTT[1-6]?","RCT",b.rtt,b.rct],b.rttn).$compact()},y.$$arity=0),n.$private(),void e.def(n,"$format_skill",E=function(b,_){return this.$format(b,B(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:_.$category_dice(),row_dice:_.$row_dice(),category_name:_.$category_name(),skill_name:_.$name(),text:_.$to_s()}))},E.$$arity=2)},Opal.modules["bcdice/dice_table/table"]=function(e){var C,f,Y,l,n,m,c,L,z,H,A,w=[],r=e.nil,$=e.$$,Q=e.module,u=e.klass,N=e.hash2,B=e.truthy;return C=w,f=A=[Q(w[0],"BCDice")].concat(C),Y=H=[Q(A[0],"DiceTable")].concat(f),L=u(H[0],null,"Table"),z=[L].concat(Y),L.$$prototype.times=L.$$prototype.sides=L.$$prototype.name=L.$$prototype.items=r,e.defs(L,"$from_i18n",l=function(p,v){var y=r;return y=$(z,"I18n").$t(p,N(["locale"],{locale:v})),this.$new(y["$[]"]("name"),y["$[]"]("type"),y["$[]"]("items"))},l.$$arity=2),e.def(L,"$initialize",n=function(p,v,h){var y=this,E=r;return y.name=p,y.items=h.$freeze(),E=/(\d+)D(\d+)/i.$match(v),B(E)||y.$raise($(z,"ArgumentError"),"Unexpected table type: "+v),y.times=E["$[]"](1).$to_i(),y.sides=E["$[]"](2).$to_i()},n.$$arity=3),e.def(L,"$roll",m=function(p){var h,v=this;return h=p.$roll_sum(v.times,v.sides),v.$choice(h)},m.$$arity=1),void e.def(L,"$choice",c=function(p){var h,v=this;return h=function(t,C){return"number"==typeof t&&"number"==typeof C?t-C:t["$-"](C)}(p,v.times),$(z,"RollResult").$new(v.name,p,v.items["$[]"](h))},c.$$arity=1)},Opal.modules["bcdice/dice_table"]=function(e){var j=e.top;return j.$require("bcdice/dice_table/roll_result"),j.$require("bcdice/dice_table/chain_table"),j.$require("bcdice/dice_table/d66_grid_table"),j.$require("bcdice/dice_table/d66_half_grid_table"),j.$require("bcdice/dice_table/d66_one_third_table"),j.$require("bcdice/dice_table/d66_left_range_table"),j.$require("bcdice/dice_table/d66_parity_table"),j.$require("bcdice/dice_table/d66_range_table"),j.$require("bcdice/dice_table/d66_table"),j.$require("bcdice/dice_table/range_table"),j.$require("bcdice/dice_table/sai_fic_skill_table"),j.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var u,C,A,B,X=[],$=e.module;return u=X,C=B=[$(X[0],"BCDice")].concat(u),A=[$(B[0],"D66SortType")].concat(C),e.const_set(A[0],"NO_SORT","no_sort"),e.const_set(A[0],"ASC","asc"),e.const_set(A[0],"DESC","desc"),void function(t,C){var A=[$(t,"RoundType")].concat(C);e.const_set(A[0],"CEIL","ceil"),e.const_set(A[0],"FLOOR","floor"),e.const_set(A[0],"ROUND","round")}(B[0],B)},Opal.modules["bcdice/translate"]=function(e){var B,A,D,V,f,C,X=[],w=e.nil,x=e.$$,$=e.module,Q=e.hash2;return B=X,A=C=[$(X[0],"BCDice")].concat(B),V=$(C[0],"Translate"),f=[V].concat(A),void e.def(V,"$translate",D=function(U,S){var Y,L=this;if(null==L.locale&&(L.locale=w),null==S)S=Q([],{});else if(!S.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return Y=e.kwrestargs(S,{}),x(f,"I18n").$translate(U,Q(["locale","raise"],{locale:L.locale,raise:!0}).$merge(e.to_hash(Y)))},D.$$arity=-2)},Opal.modules["bcdice/result"]=function(e){function j(B,t){return"number"==typeof B&&"number"==typeof t?B-t:B["$-"](t)}var t,m,p,v,h,y,E,f,U,S,Y,L,z,l,n,D,H,i,w=[],r=e.nil,u=e.klass,N=e.send;return t=w,f=i=[(0,e.module)(w[0],"BCDice")].concat(t),H=[D=u(i[0],null,"Result")].concat(f),D.$$prototype.secret=D.$$prototype.success=D.$$prototype.failure=D.$$prototype.critical=D.$$prototype.fumble=r,[m=e.get_singleton_class(D)].concat(H),e.def(m,"$success",p=function(b){var _;return N(this.$new(),"tap",[],((_=function(g){function R(I){return g.apply(this,arguments)}return R.toString=function(){return g.toString()},R}(function(g){var I=r;return null==g&&(g=r),N(g,"text=",e.to_a(I=[b])),j(I.length,1),N(g,"success=",e.to_a(I=[!0])),I[j(I.length,1)]})).$$s=this,_.$$arity=1,_))},p.$$arity=1),e.def(m,"$failure",v=function(b){var _;return N(this.$new(),"tap",[],((_=function(R){var a=r;return null==R&&(R=r),N(R,"text=",e.to_a(a=[b])),j(a.length,1),N(R,"failure=",e.to_a(a=[!0])),a[j(a.length,1)]}).$$s=this,_.$$arity=1,_))},v.$$arity=1),e.def(m,"$critical",h=function(b){var _;return N(this.$new(),"tap",[],((_=function(R){var a=r;return null==R&&(R=r),N(R,"text=",e.to_a(a=[b])),j(a.length,1),N(R,"critical=",e.to_a(a=[!0])),j(a.length,1),N(R,"success=",e.to_a(a=[!0])),a[j(a.length,1)]}).$$s=this,_.$$arity=1,_))},h.$$arity=1),e.def(m,"$fumble",y=function(b){var _;return N(this.$new(),"tap",[],((_=function(R){var a=r;return null==R&&(R=r),N(R,"text=",e.to_a(a=[b])),j(a.length,1),N(R,"fumble=",e.to_a(a=[!0])),j(a.length,1),N(R,"failure=",e.to_a(a=[!0])),a[j(a.length,1)]}).$$s=this,_.$$arity=1,_))},y.$$arity=1),e.def(m,"$nothing",E=function(){return"nothing"},E.$$arity=0),e.def(D,"$initialize",U=function(c){var d=this;return null==c&&(c=r),d.text=c,d.rands=r,d.detailed_rands=r,d.secret=!1,d.success=!1,d.failure=!1,d.critical=!1,d.fumble=!1},U.$$arity=-1),D.$attr_accessor("text","rands","detailed_rands"),D.$attr_writer("secret","success","failure","critical","fumble"),e.def(D,"$secret?",S=function(){return this.secret},S.$$arity=0),e.def(D,"$success?",Y=function(){return this.success},Y.$$arity=0),e.def(D,"$failure?",L=function(){return this.failure},L.$$arity=0),e.def(D,"$critical?",z=function(){return this.critical},z.$$arity=0),e.def(D,"$fumble?",l=function(){return this.fumble},l.$$arity=0),void e.def(D,"$condition=",n=function(c){return this.success=c,this.failure=c["$!"]()},n.$$arity=1)},Opal.modules["racc/parser"]=function(e){function j(U,S){return"number"==typeof U&&"number"==typeof S?U<S:U["$<"](S)}function X(U,S){return"number"==typeof U&&"number"==typeof S?U-S:U["$-"](S)}function w(U,S){return"number"==typeof U&&"number"==typeof S?U+S:U["$+"](S)}function r(U,S){return"number"==typeof U&&"number"==typeof S?U>=S:U["$>="](S)}function x(U,S){return"number"==typeof U&&"number"==typeof S?U>S:U["$>"](S)}function $(U,S){return"number"==typeof U&&"number"==typeof S?U<=S:U["$<="](S)}var z,l,n,S,L,B=[],t=e.nil,C=e.$$$,i=e.$$,A=e.module,V=e.klass,f=e.truthy,D=e.gvars,H=e.send;return S=B,z=(L=[A(B[0],"Racc")].concat(S))[0],l=i(L,"StandardError"),n=L,[V(z,l,"ParseError")].concat(n),f(C("::","ParseError","skip_raise")?"constant":t)||e.const_set(B[0],"ParseError",C(i(B,"Racc"),"ParseError")),function(U,S){var m,p,v,h,y,E,W,b,_,o,g,R,I,a,T,K,te,$e,ye,ge,Te,Be,ze,qe,Ae,c,d,L=[A(U,"Racc")].concat(S);f(i(L,"Racc_No_Extensions","skip_raise")?"constant":t)||e.const_set(L[0],"Racc_No_Extensions",!1),m=L,c=V(L[0],null,"Parser"),d=[c].concat(m),c.$$prototype.yydebug=c.$$prototype.racc_debug_out=c.$$prototype.racc_error_status=c.$$prototype.racc_t=c.$$prototype.racc_vstack=c.$$prototype.racc_val=c.$$prototype.racc_state=c.$$prototype.racc_tstack=t,e.const_set(d[0],"Racc_Runtime_Version","1.4.6"),e.const_set(d[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),e.const_set(d[0],"Racc_Runtime_Core_Version_R","1.4.6"),e.const_set(d[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),e.const_set(d[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),e.const_set(d[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),e.const_set(d[0],"Racc_Runtime_Core_Version",i(d,"Racc_Runtime_Core_Version_R")),e.const_set(d[0],"Racc_Runtime_Core_Revision",i(d,"Racc_Runtime_Core_Revision_R")),e.const_set(d[0],"Racc_Runtime_Type","ruby"),e.defs(i(d,"Parser"),"$racc_runtime_type",p=function(){return i(d,"Racc_Runtime_Type")},p.$$arity=0),e.def(c,"$_racc_setup",v=function(){var O,J,s=this,q=t,P=t,k=t;return null==D.stderr&&(D.stderr=t),f(C(s.$class(),"Racc_debug_parser"))||(s.yydebug=!1),f(null!=(O=s.yydebug)&&O!==t?"instance-variable":t)||(s.yydebug=!1),f(s.yydebug)&&(f(null!=(J=s.racc_debug_out)&&J!==t?"instance-variable":t)||(s.racc_debug_out=D.stderr),s.racc_debug_out=f(q=s.racc_debug_out)?q:D.stderr),P=C(s.$class(),"Racc_arg"),f(j(P.$size(),14))&&(H(P,"[]=",e.to_a(k=[13,!0])),X(k.length,1)),P},v.$$arity=0),e.def(c,"$_racc_init_sysvars",h=function(){var O=this;return O.racc_state=[0],O.racc_tstack=[],O.racc_vstack=[],O.racc_t=t,O.racc_val=t,O.racc_read_next=!0,O.racc_user_yyerror=!1,O.racc_error_status=0},h.$$arity=0),e.def(c,"$do_parse",y=function(){return this.$__send__(i(d,"Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},y.$$arity=0),e.def(c,"$next_token",E=function(){return this.$raise(i(d,"NotImplementedError"),this.$class()+"#next_token is not defined")},E.$$arity=0),e.def(c,"$_racc_do_parse_rb",W=function(O,J){var s,P,k=this,Z=t,ee=t,ne=t,de=t,ie=t,me=t,be=t,le=t;return s=e.to_ary(O),Z=null==s[0]?t:s[0],ee=null==s[1]?t:s[1],ne=null==s[2]?t:s[2],de=null==s[3]?t:s[3],ie=null==s[10]?t:s[10],k.$_racc_init_sysvars(),me=be=le=t,H(k,"catch",["racc_end_parse"],((P=function(){var Ee,Ne,ae=null==P.$$s?this:P.$$s,De=t,Ie=t,Ce=t;for(null==ae.racc_state&&(ae.racc_state=t),null==ae.racc_read_next&&(ae.racc_read_next=t),null==ae.racc_t&&(ae.racc_t=t),null==ae.yydebug&&(ae.yydebug=t),null==ae.racc_val&&(ae.racc_val=t);f(!0);)for(f(le=de["$[]"](ae.racc_state["$[]"](-1)))?(f(ae.racc_read_next)&&f(ae.racc_t["$!="](0))&&(Ne=ae.$next_token(),Ee=e.to_ary(Ne),me=null==Ee[0]?t:Ee[0],ae.racc_val=null==Ee[1]?t:Ee[1],ae.racc_t=f(me)?f(De=ie["$[]"](me))?De:1:0,f(ae.yydebug)&&ae.$racc_read_token(ae.racc_t,me,ae.racc_val),ae.racc_read_next=!1),le=w(le,ae.racc_t),f(f(Ie=f(Ce=r(le,0))?be=Z["$[]"](le):Ce)?ee["$[]"](le)["$=="](ae.racc_state["$[]"](-1)):Ie)||(be=ne["$[]"](ae.racc_state["$[]"](-1)))):be=ne["$[]"](ae.racc_state["$[]"](-1));f(be=ae.$_racc_evalact(be,O)););}).$$s=k,P.$$arity=0,P))},W.$$arity=2),e.def(c,"$yyparse",b=function(O,J){return this.$__send__(i(d,"Racc_YY_Parse_Method"),O,J,this.$_racc_setup(),!0)},b.$$arity=2),e.def(c,"$_racc_yyparse_rb",_=function(O,J,s,q){var P,Z,ne=t,de=t,re=t,ie=t,be=t,le=t,he=t;return P=e.to_ary(s),ne=null==P[0]?t:P[0],de=null==P[1]?t:P[1],re=null==P[2]?t:P[2],ie=null==P[3]?t:P[3],be=null==P[10]?t:P[10],this.$_racc_init_sysvars(),le=t,he=t,H(this,"catch",["racc_end_parse"],((Z=function(){var De,xe=null==Z.$$s?this:Z.$$s;for(null==xe.racc_state&&(xe.racc_state=t);!f(he=ie["$[]"](xe.racc_state["$[]"](-1)));)for(;f(le=xe.$_racc_evalact(re["$[]"](xe.racc_state["$[]"](-1)),s)););return H(O,"__send__",[J],((De=function(Ce,Se){var Ue,Ge,ke=null==De.$$s?this:De.$$s,Le=t,He=t,je=t,We=t,ue=t,M=t,_e=t;for(null==ke.racc_t&&(ke.racc_t=t),null==ke.racc_state&&(ke.racc_state=t),null==ke.racc_read_next&&(ke.racc_read_next=t),null==Ce&&(Ce=t),null==Se&&(Se=t),ke.racc_t=f(Ce)?f(Le=be["$[]"](Ce))?Le:1:0,ke.racc_val=Se,ke.racc_read_next=!1,he=w(he,ke.racc_t),f(f(Ue=f(Ge=r(he,0))?le=ne["$[]"](he):Ge)?de["$[]"](he)["$=="](ke.racc_state["$[]"](-1)):Ue)||(le=re["$[]"](ke.racc_state["$[]"](-1)));f(le=ke.$_racc_evalact(le,s)););for(;f(f(He=f(je=(he=ie["$[]"](ke.racc_state["$[]"](-1)))["$!"]())?je:ke.racc_read_next["$!"]())?He:ke.racc_t["$=="](0));)for(f(f(We=f(ue=f(M=f(_e=he)?he=w(he,ke.racc_t):_e)?r(he,0):M)?le=ne["$[]"](he):ue)?de["$[]"](he)["$=="](ke.racc_state["$[]"](-1)):We)||(le=re["$[]"](ke.racc_state["$[]"](-1)));f(le=ke.$_racc_evalact(le,s)););}).$$s=xe,De.$$arity=2,De))}).$$s=this,Z.$$arity=0,Z))},_.$$arity=4),e.def(c,"$_racc_evalact",o=function(O,J){var s,P,re,me,k=this,Z=t,ee=t,de=t,ie=t,be=t,le=t,he=t,ae=t,xe=t,Ee=t;if(Z=null==(s=e.to_ary(J))[0]?t:s[0],ee=null==s[1]?t:s[1],de=null==s[3]?t:s[3],re=null==s[11]?t:s[11],ie=null==s[12]?t:s[12],f(f(me=x(O,0))?j(O,re):me))f(x(k.racc_error_status,0))&&(k.racc_t["$=="](1)||(k.racc_error_status=X(k.racc_error_status,1))),k.racc_vstack.$push(k.racc_val),k.racc_state.$push(O),k.racc_read_next=!0,f(k.yydebug)&&(k.racc_tstack.$push(k.racc_t),k.$racc_shift(k.racc_t,k.racc_tstack,k.racc_vstack));else if(f(f(be=j(O,0))?x(O,ie["$-@"]()):be)){if(le=H(k,"catch",["racc_jump"],((P=function(){var De=null==P.$$s?this:P.$$s;return null==De.racc_state&&(De.racc_state=t),De.racc_state.$push(De.$_racc_do_reduce(J,O)),!1}).$$s=k,P.$$arity=0,P)),f(le)){if(1["$==="](he=le))return k.racc_user_yyerror=!0,ie["$-@"]();if(2["$==="](he))return re;k.$raise("[Racc Bug] unknown jump code")}}else if(O["$=="](re))f(k.yydebug)&&k.$racc_accept(),k.$throw("racc_end_parse",k.racc_vstack["$[]"](0));else{if(O["$=="](ie["$-@"]())){for((0)["$==="](he=k.racc_error_status)?f(J["$[]"](21))||k.$on_error(k.racc_t,k.racc_val,k.racc_vstack):3["$==="](he)&&(k.racc_t["$=="](0)&&k.$throw("racc_end_parse",t),k.racc_read_next=!0),k.racc_user_yyerror=!1,k.racc_error_status=3;f(!0)&&(!f(ae=de["$[]"](k.racc_state["$[]"](-1)))||(ae=w(ae,1),!f(f(xe=f(Ee=r(ae,0))?O=Z["$[]"](ae):Ee)?ee["$[]"](ae)["$=="](k.racc_state["$[]"](-1)):xe)));)f($(k.racc_state.$size(),1))&&k.$throw("racc_end_parse",t),k.racc_state.$pop(),k.racc_vstack.$pop(),f(k.yydebug)&&(k.racc_tstack.$pop(),k.$racc_e_pop(k.racc_state,k.racc_tstack,k.racc_vstack));return O}k.$raise("[Racc Bug] unknown action "+O.$inspect())}return f(k.yydebug)&&k.$racc_next_state(k.racc_state["$[]"](-1),k.racc_state),t},o.$$arity=2),e.def(c,"$_racc_do_reduce",g=function(O,J){var s,re,me,Ee,Ne,De,ke,P=this,Z=t,ee=t,ne=t,de=t,ie=t,be=t,le=t,he=t,ae=t,xe=t,Ie=t,Ce=t,Se=t,Fe=t,Me=t,Le=t;return Z=null==(s=e.to_ary(O))[4]?t:s[4],ee=null==s[5]?t:s[5],ne=null==s[6]?t:s[6],de=null==s[7]?t:s[7],re=null==s[8]?t:s[8],ie=null==s[9]?t:s[9],me=null==s[13]?t:s[13],be=P.racc_state,le=P.racc_vstack,he=P.racc_tstack,ae=function(U,S){return"number"==typeof U?-3*U:U["$*"](-3)}(J),xe=ie["$[]"](ae),Ee=ie["$[]"](w(ae,1)),Ne=ie["$[]"](w(ae,2)),De=[],f(P.yydebug)&&(Ie=he["$[]"](xe["$-@"](),xe)),Ce=le["$[]"](xe["$-@"](),xe),f(P.yydebug)&&(Se=[xe["$-@"](),xe,De],H(he,"[]=",e.to_a(Se)),X(Se.length,1)),Se=[xe["$-@"](),xe,De],H(le,"[]=",e.to_a(Se)),X(Se.length,1),Se=[xe["$-@"](),xe,De],H(be,"[]=",e.to_a(Se)),X(Se.length,1),f(me)?le.$push(P.$__send__(Ne,Ce,le,Ce["$[]"](0))):le.$push(P.$__send__(Ne,Ce,le)),he.$push(Ee),f(P.yydebug)&&P.$racc_reduce(Ie,Ee,he,le),ke=X(Ee,re),f(ae=de["$[]"](ke))&&(ae=w(ae,be["$[]"](-1)),f(f(Fe=f(Me=r(ae,0))?Le=Z["$[]"](ae):Me)?ee["$[]"](ae)["$=="](ke):Fe))?Le:ne["$[]"](ke)},g.$$arity=2),e.def(c,"$on_error",R=function(O,J,s){var P,q=this;return q.$raise(i(d,"ParseError"),q.$sprintf("\nparse error on value %s (%s)",J.$inspect(),f(P=q.$token_to_str(O))?P:"?"))},R.$$arity=3),e.def(c,"$yyerror",I=function(){return this.$throw("racc_jump",1)},I.$$arity=0),e.def(c,"$yyaccept",a=function(){return this.$throw("racc_jump",2)},a.$$arity=0),e.def(c,"$yyerrok",T=function(){return this.racc_error_status=0},T.$$arity=0),e.def(c,"$racc_read_token",K=function(O,J,s){var q=this;return q.racc_debug_out.$print("read    "),q.racc_debug_out.$print(J.$inspect(),"(",q.$racc_token2str(O),") "),q.racc_debug_out.$puts(s.$inspect()),q.racc_debug_out.$puts()},K.$$arity=3),e.def(c,"$racc_shift",te=function(O,J,s){var q=this;return q.racc_debug_out.$puts("shift   "+q.$racc_token2str(O)),q.$racc_print_stacks(J,s),q.racc_debug_out.$puts()},te.$$arity=3),e.def(c,"$racc_reduce",$e=function(O,J,s,q){var P,k=this,Z=t;return(Z=k.racc_debug_out).$print("reduce "),f(O["$empty?"]())?Z.$print(" <none>"):H(O,"each",[],((P=function(ne){return null==ne&&(ne=t),Z.$print(" ",(null==P.$$s?this:P.$$s).$racc_token2str(ne))}).$$s=k,P.$$arity=1,P)),Z.$puts(" --\x3e "+k.$racc_token2str(J)),k.$racc_print_stacks(s,q),k.racc_debug_out.$puts()},$e.$$arity=4),e.def(c,"$racc_accept",ye=function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},ye.$$arity=0),e.def(c,"$racc_e_pop",ge=function(O,J,s){var q=this;return q.racc_debug_out.$puts("error recovering mode: pop token"),q.$racc_print_states(O),q.$racc_print_stacks(J,s),q.racc_debug_out.$puts()},ge.$$arity=3),e.def(c,"$racc_next_state",Te=function(O,J){var s=this;return s.racc_debug_out.$puts("goto    "+O),s.$racc_print_states(J),s.racc_debug_out.$puts()},Te.$$arity=2),e.def(c,"$racc_print_stacks",Be=function(O,J){var s,P=t;return(P=this.racc_debug_out).$print("        ["),H(O,"each_index",[],((s=function(Z){return null==Z&&(Z=t),P.$print(" (",(null==s.$$s?this:s.$$s).$racc_token2str(O["$[]"](Z))," ",J["$[]"](Z).$inspect(),")")}).$$s=this,s.$$arity=1,s)),P.$puts(" ]")},Be.$$arity=2),e.def(c,"$racc_print_states",ze=function(O){var J,q=t;return(q=this.racc_debug_out).$print("        ["),H(O,"each",[],((J=function(k){return null==k&&(k=t),q.$print(" ",k)}).$$s=this,J.$$arity=1,J)),q.$puts(" ]")},ze.$$arity=1),e.def(c,"$racc_token2str",qe=function(O){var s;return f(s=C(this.$class(),"Racc_token_to_s_table")["$[]"](O))?s:this.$raise("[Racc Bug] can't convert token "+O+" to string")},qe.$$arity=1),e.def(c,"$token_to_str",Ae=function(O){return C(this.$class(),"Racc_token_to_s_table")["$[]"](O)},Ae.$$arity=1)}(B[0],B)},Opal.modules["bcdice/arithmetic/node"]=function(e){function j(B,t){return"number"==typeof B&&"number"==typeof t?B/t:B["$/"](t)}var t,V,U,L,z,l,c,d,p,v,h,y,n,m,Y,D,i,w=[],r=e.nil,x=e.$$$,$=e.$$,Q=e.module,u=e.klass,N=e.send2;return t=w,V=i=[Q(w[0],"BCDice")].concat(t),U=D=[Q(i[0],"Arithmetic")].concat(V),function(L,z,l){var c,d,p,v,h,n=u(L,null,"BinaryOp");[n].concat(l),n.$$prototype.lhs=n.$$prototype.rhs=n.$$prototype.op=r,e.def(n,"$initialize",c=function(E,W,b){var _=this;return _.lhs=E,_.op=W,_.rhs=b},c.$$arity=3),e.def(n,"$eval",d=function(E){var _,W=this,b=r;return b=W.lhs.$eval(E),_=W.rhs.$eval(E),b.$send(W.op,_)},d.$$arity=1),e.def(n,"$output",p=function(){var E=this;return""+E.lhs.$output()+E.op+E.rhs.$output()},p.$$arity=0),e.def(n,"$s_exp",v=function(){var E=this;return"("+E.$op_for_s_exp()+" "+E.lhs.$s_exp()+" "+E.rhs.$s_exp()+")"},v.$$arity=0),e.def(n,"$op_for_s_exp",h=function(){return this.op},h.$$arity=0)}((Y=[Q(D[0],"Node")].concat(U))[0],0,Y),L=Y[0],z=$(Y,"BinaryOp"),l=Y,n=u(L,z,"DivideBase"),m=[n].concat(l),n.$$prototype.lhs=n.$$prototype.rhs=n.$$prototype.op=r,e.def(n,"$initialize",c=function(W,b){return c.$$p&&(c.$$p=null),N(this,e.find_super_dispatcher(this,"initialize",c,!1,!0),"initialize",[W,"/",b],null)},c.$$arity=2),e.def(n,"$eval",d=function(W){var _,b=this,o=r;return _=b.lhs.$eval(W),(o=b.rhs.$eval(W))["$=="](0)&&b.$raise($(m,"ZeroDivisionError")),b.$divide_and_round(_,o,W)},d.$$arity=1),e.def(n,"$output",p=function(){var W=p.$$p,_=this,o=r,g=r,R=r;for(W&&(p.$$p=null),g=0,R=arguments.length,o=new Array(R);g<R;g++)o[g]=arguments[g];return""+N(_,e.find_super_dispatcher(_,"output",p,!1,!0),"output",o,W)+_.$rounding_method()},p.$$arity=0),n.$private(),e.def(n,"$rounding_method",v=function(){return x(this.$class(),"ROUNDING_METHOD")},v.$$arity=0),e.def(n,"$op_for_s_exp",h=function(){return""+this.op+this.$rounding_method()},h.$$arity=0),e.def(n,"$divide_and_round",y=function(W,b,_){return this.$raise($(m,"NotImplementedError"))},y.$$arity=3),function(L,z,l){var c,n=u(L,z,"DivideWithGameSystemDefault"),m=[n].concat(l);e.const_set(m[0],"ROUNDING_METHOD",""),n.$private(),e.def(n,"$divide_and_round",c=function(p,v,h){var E;return E=h,x($(m,"RoundType"),"CEIL")["$==="](E)?j(p.$to_f(),v).$ceil():x($(m,"RoundType"),"ROUND")["$==="](E)?j(p.$to_f(),v).$round():j(p,v).$to_i()},c.$$arity=3)}(Y[0],$(Y,"DivideBase"),Y),function(L,z,l){var c,n=u(L,z,"DivideWithCeil"),m=[n].concat(l);e.const_set(m[0],"ROUNDING_METHOD","C"),n.$private(),e.def(n,"$divide_and_round",c=function(p,v,h){return j(p.$to_f(),v).$ceil()},c.$$arity=3)}(Y[0],$(Y,"DivideBase"),Y),function(L,z,l){var c,n=u(L,z,"DivideWithRound"),m=[n].concat(l);e.const_set(m[0],"ROUNDING_METHOD","R"),n.$private(),e.def(n,"$divide_and_round",c=function(p,v,h){return j(p.$to_f(),v).$round()},c.$$arity=3)}(Y[0],$(Y,"DivideBase"),Y),function(L,z,l){var c,n=u(L,z,"DivideWithFloor"),m=[n].concat(l);e.const_set(m[0],"ROUNDING_METHOD","F"),n.$private(),e.def(n,"$divide_and_round",c=function(p,v,h){return j(p,v).$to_i()},c.$$arity=3)}(Y[0],$(Y,"DivideBase"),Y),function(L,z,l){var c,d,p,v,n=u(L,null,"Negative");[n].concat(l),n.$$prototype.body=r,e.def(n,"$initialize",c=function(y){return this.body=y},c.$$arity=1),e.def(n,"$eval",d=function(y){return this.body.$eval(y)["$-@"]()},d.$$arity=1),e.def(n,"$output",p=function(){return"-"+this.body.$output()},p.$$arity=0),e.def(n,"$s_exp",v=function(){return"(- "+this.body.$s_exp()+")"},v.$$arity=0)}(Y[0],0,Y),function(L,z,l){var c,d,p,v,n=u(L,null,"Parenthesis");[n].concat(l),n.$$prototype.expr=r,e.def(n,"$initialize",c=function(y){return this.expr=y},c.$$arity=1),e.def(n,"$eval",d=function(y){return this.expr.$eval(y)},d.$$arity=1),e.def(n,"$output",p=function(){return"("+this.expr.$output()+")"},p.$$arity=0),e.def(n,"$s_exp",v=function(){return"(Parenthesis "+this.expr.$s_exp()+")"},v.$$arity=0)}(Y[0],0,Y),void function(L,z,l){var c,d,p,n=u(L,null,"Number");[n].concat(l),n.$$prototype.value=r,e.def(n,"$initialize",c=function(h){return this.value=h},c.$$arity=1),e.def(n,"$eval",d=function(h){return this.value},d.$$arity=1),e.def(n,"$output",p=function(){return this.value.$to_s()},p.$$arity=0),e.alias(n,"s_exp","output")}(Y[0],0,Y)},Opal.modules.strscan=function(e){var C,V,f,D,H,U,S,Y,L,z,l,n,m,c,d,p,v,h,y,E,W,b,_,o,g,R,i,A,w=[],r=e.nil,$=e.$$,u=e.truthy,N=e.send;return C=w,i=(0,e.klass)(w[0],null,"StringScanner"),A=[i].concat(C),i.$$prototype.pos=i.$$prototype.string=i.$$prototype.working=i.$$prototype.matched=i.$$prototype.prev_pos=i.$$prototype.match=r,i.$attr_reader("pos"),i.$attr_reader("matched"),e.def(i,"$initialize",V=function(a){var T=this;return T.string=a,T.pos=0,T.matched=r,T.working=a,T.match=[]},V.$$arity=1),i.$attr_reader("string"),e.def(i,"$beginning_of_line?",f=function(){var a=this;return 0===a.pos||"\n"===a.string.charAt(a.pos-1)},f.$$arity=0),e.alias(i,"bol?","beginning_of_line?"),e.def(i,"$scan",D=function(a){var T=this,K=(a=T.$anchor(a)).exec(T.working);return null==K?T.matched=r:"object"==typeof K?(T.prev_pos=T.pos,T.pos+=K[0].length,T.working=T.working.substring(K[0].length),T.matched=K[0],T.match=K,K[0]):"string"==typeof K?(T.pos+=K.length,T.working=T.working.substring(K.length),K):r},D.$$arity=1),e.def(i,"$scan_until",H=function(a){var T=this;a=T.$anchor(a);for(var $e,K=T.pos,te=T.working;;){if($e=a.exec(te),K+=1,te=te.substr(1),null!=$e)return T.matched=T.string.substr(T.pos,K-T.pos-1+$e[0].length),T.match=$e,T.prev_pos=K-1,T.pos=K,T.working=te.substr($e[0].length),T.matched;if(0===te.length)return T.match=[],T.matched=r}},H.$$arity=1),e.def(i,"$[]",U=function(a){var K;if(u(this.match["$empty?"]()))return r;K=a,$(A,"Symbol")["$==="](K)?a=a.$to_s():$(A,"String")["$==="](K)||(a=$(A,"Opal")["$coerce_to!"](a,$(A,"Integer"),"to_int"));var te=this.match;return a<0&&(a+=te.length),a<0||a>=te.length||null==te[a]?r:te[a]},U.$$arity=1),e.def(i,"$check",S=function(a){var T=this,K=(a=T.$anchor(a)).exec(T.working);return T.matched=null==K?r:K[0]},S.$$arity=1),e.def(i,"$check_until",Y=function(a){var T=this,K=T.prev_pos,te=T.pos,$e=T.$scan_until(a);return $e!==r&&(T.matched=$e.substr(-1),T.working=T.string.substr(te)),T.prev_pos=K,T.pos=te,$e},Y.$$arity=1),e.def(i,"$peek",L=function(a){return this.working.substring(0,a)},L.$$arity=1),e.def(i,"$eos?",z=function(){return 0===this.working.length},z.$$arity=0),e.def(i,"$exist?",l=function(a){var K=a.exec(this.working);return null==K?r:0==K.index?0:K.index+1},l.$$arity=1),e.def(i,"$skip",n=function(a){var T=this,K=(a=T.$anchor(a)).exec(T.working);if(null==K)return T.match=[],T.matched=r;var te=K[0],$e=te.length;return T.matched=te,T.match=K,T.prev_pos=T.pos,T.pos+=$e,T.working=T.working.substring($e),$e},n.$$arity=1),e.def(i,"$skip_until",m=function(a){var K=this.$scan_until(a);return K===r?r:(this.matched=K.substr(-1),K.length)},m.$$arity=1),e.def(i,"$get_byte",c=function(){var a=this,T=r;return a.pos<a.string.length?(a.prev_pos=a.pos,a.pos+=1,T=a.matched=a.working.substring(0,1),a.working=a.working.substring(1)):a.matched=r,T},c.$$arity=0),e.alias(i,"getch","get_byte"),e.def(i,"$match?",d=function(a){var T=this,K=(a=T.$anchor(a)).exec(T.working);return null==K?r:(T.prev_pos=T.pos,K[0].length)},d.$$arity=1),e.def(i,"$pos=",p=function(a){var T=this;return a<0&&(a+=T.string.$length()),T.pos=a,T.working=T.string.slice(a)},p.$$arity=1),e.def(i,"$matched_size",v=function(){return this.matched===r?r:this.matched.length},v.$$arity=0),e.def(i,"$post_match",h=function(){var a=this;return a.matched===r?r:a.string.substr(a.pos)},h.$$arity=0),e.def(i,"$pre_match",y=function(){var a=this;return a.matched===r?r:a.string.substr(0,a.prev_pos)},y.$$arity=0),e.def(i,"$reset",E=function(){var a=this;return a.working=a.string,a.matched=r,a.pos=0},E.$$arity=0),e.def(i,"$rest",W=function(){return this.working},W.$$arity=0),e.def(i,"$rest?",b=function(){return 0!==this.working.length},b.$$arity=0),e.def(i,"$rest_size",_=function(){return this.$rest().$size()},_.$$arity=0),e.def(i,"$terminate",o=function(){var T,B,a=this;return a.match=r,T=[a.string.$length()],N(a,"pos=",e.to_a(T)),T[(B=T.length,"number"==typeof B?B-1:B["$-"](1))]},o.$$arity=0),e.def(i,"$unscan",g=function(){var a=this;return a.pos=a.prev_pos,a.prev_pos=r,a.match=r,a},g.$$arity=0),i.$private(),e.def(i,"$anchor",R=function(a){var K=a.toString().match(/\/([^\/]+)$/);return K=K?K[1]:void 0,new RegExp("^(?:"+a.source+")",K)},R.$$arity=1),r&&"anchor"},Opal.modules["bcdice/normalize"]=function(e){var C,V,f,i,u,B,X=[],w=e.nil,$=e.module;return u=X,C=B=[$(X[0],"BCDice")].concat(u),[i=$(B[0],"Normalize")].concat(C),i.$module_function(),e.def(i,"$comparison_operator",V=function(H){var S;return/<=|=</["$==="](S=H)?"<=":/>=|=>/["$==="](S)?">=":/<>|!=|=!/["$==="](S)?"!=":/</["$==="](S)?"<":/>/["$==="](S)?">":/=/["$==="](S)?"==":w},V.$$arity=1),void e.def(i,"$target_number",f=function(H){return H["$=="]("?")?H:H.$to_i()},f.$$arity=1)},Opal.modules["bcdice/command/lexer"]=function(e){var C,f,Y,l,n,m,L,z,H,A,j=e.top,X=[],w=e.nil,x=e.$$,$=e.module,Q=e.klass,u=e.hash2,N=e.truthy,B=e.send;return j.$require("strscan"),j.$require("bcdice/normalize"),C=X,f=A=[$(X[0],"BCDice")].concat(C),Y=H=[$(A[0],"Command")].concat(f),L=Q(H[0],null,"Lexer"),z=[L].concat(Y),L.$$prototype.scanner=L.$$prototype.notations=w,e.const_set(z[0],"SYMBOLS",u(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),e.def(L,"$initialize",l=function(d,p){var v,h,y,W,E=this;return d=N(W=(h=(v=d)===w||null==v?w:B(v,"split",[" ",2]))===w||null==h?w:B(h,"first",[]))?W:"",E.scanner=x(z,"StringScanner").$new(d),E.notations=B(p,"map",[],((y=function(b){function _(o){return b.apply(this,arguments)}return _.toString=function(){return b.toString()},_}(function(b){return null==b&&(b=w),N(b["$is_a?"](x(z,"String")))?x(z,"Regexp").$new(b):b})).$$s=E,y.$$arity=1,y))},l.$$arity=2),e.def(L,"$next_token",n=function(){try{var d,p=this,v=w,h=w,E=w,W=w;return N(p.scanner["$eos?"]())?[!1,"$"]:(B(p.notations,"each",[],((d=function(_){var g,o=null==d.$$s?this:d.$$s;if(null==o.scanner&&(o.scanner=w),null==_&&(_=w),g=o.scanner.$scan(_),!N(g))return w;e.ret(["NOTATION",g])}).$$s=p,d.$$arity=1,d)),N(v=p.scanner.$scan(/\d+/))?["NUMBER",v.$to_i()]:N(h=p.scanner.$scan(/[<>!=]+/))?(h=x(z,"Normalize").$comparison_operator(h),[N(h)?"CMP_OP":"ILLEGAL",h]):(E=p.scanner.$getch().$upcase(),[N(W=x(z,"SYMBOLS")["$[]"](E))?W:E.$to_sym(),E]))}catch(b){if(b===e.returner)return b.$v;throw b}},n.$$arity=0),void e.def(L,"$source",m=function(){return this.scanner.$string()},m.$$arity=0)},Opal.modules["bcdice/command/parsed"]=function(e){var B,A,U,L,z,l,S,Y,f,C,X=[],w=e.nil,x=e.$$,$=e.module,Q=e.klass,u=e.truthy;return B=X,A=C=[$(X[0],"BCDice")].concat(B),U=f=[$(C[0],"Command")].concat(A),S=Q(f[0],null,"Parsed"),Y=[S].concat(U),S.$$prototype.question_target=S.$$prototype.critical=S.$$prototype.fumble=S.$$prototype.dollar=S.$$prototype.modify_number=S.$$prototype.target_number=S.$$prototype.prefix_number=S.$$prototype.command=S.$$prototype.suffix_number=S.$$prototype.cmp_op=w,S.$attr_accessor("command"),S.$attr_accessor("prefix_number"),S.$attr_accessor("suffix_number"),S.$attr_accessor("critical"),S.$attr_accessor("fumble"),S.$attr_accessor("dollar"),S.$attr_accessor("modify_number"),S.$attr_accessor("cmp_op"),S.$attr_accessor("target_number"),S.$attr_writer("question_target"),e.def(S,"$initialize",L=function(){var m=this;return m.prefix_number=w,m.suffix_number=w,m.critical=w,m.fumble=w,m.dollar=w,m.cmp_op=w,m.target_number=w,m.question_target=!1},L.$$arity=0),e.def(S,"$question_target?",z=function(){return this.question_target},z.$$arity=0),void e.def(S,"$to_s",l=function(m){var E,c=this,d=w,p=w,v=w,h=w,y=w;return null==m&&(m="after_command"),d=u(c.critical)?"@"+c.critical:w,p=u(c.fumble)?"#"+c.fumble:w,v=u(c.dollar)?"$"+c.dollar:w,h=x(Y,"Format").$modifier(c.modify_number),y=u(c.question_target)?"?":c.target_number,"after_command"["$==="](E=m)?[c.prefix_number,c.command,c.suffix_number,d,p,v,h,c.cmp_op,y].$join():"after_modify_number"["$==="](E)?[c.prefix_number,c.command,c.suffix_number,h,d,p,v,c.cmp_op,y].$join():"after_target_number"["$==="](E)?[c.prefix_number,c.command,c.suffix_number,h,c.cmp_op,y,d,p,v].$join():w},l.$$arity=-1)},Opal.modules["bcdice/command/parser"]=function(e){function j(A,V){return"number"==typeof A&&"number"==typeof V?A-V:A["$-"](V)}var V,U,L,z,l,c,d,p,v,h,y,E,W,b,_,o,g,R,I,a,T,K,te,$e,ye,ge,Te,Be,ze,qe,Ae,fe,O,J,s,q,P,k,Z,ee,ne,de,re,ie,me,be,le,he,ae,xe,Ee,Ne,De,Ie,Ce,Se,ke,Fe,Me,Le,He,n,m,Y,D,X=e.top,w=[],r=e.nil,x=e.$$$,$=e.$$,Q=e.klass,u=e.module,N=e.hash2,B=e.send2,t=e.send,C=e.hash,i=e.truthy;return X.$require("racc/parser.rb"),X.$require("bcdice/arithmetic/node"),X.$require("bcdice/command/lexer"),X.$require("bcdice/command/parsed"),function(A,V,f){[Q(A,V,"Parser")].concat(f)}(x($(w,"BCDice"),"Command"),x($(w,"Racc"),"Parser"),w),V=w,U=D=[u(w[0],"BCDice")].concat(V),L=(Y=[u(D[0],"Command")].concat(U))[0],z=x($(Y,"Racc"),"Parser"),l=Y,n=Q(L,z,"Parser"),m=[n].concat(l),n.$$prototype.notations=n.$$prototype.lexer=n.$$prototype.modifier=n.$$prototype.prefix_number=n.$$prototype.suffix_number=n.$$prototype.need_suffix_number=n.$$prototype.need_prefix_number=n.$$prototype.critical=n.$$prototype.fumble=n.$$prototype.dollar=n.$$prototype.allowed_cmp_op=n.$$prototype.question_target=r,e.def(n,"$initialize",c=function(M,_e){var G,F,se,Re,pe=c.$$p,oe=this;if(pe&&(c.$$p=null),G=e.slice.call(arguments,0,arguments.length),null==(F=e.extract_kwargs(G)))F=N([],{});else if(!F.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(se=G,!e.hasOwnProperty.call(F.$$smap,"round_type"))throw e.ArgumentError.$new("missing keyword: round_type");return Re=F.$$smap.round_type,B(oe,e.find_super_dispatcher(oe,"initialize",c,!1,!0),"initialize",[],null),oe.notations=se,oe.round_type=Re,oe.prefix_number=!1,oe.suffix_number=!1,oe.need_prefix_number=!1,oe.need_suffix_number=!1,oe.modifier=!0,oe.critical=!1,oe.fumble=!1,oe.dollar=!1,oe.allowed_cmp_op=[r,">=",">","<=","<","==","!="],oe.question_target=!1},c.$$arity=-2),e.def(n,"$disable_modifier",d=function(){return this.modifier=!1,this},d.$$arity=0),e.def(n,"$enable_prefix_number",p=function(){return this.prefix_number=!0,this},p.$$arity=0),e.def(n,"$enable_suffix_number",v=function(){return this.suffix_number=!0,this},v.$$arity=0),e.def(n,"$has_prefix_number",h=function(){var M=this;return M.prefix_number=!0,M.need_prefix_number=!0,M},h.$$arity=0),e.def(n,"$has_suffix_number",y=function(){var M=this;return M.suffix_number=!0,M.need_suffix_number=!0,M},y.$$arity=0),e.def(n,"$enable_critical",E=function(){return this.critical=!0,this},E.$$arity=0),e.def(n,"$enable_fumble",W=function(){return this.fumble=!0,this},W.$$arity=0),e.def(n,"$enable_dollar",b=function(){return this.dollar=!0,this},b.$$arity=0),e.def(n,"$restrict_cmp_op_to",_=function(M){var _e,F=this;return _e=e.slice.call(arguments,0,arguments.length),F.allowed_cmp_op=_e,F},_.$$arity=-1),e.def(n,"$enable_question_target",o=function(){return this.question_target=!0,this},o.$$arity=0),e.def(n,"$parse",g=function(M){try{return this.lexer=$(m,"Lexer").$new(M,this.notations),this.$do_parse()}catch(G){if(!e.rescue(G,[$(m,"ParseError"),$(m,"ZeroDivisionError")]))throw G;try{return r}finally{e.pop_exception()}}},g.$$arity=1),n.$private(),e.def(n,"$parsed",R=function(M,_e,G,F){var se;return t($(m,"Parsed").$new(),"tap",[],((se=function(ve){var we,Pe,Ye,Ke,Ve,Qe,oe=null==se.$$s?this:se.$$s,ce=r;return null==oe.round_type&&(oe.round_type=r),null==ve&&(ve=r),ce=[M["$[]"]("command")],t(ve,"command=",e.to_a(ce)),j(ce.length,1),ce=[(we=M["$[]"]("prefix"),we===r||null==we?r:t(we,"eval",[oe.round_type]))],t(ve,"prefix_number=",e.to_a(ce)),j(ce.length,1),ce=[(Pe=M["$[]"]("suffix"),Pe===r||null==Pe?r:t(Pe,"eval",[oe.round_type]))],t(ve,"suffix_number=",e.to_a(ce)),j(ce.length,1),ce=[(Ye=_e["$[]"]("critical"),Ye===r||null==Ye?r:t(Ye,"eval",[oe.round_type]))],t(ve,"critical=",e.to_a(ce)),j(ce.length,1),ce=[(Ke=_e["$[]"]("fumble"),Ke===r||null==Ke?r:t(Ke,"eval",[oe.round_type]))],t(ve,"fumble=",e.to_a(ce)),j(ce.length,1),ce=[(Ve=_e["$[]"]("dollar"),Ve===r||null==Ve?r:t(Ve,"eval",[oe.round_type]))],t(ve,"dollar=",e.to_a(ce)),j(ce.length,1),ce=[G.$eval(oe.round_type)],t(ve,"modify_number=",e.to_a(ce)),j(ce.length,1),ce=[F["$[]"]("cmp_op")],t(ve,"cmp_op=",e.to_a(ce)),j(ce.length,1),F["$[]"]("target")["$=="]("?")?(t(ve,"question_target=",e.to_a(ce=[!0])),j(ce.length,1),t(ve,"target_number=",e.to_a(ce=[0])),ce[j(ce.length,1)]):(t(ve,"question_target=",e.to_a(ce=[!1])),j(ce.length,1),ce=[(Qe=F["$[]"]("target"),Qe===r||null==Qe?r:t(Qe,"eval",[oe.round_type]))],t(ve,"target_number=",e.to_a(ce)),ce[j(ce.length,1)])}).$$s=this,se.$$arity=1,se))},R.$$arity=4),e.def(n,"$next_token",I=function(){return this.lexer.$next_token()},I.$$arity=0),Ne=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,33,34,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,r,r,17,18,6,r,5,r,r,17,18,r,r,5,23,24,25,26,56,54,55,57],De=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,r,17,15,15,18,18,23,r,18,30,30,23,23,24,r,23,31,31,24,24,25,r,24,44,44,25,25,28,r,25,47,47,28,28,29,r,28,48,48,29,29,33,r,29,49,49,33,33,34,r,33,50,50,34,34,36,r,34,r,r,36,36,37,r,36,r,r,37,37,r,r,37,27,27,27,27,52,52,52,52],Ie=[-2,4,16,-3,-1,11,r,33,13,35,23,30,1,r,28,40,r,37,44,r,r,-2,r,51,58,65,0,106,72,79,47,54,r,86,93,r,100,107,r,r,r,r,r,r,63,r,r,68,75,82,89,r,120,r,r,r,r,r],Ce=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],Se=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,r,r,21,47,48,40,51,52,49,50,44,46,3,r,r,r,13,r,r,r,r,r,r,r,32],ke=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,r,r,4,8,8,5,7,7,8,8,9,5,6,r,r,r,6,r,r,r,r,r,r,r,6],Fe=[r,6,13,3,9,-1,27,-15,-10,-1,-38],Me=[r,r,r,r,r,r,19,16,15,r,r],Le=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],He=C(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),e.const_set(m[0],"Racc_arg",[Ne,De,Ce,Ie,Se,ke,Me,Fe,19,Le,He,58,35,!0]),e.const_set(m[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),e.const_set(m[0],"Racc_debug_parser",!1),e.def(n,"$_reduce_1",a=function(M,_e,G){var F;return i(this.modifier)||this.$raise($(m,"ParseError")),F=e.to_ary(M),this.$parsed(null==F[0]?r:F[0],null==F[1]?r:F[1],null==F[2]?r:F[2],null==F[3]?r:F[3])},a.$$arity=3),e.def(n,"$_reduce_2",T=function(M,_e,G){var F;return i(this.modifier)||this.$raise($(m,"ParseError")),F=e.to_ary(M),this.$parsed(null==F[0]?r:F[0],null==F[2]?r:F[2],null==F[1]?r:F[1],null==F[3]?r:F[3])},T.$$arity=3),e.def(n,"$_reduce_3",K=function(M,_e,G){var F,oe;return oe=null==(F=e.to_ary(M))[2]?r:F[2],this.$parsed(null==F[0]?r:F[0],null==F[1]?r:F[1],x(x($(m,"Arithmetic"),"Node"),"Number").$new(0),oe)},K.$$arity=3),e.def(n,"$_reduce_4",te=function(M,_e,G){var se,F=this;return i(i(se=F.prefix_number)?F.suffix_number:se)||F.$raise($(m,"ParseError")),N(["command","prefix","suffix"],{command:M["$[]"](1),prefix:M["$[]"](0),suffix:M["$[]"](2)})},te.$$arity=3),e.def(n,"$_reduce_5",$e=function(M,_e,G){var F=this;return i(F.prefix_number)||F.$raise($(m,"ParseError")),i(F.need_suffix_number)&&F.$raise($(m,"ParseError")),N(["command","prefix"],{command:M["$[]"](1),prefix:M["$[]"](0)})},$e.$$arity=3),e.def(n,"$_reduce_6",ye=function(M,_e,G){var F=this;return i(F.suffix_number)||F.$raise($(m,"ParseError")),i(F.need_prefix_number)&&F.$raise($(m,"ParseError")),N(["command","suffix"],{command:M["$[]"](0),suffix:M["$[]"](1)})},ye.$$arity=3),e.def(n,"$_reduce_7",ge=function(M,_e,G){var se,F=this;return i(i(se=F.need_prefix_number)?se:F.need_suffix_number)&&F.$raise($(m,"ParseError")),N(["command"],{command:M["$[]"](0)})},ge.$$arity=3),e.def(n,"$_reduce_8",Te=function(M,_e,G){return N([],{})},Te.$$arity=3),e.def(n,"$_reduce_9",Be=function(M,_e,G){var F,oe,Pe,we,pe=r;return pe=null==(F=e.to_ary(M))[0]?r:F[0],oe=null==F[2]?r:F[2],i(i(we=this.critical)?pe["$[]"]("critical")["$nil?"]():we)||this.$raise($(m,"ParseError")),t(pe,"[]=",e.to_a(Pe=["critical",oe])),j(Pe.length,1),pe},Be.$$arity=3),e.def(n,"$_reduce_10",ze=function(M,_e,G){var F,oe,Pe,we,pe=r;return pe=null==(F=e.to_ary(M))[0]?r:F[0],oe=null==F[2]?r:F[2],i(i(we=this.fumble)?pe["$[]"]("fumble")["$nil?"]():we)||this.$raise($(m,"ParseError")),t(pe,"[]=",e.to_a(Pe=["fumble",oe])),j(Pe.length,1),pe},ze.$$arity=3),e.def(n,"$_reduce_11",qe=function(M,_e,G){var F,oe,Pe,we,pe=r;return pe=null==(F=e.to_ary(M))[0]?r:F[0],oe=null==F[2]?r:F[2],i(i(we=this.dollar)?pe["$[]"]("dollar")["$nil?"]():we)||this.$raise($(m,"ParseError")),t(pe,"[]=",e.to_a(Pe=["dollar",oe])),j(Pe.length,1),pe},qe.$$arity=3),e.def(n,"$_reduce_12",Ae=function(M,_e,G){return M["$[]"](1)},Ae.$$arity=3),e.def(n,"$_reduce_13",fe=function(M,_e,G){return x(x($(m,"Arithmetic"),"Node"),"Negative").$new(M["$[]"](1))},fe.$$arity=3),e.def(n,"$_reduce_14",O=function(M,_e,G){return x(x($(m,"Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"+",M["$[]"](2))},O.$$arity=3),e.def(n,"$_reduce_15",J=function(M,_e,G){return x(x($(m,"Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"-",M["$[]"](2))},J.$$arity=3),e.def(n,"$_reduce_16",s=function(M,_e,G){return i(this.allowed_cmp_op["$include?"](r))||this.$raise($(m,"ParseError")),N([],{})},s.$$arity=3),e.def(n,"$_reduce_17",q=function(M,_e,G){var F,pe,ve;return ve=null==(F=e.to_ary(M))[1]?r:F[1],i(this.allowed_cmp_op["$include?"](pe=null==F[0]?r:F[0]))||this.$raise($(m,"ParseError")),N(["cmp_op","target"],{cmp_op:pe,target:ve})},q.$$arity=3),e.def(n,"$_reduce_18",P=function(M,_e,G){var se,F=this;return se=M["$[]"](0),i(F.question_target)||F.$raise($(m,"ParseError")),i(F.allowed_cmp_op["$include?"](se))||F.$raise($(m,"ParseError")),N(["cmp_op","target"],{cmp_op:se,target:"?"})},P.$$arity=3),e.def(n,"$_reduce_19",k=function(M,_e,G){return x(x($(m,"Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"+",M["$[]"](2))},k.$$arity=3),e.def(n,"$_reduce_20",Z=function(M,_e,G){return x(x($(m,"Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"-",M["$[]"](2))},Z.$$arity=3),e.def(n,"$_reduce_22",ee=function(M,_e,G){return x(x($(m,"Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"*",M["$[]"](2))},ee.$$arity=3),e.def(n,"$_reduce_23",ne=function(M,_e,G){return M["$[]"](3).$new(M["$[]"](0),M["$[]"](2))},ne.$$arity=3),e.def(n,"$_reduce_25",de=function(M,_e,G){return x(x($(m,"Arithmetic"),"Node"),"DivideWithGameSystemDefault")},de.$$arity=3),e.def(n,"$_reduce_26",re=function(M,_e,G){return x(x($(m,"Arithmetic"),"Node"),"DivideWithCeil")},re.$$arity=3),e.def(n,"$_reduce_27",ie=function(M,_e,G){return x(x($(m,"Arithmetic"),"Node"),"DivideWithCeil")},ie.$$arity=3),e.def(n,"$_reduce_28",me=function(M,_e,G){return x(x($(m,"Arithmetic"),"Node"),"DivideWithRound")},me.$$arity=3),e.def(n,"$_reduce_29",be=function(M,_e,G){return x(x($(m,"Arithmetic"),"Node"),"DivideWithFloor")},be.$$arity=3),e.def(n,"$_reduce_30",le=function(M,_e,G){return M["$[]"](1)},le.$$arity=3),e.def(n,"$_reduce_31",he=function(M,_e,G){return x(x($(m,"Arithmetic"),"Node"),"Negative").$new(M["$[]"](1))},he.$$arity=3),e.def(n,"$_reduce_33",ae=function(M,_e,G){return M["$[]"](1)},ae.$$arity=3),e.def(n,"$_reduce_34",xe=function(M,_e,G){return x(x($(m,"Arithmetic"),"Node"),"Number").$new(M["$[]"](0))},xe.$$arity=3),void e.def(n,"$_reduce_none",Ee=function(M,_e,G){return M["$[]"](0)},Ee.$$arity=3)},Opal.modules["bcdice/deprecated/checker"]=function(e){var B,A,H,Y,L,z,l,n,m,U,S,f,C,X=[],w=e.nil,x=e.$$,$=e.module,Q=e.send,u=e.truthy;return B=X,A=C=[$(X[0],"BCDice")].concat(B),H=f=[$(C[0],"Deprecated")].concat(A),U=$(f[0],"Checker"),S=[U].concat(H),U.$private(),e.def(U,"$check_result_legacy",Y=function(d,p,v,h){var b,g,y=this,E=w,W=w,_=w,o=w,R=w;return E=Q(p,"map",[],"sides".$to_proc()),b=(W=Q(p,"map",[],"value".$to_proc())).$sum(),_=[100]["$==="](o=E)?y.$check_1D100(d,b,v,h):[20]["$==="](o)?y.$check_1D20(d,b,v,h):[6,6]["$==="](o)?y.$check_2D6(d,b,W,v,h):w,u(u(g=_["$nil?"]())?g:_["$empty?"]())&&(o=E.$uniq(),_=[10]["$==="](o)?y.$check_nD10(d,b,W,v,h):[6]["$==="](o)?y.$check_nD6(d,b,W,v,h):w,u(u(R=_["$nil?"]())?R:_["$empty?"]()))?w:x(S,"Result").$new(_.$delete_prefix(" \uff1e "))},Y.$$arity=4),e.def(U,"$check_1D100",L=function(d,p,v,h){return w},L.$$arity=4),e.def(U,"$check_1D20",z=function(d,p,v,h){return w},z.$$arity=4),e.def(U,"$check_nD10",l=function(d,p,v,h,y){return w},l.$$arity=5),e.def(U,"$check_2D6",n=function(d,p,v,h,y){return w},n.$$arity=5),void e.def(U,"$check_nD6",m=function(d,p,v,h,y){return w},m.$$arity=5)},Opal.modules["bcdice/base"]=function(e){function j(D,H){return"number"==typeof D&&"number"==typeof H?D+H:D["$+"](H)}function X(D,H){return"number"==typeof D&&"number"==typeof H?D-H:D["$-"](H)}var H,z,m,c,d,p,v,h,y,E,W,b,_,o,g,R,I,a,T,K,te,$e,ye,ge,Te,Be,ze,qe,Ae,fe,O,J,P,k,Z,ee,ne,q,l,n,S,$=e.top,Q=[],u=e.nil,N=e.$$$,B=e.$$,t=e.module,C=e.klass,i=e.truthy,A=e.send,V=e.range,f=u;return $.$require("i18n"),$.$require("i18n/backend/fallbacks"),$.$require("bcdice/randomizer"),$.$require("bcdice/dice_table"),$.$require("bcdice/enum"),$.$require("bcdice/translate"),$.$require("bcdice/result"),$.$require("bcdice/command/parser"),$.$require("bcdice/deprecated/checker"),H=Q,z=S=[t(Q[0],"BCDice")].concat(H),l=C(S[0],null,"Base"),n=[l].concat(z),l.$$prototype.sort_add_dice=l.$$prototype.sort_barabara_dice=l.$$prototype.enabled_d9=l.$$prototype.raw_input=l.$$prototype.randomizer=l.$$prototype.enabled_upcase_input=l.$$prototype.debug=u,J=e.get_singleton_class(l),q=[J].concat(n),J.$attr_reader("prefixes"),e.def(J,"$register_prefix",P=function(re){var me,be=this,le=u;return null==be.prefixes&&(be.prefixes=u),me=e.slice.call(arguments,0,arguments.length),be.prefixes=i(le=be.prefixes)?le:[],be.prefixes.$concat(me.$flatten())},P.$$arity=-1),e.def(J,"$register_prefix_from_super_class",k=function(){return this.$register_prefix(this.$superclass().$prefixes())},k.$$arity=0),e.def(J,"$prefixes_pattern",Z=function(){var ie,re=this,me=u;return null==re.prefixes_pattern&&(re.prefixes_pattern=u),null==re.prefixes&&(re.prefixes=u),re.prefixes_pattern=i(ie=re.prefixes_pattern)?ie:u,i(re.prefixes_pattern)?re.prefixes_pattern:(re.prefixes=i(me=re.prefixes)?me:[],re.prefixes.$freeze(),re.prefixes_pattern=(i(re.prefixes["$empty?"]())?/(?!)/:e.regexp(["^(S)?(",re.prefixes.$join("|"),")"],"i")).$freeze())},Z.$$arity=0),e.def(J,"$command_pattern",ee=function(){var re,me,ie=this,be=u,le=u;return null==ie.command_pattern&&(ie.command_pattern=u),null==ie.prefixes&&(ie.prefixes=u),ie.command_pattern=i(me=ie.command_pattern)?me:u,i(ie.command_pattern)?ie.command_pattern:(ie.prefixes=i(be=ie.prefixes)?be:[],ie.prefixes.$freeze(),le=j(A(N(B(q,"CommonCommand"),"COMMANDS"),"map",[],((re=function(ae){return null==ae&&(ae=u),N(ae,"PREFIX_PATTERN").$source()}).$$s=ie,re.$$arity=1,re)),ie.prefixes),ie.command_pattern=e.regexp(["^S?(",le.$join("|"),")"],"i").$freeze())},ee.$$arity=0),e.def(J,"$eval",ne=function(re){return this.$new(re).$eval()},ne.$$arity=1),l.$include(B(n,"Translate")),l.$include(N(B(n,"Deprecated"),"Checker")),e.def(l,"$initialize",m=function(s){var q=this;return q.raw_input=s,q.sort_add_dice=!1,q.sort_barabara_dice=!1,q.d66_sort_type=N(B(n,"D66SortType"),"NO_SORT"),q.enabled_d9=!1,q.round_type=N(B(n,"RoundType"),"FLOOR"),q.sides_implicit_d=6,q.upper_dice_reroll_threshold=u,q.reroll_dice_reroll_threshold=u,q.default_cmp_op=u,q.default_target_number=u,q.enabled_upcase_input=!0,q.locale="ja_jp",q.randomizer=N(B(n,"BCDice"),"Randomizer").$new(),q.debug=!1},m.$$arity=1),l.$attr_accessor("randomizer"),l.$attr_reader("d66_sort_type"),l.$attr_reader("round_type"),l.$attr_reader("sides_implicit_d"),l.$attr_reader("upper_dice_reroll_threshold"),l.$attr_reader("reroll_dice_reroll_threshold"),l.$attr_reader("default_cmp_op"),l.$attr_reader("default_target_number"),e.def(l,"$sort_add_dice?",c=function(){return this.sort_add_dice},c.$$arity=0),e.def(l,"$sort_barabara_dice?",d=function(){return this.sort_barabara_dice},d.$$arity=0),e.def(l,"$enabled_d9?",p=function(){return this.enabled_d9},p.$$arity=0),e.def(l,"$enable_debug",v=function(){return this.debug=!0},v.$$arity=0),e.def(l,"$eval",h=function(){var q,P,k,s=this,Z=u;return q=N(B(n,"BCDice"),"Preprocessor").$process(s.raw_input,s),P=i(k=s.$dice_command(q))?k:s.$eval_common_command(s.raw_input),i(P)?(Z=[s.randomizer.$rand_results()],A(P,"rands=",e.to_a(Z)),X(Z.length,1),Z=[s.randomizer.$detailed_rand_results()],A(P,"detailed_rands=",e.to_a(Z)),X(Z.length,1),P):u},h.$$arity=0),e.def(l,"$change_text",y=function(s){return s},y.$$arity=1),e.def(l,"$check_result",E=function(s,q,P,k){var Z=this,ee=u,ne=u,de=u,re=u,ie=u;return ee=Z.$check_result_legacy(s,q,P,k),i(ee)?ee:(ne=A(q,"map",[],"sides".$to_proc()),re=(de=A(q,"map",[],"value".$to_proc())).$sum(),(ee=[100]["$==="](ie=ne)?Z.$result_1d100(s,re,P,k):[20]["$==="](ie)?Z.$result_1d20(s,re,P,k):[6,6]["$==="](ie)?Z.$result_2d6(s,re,de,P,k):u)["$=="](B(n,"Result").$nothing())?u:i(ee)?ee:(ie=ne.$uniq(),(ee=[10]["$==="](ie)?Z.$result_nd10(s,re,de,P,k):[6]["$==="](ie)?Z.$result_nd6(s,re,de,P,k):u)["$=="](B(n,"Result").$nothing())?u:i(ee)?ee:Z.$result_ndx(s,P,k)))},E.$$arity=4),e.def(l,"$grich_text",W=function(s,q,P){return u},W.$$arity=3),l.$private(),e.def(l,"$eval_common_command",b=function(s){try{var q;return s=this.$change_text(s),A(N(B(n,"CommonCommand"),"COMMANDS"),"each",[],((q=function(Z){var ne,ee=null==q.$$s?this:q.$$s;if(null==ee.randomizer&&(ee.randomizer=u),null==Z&&(Z=u),ne=Z.$eval(s,ee,ee.randomizer),!i(ne))return u;e.ret(ne)}).$$s=this,q.$$arity=1,q)),u}catch(k){if(k===e.returner)return k.$v;throw k}},b.$$arity=1),e.def(l,"$dice_command",_=function(s){var q,P=this,k=u,Z=u,ee=u,ne=u,de=u,re=u,ie=u;return i(P.enabled_upcase_input)&&(s=s.$upcase()),k=P.$class().$prefixes_pattern().$match(s),i(k)?(Z=k["$[]"](1)["$nil?"]()["$!"](),i(Z)&&(s=s["$[]"](V(1,-1,!1))),ee=P.$eval_game_system_specific_command(s),i(ee["$is_a?"](B(n,"Result")))?(ne=[i(de=ee["$secret?"]())?de:Z],A(ee,"secret=",e.to_a(ne)),X(ne.length,1),ee):i(i(re=i(ie=ee["$nil?"]())?ie:ee["$empty?"]())?re:ee["$=="]("1"))?u:A(B(n,"Result").$new(),"tap",[],((q=function(be){return null==be&&(be=u),ne=[ee.$to_s()],A(be,"text=",e.to_a(ne)),X(ne.length,1),A(be,"secret=",e.to_a(ne=[Z])),ne[X(ne.length,1)]}).$$s=P,q.$$arity=1,q))):u},_.$$arity=1),e.def(l,"$eval_game_system_specific_command",o=function(s){return u},o.$$arity=1),e.def(l,"$result_ndx",g=function(s,q,P){return i(P["$is_a?"](B(n,"String")))?u:i(s.$send(q,P))?B(n,"Result").$success(this.$translate("success")):B(n,"Result").$failure(this.$translate("failure"))},g.$$arity=3),e.def(l,"$result_1d100",R=function(s,q,P,k){return u},R.$$arity=4),e.def(l,"$result_1d20",I=function(s,q,P,k){return u},I.$$arity=4),e.def(l,"$result_nd10",a=function(s,q,P,k,Z){return u},a.$$arity=5),e.def(l,"$result_2d6",T=function(s,q,P,k,Z){return u},T.$$arity=5),e.def(l,"$result_nd6",K=function(s,q,P,k,Z){return u},K.$$arity=5),e.def(l,"$get_table_by_2d6",te=function(s){return this.$get_table_by_nD6(s,2)},te.$$arity=1),e.def(l,"$get_table_by_1d6",$e=function(s){return this.$get_table_by_nD6(s,1)},$e.$$arity=1),e.def(l,"$get_table_by_nD6",ye=function(s,q){return this.$get_table_by_nDx(s,q,6)},ye.$$arity=2),e.def(l,"$get_table_by_nDx",ge=function(s,q,P){var Z,ee=u;return Z=this.randomizer.$roll_sum(q,P),ee=this.$get_table_value(s["$[]"](X(Z,q))),i(ee["$nil?"]())?["1",0]:[ee,Z]},ge.$$arity=3),e.def(l,"$get_table_by_1d3",Te=function(s){var k,Z,D,q=this,ee=u;return q.$debug("get_table_by_1d3"),k=q.randomizer.$roll_sum(1,6),q.$debug("num",k),Z=(D=X(k,1),"number"==typeof D?D/2:D["$/"](2)).$to_i(),q.$debug("index",Z),ee=s["$[]"](Z),i(ee["$nil?"]())?["1",0]:[ee,k]},Te.$$arity=1),e.def(l,"$get_table_by_d66_swap",Be=function(s){var P;return P=this.randomizer.$roll_d66(N(B(n,"D66SortType"),"ASC")),[this.$get_table_by_number(P,s),P]},Be.$$arity=1),e.def(l,"$get_table_by_d66",ze=function(s){var P,k,Z,ne,D,ee=u;return P=this.randomizer.$roll_once(6),k=this.randomizer.$roll_once(6),Z=j("number"==typeof(D=X(P,1))?6*D:D["$*"](6),X(k,1)),ee=s["$[]"](Z),ne=""+P+k,i(ee["$nil?"]())?["1",ne]:[ee,ne]},ze.$$arity=1),e.def(l,"$get_table_by_number",qe=function(s,q,P){try{var k;return null==P&&(P="1"),A(q,"each",[],((k=function(ne){var re,de=null==k.$$s?this:k.$$s;if(null==ne&&(ne=u),re=ne["$[]"](0),!i(function(D,H){return"number"==typeof D&&"number"==typeof H?D>=H:D["$>="](H)}(re,s)))return u;e.ret(de.$get_table_value(ne["$[]"](1)))}).$$s=this,k.$$arity=1,k)),this.$get_table_value(P)}catch(ee){if(ee===e.returner)return ee.$v;throw ee}},qe.$$arity=-3),e.def(l,"$get_table_value",Ae=function(s){return i(s["$is_a?"](B(n,"Proc")))?s.$call():s},Ae.$$arity=1),e.def(l,"$roll_tables",fe=function(s,q){var k=u;return k=q["$[]"](s),i(k)?k.$roll(this.randomizer).$to_s():u},fe.$$arity=2),e.def(l,"$debug",O=function(s,q){var k,Z,ee=this,ne=u,de=u;return k=e.slice.call(arguments,1,arguments.length),i(ee.debug)?(ne=i(s["$is_a?"](B(n,"String")))?s:s.$inspect(),i(k["$empty?"]())?ee.$warn(ne):(de=A(k,"map",[],((Z=function(ie){return null==ie&&(ie=u),i(ie["$is_a?"](B(n,"String")))?'"'+ie+'"':ie.$inspect()}).$$s=ee,Z.$$arity=1,Z)),ee.$warn(ne+": "+de.$join(", ")))):u},O.$$arity=-2),N(N(B(Q,"I18n"),"Backend"),"Simple").$include(N(N(B(Q,"I18n"),"Backend"),"Fallbacks")),B(Q,"I18n").$load_path()["$<<"](B(Q,"Dir")["$[]"](B(Q,"File").$join($.$__dir__(),"../../i18n/**/*.yml"))),f=["ja_jp"],A(B(Q,"I18n"),"default_locale=",e.to_a(f)),X(f.length,1),f=[["ja_jp"]],A(B(Q,"I18n").$fallbacks(),"defaults=",e.to_a(f)),f[X(f.length,1)]},function(e){function j(f,D){return"number"==typeof f&&"number"==typeof D?f+D:f["$+"](D)}function w(f,D){return"number"==typeof f&&"number"==typeof D?f-D:f["$-"](D)}var D,Y,m,p,v,h,y,c,d,z,U,x=[],$=e.nil,Q=e.$$$,u=e.$$,N=e.module,B=e.klass,t=e.hash2,C=e.send2,i=e.truthy,A=e.range,V=e.send;e.top.$require("bcdice/base"),D=x,Y=U=[N(x[0],"BCDice")].concat(D),m=z=[N(U[0],"GameSystem")].concat(Y),c=B(z[0],u(z,"Base"),"DesperateRun"),d=[c].concat(m),c.$$prototype.randomizer=$,e.const_set(d[0],"ID","DesperateRun"),e.const_set(d[0],"NAME","Desperate Run TRPG"),e.const_set(d[0],"SORT_KEY","\u3066\u3059\u3078\u308c\u3044\u3068\u3089\u3093TRPG"),e.const_set(d[0],"HELP_MESSAGE","\u30fb\u96e3\u6613\u5ea6\u7b97\u51fa\u30b3\u30de\u30f3\u30c9\u3000DDC\n\u30fb\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\u3000RCx\u3000or\u3000RCx+y\u3000or\u3000RCx-y\uff08x\uff1d\u96e3\u6613\u5ea6\u3001y=\u4fee\u6b63\u5024\uff08\u7701\u7565\u53ef\u80fd\uff09\uff09\n\u30fb\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u8868\u3000ACT\n\u30fb\u521d\u671f\u30a2\u30a4\u30c6\u30e0\u8868\u3000ITEMT\n\u30fb\u52d5\u6a5f\u8868\u3000DOUKIT\n\u30fb\u6b7b\u4ea1\u30d5\u30e9\u30b0\u53f0\u8a5e\u8868\u3000FLAGT\n\u30fb\u9014\u4e2d\u53c2\u52a0\u52d5\u6a5f\u8868\u3000ENTRYT\n\u30fb\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868\u3000ROADT\n"),e.const_set(d[0],"TABLES",t(["ACT","ITEMT","DOUKIT","FLAGT","ENTRYT","ROADT"],{ACT:Q(u(d,"DiceTable"),"Table").$new("\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u8868","1D6",["PC\u5168\u54e1\u3001\u968a\u5217\u30921D6\u3067\u6c7a\u3081\u308b\uff0812\uff1a\u524d\u5217\u300134\uff1a\u4e2d\u5217\u300156\uff1a\u5f8c\u5217\uff09","1\u30bf\u30fc\u30f3\u3001\u30e2\u30f3\u30b9\u30bf\u30fc\u5074\u306e\u307f\u884c\u52d5\u3059\u308b\u3002","\u3053\u306e\u6226\u95d8\u306e\u884c\u52d5\u9806\u304c\u3001PC\u2192\u30e2\u30f3\u30b9\u30bf\u30fc\u3001\u304b\u3089\u3001\u30e2\u30f3\u30b9\u30bf\u30fc\u2192PC\u306b\u5909\u308f\u308b\u3002","PC\u5168\u54e1\u3001\u30a2\u30a4\u30c6\u30e01\u3064\u3092\u9078\u3093\u3067\u5931\u3046\u3002","PC\u5168\u54e11D6\u3092\u632f\u308b\u3002\u3053\u306e\u6226\u95d8\u4e2d\u3001\u305d\u306e\u51fa\u76ee\u306f\u30ce\u30fc\u30d7\u30e9\u30f3\u306b\u306a\u308b\u3002","PC\u5168\u54e1\u3001Flag\u304c1\u5897\u52a0\u3059\u308b\u3002"]),ITEMT:Q(u(d,"DiceTable"),"Table").$new("\u521d\u671f\u30a2\u30a4\u30c6\u30e0\u8868","2D6",["\u30ed\u30b1\u30c3\u30c8\u30e9\u30f3\u30c1\u30e3\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30de\u30ab\u30d6\u30ebLv+3\u3000\u56de\u6570\uff1a\u653b\u64831\u56de","\u30ad\u30fc\u30d4\u30c3\u30af\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30e0\u30fc\u30d6\u30b7\u30fc\u30f3\u3067\u4f7f\u7528\u53ef\u3002\u5224\u5b9a\u306e\u51fa\u76ee\u306e\u5408\u8a08+1\u3000\u56de\u6570\uff1a2\u56de","\u30ec\u30fc\u30c0\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30ce\u30fc\u30d7\u30e9\u30f3\u3000\u88c5\u5099\u6642\u3001\u300c\u5371\u967a\u300d\u30921\u6e1b\u3089\u3059\u3053\u3068\u304c\u51fa\u6765\u308b\u3000\u56de\u6570\uff1a\u5371\u967a\u6e1b\u5c112\u56de","\u98df\u6599\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30e0\u30fc\u30d6\u30b7\u30fc\u30f3\u3067\u4f7f\u7528\u53ef\u3002Life3\u56de\u5fa9\u3000\u56de\u6570\uff1a1\u56de","\u5fdc\u6025\u30ad\u30c3\u30c8\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30e1\u30c7\u30a3\u30ab\u30ebLv+1\u3000\u56de\u6570\uff1a\u56de\u5fa93\u56de","\u5203\u7269\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30a2\u30bf\u30c3\u30afLv+1\u3000\u56de\u6570\uff1a\u653b\u64836\u56de","\u9283\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30b7\u30e5\u30fc\u30c8Lv+1\u3000\u56de\u6570\uff1a\u653b\u64836\u56de","\u30c9\u30e9\u30c3\u30b0\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u3044\u3064\u3067\u3082\u4f7f\u7528\u53ef\u3002Brave1\u56de\u5fa9\u3000\u56de\u6570\uff1a1\u56de","\u91d1\u5238\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30a2\u30d5\u30bf\u30fc\u30d7\u30ec\u30a4\u3067\u4f7f\u7528\u53ef\u3002\u7d4c\u9a13\u70b9+2\u3000\u56de\u6570\uff1a1\u56de","\u30d7\u30ed\u30c6\u30af\u30bf\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30ac\u30fc\u30c9Lv+1\u3000\u56de\u6570\uff1a\u9632\u5fa15\u56de","\u30c8\u30df\u30fc\u30ac\u30f3\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30c1\u30a7\u30fc\u30f3Lv+5\u3000\u56de\u6570\uff1a\u653b\u64831\u56de"]),DOUKIT:Q(u(d,"DiceTable"),"Table").$new("\u52d5\u6a5f\u8868","1D6",["\u96b7\u5c5e\u3002\u4f55\u304b\u5f31\u307f\u306b\u4ed8\u3051\u8fbc\u307e\u308c\u3001\u5acc\u3005\u306a\u304c\u3089\u3082\u53c2\u52a0\u3059\u308b\u3053\u3068\u3068\u306a\u308b\u3002\u5f8c\u308d\u3081\u305f\u3044\u4e8b\u3001\u501f\u91d1\u3001\u306a\u3069\u3002","\u732e\u8eab\u3002\u3053\u306e\u756a\u7d44\u306f\u8ab0\u304b\u306e\u305f\u3081\u306b\u51fa\u3066\u3044\u308b\u3002\u75c5\u6c17\u306e\u5bb6\u65cf\u3092\u6551\u3046\u305f\u3081\u3001\u53c2\u52a0\u8005\u306e\u4e00\u4eba\u304c\u604b\u4eba\u3067\u3042\u308b\u3001\u306a\u3069\u3002","\u6210\u884c\u3002\u671b\u3093\u3067\u3044\u306a\u3044\u306e\u306b\u53c2\u52a0\u3059\u308b\u3053\u3068\u3068\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u3002\u8ab0\u304b\u304c\u52dd\u624b\u306b\u7533\u3057\u8fbc\u3093\u3060\u3001\u7d1b\u308c\u8fbc\u3093\u3067\u3057\u307e\u3063\u305f\u3001\u306a\u3069\u3002","\u6e07\u671b\u3002\u3068\u306b\u304b\u304f\u4f55\u304b\u3092\u6b32\u3057\u3066\u53c2\u52a0\u3057\u3066\u3044\u308b\u3002\u91d1\u3001\u30b9\u30ea\u30eb\u3001\u91d1\u3067\u624b\u306b\u5165\u308b\u3082\u306e\u3001\u306a\u3069\u3002","\u5947\u4eba\u3002\u597d\u304d\u597d\u3093\u3067\u3053\u306e\u756a\u7d44\u306b\u51fa\u3066\u3044\u308b\u3002\u6bba\u4eba\u7656\u3001\u30ca\u30eb\u30b7\u30b9\u30c8\u3001\u81ea\u6bba\u9858\u671b\u3001\u5316\u3051\u7269\u30de\u30cb\u30a2\u3001\u306a\u3069\u3002","\u4ed5\u4e8b\u3002\u3053\u306e\u756a\u7d44\u306b\u51fa\u308b\u306e\u306f\u4ed5\u4e8b\u3060\u304b\u3089\u3060\u3002\u8cde\u91d1\u7a3c\u304e\u3001\u82b8\u80fd\u4eba\u3001\u8a18\u8005\u3001\u756a\u7d44\u30b9\u30bf\u30c3\u30d5\u3001\u306a\u3069\u3002"]),FLAGT:Q(u(d,"DiceTable"),"Table").$new("\u6b7b\u4ea1\u30d5\u30e9\u30b0\u53f0\u8a5e\u8868","1D6",["\u5e0c\u671b\u3002\u300c\u3053\u308c\u304c\u7d42\u308f\u3063\u305f\u3089\u3001\u4e00\u7dd2\u306b\u9152\u3067\u3082\u98f2\u3082\u3046\u3084\u300d\u300c\u3082\u3046\u4f55\u3082\u6016\u304f\u306a\u3044\u300d\u306a\u3069\u3002","\u671b\u90f7\u3002\u300c\u304f\u305d\u3063\u3001\u3001\u3001\u4ffa\u306b\u306f\u3001\u5e30\u308a\u3092\u5f85\u3064\u4eba\u304c\u3001\u3001\u3001\u3063\uff01\u300d\u300c\u3042\u3042\u3001\u6545\u90f7\u306e\u30de\u30eb\u30b2\u30ea\u30fc\u30bf\u3092\u3082\u3046\u4e00\u5ea6\u98df\u3079\u305f\u304b\u3063\u305f\u3001\u3001\u3001\u300d\u306a\u3069\u3002","\u72c2\u4e71\u3002\u300c\u304a\u524d\u3092\u3001\u6bba\u305b\u3070\u3001\u4ffa\u306f\u3001\u5104\u4e07\u9577\u8005\u306a\u3093\u3060\u3088\u3049\u3049\u3049\u304a\uff01\uff01\u300d\u300c\u30d2\u30cf\u30c3\u3001\u6b7b\u306d\u6b7b\u306d\u6b7b\u306d\u6b7b\u306d\u3047\u3047\u3047\u3047\u300d\u306a\u3069\u3002","\u7d76\u671b\u3002\u300c\u3082\u3046\u3060\u3081\u3060\u3041\u3001\u3001\u3001\u304a\u3057\u307e\u3044\u3060\u3041\u3001\u3001\u3001\u300d\u300c\u304f\u3001\u304f\u308b\u306a\u3063\u3001\u304f\u308b\u306a\u3041\u3041\u3041\u3041\uff01\uff01\u300d\u306a\u3069\u3002","\u6162\u5fc3\u3002\u300c\u306a\u3093\u3060\u3001\u3053\u3093\u306a\u3084\u3064\u3001\u4ffa\u3060\u3051\u3067\u5341\u5206\u3060\u300d\u300c\u5927\u4e08\u592b\u3060\u3001\u554f\u984c\u306a\u3044\u300d\u306a\u3069\u3002","\u72a0\u7272\u3002\u300c\u3075\u3075\u3001\u4ffa\u306a\u3089\u5927\u4e08\u592b\u3060\u3001\u3001\u3001\u6c17\u306b\u3059\u308b\u306a\u300d\u300c\u304a\u524d\u3089\u4e0b\u304c\u308c\u3063\uff01\u3053\u3053\u306f\u4ffa\u306b\u4efb\u305b\u308d\uff01\u300d\u306a\u3069\u3002"]),ENTRYT:Q(u(d,"DiceTable"),"Table").$new("\u9014\u4e2d\u53c2\u52a0\u52d5\u6a5f\u8868","1D6",["\u9045\u523b\u3002\u3082\u3068\u3082\u3068\u53c2\u52a0\u3059\u308b\u4e88\u5b9a\u3060\u3063\u305f\u306e\u3060\u304c\u9045\u308c\u3066\u3057\u307e\u3063\u305f\u3002\u4eca\u304b\u3089\u3067\u3082\u8d70\u308c\u3068\u7121\u7406\u77e2\u7406\u53c2\u52a0\u3002","\u73fe\u4f4f\u3002\u3082\u3068\u3082\u3068\u3053\u3053\u306b\u4f4f\u3093\u3067\u3044\u305f\u3002\u4f55\uff1f\u756a\u7d44\uff1f\u3048\uff1f\u3042\u3001\u304a\u91d1\u3082\u3089\u3048\u3093\u306e\uff1f\u30a4\u30a4\u30cd\uff01","\u7a81\u767a\u3002\u3082\u3068\u3082\u3068\u8996\u8074\u8005\u3068\u3057\u3066\u30b9\u30bf\u30b8\u30aa\u306b\u5c45\u305f\u3093\u3060\u3051\u3069\u3001\u53f8\u4f1a\u306b\u3046\u307e\u304f\u4e57\u305b\u3089\u308c\u3066\u30fb\u30fb\u30fb","\u4e71\u5165\u3002\u4f55\u304b\u76ee\u7684\u304c\u3042\u3063\u3066\u4e71\u5165\u3057\u305f\u3002\u4eca\u56de\u306e\u30b9\u30c6\u30fc\u30b8\u304c\u7c21\u5358\u306b\u898b\u3048\u305f\u308a\u3001\u53c2\u52a0\u8005\u306b\u5927\u4e8b\u306a\u4eba\u304c\u3044\u305f\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002","\u795e\u96a0\u3002\u4eca\u56de\u3088\u308a\u524d\u306e\u756a\u7d44\u306b\u53c2\u52a0\u3057\u3066\u3044\u305f\u304c\u884c\u65b9\u4e0d\u660e\u30fb\u6b7b\u3093\u3060\u3068\u601d\u308f\u308c\u3066\u3044\u305f\u3002\u304c\u3002\u541b\u306f\u307e\u3060\u3053\u3053\u306b\u3044\u308b\u3002","\u8077\u54e1\u3002\u3042\u308c\u3001\u9003\u3052\u9045\u308c\u307e\u3057\u305f\uff1f\u3042\u3089\u3042\u3089\u3001\u5927\u5909\u3067\u3059\u306d\u3001\u3057\u3087\u3046\u304c\u306a\u3044\u304b\u3089\u53c2\u52a0\u8005\u3055\u3093\u3068\u4e00\u7dd2\u306b\u8d70\u3063\u3066\u304f\u3060\u3055\u3044\u3002"]),ROADT:Q(u(d,"DiceTable"),"Table").$new("\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868","1D6",["\u6b7b\u7dda\u3002\u6b7b\u306c\u304b\u3068\u601d\u3063\u305f\u3002Flag+1","\u602a\u6211\u3002\u75db\u3044\u3002Life-1","\u5931\u610f\u3002\u3069\u3046\u3057\u3066\u3053\u3046\u306a\u3063\u305f\u3002Brave-1\u3002\u6e1b\u3089\u305b\u306a\u3044\u5834\u5408\u3001Flag+1","\u7d1b\u5931\u3002\u3069\u3063\u304b\u3044\u3063\u305f\u3002Item\u3092\u3069\u308c\u304b1\u3064\u6368\u3066\u308b\u3002\u6368\u3066\u308c\u306a\u3044\u5834\u5408\u3001Flag+1","\u8ffd\u5c3e\u3002\u5f8c\u308d\uff01\u5f8c\u308d\u30fc\u3063\uff01\u53c2\u52a0\u958b\u59cb\u90e8\u5c4b\u306e\u5371\u967a+1","\u8ff7\u5b50\u3002\u3042\u308c\u3001\u3053\u3053\u3069\u3053\u3060\uff1f\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868\u3092\u632f\u308b\u56de\u6570+2"])}).$freeze()),c.$register_prefix("RC","DDC",u(d,"TABLES").$keys()),e.def(c,"$initialize",p=function(W){var o=this;return p.$$p&&(p.$$p=null),C(o,e.find_super_dispatcher(o,"initialize",p,!1,!0),"initialize",[W],null),o.sort_add_dice=!0,o.d66_sort_type=Q(u(d,"D66SortType"),"ASC")},p.$$arity=1),c.$private(),e.def(c,"$eval_game_system_specific_command",v=function(W){var _,o,b=this;return i(_=i(o=b.$check_roll(W))?o:b.$ddc_table(W))?_:b.$roll_tables(W,Q(b.$class(),"TABLES"))},v.$$arity=1),e.def(c,"$check_roll",h=function(W){var b,_,R=$,I=$,a=$,T=$,K=$,te=$,$e=$,ye=$,Te=$;return R=Q(u(d,"Command"),"Parser").$new(/RC\d+/,t(["round_type"],{round_type:this.$round_type()})).$restrict_cmp_op_to($).$parse(W),i(R)?(_=this.randomizer.$roll_barabara(2,6),T=j(I=null==(b=e.to_ary(_))[0]?$:b[0],a=null==b[1]?$:b[1]),K=j(j(I,a),R.$modify_number()),te=R.$command()["$[]"](A(2,-1,!1)).$to_i(),i(R.$modify_number()["$!="](0))&&($e="\u3000\u4fee\u6b63\u5024\uff1a"+R.$modify_number()),ye=I["$=="](a)?u(d,"Result").$critical("\u30be\u30ed\u76ee\uff01\u3010Critical\u3011"):T["$=="](7)?u(d,"Result").$fumble("\u30c0\u30a4\u30b9\u306e\u51fa\u76ee\u304c\u8868\u88cf\uff01\u3010Fumble\u3011"):i(function(f,D){return"number"==typeof f&&"number"==typeof D?f>=D:f["$>="](D)}(K,te))?u(d,"Result").$success(K+"\u3001\u96e3\u6613\u5ea6\u4ee5\u4e0a\uff01\u3010Success\u3011"):u(d,"Result").$failure(K+"\u3001\u96e3\u6613\u5ea6\u672a\u6e80\uff01\u3010Miss\u3011"),Te=[["\u5224\u5b9a\u3000\u96e3\u6613\u5ea6\uff1a"+te+$e,"\u51fa\u76ee\uff1a"+I+"\u3001"+a,ye.$text()].$join(" \uff1e ")],V(ye,"text=",e.to_a(Te)),w(Te.length,1),ye):$},h.$$arity=1),e.def(c,"$ddc_table",y=function(W){var b,_,g=$,R=$,I=$,a=$,T=$;return i(W["$!="]("DDC"))?$:(_=this.randomizer.$roll_barabara(2,6),_=[g=null==(b=e.to_ary(_))[0]?$:b[0],R=null==b[1]?$:b[1]].$sort(),"\u96e3\u6613\u5ea6\u6c7a\u5b9a \uff1e \u51fa\u76ee\uff1a"+g+"\u3001"+R+" \uff1e "+(a=null==(b=e.to_ary(_))[1]?$:b[1])+"-"+(I=null==b[0]?$:b[0])+"="+(T=w(a,I))+" \uff1e \u96e3\u6613\u5ea6"+j(5,T))},y.$$arity=1)}(Opal)}}]);