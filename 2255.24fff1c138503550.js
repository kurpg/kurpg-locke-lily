(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[2255],{2255:(de,me,fe)=>{fe(9993),Opal.modules["i18n/backend/fallbacks"]=function(r){var U,_,B,N,C,o,M=[],t=r.nil,v=r.$$$,e=r.module,g=r.class_variable_set,E=r.truthy,A=r.class_variable_get,c=r.def,z=r.send,Y=r.to_a,S=r.rb_minus,P=r.send2,H=r.find_super,F=r.hash2,L=r.find_block_super,j=r.neqeq;return U=M,o=[C=e(M[0],"I18n")].concat(U),g(o[0],"@@fallbacks",t),_=r.get_singleton_class(C),B=[_].concat(o),N=r.$r(B),c(_,"$fallbacks",function(){var p=t;return g(B[1],"@@fallbacks",E(null!=B[1].$$cvars["@@fallbacks"]?"class variable":t)&&E(p=A(B[1],"@@fallbacks",!1))?p:v(v(N("I18n"),"Locale"),"Fallbacks").$new()),E(p=N("Thread").$current()["$[]"]("i18n_fallbacks"))?p:A(B[1],"@@fallbacks",!1)},0),c(_,"$fallbacks=",function(d){var p;return g(B[1],"@@fallbacks",E(d["$is_a?"](N("Array")))?v(v(N("I18n"),"Locale"),"Fallbacks").$new(d):d),p=["i18n_fallbacks",A(B[1],"@@fallbacks",!1)],z(N("Thread").$current(),"[]=",Y(p)),p[S(p.length,1)]},1),function(_,q){var d,p,y,f,N=[e(_,"Backend")].concat(q);return d=N,y=[p=e(N[0],"Fallbacks")].concat(d),f=r.$r(y),c(p,"$translate",function l($,a,i){try{var n=l.$$p||t,u=this,m=t,x=t;return delete l.$$p,null==i&&(i=f("EMPTY_HASH")),E(i.$fetch("fallback",!0))?E(i["$[]"]("fallback_in_progress"))?P(u,H(u,"translate",l,!1,!0),"translate",[$,a,i],n):(E(i["$[]"]("default"))&&(m=u["$extract_non_symbol_default!"](i)),x=i.$merge(F(["fallback_in_progress"],{fallback_in_progress:!0})),z(f("I18n").$fallbacks()["$[]"]($),"each",[],function h(k){var I=null==h.$$s?this:h.$$s;null==k&&(k=t);try{return z(I,"catch",["exception"],function G(){var s=null==G.$$s?this:G.$$s,Z=t;if(Z=P(s,L(s,"translate",G.$$def||h.$$def||l,!1,!1),"translate",[k,a,x],null),E(Z["$nil?"]()))return t;j($.$to_s(),k.$to_s())&&s.$on_fallback($,k,a,i),r.ret(Z)},{$$arity:0,$$s:I})}catch(G){if(!r.rescue(G,[v(f("I18n"),"InvalidLocale")]))throw G;try{return t}finally{r.pop_exception()}}},{$$arity:1,$$s:u}),E(i["$key?"]("default"))&&E(i["$[]"]("default")["$nil?"]())?t:E(m)?P(u,H(u,"translate",l,!1,!0),"translate",[$,t,i.$merge(F(["default"],{default:m}))],null):u.$throw("exception",v(f("I18n"),"MissingTranslation").$new($,a,i))):P(u,H(u,"translate",l,!1,!0),"translate",[$,a,i],n)}catch(h){if(h===r.returner)return h.$v;throw h}},-3),c(p,"$extract_non_symbol_default!",function($){var i,a=t,n=t;return a=[$["$[]"]("default")].$flatten(),i=z(a,"detect",[],function(m){return null==m&&(m=t),m["$is_a?"](f("Symbol"))["$!"]()},1),E(i)&&(n=["default",a["$[]"](0,a.$index(i))],z($,"[]=",Y(n)),S(n.length,1)),i},1),c(p,"$exists?",function l($,a,i){try{var n=l.$$p||t,u=this;return delete l.$$p,null==i&&(i=f("EMPTY_HASH")),E(i.$fetch("fallback",!0))?(z(f("I18n").$fallbacks()["$[]"]($),"each",[],function m(x){var h=null==m.$$s?this:m.$$s;null==x&&(x=t);try{if(!E(P(h,L(h,"exists?",m.$$def||l,!1,!1),"exists?",[x,a],null)))return t;r.ret(!0)}catch(k){if(!r.rescue(k,[v(f("I18n"),"InvalidLocale")]))throw k;try{return t}finally{r.pop_exception()}}},{$$arity:1,$$s:u}),!1):P(u,H(u,"exists?",l,!1,!0),"exists?",[$,a,i],n)}catch(m){if(m===r.returner)return m.$v;throw m}},-3),p.$private(),c(p,"$on_fallback",function($,a,i,n){return t},4)}(o[0],o)},Opal.modules["bcdice/randomizer"]=function(r){var C,b,d,p,y,f,_,q,M=[],t=r.nil,v=r.$$$,g=r.klass,E=r.const_set,A=r.def,c=r.truthy,z=r.rb_gt,Y=r.rb_plus,S=r.rb_le,P=r.send,H=r.rb_minus,F=r.eqeq,L=r.rb_times,j=r.eqeqeq,Q=r.rb_ge;return C=M,_=[(0,r.module)(M[0],"BCDice")].concat(C),q=r.$r(_),b=_,p=[d=g(_[0],null,"Randomizer")].concat(b),y=r.$r(p),(f=d.$$prototype).rand_results=f.detailed_rand_results=t,E(p[0],"UPPER_LIMIT_DICE_TIMES",200),E(p[0],"UPPER_LIMIT_DICE_SIDES",1e4),E(p[0],"UPPER_LIMIT_RANDS",1e4),A(d,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]},0),d.$attr_reader("rand_results"),d.$attr_reader("detailed_rand_results"),E(p[0],"DetailedRandResult",y("Struct").$new("kind","sides","value")),A(d,"$roll_barabara",function($,a){var i=this;return c(z(Y(i.rand_results.$size(),$),y("UPPER_LIMIT_RANDS")))&&i.$raise(y("TooManyRandsError")),c(S($,0))||c(z($,y("UPPER_LIMIT_DICE_TIMES")))?[]:P(y("Array"),"new",[$],function n(){return(null==n.$$s?this:n.$$s).$roll_once(a)},{$$arity:0,$$s:i})},2),A(d,"$roll_sum",function($,a){return this.$roll_barabara($,a).$sum()},2),A(d,"$roll_once",function($){var i=t;return c(S($,0))||c(z($,y("UPPER_LIMIT_DICE_SIDES")))?0:(i=this.$rand_inner($),this.$push_to_detail("normal",$,i),i)},1),A(d,"$roll_index",function($){return H(this.$roll_once($),1)},1),A(d,"$roll_tens_d10",function(){var i,a=t;return a=this.$rand_inner(10),F(a,10)&&(a=0),i=L(a,10),this.$push_to_detail("tens_d10",10,i),i},0),A(d,"$roll_d9",function(){var a;return a=H(this.$rand_inner(10),1),this.$push_to_detail("d9",10,a),a},0),A(d,"$roll_d66",function($){var n,i=t;return i=P(y("Array"),"new",[2],function u(){return(null==u.$$s?this:u.$$s).$roll_once(6)},{$$arity:0,$$s:this}),j(v(y("D66SortType"),"ASC"),n=$)?i["$sort!"]():j(v(y("D66SortType"),"DESC"),n)&&i["$sort!"]()["$reverse!"](),Y(L(i["$[]"](0),10),i["$[]"](1))},1),d.$private(),A(d,"$rand_inner",function($){var i,a=this;return c(Q(a.rand_results.$size(),y("UPPER_LIMIT_RANDS")))&&a.$raise(y("TooManyRandsError")),i=a.$random($),a.rand_results["$<<"]([i,$]),i},1),A(d,"$random",function($){return Y(y("Kernel").$rand($),1)},1),A(d,"$push_to_detail",function($,a,i){var u;return u=y("DetailedRandResult").$new($,a,i),this.detailed_rand_results.$push(u)},3),g(_[0],q("StandardError"),"TooManyRandsError"),t},Opal.modules["bcdice/dice_table/roll_result"]=function(r){var c,P,Q,U,C,o,_,F,Y,M=[],t=r.nil,v=r.module,e=r.klass,g=r.def,E=r.truthy;return c=M,P=Y=[v(M[0],"BCDice")].concat(c),Q=F=[v(Y[0],"DiceTable")].concat(P),C=[U=e(F[0],null,"RollResult")].concat(Q),o=r.$r(C),(_=U.$$prototype).table_name=_.value=_.body=t,g(U,"$initialize",function(B,N,b){var d=this;return d.table_name=B,d.value=N,d.body=b},3),U.$attr_reader("table_name"),U.$attr_reader("value"),U.$attr_reader("body"),g(U,"$to_s",function(){var B=this;return B.table_name+"("+B.value+") \uff1e "+B.body},0),g(U,"$last_body",function(){var B=this;return E(B.body["$is_a?"](o("RollResult")))?B.body.$last_body():B.body},0),g(U,"$empty?",function(){return!1},0)},Opal.modules["bcdice/dice_table/chain_table"]=function(r){var z,H,U,C,o,_,q,L,S,M=[],t=r.nil,v=r.module,e=r.klass,g=r.truthy,E=r.def,A=r.rb_minus;return z=M,H=S=[v(M[0],"BCDice")].concat(z),U=L=[v(S[0],"DiceTable")].concat(H),o=[C=e(L[0],null,"ChainTable")].concat(U),_=r.$r(o),(q=C.$$prototype).times=q.sides=q.items=q.name=t,E(C,"$initialize",function(N,b,d){var p=this,y=t;return p.name=N,p.items=d.$freeze(),y=/(\d+)D(\d+)/i.$match(b),g(y)||p.$raise(_("ArgumentError"),"Unexpected table type: "+b),p.times=y["$[]"](1).$to_i(),p.sides=y["$[]"](2).$to_i()},3),E(C,"$roll",function(N){var d,p,b=this,y=t;return d=N.$roll_sum(b.times,b.sides),p=A(d,b.times),y=b.items["$[]"](p),g(y["$respond_to?"]("roll"))&&(y=y.$roll(N)),_("RollResult").$new(b.name,d,y)},1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(r){var P,j,_,q,B,N,b,U,F,M=[],t=r.nil,v=r.module,e=r.klass,g=r.hash2,E=r.defs,A=r.def,c=r.rb_plus,z=r.rb_times,Y=r.rb_minus;return P=M,j=F=[v(M[0],"BCDice")].concat(P),_=U=[v(F[0],"DiceTable")].concat(j),B=[q=e(U[0],null,"D66GridTable")].concat(_),N=r.$r(B),(b=q.$$prototype).name=b.items=t,E(q,"$from_i18n",function(p,y){var l=t;return l=N("I18n").$t(p,g(["locale","raise"],{locale:y,raise:!0})),this.$new(l["$[]"]("name"),l["$[]"]("items"))},2),A(q,"$initialize",function(p,y){return this.name=p,this.items=y.$freeze()},2),A(q,"$roll",function(p){var f,l,$,a,i;return f=p.$roll_once(6),l=p.$roll_once(6),$=c(z(f,10),l),a=Y(f,1),i=Y(l,1),N("RollResult").$new(this.name,$,this.items["$[]"](a)["$[]"](i))},1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(r){var Y,F,o,_,q,B,j,Q,P,t=[],v=r.nil,e=r.module,g=r.klass,E=r.hash2,A=r.defs,c=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),Y=t,F=P=[e(t[0],"BCDice")].concat(Y),j=[e(P[0],"DiceTable")].concat(F),Q=r.$r(j),o=j,q=[_=g(j[0],Q("D66GridTable"),"D66HalfGridTable")].concat(o),B=r.$r(q),A(_,"$from_i18n",function(b,d){var y=v;return y=B("I18n").$t(b,E(["locale","raise"],{locale:d,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items_1_2_3"),y["$[]"]("items_4_5_6"))},2),c(_,"$initialize",function(b,d,p){return this.name=b,this.items=[d,d,d,p,p,p].$freeze()},3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(r){var Y,F,o,_,q,B,j,Q,P,t=[],v=r.nil,e=r.module,g=r.klass,E=r.hash2,A=r.defs,c=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),Y=t,F=P=[e(t[0],"BCDice")].concat(Y),j=[e(P[0],"DiceTable")].concat(F),Q=r.$r(j),o=j,q=[_=g(j[0],Q("D66GridTable"),"D66OneThirdTable")].concat(o),B=r.$r(q),A(_,"$from_i18n",function(b,d){var y=v;return y=B("I18n").$t(b,E(["locale","raise"],{locale:d,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items_1_2"),y["$[]"]("items_3_4"),y["$[]"]("items_5_6"))},2),c(_,"$initialize",function(b,d,p,y){return this.name=b,this.items=[d,d,p,p,y,y].$freeze()},4)},Opal.modules["bcdice/dice_table/d66_table"]=function(r){var F,U,B,N,b,d,p,o,j,M=[],t=r.nil,v=r.$$$,e=r.module,g=r.klass,E=r.hash2,A=r.defs,c=r.def,z=r.eqeqeq,Y=r.rb_plus,S=r.rb_times,P=r.truthy;return F=M,U=j=[e(M[0],"BCDice")].concat(F),B=o=[e(j[0],"DiceTable")].concat(U),b=[N=g(o[0],null,"D66Table")].concat(B),d=r.$r(b),(p=N.$$prototype).sort_type=p.items=p.name=t,A(N,"$from_i18n",function(f,l){var i,a=t;return a=d("I18n").$t(f,E(["locale"],{locale:l})),i=d("D66SortType").$const_get(a["$[]"]("d66_sort_type")),this.$new(a["$[]"]("name"),i,a["$[]"]("items"))},2),c(N,"$initialize",function(f,l,$){var a=this;return a.name=f,a.sort_type=l,a.items=$.$freeze()},3),c(N,"$roll",function(f){var l=this,$=t,a=t,i=t,n=t;return $=f.$roll_barabara(2,6),z(v(d("D66SortType"),"ASC"),a=l.sort_type)?$["$sort!"]():z(v(d("D66SortType"),"DESC"),a)&&$["$sort!"]()["$reverse!"](),i=Y(S($["$[]"](0),10),$["$[]"](1)),n=P(a=l.items["$[]"](i))?a:l.items["$[]"](i.$to_s()),P(n["$respond_to?"]("roll"))&&(n=n.$roll(f)),d("RollResult").$new(l.name,i,n)},1),c(N,"$choice",function(f){return d("RollResult").$new(this.name,f,this.items["$[]"](f))},1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(r){var Q,_,B,N,C,t=[],v=r.nil,e=r.module,g=r.klass,E=r.hash2,A=r.send,c=r.to_ary,z=r.rb_plus,Y=r.rb_times,S=r.to_a,P=r.rb_minus,H=r.send2,F=r.find_super,L=r.def;return r.top.$require("bcdice/dice_table/d66_table"),Q=t,_=C=[e(t[0],"BCDice")].concat(Q),B=[e(C[0],"DiceTable")].concat(_),N=r.$r(B),L(g(B[0],N("D66Table"),"D66LeftRangeTable"),"$initialize",function y(f,l,$){var n;return delete y.$$p,n=E([],{}),A($,"each",[],function(m){var x,I;return null==m&&(m=v),x=c(m),I=null==x[1]?v:x[1],A(null==x[0]?v:x[0],"each",[],function(s){return null==s&&(s=v),A(I,"each_with_index",[],function(w,O){var ie,ne;return null==w&&(w=v),null==O&&(O=v),ie=z(Y(s,10),z(O,1)),A(n,"[]=",S(ne=[ie,w])),ne[P(ne.length,1)]},2)},1)},1),H(this,F(this,"initialize",y,!1,!0),"initialize",[f,l,n],null)},3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(r){var H,Q,q,B,N,b,d,C,L,M=[],t=r.nil,v=r.module,e=r.klass,g=r.hash2,E=r.defs,A=r.def,c=r.truthy,z=r.rb_minus,Y=r.rb_plus,S=r.rb_times;return H=M,Q=L=[v(M[0],"BCDice")].concat(H),q=C=[v(L[0],"DiceTable")].concat(Q),N=[B=e(C[0],null,"D66ParityTable")].concat(q),b=r.$r(N),(d=B.$$prototype).odd=d.even=d.name=t,E(B,"$from_i18n",function(y,f){var $=t;return $=b("I18n").$t(y,g(["locale","raise"],{locale:f,raise:!0})),this.$new($["$[]"]("name"),$["$[]"]("odd"),$["$[]"]("even"))},2),A(B,"$initialize",function(y,f,l){var $=this;return $.name=y,$.odd=f.$freeze(),$.even=l.$freeze()},3),A(B,"$roll",function(y){var $,i,n,f=this,l=t;return l=y.$roll_once(6),$=y.$roll_once(6),i=(c(l["$odd?"]())?f.odd:f.even)["$[]"](z($,1)),n=Y(S(l,10),$),b("RollResult").$new(f.name,n,i)},1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(r){var Y,F,C,o,_,q,B,j,P,M=[],t=r.nil,v=r.module,e=r.klass,g=r.def,E=r.rb_plus,A=r.rb_times,c=r.send;return Y=M,F=P=[v(M[0],"BCDice")].concat(Y),C=j=[v(P[0],"DiceTable")].concat(F),_=[o=e(j[0],null,"D66RangeTable")].concat(C),q=r.$r(_),(B=o.$$prototype).items=B.name=t,g(o,"$initialize",function(b,d){return this.name=b,this.items=d.$freeze()},2),g(o,"$roll",function(b){var p,y,f,l=t;return p=b.$roll_once(6),y=b.$roll_once(6),f=E(A(p,10),y),l=c(this.items,"find",[],function(a){return null==a&&(a=t),a["$[]"](0)["$include?"](f)},1),q("RollResult").$new(this.name,f,l["$[]"](1))},1)},Opal.modules["bcdice/dice_table/range_table"]=function(r){var L,C,N,b,d,p,y,_,Q,M=[],t=r.nil,v=r.module,e=r.klass,g=r.const_set,E=r.send,A=r.truthy,c=r.def,z=r.to_a,Y=r.rb_minus,S=r.eqeqeq,P=r.rb_times,H=r.rb_plus;return L=M,C=Q=[v(M[0],"BCDice")].concat(L),N=_=[v(Q[0],"DiceTable")].concat(C),d=[b=e(_[0],null,"RangeTable")].concat(N),p=r.$r(d),(y=b.$$prototype).name=y.items=y.num_of_dice=y.num_of_sides=y.formatter=t,g(d[0],"RollResult",E(p("Struct"),"new",["sum","values","content","formatted"],function f(){return(null==f.$$s?this:f.$$s).$alias_method("to_s","formatted")},{$$arity:0,$$s:b})),g(d[0],"Item",p("Struct").$new("range","content")),g(d[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),g(d[0],"DEFAULT_FORMATTER",E(b,"lambda",[],function(l,$){return null==l&&(l=t),null==$&&($=t),l.$name()+"("+$.$sum()+") \uff1e "+$.$content()},2)),b.$attr_reader("name"),b.$attr_reader("num_of_dice"),b.$attr_reader("num_of_sides"),c(b,"$initialize",function f(l,$,a){var u,i=f.$$p||t,n=this,m=t;return delete f.$$p,n.name=l.$freeze(),n.formatter=A(u=i)?u:p("DEFAULT_FORMATTER"),m=p("DICE_ROLL_METHOD_RE").$match($),A(m)||n.$raise(p("ArgumentError"),n.name+": invalid dice roll method: "+$),n.num_of_dice=m["$[]"](1).$to_i(),n.num_of_sides=m["$[]"](2).$to_i(),n.$store(a)},3),c(b,"$fetch",function(l){var a,$=this;return a=E($.items,"find",[],function(n){return null==n&&(n=t),n.$range()["$include?"](l)},1),A(a)||$.$raise(p("RangeError"),$.name+": value is out of range: "+l),a},1),c(b,"$roll",function(l){var i,n,u,$=this,a=t;return i=(a=l.$roll_barabara($.num_of_dice,$.num_of_sides)).$sum(),n=p("RollResult").$new(i,a,$.$fetch(i).$content()),u=[$.formatter["$[]"]($,n)],E(n,"formatted=",z(u)),Y(u.length,1),n},1),b.$private(),c(b,"$store",function(l){var a,i,$=this;return a=E(l,"map",[],function n(u,m){return null==u&&(u=t),null==m&&(m=t),[(null==n.$$s?this:n.$$s).$coerce_to_int_range(u),m]},{$$arity:2,$$s:$}),i=E(a,"sort_by",[],function(u,m){return null==u&&(u=t),null==m&&(m=t),u.$min()},2),$.$assert_min_sum_is_covered(i),$.$assert_max_sum_is_covered(i),$.$assert_no_gap_or_overlap_in_ranges(i),$.items=E(i,"map",[],function(u,m){return null==u&&(u=t),null==m&&(m=t),p("Item").$new(u,m.$freeze()).$freeze()},2).$freeze(),$},1),c(b,"$coerce_to_int_range",function(l){var a;return S(p("Integer"),a=l)?p("Range").$new(l,l):S(p("Range"),a)&&A(l.$begin()["$is_a?"](p("Integer")))&&A(l.$end()["$is_a?"](p("Integer")))?l:this.$raise(p("TypeError"),this.name+": "+l+" ("+l.$class()+") must be an Integer or a Range with Integers ")},1),c(b,"$assert_min_sum_is_covered",function(l){var a,$=this,i=t;return a=$.num_of_dice,i=l.$first()["$[]"](0),A(i["$include?"](a))||$.$raise(p("RangeError"),$.name+": min value ("+a+") is not covered: "+i),$},1),c(b,"$assert_max_sum_is_covered",function(l){var a,$=this,i=t;return a=P($.num_of_dice,$.num_of_sides),i=l.$last()["$[]"](0),A(i["$include?"](a))||$.$raise(p("RangeError"),$.name+": max value ("+a+") is not covered: "+i),$},1),c(b,"$assert_no_gap_or_overlap_in_ranges",function(l){return E(l,"each_cons",[2],function a(i,n){var h,k,u=null==a.$$s?this:a.$$s,m=t,x=t;return null==u.name&&(u.name=t),null==i&&(i=t),null==n&&(n=t),m=i["$[]"](0),x=n["$[]"](0),h=m.$max(),k=H(h,1),A(x["$include?"](h))&&u.$raise(p("RangeError"),u.name+": Range overlap: "+m+" and "+x),A(x["$include?"](k))?t:u.$raise(p("RangeError"),u.name+": Range gap: "+m+" and "+x)},{$$arity:2,$$s:this}),this},1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(r){var Y,F,C,N,b,d,p,_,j,P,M=[],t=r.nil,v=r.$$$,e=r.module,g=r.klass,E=r.send,A=r.def,c=r.rb_minus;return Y=M,F=P=[e(M[0],"BCDice")].concat(Y),C=j=[e(P[0],"DiceTable")].concat(F),N=_=[g(j[0],null,"SaiFicSkillTable")].concat(C),d=[b=g(_[0],null,"Category")].concat(N),p=r.$r(d),b.$$prototype.name=t,A(b,"$initialize",function(l,$,a,i){var n=this;return n.name=l,n.skills=E($.$map(),"with_index",[2],function(m,x){return null==m&&(m=t),null==x&&(x=t),v(p("SaiFicSkillTable"),"Skill").$new(l,m,a,x,i)},2),n.dice=a},4),A(b,"$roll",function(l){return this.$skills()["$[]"](c(l.$roll_sum(2,6),2))},1),A(b,"$to_s",function(){return this.name},0),b.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(r){var c,P,Q,q,B,C,F,Y,M=[],t=r.nil,v=r.module,e=r.klass,g=r.def,E=r.hash2;return c=M,P=Y=[v(M[0],"BCDice")].concat(c),Q=F=[v(Y[0],"DiceTable")].concat(P),C=[e(F[0],null,"SaiFicSkillTable")].concat(Q),(B=(q=e(C[0],null,"Skill")).$$prototype).s_format=B.category_dice=B.row_dice=B.category_name=B.name=t,g(q,"$initialize",function(b,d,p,y,f){var l=this;return l.category_name=b,l.name=d,l.category_dice=p,l.row_dice=y,l.s_format=f},5),g(q,"$to_s",function(){var b=this;return b.$format(b.s_format,E(["category_dice","row_dice","category_name","skill_name"],{category_dice:b.category_dice,row_dice:b.row_dice,category_name:b.category_name,skill_name:b.name}))},0),q.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(r){var U,q,p,y,f,l,$,N,o,M=r.top,t=[],v=r.nil,e=r.$$$,g=r.module,E=r.klass,A=r.hash2,c=r.send,Y=r.defs,S=r.const_set,P=r.to_ary,H=r.def,F=r.truthy,L=r.rb_minus,j=r.rb_plus;return M.$require("bcdice/dice_table/sai_fic_skill_table/category"),M.$require("bcdice/dice_table/sai_fic_skill_table/skill"),U=t,q=o=[g(t[0],"BCDice")].concat(U),p=N=[g(o[0],"DiceTable")].concat(q),f=[y=E(N[0],null,"SaiFicSkillTable")].concat(p),l=r.$r(f),($=y.$$prototype).rtt=$.rtt_format=$.rct=$.rct_format=$.rttn=$.rttn_format=$.categories=v,Y(y,"$from_i18n",function(i,n,u){var m,x,h,s,G=v;if(null==u)u=A([],{});else if(!u.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(m=u.$$smap.rtt)&&(m=v),null==(x=u.$$smap.rct)&&(x=v),null==(h=u.$$smap.rttn)&&(h=v),s=(G=l("I18n").$t("RTT",A(["locale","raise","default"],{locale:n,raise:!1,default:A([],{})})).$merge(l("I18n").$t(i,A(["locale","raise"],{locale:n,raise:!0}))))["$[]"]("items"),G=c(G,"select",[],function(w,O){return null==w&&(w=v),null==O&&(O=v),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](w)},2),this.$new(s,r.to_hash(G).$merge(A(["rtt","rct","rttn"],{rtt:m,rct:x,rttn:h})))},-3),S(f[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),S(f[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),S(f[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),S(f[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),H(y,"$initialize",function(i,n){var u,m,x,h,k,I,G,s=this;if(null==n)n=A([],{});else if(!n.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(u=n.$$smap.rtt)&&(u=v),null==(m=n.$$smap.rct)&&(m=v),null==(x=n.$$smap.rttn)&&(x=v),null==(h=n.$$smap.rtt_format)&&(h=l("DEFAULT_RTT")),null==(k=n.$$smap.rct_format)&&(k=l("DEFAULT_RCT")),null==(I=n.$$smap.rttn_format)&&(I=l("DEFAULT_RTTN")),null==(G=n.$$smap.s_format)&&(G=l("DEFAULT_S")),s.categories=c(i.$map(),"with_index",[1],function(w,O){var ie,ue,te;return null==w&&(w=v),null==O&&(O=v),ue=null==(ie=P(w))[0]?v:ie[0],te=null==ie[1]?v:ie[1],e(l("SaiFicSkillTable"),"Category").$new(ue,te,O,G)},{$$arity:2,$$has_top_level_mlhs_arg:!0}),s.rtt=u,s.rct=m,s.rttn=x.$to_a(),s.rtt_format=h,s.rct_format=k,s.rttn_format=I},-2),S(f[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),y.$attr_reader("categories"),H(y,"$roll_command",function(i,n){var m,u=this,x=v,h=v;return F(["RTT",u.rtt]["$include?"](m=n))?u.$format_skill(u.rtt_format,u.$roll_skill(i)):F(["RCT",u.rct]["$include?"](m))?(x=u.$roll_category(i),u.$format(u.rct_format,A(["category_dice","category_name"],{category_dice:x.$dice(),category_name:x.$name()}))):F(h=l("RTTN").$index(m))||F(h=u.rttn.$index(m))?u.$format_skill(u.rttn_format,u.categories["$[]"](h).$roll(i)):v},2),H(y,"$roll_category",function(i){return this.categories["$[]"](L(i.$roll_once(6),1))},1),H(y,"$roll_skill",function(i){return this.$roll_category(i).$roll(i)},1),H(y,"$prefixes",function(){var i=this;return j(["RTT[1-6]?","RCT",i.rtt,i.rct],i.rttn).$compact()},0),y.$private(),H(y,"$format_skill",function(i,n){return this.$format(i,A(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:n.$category_dice(),row_dice:n.$row_dice(),category_name:n.$category_name(),skill_name:n.$name(),text:n.$to_s()}))},2)},Opal.modules["bcdice/dice_table/table"]=function(r){var S,L,o,_,q,B,N,Q,H,M=[],t=r.nil,v=r.module,e=r.klass,g=r.hash2,E=r.defs,A=r.truthy,c=r.def,z=r.rb_minus;return S=M,L=H=[v(M[0],"BCDice")].concat(S),o=Q=[v(H[0],"DiceTable")].concat(L),q=[_=e(Q[0],null,"Table")].concat(o),B=r.$r(q),(N=_.$$prototype).times=N.sides=N.name=N.items=t,E(_,"$from_i18n",function(d,p){var f=t;return f=B("I18n").$t(d,g(["locale"],{locale:p})),this.$new(f["$[]"]("name"),f["$[]"]("type"),f["$[]"]("items"))},2),c(_,"$initialize",function(d,p,y){var f=this,l=t;return f.name=d,f.items=y.$freeze(),l=/(\d+)D(\d+)/i.$match(p),A(l)||f.$raise(B("ArgumentError"),"Unexpected table type: "+p),f.times=l["$[]"](1).$to_i(),f.sides=l["$[]"](2).$to_i()},3),c(_,"$roll",function(d){var y,p=this;return y=d.$roll_sum(p.times,p.sides),p.$choice(y)},1),c(_,"$choice",function(d){var y,p=this;return y=z(d,p.times),B("RollResult").$new(p.name,d,p.items["$[]"](y))},1)},Opal.modules["bcdice/dice_table"]=function(r){var M=r.top;return M.$require("bcdice/dice_table/roll_result"),M.$require("bcdice/dice_table/chain_table"),M.$require("bcdice/dice_table/d66_grid_table"),M.$require("bcdice/dice_table/d66_half_grid_table"),M.$require("bcdice/dice_table/d66_one_third_table"),M.$require("bcdice/dice_table/d66_left_range_table"),M.$require("bcdice/dice_table/d66_parity_table"),M.$require("bcdice/dice_table/d66_range_table"),M.$require("bcdice/dice_table/d66_table"),M.$require("bcdice/dice_table/range_table"),M.$require("bcdice/dice_table/sai_fic_skill_table"),M.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(r){var E,Y,P,c,M=[],v=r.module,e=r.const_set;return E=M,Y=c=[v(M[0],"BCDice")].concat(E),P=[v(c[0],"D66SortType")].concat(Y),e(P[0],"NO_SORT","no_sort"),e(P[0],"ASC","asc"),e(P[0],"DESC","desc"),function(z,Y){var P=[v(z,"RoundType")].concat(Y);return e(P[0],"CEIL","ceil"),e(P[0],"FLOOR","floor"),e(P[0],"ROUND","round")}(c[0],c)},Opal.modules["bcdice/translate"]=function(r){var c,P,H,F,L,Y,M=[],t=r.nil,v=r.module,e=r.hash2,E=r.def;return c=M,P=Y=[v(M[0],"BCDice")].concat(c),F=[H=v(Y[0],"Translate")].concat(P),L=r.$r(F),E(H,"$translate",function(Q,U){var C,o=this;if(null==o.locale&&(o.locale=t),null==U)U=e([],{});else if(!U.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return C=r.kwrestargs(U,{}),L("I18n").$translate(Q,e(["locale","raise"],{locale:o.locale,raise:!0}).$merge(r.to_hash(C)))},-2)},Opal.modules["bcdice/result"]=function(r){var Y,L,C,j,U,P,M=[],t=r.nil,e=r.klass,g=r.send,E=r.to_a,A=r.rb_minus,c=r.def;return Y=M,L=P=[(0,r.module)(M[0],"BCDice")].concat(Y),[j=e(P[0],null,"Result")].concat(L),(U=j.$$prototype).secret=U.success=U.failure=U.critical=U.fumble=t,c(C=r.get_singleton_class(j),"$success",function(q){return g(this.$new(),"tap",[],function(b){var d=t;return null==b&&(b=t),g(b,"text=",E(d=[q])),A(d.length,1),g(b,"success=",E(d=[!0])),d[A(d.length,1)]},1)},1),c(C,"$failure",function(q){return g(this.$new(),"tap",[],function(b){var d=t;return null==b&&(b=t),g(b,"text=",E(d=[q])),A(d.length,1),g(b,"failure=",E(d=[!0])),d[A(d.length,1)]},1)},1),c(C,"$critical",function(q){return g(this.$new(),"tap",[],function(b){var d=t;return null==b&&(b=t),g(b,"text=",E(d=[q])),A(d.length,1),g(b,"critical=",E(d=[!0])),A(d.length,1),g(b,"success=",E(d=[!0])),d[A(d.length,1)]},1)},1),c(C,"$fumble",function(q){return g(this.$new(),"tap",[],function(b){var d=t;return null==b&&(b=t),g(b,"text=",E(d=[q])),A(d.length,1),g(b,"fumble=",E(d=[!0])),A(d.length,1),g(b,"failure=",E(d=[!0])),d[A(d.length,1)]},1)},1),c(C,"$nothing",function(){return"nothing"},0),c(j,"$initialize",function(o){var _=this;return null==o&&(o=t),_.text=o,_.rands=t,_.detailed_rands=t,_.secret=!1,_.success=!1,_.failure=!1,_.critical=!1,_.fumble=!1},-1),j.$attr_accessor("text","rands","detailed_rands"),j.$attr_writer("secret","success","failure","critical","fumble"),c(j,"$secret?",function(){return this.secret},0),c(j,"$success?",function(){return this.success},0),c(j,"$failure?",function(){return this.failure},0),c(j,"$critical?",function(){return this.critical},0),c(j,"$fumble?",function(){return this.fumble},0),c(j,"$condition=",function(o){return this.success=o,this.failure=o["$!"]()},1)},Opal.modules["racc/parser"]=function(r){var p,f,l,t=[],v=r.$r(t),e=r.nil,g=r.$$$,E=r.module,A=r.klass,c=r.truthy,z=r.const_set,Y=r.defs,S=r.gvars,P=r.rb_lt,H=r.send,F=r.to_a,L=r.rb_minus,j=r.def,Q=r.to_ary,U=r.neqeq,C=r.rb_plus,o=r.eqeq,_=r.rb_ge,q=r.rb_gt,B=r.eqeqeq,N=r.rb_le,b=r.rb_times;return p=t,f=[E(t[0],"Racc")].concat(p),l=r.$r(f),A(f[0],l("StandardError"),"ParseError"),c(g("::","ParseError","skip_raise")?"constant":e)||z(t[0],"ParseError",g(v("Racc"),"ParseError")),function(d,p){var n,u,m,x,h,l=[E(d,"Racc")].concat(p),$=r.$r(l);return c($("Racc_No_Extensions","skip_raise")?"constant":e)||z(l[0],"Racc_No_Extensions",!1),n=l,m=[u=A(l[0],null,"Parser")].concat(n),x=r.$r(m),(h=u.$$prototype).yydebug=h.racc_debug_out=h.racc_error_status=h.racc_t=h.racc_vstack=h.racc_val=h.racc_state=h.racc_tstack=e,z(m[0],"Racc_Runtime_Version","1.4.6"),z(m[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),z(m[0],"Racc_Runtime_Core_Version_R","1.4.6"),z(m[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),z(m[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),z(m[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),z(m[0],"Racc_Runtime_Core_Version",x("Racc_Runtime_Core_Version_R")),z(m[0],"Racc_Runtime_Core_Revision",x("Racc_Runtime_Core_Revision_R")),z(m[0],"Racc_Runtime_Type","ruby"),Y(x("Parser"),"$racc_runtime_type",function(){return x("Racc_Runtime_Type")},0),j(u,"$_racc_setup",function(){var I,G,s=this,Z=e,w=e,O=e;return null==S.stderr&&(S.stderr=e),c(g(s.$class(),"Racc_debug_parser"))||(s.yydebug=!1),c(null!=(I=s.yydebug)&&I!==e?"instance-variable":e)||(s.yydebug=!1),c(s.yydebug)&&(c(null!=(G=s.racc_debug_out)&&G!==e?"instance-variable":e)||(s.racc_debug_out=S.stderr),s.racc_debug_out=c(Z=s.racc_debug_out)?Z:S.stderr),w=g(s.$class(),"Racc_arg"),c(P(w.$size(),14))&&(H(w,"[]=",F(O=[13,!0])),L(O.length,1)),w},0),j(u,"$_racc_init_sysvars",function(){var I=this;return I.racc_state=[0],I.racc_tstack=[],I.racc_vstack=[],I.racc_t=e,I.racc_val=e,I.racc_read_next=!0,I.racc_user_yyerror=!1,I.racc_error_status=0},0),j(u,"$do_parse",function(){return this.$__send__(x("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),j(u,"$next_token",function(){return this.$raise(x("NotImplementedError"),this.$class()+"#next_token is not defined")},0),j(u,"$_racc_do_parse_rb",function(I,G){var s,w=this,O=e,ie=e,ne=e,ue=e,K=e,D=e,V=e,R=e;return s=Q(I),O=null==s[0]?e:s[0],ie=null==s[1]?e:s[1],ne=null==s[2]?e:s[2],ue=null==s[3]?e:s[3],K=null==s[10]?e:s[10],w.$_racc_init_sysvars(),D=V=R=e,H(w,"catch",["racc_end_parse"],function T(){var re,X,W=null==T.$$s?this:T.$$s,ae=e;for(null==W.racc_state&&(W.racc_state=e),null==W.racc_read_next&&(W.racc_read_next=e),null==W.racc_t&&(W.racc_t=e),null==W.yydebug&&(W.yydebug=e),null==W.racc_val&&(W.racc_val=e);c(!0);)for(c(R=ue["$[]"](W.racc_state["$[]"](-1)))?(c(W.racc_read_next)&&U(W.racc_t,0)&&(X=W.$next_token(),re=Q(X),D=null==re[0]?e:re[0],W.racc_val=null==re[1]?e:re[1],W.racc_t=c(D)?c(ae=K["$[]"](D))?ae:1:0,c(W.yydebug)&&W.$racc_read_token(W.racc_t,D,W.racc_val),W.racc_read_next=!1),R=C(R,W.racc_t),c(_(R,0))&&c(V=O["$[]"](R))&&o(ie["$[]"](R),W.racc_state["$[]"](-1))||(V=ne["$[]"](W.racc_state["$[]"](-1)))):V=ne["$[]"](W.racc_state["$[]"](-1));c(V=W.$_racc_evalact(V,I)););},{$$arity:0,$$s:w})},2),j(u,"$yyparse",function(I,G){return this.$__send__(x("Racc_YY_Parse_Method"),I,G,this.$_racc_setup(),!0)},2),j(u,"$_racc_yyparse_rb",function(I,G,s,Z){var w,ne=e,ue=e,te=e,K=e,V=e,R=e,T=e;return w=Q(s),ne=null==w[0]?e:w[0],ue=null==w[1]?e:w[1],te=null==w[2]?e:w[2],K=null==w[3]?e:w[3],V=null==w[10]?e:w[10],this.$_racc_init_sysvars(),R=e,T=e,H(this,"catch",["racc_end_parse"],function ee(){var W=null==ee.$$s?this:ee.$$s;for(null==W.racc_state&&(W.racc_state=e);!c(T=K["$[]"](W.racc_state["$[]"](-1)));)for(;c(R=W.$_racc_evalact(te["$[]"](W.racc_state["$[]"](-1)),s)););return H(I,"__send__",[G],function ae(se,_e){var $e=null==ae.$$s?this:ae.$$s,J=e,oe=e;for(null==$e.racc_t&&($e.racc_t=e),null==$e.racc_state&&($e.racc_state=e),null==$e.racc_read_next&&($e.racc_read_next=e),null==se&&(se=e),null==_e&&(_e=e),$e.racc_t=c(se)?c(J=V["$[]"](se))?J:1:0,$e.racc_val=_e,$e.racc_read_next=!1,T=C(T,$e.racc_t),c(_(T,0))&&c(R=ne["$[]"](T))&&o(ue["$[]"](T),$e.racc_state["$[]"](-1))||(R=te["$[]"]($e.racc_state["$[]"](-1)));c(R=$e.$_racc_evalact(R,s)););for(;c(c(J=c(oe=(T=K["$[]"]($e.racc_state["$[]"](-1)))["$!"]())?oe:$e.racc_read_next["$!"]())?J:$e.racc_t["$=="](0));)for(c(T)&&c(T=C(T,$e.racc_t))&&c(_(T,0))&&c(R=ne["$[]"](T))&&o(ue["$[]"](T),$e.racc_state["$[]"](-1))||(R=te["$[]"]($e.racc_state["$[]"](-1)));c(R=$e.$_racc_evalact(R,s)););},{$$arity:2,$$s:W})},{$$arity:0,$$s:this})},4),j(u,"$_racc_evalact",function(I,G){var s,te,w=this,O=e,ie=e,ue=e,K=e,D=e,V=e,R=e;if(O=null==(s=Q(G))[0]?e:s[0],ie=null==s[1]?e:s[1],ue=null==s[3]?e:s[3],te=null==s[11]?e:s[11],K=null==s[12]?e:s[12],c(q(I,0))&&c(P(I,te)))c(q(w.racc_error_status,0))&&(o(w.racc_t,1)||(w.racc_error_status=L(w.racc_error_status,1))),w.racc_vstack.$push(w.racc_val),w.racc_state.$push(I),w.racc_read_next=!0,c(w.yydebug)&&(w.racc_tstack.$push(w.racc_t),w.$racc_shift(w.racc_t,w.racc_tstack,w.racc_vstack));else if(c(P(I,0))&&c(q(I,K["$-@"]()))){if(D=H(w,"catch",["racc_jump"],function T(){var ee=null==T.$$s?this:T.$$s;return null==ee.racc_state&&(ee.racc_state=e),ee.racc_state.$push(ee.$_racc_do_reduce(G,I)),!1},{$$arity:0,$$s:w}),c(D)){if(B(1,V=D))return w.racc_user_yyerror=!0,K["$-@"]();if(B(2,V))return te;w.$raise("[Racc Bug] unknown jump code")}}else if(o(I,te))c(w.yydebug)&&w.$racc_accept(),w.$throw("racc_end_parse",w.racc_vstack["$[]"](0));else{if(o(I,K["$-@"]())){for(B(0,V=w.racc_error_status)?c(G["$[]"](21))||w.$on_error(w.racc_t,w.racc_val,w.racc_vstack):B(3,V)&&(o(w.racc_t,0)&&w.$throw("racc_end_parse",e),w.racc_read_next=!0),w.racc_user_yyerror=!1,w.racc_error_status=3;c(!0)&&!(c(R=ue["$[]"](w.racc_state["$[]"](-1)))&&(R=C(R,1),c(_(R,0))&&c(I=O["$[]"](R))&&o(ie["$[]"](R),w.racc_state["$[]"](-1))));)c(N(w.racc_state.$size(),1))&&w.$throw("racc_end_parse",e),w.racc_state.$pop(),w.racc_vstack.$pop(),c(w.yydebug)&&(w.racc_tstack.$pop(),w.$racc_e_pop(w.racc_state,w.racc_tstack,w.racc_vstack));return I}w.$raise("[Racc Bug] unknown action "+I.$inspect())}return c(w.yydebug)&&w.$racc_next_state(w.racc_state["$[]"](-1),w.racc_state),e},2),j(u,"$_racc_do_reduce",function(I,G){var s,K,V,W,ae,se,$e,w=this,ie=e,ne=e,ue=e,te=e,D=e,R=e,T=e,ee=e,re=e,X=e,_e=e,le=e,ce=e,J=e;return ie=null==(s=Q(I))[4]?e:s[4],ne=null==s[5]?e:s[5],ue=null==s[6]?e:s[6],te=null==s[7]?e:s[7],K=null==s[8]?e:s[8],D=null==s[9]?e:s[9],V=null==s[13]?e:s[13],R=w.racc_state,T=w.racc_vstack,ee=w.racc_tstack,re=b(G,-3),X=D["$[]"](re),W=D["$[]"](C(re,1)),ae=D["$[]"](C(re,2)),se=[],c(w.yydebug)&&(_e=ee["$[]"](X["$-@"](),X)),le=T["$[]"](X["$-@"](),X),c(w.yydebug)&&(ce=[X["$-@"](),X,se],H(ee,"[]=",F(ce)),L(ce.length,1)),ce=[X["$-@"](),X,se],H(T,"[]=",F(ce)),L(ce.length,1),ce=[X["$-@"](),X,se],H(R,"[]=",F(ce)),L(ce.length,1),c(V)?T.$push(w.$__send__(ae,le,T,le["$[]"](0))):T.$push(w.$__send__(ae,le,T)),ee.$push(W),c(w.yydebug)&&w.$racc_reduce(_e,W,ee,T),$e=L(W,K),c(re=te["$[]"]($e))&&(re=C(re,R["$[]"](-1)),c(_(re,0))&&c(J=ie["$[]"](re))&&o(ne["$[]"](re),$e))?J:ue["$[]"]($e)},2),j(u,"$on_error",function(I,G,s){var w,Z=this;return Z.$raise(x("ParseError"),Z.$sprintf("\nparse error on value %s (%s)",G.$inspect(),c(w=Z.$token_to_str(I))?w:"?"))},3),j(u,"$yyerror",function(){return this.$throw("racc_jump",1)},0),j(u,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),j(u,"$yyerrok",function(){return this.racc_error_status=0},0),j(u,"$racc_read_token",function(I,G,s){var Z=this;return Z.racc_debug_out.$print("read    "),Z.racc_debug_out.$print(G.$inspect(),"(",Z.$racc_token2str(I),") "),Z.racc_debug_out.$puts(s.$inspect()),Z.racc_debug_out.$puts()},3),j(u,"$racc_shift",function(I,G,s){var Z=this;return Z.racc_debug_out.$puts("shift   "+Z.$racc_token2str(I)),Z.$racc_print_stacks(G,s),Z.racc_debug_out.$puts()},3),j(u,"$racc_reduce",function(I,G,s,Z){var w=this,O=e;return(O=w.racc_debug_out).$print("reduce "),c(I["$empty?"]())?O.$print(" <none>"):H(I,"each",[],function ie(ne){return null==ne&&(ne=e),O.$print(" ",(null==ie.$$s?this:ie.$$s).$racc_token2str(ne))},{$$arity:1,$$s:w}),O.$puts(" --\x3e "+w.$racc_token2str(G)),w.$racc_print_stacks(s,Z),w.racc_debug_out.$puts()},4),j(u,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),j(u,"$racc_e_pop",function(I,G,s){var Z=this;return Z.racc_debug_out.$puts("error recovering mode: pop token"),Z.$racc_print_states(I),Z.$racc_print_stacks(G,s),Z.racc_debug_out.$puts()},3),j(u,"$racc_next_state",function(I,G){var s=this;return s.racc_debug_out.$puts("goto    "+I),s.$racc_print_states(G),s.racc_debug_out.$puts()},2),j(u,"$racc_print_stacks",function(I,G){var Z=e;return(Z=this.racc_debug_out).$print("        ["),H(I,"each_index",[],function w(O){return null==O&&(O=e),Z.$print(" (",(null==w.$$s?this:w.$$s).$racc_token2str(I["$[]"](O))," ",G["$[]"](O).$inspect(),")")},{$$arity:1,$$s:this}),Z.$puts(" ]")},2),j(u,"$racc_print_states",function(I){var s=e;return(s=this.racc_debug_out).$print("        ["),H(I,"each",[],function(w){return null==w&&(w=e),s.$print(" ",w)},1),s.$puts(" ]")},1),j(u,"$racc_token2str",function(I){var s;return c(s=g(this.$class(),"Racc_token_to_s_table")["$[]"](I))?s:this.$raise("[Racc Bug] can't convert token "+I+" to string")},1),j(u,"$token_to_str",function(I){return g(this.$class(),"Racc_token_to_s_table")["$[]"](I)},1)}(t[0],t)},Opal.modules["bcdice/arithmetic/node"]=function(r){var j,o,N,l,$,d,p,q,U,M=[],t=r.nil,v=r.$$$,e=r.module,g=r.klass,E=r.def,A=r.send2,c=r.find_super,z=r.eqeq,Y=r.const_set,S=r.eqeqeq,P=r.rb_divide,H=r.truthy,F=r.alias;return j=M,o=U=[e(M[0],"BCDice")].concat(j),N=q=[e(U[0],"Arithmetic")].concat(o),d=[e(q[0],"Node")].concat(N),p=r.$r(d),($=(l=g(d[0],null,"BinaryOp")).$$prototype).lhs=$.rhs=$.op=t,E(l,"$initialize",function(i,n,u){var m=this;return m.lhs=i,m.op=n,m.rhs=u},3),E(l,"$eval",function(i){var m,n=this,u=t;return u=n.lhs.$eval(i),m=n.rhs.$eval(i),u.$send(n.op,m)},1),E(l,"$output",function(){var i=this;return""+i.lhs.$output()+i.op+i.rhs.$output()},0),E(l,"$s_exp",function(){var i=this;return"("+i.$op_for_s_exp()+" "+i.lhs.$s_exp()+" "+i.rhs.$s_exp()+")"},0),E(l,"$op_for_s_exp",function(){return this.op},0),function(y,f,l){var $=g(y,f,"DivideBase"),a=[$].concat(l),i=r.$r(a),n=$.$$prototype;n.lhs=n.rhs=n.op=t,E($,"$initialize",function u(m,x){return delete u.$$p,A(this,c(this,"initialize",u,!1,!0),"initialize",[m,"/",x],null)},2),E($,"$eval",function(m){var h,k,x=this;return h=x.lhs.$eval(m),k=x.rhs.$eval(m),z(k,0)&&x.$raise(i("ZeroDivisionError")),x.$divide_and_round(h,k,m)},1),E($,"$output",function u(){var m=u.$$p||t,x=this;return delete u.$$p,""+A(x,c(x,"output",u,!1,!0),"output",[],m)+x.$rounding_method()},0),$.$private(),E($,"$rounding_method",function(){return v(this.$class(),"ROUNDING_METHOD")},0),E($,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),E($,"$divide_and_round",function(m,x,h){return this.$raise(i("NotImplementedError"))},3)}(d[0],p("BinaryOp"),d),function(y,f,l){var $=g(y,f,"DivideWithGameSystemDefault"),a=[$].concat(l),i=r.$r(a);Y(a[0],"ROUNDING_METHOD",""),$.$private(),E($,"$divide_and_round",function(u,m,x){var h,k=t;return S(v(i("RoundType"),"CEIL"),h=x)?P(u.$to_f(),m).$ceil():S(v(i("RoundType"),"ROUND"),h)?(k=P(u.$to_f(),m),H(k["$negative?"]())?k.$abs().$round()["$-@"]():k.$round()):P(u,m).$floor()},3)}(d[0],p("DivideBase"),d),function(y,f,l){var $=g(y,f,"DivideWithCeil"),a=[$].concat(l);Y(a[0],"ROUNDING_METHOD","C"),$.$private(),E($,"$divide_and_round",function(n,u,m){return P(n.$to_f(),u).$ceil()},3)}(d[0],p("DivideBase"),d),function(y,f,l){var $=g(y,f,"DivideWithRound"),a=[$].concat(l);Y(a[0],"ROUNDING_METHOD","R"),$.$private(),E($,"$divide_and_round",function(n,u,m){var x=t;return x=P(n.$to_f(),u),H(x["$negative?"]())?x.$abs().$round()["$-@"]():x.$round()},3)}(d[0],p("DivideBase"),d),function(y,f,l){var $=g(y,f,"DivideWithFloor"),a=[$].concat(l);Y(a[0],"ROUNDING_METHOD","F"),$.$private(),E($,"$divide_and_round",function(n,u,m){return P(n,u).$floor()},3)}(d[0],p("DivideBase"),d),function(y,f){var l=g(y,null,"Negative");l.$$prototype.body=t,E(l,"$initialize",function(i){return this.body=i},1),E(l,"$eval",function(i){return this.body.$eval(i)["$-@"]()},1),E(l,"$output",function(){return"-"+this.body.$output()},0),E(l,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(d[0]),function(y,f){var l=g(y,null,"Parenthesis");l.$$prototype.expr=t,E(l,"$initialize",function(i){return this.expr=i},1),E(l,"$eval",function(i){return this.expr.$eval(i)},1),E(l,"$output",function(){return"("+this.expr.$output()+")"},0),E(l,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(d[0]),function(y,f){var l=g(y,null,"Number");return l.$$prototype.value=t,E(l,"$initialize",function(i){return this.value=i},1),E(l,"$eval",function(i){return this.value},1),E(l,"$output",function(){return this.value.$to_s()},0),F(l,"s_exp","output")}(d[0])},Opal.modules.strscan=function(r){var F,L,j,Q,U,M=[],t=r.nil,e=r.def,g=r.truthy,E=r.eqeqeq,A=r.Opal,c=r.send,z=r.to_a,Y=r.rb_minus,S=r.alias;return F=M,j=[L=(0,r.klass)(M[0],null,"StringScanner")].concat(F),Q=r.$r(j),(U=L.$$prototype).pos=U.string=U.working=U.matched=U.prev_pos=U.match=t,L.$attr_reader("pos","matched"),e(L,"$initialize",function(o){var _=this;return _.string=o,_.pos=0,_.matched=t,_.working=o,_.match=[]},1),L.$attr_reader("string"),e(L,"$beginning_of_line?",function(){var o=this;return 0===o.pos||"\n"===o.string.charAt(o.pos-1)},0),e(L,"$scan",function(o){var _=this,q=(o=_.$anchor(o)).exec(_.working);return null==q?_.matched=t:"object"==typeof q?(_.prev_pos=_.pos,_.pos+=q[0].length,_.working=_.working.substring(q[0].length),_.matched=q[0],_.match=q,q[0]):"string"==typeof q?(_.pos+=q.length,_.working=_.working.substring(q.length),q):t},1),e(L,"$scan_until",function(o){var _=this;o=_.$anchor(o);for(var N,q=_.pos,B=_.working;;){if(N=o.exec(B),q+=1,B=B.substr(1),null!=N)return _.matched=_.string.substr(_.pos,q-_.pos-1+N[0].length),_.match=N,_.prev_pos=q-1,_.pos=q,_.working=B.substr(N[0].length),_.matched;if(0===B.length)return _.match=[],_.matched=t}},1),e(L,"$[]",function(o){var q;if(g(this.match["$empty?"]()))return t;E(Q("Symbol"),q=o)?o=o.$to_s():E(Q("String"),q)||(o=A["$coerce_to!"](o,Q("Integer"),"to_int"));var B=this.match;return o<0&&(o+=B.length),o<0||o>=B.length||null==B[o]?t:B[o]},1),e(L,"$check",function(o){var _=this,q=(o=_.$anchor(o)).exec(_.working);return _.matched=null==q?t:q[0]},1),e(L,"$check_until",function(o){var _=this,q=_.prev_pos,B=_.pos,N=_.$scan_until(o);return N!==t&&(_.matched=N.substr(-1),_.working=_.string.substr(B)),_.prev_pos=q,_.pos=B,N},1),e(L,"$peek",function(o){return this.working.substring(0,o)},1),e(L,"$eos?",function(){return 0===this.working.length},0),e(L,"$exist?",function(o){var q=o.exec(this.working);return null==q?t:0==q.index?0:q.index+1},1),e(L,"$skip",function(o){var _=this,q=(o=_.$anchor(o)).exec(_.working);if(null==q)return _.match=[],_.matched=t;var B=q[0],N=B.length;return _.matched=B,_.match=q,_.prev_pos=_.pos,_.pos+=N,_.working=_.working.substring(N),N},1),e(L,"$skip_until",function(o){var q=this.$scan_until(o);return q===t?t:(this.matched=q.substr(-1),q.length)},1),e(L,"$get_byte",function(){var o=this,_=t;return o.pos<o.string.length?(o.prev_pos=o.pos,o.pos+=1,_=o.matched=o.working.substring(0,1),o.working=o.working.substring(1)):o.matched=t,_},0),e(L,"$match?",function(o){var _=this,q=(o=_.$anchor(o)).exec(_.working);return null==q?t:(_.prev_pos=_.pos,q[0].length)},1),e(L,"$pos=",function(o){var _=this;return o<0&&(o+=_.string.$length()),_.pos=o,_.working=_.string.slice(o)},1),e(L,"$matched_size",function(){return this.matched===t?t:this.matched.length},0),e(L,"$post_match",function(){var o=this;return o.matched===t?t:o.string.substr(o.pos)},0),e(L,"$pre_match",function(){var o=this;return o.matched===t?t:o.string.substr(0,o.prev_pos)},0),e(L,"$reset",function(){var o=this;return o.working=o.string,o.matched=t,o.pos=0},0),e(L,"$rest",function(){return this.working},0),e(L,"$rest?",function(){return 0!==this.working.length},0),e(L,"$rest_size",function(){return this.$rest().$size()},0),e(L,"$terminate",function(){var _,o=this;return o.match=t,_=[o.string.$length()],c(o,"pos=",z(_)),_[Y(_.length,1)]},0),e(L,"$unscan",function(){var o=this;return o.pos=o.prev_pos,o.prev_pos=t,o.match=t,o},0),S(L,"bol?","beginning_of_line?"),S(L,"getch","get_byte"),L.$private(),e(L,"$anchor",function(o){var _=o.toString().match(/\/([^\/]+)$/);return _=_?_[1]:void 0,new RegExp("^(?:"+o.source+")",_)},1)},Opal.modules["bcdice/normalize"]=function(r){var c,P,Y,M=[],t=r.nil,v=r.module,e=r.eqeqeq,g=r.def,E=r.eqeq;return c=M,Y=[v(M[0],"BCDice")].concat(c),(P=v(Y[0],"Normalize")).$module_function(),g(P,"$comparison_operator",function(F){var L;return e(/<=|=</,L=F)?"<=":e(/>=|=>/,L)?">=":e(/<>|!=|=!/,L)?"!=":e(/</,L)?"<":e(/>/,L)?">":e(/=/,L)?"==":t},1),g(P,"$target_number",function(F){return E(F,"?")?F:F.$to_i()},1)},Opal.modules["bcdice/command/lexer"]=function(r){var P,j,_,q,B,N,b,U,F,M=r.top,t=[],v=r.nil,e=r.module,g=r.klass,E=r.const_set,A=r.hash2,c=r.truthy,z=r.send,Y=r.def;return M.$require("strscan"),M.$require("bcdice/normalize"),P=t,j=F=[e(t[0],"BCDice")].concat(P),_=U=[e(F[0],"Command")].concat(j),B=[q=g(U[0],null,"Lexer")].concat(_),N=r.$r(B),(b=q.$$prototype).scanner=b.notations=v,E(B[0],"SYMBOLS",A(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),Y(q,"$initialize",function(p,y){var f,l,a;return p=c(a=(l=(f=p)===v||null==f?v:z(f,"split",[" ",2]))===v||null==l?v:z(l,"first",[]))?a:"",this.scanner=N("StringScanner").$new(p),this.notations=z(y,"map",[],function(n){return null==n&&(n=v),c(n["$is_a?"](N("String")))?N("Regexp").$new(n):n},1)},2),Y(q,"$next_token",function(){try{var p=this,y=v,f=v,$=v,a=v;return c(p.scanner["$eos?"]())?[!1,"$"]:(z(p.notations,"each",[],function i(n){var m,u=null==i.$$s?this:i.$$s;if(null==u.scanner&&(u.scanner=v),null==n&&(n=v),m=u.scanner.$scan(n),!c(m))return v;r.ret(["NOTATION",m])},{$$arity:1,$$s:p}),c(y=p.scanner.$scan(/\d+/))?["NUMBER",y.$to_i()]:c(f=p.scanner.$scan(/[<>!=]+/))?(f=N("Normalize").$comparison_operator(f),[c(f)?"CMP_OP":"ILLEGAL",f]):($=p.scanner.$getch().$upcase(),[c(a=N("SYMBOLS")["$[]"]($))?a:$.$to_sym(),$]))}catch(i){if(i===r.returner)return i.$v;throw i}},0),Y(q,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/command/parsed"]=function(r){var z,H,U,C,o,_,q,L,S,M=[],t=r.nil,v=r.module,e=r.klass,g=r.def,E=r.truthy,A=r.eqeqeq;return z=M,H=S=[v(M[0],"BCDice")].concat(z),U=L=[v(S[0],"Command")].concat(H),o=[C=e(L[0],null,"Parsed")].concat(U),_=r.$r(o),(q=C.$$prototype).question_target=q.critical=q.fumble=q.dollar=q.modify_number=q.target_number=q.prefix_number=q.command=q.suffix_number=q.cmp_op=t,C.$attr_accessor("command"),C.$attr_accessor("prefix_number"),C.$attr_accessor("suffix_number"),C.$attr_accessor("critical"),C.$attr_accessor("fumble"),C.$attr_accessor("dollar"),C.$attr_accessor("modify_number"),C.$attr_accessor("cmp_op"),C.$attr_accessor("target_number"),C.$attr_writer("question_target"),g(C,"$initialize",function(){var N=this;return N.prefix_number=t,N.suffix_number=t,N.critical=t,N.fumble=t,N.dollar=t,N.cmp_op=t,N.target_number=t,N.question_target=!1},0),g(C,"$question_target?",function(){return this.question_target},0),g(C,"$to_s",function(N){var $,b=this,d=t,p=t,y=t,f=t,l=t;return null==N&&(N="after_command"),d=E(b.critical)?"@"+b.critical:t,p=E(b.fumble)?"#"+b.fumble:t,y=E(b.dollar)?"$"+b.dollar:t,f=_("Format").$modifier(b.modify_number),l=E(b.question_target)?"?":b.target_number,A("after_command",$=N)?[b.prefix_number,b.command,b.suffix_number,d,p,y,f,b.cmp_op,l].$join():A("after_modify_number",$)?[b.prefix_number,b.command,b.suffix_number,f,d,p,y,b.cmp_op,l].$join():A("after_target_number",$)?[b.prefix_number,b.command,b.suffix_number,f,b.cmp_op,l,d,p,y].$join():t},-1)},Opal.modules["bcdice/command/parser"]=function(r){var _,b,$,u,m,x,h,k,I,G,s,Z,ie,a,i,n,te,p,y,B,M=r.top,t=[],v=r.$r(t),e=r.nil,g=r.$$$,E=r.klass,A=r.module,c=r.hash2,z=r.send2,Y=r.find_super,S=r.def,P=r.send,H=r.to_a,F=r.rb_minus,L=r.eqeq,j=r.hash,Q=r.const_set,U=r.truthy,C=r.to_ary;return M.$require("racc/parser.rb"),M.$require("bcdice/arithmetic/node"),M.$require("bcdice/command/lexer"),M.$require("bcdice/command/parsed"),E(g(v("BCDice"),"Command"),g(v("Racc"),"Parser"),"Parser"),_=t,b=B=[A(t[0],"BCDice")].concat(_),p=[A(B[0],"Command")].concat(b),y=r.$r(p),$=p,i=[a=E(p[0],g(y("Racc"),"Parser"),"Parser")].concat($),n=r.$r(i),(te=a.$$prototype).notations=te.lexer=te.modifier=te.suffix_number=te.prefix_number=te.need_suffix_number=te.need_prefix_number=te.critical=te.fumble=te.dollar=te.allowed_cmp_op=te.question_target=e,S(a,"$initialize",function K(D,V){var R,T,ee,re,W=this;if(delete K.$$p,R=r.slice.call(arguments),null==(T=r.extract_kwargs(R)))T=c([],{});else if(!T.$$is_hash)throw r.ArgumentError.$new("expected kwargs");if(ee=R,!r.hasOwnProperty.call(T.$$smap,"round_type"))throw r.ArgumentError.$new("missing keyword: round_type");return re=T.$$smap.round_type,z(W,Y(W,"initialize",K,!1,!0),"initialize",[],null),W.notations=ee,W.round_type=re,W.prefix_number=!1,W.suffix_number=!1,W.need_prefix_number=!1,W.need_suffix_number=!1,W.modifier=!0,W.critical=!1,W.fumble=!1,W.dollar=!1,W.allowed_cmp_op=[e,">=",">","<=","<","==","!="],W.question_target=!1},-2),S(a,"$disable_modifier",function(){return this.modifier=!1,this},0),S(a,"$enable_prefix_number",function(){return this.prefix_number=!0,this},0),S(a,"$enable_suffix_number",function(){return this.suffix_number=!0,this},0),S(a,"$has_prefix_number",function(){var D=this;return D.prefix_number=!0,D.need_prefix_number=!0,D},0),S(a,"$has_suffix_number",function(){var D=this;return D.suffix_number=!0,D.need_suffix_number=!0,D},0),S(a,"$enable_critical",function(){return this.critical=!0,this},0),S(a,"$enable_fumble",function(){return this.fumble=!0,this},0),S(a,"$enable_dollar",function(){return this.dollar=!0,this},0),S(a,"$restrict_cmp_op_to",function(D){var V,T=this;return V=r.slice.call(arguments),T.allowed_cmp_op=V,T},-1),S(a,"$enable_question_target",function(){return this.question_target=!0,this},0),S(a,"$parse",function(D){var V=this;try{return V.lexer=n("Lexer").$new(D,V.notations),V.$do_parse()}catch(R){if(!r.rescue(R,[n("ParseError"),n("ZeroDivisionError")]))throw R;try{return e}finally{r.pop_exception()}}},1),a.$private(),S(a,"$parsed",function(D,V,R,T){return P(n("Parsed").$new(),"tap",[],function re(X){var W,ae,se,_e,le,ce,$e=null==re.$$s?this:re.$$s,J=e;return null==$e.round_type&&($e.round_type=e),null==X&&(X=e),J=[D["$[]"]("command")],P(X,"command=",H(J)),F(J.length,1),J=[(W=D["$[]"]("prefix"),W===e||null==W?e:P(W,"eval",[$e.round_type]))],P(X,"prefix_number=",H(J)),F(J.length,1),J=[(ae=D["$[]"]("suffix"),ae===e||null==ae?e:P(ae,"eval",[$e.round_type]))],P(X,"suffix_number=",H(J)),F(J.length,1),J=[(se=V["$[]"]("critical"),se===e||null==se?e:P(se,"eval",[$e.round_type]))],P(X,"critical=",H(J)),F(J.length,1),J=[(_e=V["$[]"]("fumble"),_e===e||null==_e?e:P(_e,"eval",[$e.round_type]))],P(X,"fumble=",H(J)),F(J.length,1),J=[(le=V["$[]"]("dollar"),le===e||null==le?e:P(le,"eval",[$e.round_type]))],P(X,"dollar=",H(J)),F(J.length,1),J=[R.$eval($e.round_type)],P(X,"modify_number=",H(J)),F(J.length,1),J=[T["$[]"]("cmp_op")],P(X,"cmp_op=",H(J)),F(J.length,1),L(T["$[]"]("target"),"?")?(P(X,"question_target=",H(J=[!0])),F(J.length,1),P(X,"target_number=",H(J=[0])),J[F(J.length,1)]):(P(X,"question_target=",H(J=[!1])),F(J.length,1),J=[(ce=T["$[]"]("target"),ce===e||null==ce?e:P(ce,"eval",[$e.round_type]))],P(X,"target_number=",H(J)),J[F(J.length,1)])},{$$arity:1,$$s:this})},4),S(a,"$next_token",function(){return this.lexer.$next_token()},0),u=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,33,34,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,e,e,17,18,6,e,5,e,e,17,18,e,e,5,23,24,25,26,56,54,55,57],m=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,e,17,15,15,18,18,23,e,18,30,30,23,23,24,e,23,31,31,24,24,25,e,24,44,44,25,25,28,e,25,47,47,28,28,29,e,28,48,48,29,29,33,e,29,49,49,33,33,34,e,33,50,50,34,34,36,e,34,e,e,36,36,37,e,36,e,e,37,37,e,e,37,27,27,27,27,52,52,52,52],x=[-2,4,16,-3,-1,11,e,33,13,35,23,30,1,e,28,40,e,37,44,e,e,-2,e,51,58,65,0,106,72,79,47,54,e,86,93,e,100,107,e,e,e,e,e,e,63,e,e,68,75,82,89,e,120,e,e,e,e,e],h=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],k=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,e,e,21,47,48,40,51,52,49,50,44,46,3,e,e,e,13,e,e,e,e,e,e,e,32],I=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,e,e,4,8,8,5,7,7,8,8,9,5,6,e,e,e,6,e,e,e,e,e,e,e,6],G=[e,6,13,3,9,-1,27,-15,-10,-1,-38],s=[e,e,e,e,e,e,19,16,15,e,e],Z=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],ie=j(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),Q(i[0],"Racc_arg",[u,m,h,x,k,I,s,G,19,Z,ie,58,35,!0]),Q(i[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),Q(i[0],"Racc_debug_parser",!1),S(a,"$_reduce_1",function(D,V,R){var T;return U(this.modifier)||this.$raise(n("ParseError")),T=C(D),this.$parsed(null==T[0]?e:T[0],null==T[1]?e:T[1],null==T[2]?e:T[2],null==T[3]?e:T[3])},3),S(a,"$_reduce_2",function(D,V,R){var T;return U(this.modifier)||this.$raise(n("ParseError")),T=C(D),this.$parsed(null==T[0]?e:T[0],null==T[2]?e:T[2],null==T[1]?e:T[1],null==T[3]?e:T[3])},3),S(a,"$_reduce_3",function(D,V,R){var T,ae;return ae=null==(T=C(D))[2]?e:T[2],this.$parsed(null==T[0]?e:T[0],null==T[1]?e:T[1],g(g(n("Arithmetic"),"Node"),"Number").$new(0),ae)},3),S(a,"$_reduce_4",function(D,V,R){var T=this;return U(T.prefix_number)&&U(T.suffix_number)||T.$raise(n("ParseError")),c(["command","prefix","suffix"],{command:D["$[]"](1),prefix:D["$[]"](0),suffix:D["$[]"](2)})},3),S(a,"$_reduce_5",function(D,V,R){var T=this;return U(T.prefix_number)||T.$raise(n("ParseError")),U(T.need_suffix_number)&&T.$raise(n("ParseError")),c(["command","prefix"],{command:D["$[]"](1),prefix:D["$[]"](0)})},3),S(a,"$_reduce_6",function(D,V,R){var T=this;return U(T.suffix_number)||T.$raise(n("ParseError")),U(T.need_prefix_number)&&T.$raise(n("ParseError")),c(["command","suffix"],{command:D["$[]"](0),suffix:D["$[]"](1)})},3),S(a,"$_reduce_7",function(D,V,R){var T=this;return(U(T.need_prefix_number)||U(T.need_suffix_number))&&T.$raise(n("ParseError")),c(["command"],{command:D["$[]"](0)})},3),S(a,"$_reduce_8",function(D,V,R){return c([],{})},3),S(a,"$_reduce_9",function(D,V,R){var T,ae,se,X=e;return X=null==(T=C(D))[0]?e:T[0],ae=null==T[2]?e:T[2],U(this.critical)&&U(X["$[]"]("critical")["$nil?"]())||this.$raise(n("ParseError")),P(X,"[]=",H(se=["critical",ae])),F(se.length,1),X},3),S(a,"$_reduce_10",function(D,V,R){var T,ae,se,X=e;return X=null==(T=C(D))[0]?e:T[0],ae=null==T[2]?e:T[2],U(this.fumble)&&U(X["$[]"]("fumble")["$nil?"]())||this.$raise(n("ParseError")),P(X,"[]=",H(se=["fumble",ae])),F(se.length,1),X},3),S(a,"$_reduce_11",function(D,V,R){var T,ae,se,X=e;return X=null==(T=C(D))[0]?e:T[0],ae=null==T[2]?e:T[2],U(this.dollar)&&U(X["$[]"]("dollar")["$nil?"]())||this.$raise(n("ParseError")),P(X,"[]=",H(se=["dollar",ae])),F(se.length,1),X},3),S(a,"$_reduce_12",function(D,V,R){return D["$[]"](1)},3),S(a,"$_reduce_13",function(D,V,R){return g(g(n("Arithmetic"),"Node"),"Negative").$new(D["$[]"](1))},3),S(a,"$_reduce_14",function(D,V,R){return g(g(n("Arithmetic"),"Node"),"BinaryOp").$new(D["$[]"](0),"+",D["$[]"](2))},3),S(a,"$_reduce_15",function(D,V,R){return g(g(n("Arithmetic"),"Node"),"BinaryOp").$new(D["$[]"](0),"-",D["$[]"](2))},3),S(a,"$_reduce_16",function(D,V,R){return U(this.allowed_cmp_op["$include?"](e))||this.$raise(n("ParseError")),c([],{})},3),S(a,"$_reduce_17",function(D,V,R){var T,X,W;return W=null==(T=C(D))[1]?e:T[1],U(this.allowed_cmp_op["$include?"](X=null==T[0]?e:T[0]))||this.$raise(n("ParseError")),c(["cmp_op","target"],{cmp_op:X,target:W})},3),S(a,"$_reduce_18",function(D,V,R){var ee,T=this;return ee=D["$[]"](0),U(T.question_target)||T.$raise(n("ParseError")),U(T.allowed_cmp_op["$include?"](ee))||T.$raise(n("ParseError")),c(["cmp_op","target"],{cmp_op:ee,target:"?"})},3),S(a,"$_reduce_19",function(D,V,R){return g(g(n("Arithmetic"),"Node"),"BinaryOp").$new(D["$[]"](0),"+",D["$[]"](2))},3),S(a,"$_reduce_20",function(D,V,R){return g(g(n("Arithmetic"),"Node"),"BinaryOp").$new(D["$[]"](0),"-",D["$[]"](2))},3),S(a,"$_reduce_22",function(D,V,R){return g(g(n("Arithmetic"),"Node"),"BinaryOp").$new(D["$[]"](0),"*",D["$[]"](2))},3),S(a,"$_reduce_23",function(D,V,R){return D["$[]"](3).$new(D["$[]"](0),D["$[]"](2))},3),S(a,"$_reduce_25",function(D,V,R){return g(g(n("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),S(a,"$_reduce_26",function(D,V,R){return g(g(n("Arithmetic"),"Node"),"DivideWithCeil")},3),S(a,"$_reduce_27",function(D,V,R){return g(g(n("Arithmetic"),"Node"),"DivideWithCeil")},3),S(a,"$_reduce_28",function(D,V,R){return g(g(n("Arithmetic"),"Node"),"DivideWithRound")},3),S(a,"$_reduce_29",function(D,V,R){return g(g(n("Arithmetic"),"Node"),"DivideWithFloor")},3),S(a,"$_reduce_30",function(D,V,R){return D["$[]"](1)},3),S(a,"$_reduce_31",function(D,V,R){return g(g(n("Arithmetic"),"Node"),"Negative").$new(D["$[]"](1))},3),S(a,"$_reduce_33",function(D,V,R){return D["$[]"](1)},3),S(a,"$_reduce_34",function(D,V,R){return g(g(n("Arithmetic"),"Node"),"Number").$new(D["$[]"](0))},3),S(a,"$_reduce_none",function(D,V,R){return D["$[]"](0)},3)},Opal.modules["bcdice/deprecated/checker"]=function(r){var z,H,Q,U,C,o,L,S,M=[],t=r.nil,v=r.module,e=r.send,g=r.eqeqeq,E=r.truthy,A=r.def;return z=M,H=S=[v(M[0],"BCDice")].concat(z),Q=L=[v(S[0],"Deprecated")].concat(H),C=[U=v(L[0],"Checker")].concat(Q),o=r.$r(C),U.$private(),A(U,"$check_result_legacy",function(q,B,N,b){var f,d=this,p=t,y=t,l=t,$=t;return p=e(B,"map",[],"sides".$to_proc()),f=(y=e(B,"map",[],"value".$to_proc())).$sum(),l=g([100],$=p)?d.$check_1D100(q,f,N,b):g([20],$)?d.$check_1D20(q,f,N,b):g([6,6],$)?d.$check_2D6(q,f,y,N,b):t,(E(l["$nil?"]())||E(l["$empty?"]()))&&(l=g([10],$=p.$uniq())?d.$check_nD10(q,f,y,N,b):g([6],$)?d.$check_nD6(q,f,y,N,b):t,E(l["$nil?"]())||E(l["$empty?"]()))?t:o("Result").$new(l.$delete_prefix(" \uff1e "))},4),A(U,"$check_1D100",function(q,B,N,b){return t},4),A(U,"$check_1D20",function(q,B,N,b){return t},4),A(U,"$check_nD10",function(q,B,N,b,d){return t},5),A(U,"$check_2D6",function(q,B,N,b,d){return t},5),A(U,"$check_nD6",function(q,B,N,b,d){return t},5)},Opal.modules["bcdice/base"]=function(r){var B,y,i,u,m,f,l,$,a,b,M=r.top,t=[],v=r.$r(t),e=r.nil,g=r.$$$,E=r.module,A=r.klass,c=r.truthy,z=r.def,Y=r.regexp,S=r.rb_plus,P=r.send,H=r.to_a,F=r.rb_minus,L=r.eqeqeq,j=r.eqeq,Q=r.range,U=r.rb_divide,C=r.rb_times,o=r.rb_ge,_=e;return M.$require("i18n"),M.$require("i18n/backend/fallbacks"),M.$require("bcdice/randomizer"),M.$require("bcdice/dice_table"),M.$require("bcdice/enum"),M.$require("bcdice/translate"),M.$require("bcdice/result"),M.$require("bcdice/command/parser"),M.$require("bcdice/deprecated/checker"),B=t,y=b=[E(t[0],"BCDice")].concat(B),l=[f=A(b[0],null,"Base")].concat(y),$=r.$r(l),(a=f.$$prototype).sort_add_dice=a.sort_barabara_dice=a.enabled_d9=a.raw_input=a.randomizer=a.enabled_upcase_input=a.debug=e,u=[i=r.get_singleton_class(f)].concat(l),m=r.$r(u),i.$attr_reader("prefixes"),z(i,"$register_prefix",function(h){var I,G=this,s=e;return null==G.prefixes&&(G.prefixes=e),I=r.slice.call(arguments),G.prefixes=c(s=G.prefixes)?s:[],G.prefixes.$concat(I.$flatten())},-1),z(i,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())},0),z(i,"$prefixes_pattern",function(){var h=this,k=e;return null==h.prefixes_pattern&&(h.prefixes_pattern=e),null==h.prefixes&&(h.prefixes=e),h.prefixes_pattern=c(k=h.prefixes_pattern)?k:e,c(h.prefixes_pattern)?h.prefixes_pattern:(h.prefixes=c(k=h.prefixes)?k:[],h.prefixes.$freeze(),h.prefixes_pattern=(c(h.prefixes["$empty?"]())?/(?!)/:Y(["^(S)?(",h.prefixes.$join("|"),")"],"i")).$freeze())},0),z(i,"$command_pattern",function(){var h=this,k=e,I=e;return null==h.command_pattern&&(h.command_pattern=e),null==h.prefixes&&(h.prefixes=e),h.command_pattern=c(k=h.command_pattern)?k:e,c(h.command_pattern)?h.command_pattern:(h.prefixes=c(k=h.prefixes)?k:[],h.prefixes.$freeze(),I=S(P(g(m("CommonCommand"),"COMMANDS"),"map",[],function(s){return null==s&&(s=e),g(s,"PREFIX_PATTERN").$source()},1),h.prefixes),h.command_pattern=Y(["^S?(",I.$join("|"),")"],"i").$freeze())},0),z(i,"$eval",function(h){return this.$new(h).$eval()},1),f.$include($("Translate")),f.$include(g($("Deprecated"),"Checker")),z(f,"$initialize",function(n){var u=this;return u.raw_input=n,u.sort_add_dice=!1,u.sort_barabara_dice=!1,u.d66_sort_type=g($("D66SortType"),"NO_SORT"),u.enabled_d9=!1,u.round_type=g($("RoundType"),"FLOOR"),u.sides_implicit_d=6,u.upper_dice_reroll_threshold=e,u.reroll_dice_reroll_threshold=e,u.default_cmp_op=e,u.default_target_number=e,u.enabled_upcase_input=!0,u.locale="ja_jp",u.randomizer=g($("BCDice"),"Randomizer").$new(),u.debug=!1},1),f.$attr_accessor("randomizer"),f.$attr_reader("d66_sort_type"),f.$attr_reader("round_type"),f.$attr_reader("sides_implicit_d"),f.$attr_reader("upper_dice_reroll_threshold"),f.$attr_reader("reroll_dice_reroll_threshold"),f.$attr_reader("default_cmp_op"),f.$attr_reader("default_target_number"),z(f,"$sort_add_dice?",function(){return this.sort_add_dice},0),z(f,"$sort_barabara_dice?",function(){return this.sort_barabara_dice},0),z(f,"$enabled_d9?",function(){return this.enabled_d9},0),z(f,"$enable_debug",function(){return this.debug=!0},0),z(f,"$eval",function(){var u,m,x,n=this,h=e;return u=g($("BCDice"),"Preprocessor").$process(n.raw_input,n),m=c(x=n.$dice_command(u))?x:n.$eval_common_command(n.raw_input),c(m)?(h=[n.randomizer.$rand_results()],P(m,"rands=",H(h)),F(h.length,1),h=[n.randomizer.$detailed_rand_results()],P(m,"detailed_rands=",H(h)),F(h.length,1),m):e},0),z(f,"$change_text",function(n){return n},1),z(f,"$check_result",function(n,u,m,x){var h=this,k=e,I=e,G=e,s=e,Z=e;return k=h.$check_result_legacy(n,u,m,x),c(k)?k:(I=P(u,"map",[],"sides".$to_proc()),s=(G=P(u,"map",[],"value".$to_proc())).$sum(),k=L([100],Z=I)?h.$result_1d100(n,s,m,x):L([20],Z)?h.$result_1d20(n,s,m,x):L([6,6],Z)?h.$result_2d6(n,s,G,m,x):e,j(k,$("Result").$nothing())?e:c(k)?k:(k=L([10],Z=I.$uniq())?h.$result_nd10(n,s,G,m,x):L([6],Z)?h.$result_nd6(n,s,G,m,x):e,j(k,$("Result").$nothing())?e:c(k)?k:h.$result_ndx(n,m,x)))},4),z(f,"$grich_text",function(n,u,m){return e},3),f.$private(),z(f,"$eval_common_command",function(n){try{return n=this.$change_text(n),P(g($("CommonCommand"),"COMMANDS"),"each",[],function m(x){var k,h=null==m.$$s?this:m.$$s;if(null==h.randomizer&&(h.randomizer=e),null==x&&(x=e),k=x.$eval(n,h,h.randomizer),!c(k))return e;r.ret(k)},{$$arity:1,$$s:this}),e}catch(m){if(m===r.returner)return m.$v;throw m}},1),z(f,"$dice_command",function(n){var u=this,m=e,x=e,h=e,k=e,I=e;return c(u.enabled_upcase_input)&&(n=n.$upcase()),m=u.$class().$prefixes_pattern().$match(n),c(m)?(x=m["$[]"](1)["$nil?"]()["$!"](),c(x)&&(n=n["$[]"](Q(1,-1,!1))),h=u.$eval_game_system_specific_command(n),c(h["$is_a?"]($("Result")))?(k=[c(I=h["$secret?"]())?I:x],P(h,"secret=",H(k)),F(k.length,1),h):c(h["$nil?"]())||c(h["$empty?"]())||j(h,"1")?e:P($("Result").$new(),"tap",[],function(s){return null==s&&(s=e),k=[h.$to_s()],P(s,"text=",H(k)),F(k.length,1),P(s,"secret=",H(k=[x])),k[F(k.length,1)]},1)):e},1),z(f,"$eval_game_system_specific_command",function(n){return e},1),z(f,"$result_ndx",function(n,u,m){return c(m["$is_a?"]($("String")))?e:c(n.$send(u,m))?$("Result").$success(this.$translate("success")):$("Result").$failure(this.$translate("failure"))},3),z(f,"$result_1d100",function(n,u,m,x){return e},4),z(f,"$result_1d20",function(n,u,m,x){return e},4),z(f,"$result_nd10",function(n,u,m,x,h){return e},5),z(f,"$result_2d6",function(n,u,m,x,h){return e},5),z(f,"$result_nd6",function(n,u,m,x,h){return e},5),z(f,"$get_table_by_2d6",function(n){return this.$get_table_by_nD6(n,2)},1),z(f,"$get_table_by_1d6",function(n){return this.$get_table_by_nD6(n,1)},1),z(f,"$get_table_by_nD6",function(n,u){return this.$get_table_by_nDx(n,u,6)},2),z(f,"$get_table_by_nDx",function(n,u,m){var h,k=e;return h=this.randomizer.$roll_sum(u,m),k=this.$get_table_value(n["$[]"](F(h,u))),c(k["$nil?"]())?["1",0]:[k,h]},3),z(f,"$get_table_by_1d3",function(n){var x,h,u=this,k=e;return u.$debug("get_table_by_1d3"),x=u.randomizer.$roll_sum(1,6),u.$debug("num",x),h=U(F(x,1),2).$to_i(),u.$debug("index",h),k=n["$[]"](h),c(k["$nil?"]())?["1",0]:[k,x]},1),z(f,"$get_table_by_d66_swap",function(n){var m;return m=this.randomizer.$roll_d66(g($("D66SortType"),"ASC")),[this.$get_table_by_number(m,n),m]},1),z(f,"$get_table_by_d66",function(n){var m,x,h,I,k=e;return m=this.randomizer.$roll_once(6),x=this.randomizer.$roll_once(6),h=S(C(F(m,1),6),F(x,1)),k=n["$[]"](h),I=""+m+x,c(k["$nil?"]())?["1",I]:[k,I]},1),z(f,"$get_table_by_number",function(n,u,m){try{return null==m&&(m="1"),P(u,"each",[],function h(k){var G,I=null==h.$$s?this:h.$$s;if(null==k&&(k=e),G=k["$[]"](0),!c(o(G,n)))return e;r.ret(I.$get_table_value(k["$[]"](1)))},{$$arity:1,$$s:this}),this.$get_table_value(m)}catch(h){if(h===r.returner)return h.$v;throw h}},-3),z(f,"$get_table_value",function(n){return c(n["$is_a?"]($("Proc")))?n.$call():n},1),z(f,"$roll_tables",function(n,u){var x=e;return x=u["$[]"](n),c(x)?x.$roll(this.randomizer).$to_s():e},2),z(f,"$debug",function(n,u){var x,h=this,k=e,I=e;return x=r.slice.call(arguments,1),c(h.debug)?(k=c(n["$is_a?"]($("String")))?n:n.$inspect(),c(x["$empty?"]())?h.$warn(k):(I=P(x,"map",[],function(s){return null==s&&(s=e),c(s["$is_a?"]($("String")))?'"'+s+'"':s.$inspect()},1),h.$warn(k+": "+I.$join(", ")))):e},-2),g(g(v("I18n"),"Backend"),"Simple").$include(g(g(v("I18n"),"Backend"),"Fallbacks")),v("I18n").$load_path()["$<<"](v("Dir")["$[]"](v("File").$join("bcdice","../../i18n/**/*.yml"))),_=["ja_jp"],P(v("I18n"),"default_locale=",H(_)),F(_.length,1),_=[["ja_jp"]],P(v("I18n").$fallbacks(),"defaults=",H(_)),_[F(_.length,1)]},Opal.queue(function(r){var _,b,$,a,i,n,p,y,B,t=[],v=r.nil,e=r.$$$,g=r.module,E=r.klass,A=r.const_set,c=r.hash2,z=r.truthy,Y=r.eqeq,S=r.send,P=r.rb_plus,H=r.rb_times,F=r.to_a,L=r.rb_minus,j=r.def,Q=r.not,U=r.rb_le,C=r.rb_ge;return r.top.$require("bcdice/base"),_=t,b=B=[g(t[0],"BCDice")].concat(_),p=[g(B[0],"GameSystem")].concat(b),y=r.$r(p),$=p,i=[a=E(p[0],y("Base"),"SamsaraBallad")].concat($),n=r.$r(i),a.$$prototype.randomizer=v,A(i[0],"ID","SamsaraBallad"),A(i[0],"NAME","\u30b5\u30f3\u30b5\u30fc\u30e9\u30fb\u30d0\u30e9\u30c3\u30c9"),A(i[0],"SORT_KEY","\u3055\u3093\u3055\u3042\u3089\u306f\u3089\u3064\u3068"),A(i[0],"HELP_MESSAGE","SB\t \u901a\u5e38\u306eD100\u30ed\u30fc\u30eb\u3092\u884c\u3046\nSBS\t \u30b9\u30ef\u30c3\u30d7\u30ed\u30fc\u30eb\u3067D100\u30ed\u30fc\u30eb\u3092\u884c\u3046\nSB#x@y\t F\u5024\u3092x\u3001C\u5024\u3092y\u3068\u3057\u3066\u901a\u5e38\u306eD100\u30ed\u30fc\u30eb\u3092\u884c\u3046\nSBS#x@y\t F\u5024\u3092x\u3001C\u5024\u3092y\u3068\u3057\u3066\u30b9\u30ef\u30c3\u30d7\u30ed\u30fc\u30eb\u3067D100\u30ed\u30fc\u30eb\u3092\u884c\u3046\n\n\u4f8b\uff1a\nSB<=85 \u901a\u5e38\u306e\u6280\u80fd\u3067\u6210\u529f\u738785%\u306e\u5224\u5b9a\nSBS<=70 \u7fd2\u719f\u3092\u5f97\u305f\u6280\u80fd\u3067\u6210\u529f\u738770%\u306e\u5224\u5b9a\nSBS#3@7<=80 \u7fd2\u719f\u3092\u5f97\u305f\u6280\u80fd\u3067\u3001F\u50243\u3001C\u50247\u3067\u6210\u529f\u738780%\u306e\u653b\u6483\u5224\u5b9a\nSB<57 \u901a\u5e38\u306e\u6280\u80fd\u3067\u3001\u80fd\u52d5\u5074\u306e\u9054\u6210\u5024\u304c57\u306e\u53d7\u52d5\u5224\u5b9a\nSBS<70 \u7fd2\u719f\u3092\u5f97\u305f\u6280\u80fd\u3067\u3001\u80fd\u52d5\u5074\u306e\u9054\u6210\u5024\u304c70\u306e\u53d7\u52d5\u5224\u5b9a\n"),a.$register_prefix("SBS?"),j(a,"$eval_game_system_specific_command",function(x){var h=this,I=v,G=v,s=v,Z=v,w=v,O=v,ie=v,ne=v,ue=v,K=v;return h.$debug("eval_game_system_specific_command Begin"),I=e(n("Command"),"Parser").$new("SBS","SB",c(["round_type"],{round_type:h.$round_type()})).$enable_critical().$enable_fumble().$restrict_cmp_op_to(v,"<=","<").$parse(x),z(I)?(Y(I.$command(),"SB")?(G=v,s=h.randomizer.$roll_once(100)):(G=(Z=h.randomizer.$roll_once(10))+","+(w=h.randomizer.$roll_once(10)),O=S([Z,w],"map",[],function(V){return null==V&&(V=v),Y(V,10)?0:V},1).$sort(),s=P(H(O["$[]"](0),10),O["$[]"](1)),Y(s,0)&&(s=100)),ie=h.$compare(s,I),ne=z(ie["$failure?"]())?"\u5931\u6557":z(ie["$success?"]())?"\u6210\u529f":v,ue=z(ie["$fumble?"]())?"\u30d5\u30a1\u30f3\u30d6\u30eb":z(ie["$critical?"]())?"\u30af\u30ea\u30c6\u30a3\u30ab\u30eb":v,K=[["(D100"+I.$cmp_op()+I.$target_number()+")",G,s.$to_s(),ne,ue].$compact().$join(" \uff1e ")],S(ie,"text=",F(K)),L(K.length,1),ie):v},1),a.$private(),j(a,"$compare",function(x,h){var k=this;return z(["<=","<"]["$include?"](h.$cmp_op()))?Q(x.$send(h.$cmp_op(),h.$target_number()))?n("Result").$failure(v):z(k["$fumble_?"](x,h.$fumble()))?S(n("Result").$new(),"tap",[],function(G){var s=v;return null==G&&(G=v),S(G,"success=",F(s=[!0])),L(s.length,1),S(G,"fumble=",F(s=[!0])),s[L(s.length,1)]},1):z(k["$critical_?"](x,h.$critical()))?n("Result").$critical(v):n("Result").$success(v):z(k["$fumble_?"](x,h.$fumble()))?S(n("Result").$new(),"tap",[],function(G){var s;return null==G&&(G=v),S(G,"fumble=",F(s=[!0])),s[L(s.length,1)]},1):z(k["$critical_?"](x,h.$critical()))?S(n("Result").$new(),"tap",[],function(G){var s;return null==G&&(G=v),S(G,"critical=",F(s=[!0])),s[L(s.length,1)]},1):n("Result").$new()},2),j(a,"$fumble_?",function(x,h){var k;return z(k=h)?U(x["$%"](10),h):k},2),j(a,"$critical_?",function(x,h){var k;return z(k=h)?C(x["$%"](10),h):k},2)})}}]);