(self.webpackChunkudonarium_lily=self.webpackChunkudonarium_lily||[]).push([[7973],{7973:function(Xe,Je,Ze){var e,Q,K,p,_,f,C,o,i,d,O,x,T,r,m,$,U,c,W,H,t,L,n;Ze(4656),Opal.modules["bcdice/arithmetic_evaluator"]=function(e){var H,I,x,k,K,Q,l,L,X=[],T=e.nil,r=e.$$$,m=e.$$,$=e.module,U=e.hash2,c=e.truthy;return H=X,I=L=[$(X[0],"BCDice")].concat(H),l=[Q=$(L[0],"ArithmeticEvaluator")].concat(I),x=e.get_singleton_class(Q),K=[x].concat(l),void e.def(x,"$eval",k=function(Y,M){var p,d=T;if(null==M)M=U([],{});else if(!M.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(p=M.$$smap.round_type)&&(p=r(m(K,"RoundType"),"FLOOR")),c(Y)&&c(d=m(K,"Arithmetic").$eval(Y,p))?d:0},k.$$arity=-2)},Opal.modules["i18n/backend/fallbacks"]=function(e){function j(L,n){return"number"==typeof L&&"number"==typeof n?L-n:L["$-"](n)}var n,l,K,k,Z,I,Q,T=[],r=e.nil,m=e.$$$,$=e.$$,U=e.module,c=e.truthy,W=e.send,H=e.send2,t=e.hash2;return n=T,Q=[I=U(T[0],"I18n")].concat(n),e.class_variable_set(Q[0],"@@fallbacks",r),l=e.get_singleton_class(I),Z=[l].concat(Q),e.def(l,"$fallbacks",K=function(){var Y,i,p;return e.class_variable_set(Z[1],"@@fallbacks",c(p=null==(Y=Z[1].$$cvars["@@fallbacks"])?r:Y)?p:m(m($(Z,"I18n"),"Locale"),"Fallbacks").$new()),c(i=$(Z,"Thread").$current()["$[]"]("i18n_fallbacks"))?i:null==(Y=Z[1].$$cvars["@@fallbacks"])?r:Y},K.$$arity=0),e.def(l,"$fallbacks=",k=function(Y){var M,i;return e.class_variable_set(Z[1],"@@fallbacks",c(Y["$is_a?"]($(Z,"Array")))?m(m($(Z,"I18n"),"Locale"),"Fallbacks").$new(Y):Y),i=["i18n_fallbacks",null==(M=Z[1].$$cvars["@@fallbacks"])?r:M],W($(Z,"Thread").$current(),"[]=",e.to_a(i)),i[j(i.length,1)]},k.$$arity=1),void function(l,x){var K=[U(l,"Backend")].concat(x);!function(k,O){var p,i,d,_,Y=U(k,"Fallbacks"),M=[Y].concat(O);e.def(Y,"$translate",p=function(C,o,u){try{var b,N=p.$$p,D=this,y=r,g=r,E=r,R=r,P=r,s=r;for(N&&(p.$$p=null),P=0,s=arguments.length,R=new Array(s);P<s;P++)R[P]=arguments[P];return null==u&&(u=$(M,"EMPTY_HASH")),!c(u.$fetch("fallback",!0))||c(u["$[]"]("fallback_in_progress"))?H(D,e.find_super_dispatcher(D,"translate",p,!1,!0),"translate",R,N):(c(u["$[]"]("default"))&&(y=D["$extract_non_symbol_default!"](u)),g=u.$merge(t(["fallback_in_progress"],{fallback_in_progress:!0})),W($(M,"I18n").$fallbacks()["$[]"](C),"each",[],((b=function(S){var A,w=null==b.$$s?this:b.$$s;null==S&&(S=r);try{return W(w,"catch",["exception"],((A=function(){var ve=null==A.$$s?this:A.$$s,ge=r;if(ge=H(ve,e.find_iter_super_dispatcher(ve,"translate",A.$$def||b.$$def||p,!1,!1),"translate",[S,o,g],null),c(ge["$nil?"]()))return r;c(C.$to_s()["$!="](S.$to_s()))&&ve.$on_fallback(C,S,o,u),e.ret(ge)}).$$s=w,A.$$arity=0,A))}catch(ce){if(!e.rescue(ce,[m($(M,"I18n"),"InvalidLocale")]))throw ce;try{return r}finally{e.pop_exception()}}}).$$s=D,b.$$arity=1,b)),c(c(E=u["$key?"]("default"))?u["$[]"]("default")["$nil?"]():E)?r:c(y)?H(D,e.find_super_dispatcher(D,"translate",p,!1,!0),"translate",[C,r,u.$merge(t(["default"],{default:y}))],null):D.$throw("exception",m($(M,"I18n"),"MissingTranslation").$new(C,o,u)))}catch(h){if(h===e.returner)return h.$v;throw h}},p.$$arity=-3),e.def(Y,"$extract_non_symbol_default!",i=function(C){var o,N,b=r,J=r;return b=[C["$[]"]("default")].$flatten(),N=W(b,"detect",[],((o=function(y){return null==y&&(y=r),y["$is_a?"]($(M,"Symbol"))["$!"]()}).$$s=this,o.$$arity=1,o)),c(N)&&(J=["default",b["$[]"](0,b.$index(N))],W(C,"[]=",e.to_a(J)),j(J.length,1)),N},i.$$arity=1),e.def(Y,"$exists?",d=function(C,o,u){try{var b,N=d.$$p,D=this,y=r,g=r,E=r;for(N&&(d.$$p=null),g=0,E=arguments.length,y=new Array(E);g<E;g++)y[g]=arguments[g];return null==u&&(u=$(M,"EMPTY_HASH")),c(u.$fetch("fallback",!0))?(W($(M,"I18n").$fallbacks()["$[]"](C),"each",[],((b=function(P){var s=null==b.$$s?this:b.$$s;null==P&&(P=r);try{if(!c(H(s,e.find_iter_super_dispatcher(s,"exists?",b.$$def||d,!1,!1),"exists?",[P,o],null)))return r;e.ret(!0)}catch(h){if(!e.rescue(h,[m($(M,"I18n"),"InvalidLocale")]))throw h;try{return r}finally{e.pop_exception()}}}).$$s=D,b.$$arity=1,b)),!1):H(D,e.find_super_dispatcher(D,"exists?",d,!1,!0),"exists?",y,N)}catch(R){if(R===e.returner)return R.$v;throw R}},d.$$arity=-3),Y.$private(),e.def(Y,"$on_fallback",_=function(C,o,u,b){return r},_.$$arity=4)}(K[0],K)}(Q[0],Q)},Opal.modules["bcdice/randomizer"]=function(e){function j(l,x){return"number"==typeof l&&"number"==typeof x?l>x:l["$>"](x)}function X(l,x){return"number"==typeof l&&"number"==typeof x?l+x:l["$+"](x)}function T(l,x){return"number"==typeof l&&"number"==typeof x?l<=x:l["$<="](x)}function r(l,x){return"number"==typeof l&&"number"==typeof x?l-x:l["$-"](x)}function m(l,x){return"number"==typeof l&&"number"==typeof x?l*x:l["$*"](x)}var x,Y,i,d,_,f,C,o,u,b,N,J,D,M,p,K,c=[],W=e.nil,H=e.$$$,t=e.$$,n=e.klass,I=e.truthy,Q=e.send;return x=c,Y=K=[(0,e.module)(c[0],"BCDice")].concat(x),M=n(K[0],null,"Randomizer"),p=[M].concat(Y),M.$$prototype.rand_results=M.$$prototype.detailed_rand_results=W,e.const_set(p[0],"UPPER_LIMIT_DICE_TIMES",200),e.const_set(p[0],"UPPER_LIMIT_DICE_SIDES",1e3),e.const_set(p[0],"UPPER_LIMIT_RANDS",1e4),e.def(M,"$initialize",i=function(){return this.rand_results=[],this.detailed_rand_results=[]},i.$$arity=0),M.$attr_reader("rand_results"),M.$attr_reader("detailed_rand_results"),e.const_set(p[0],"DetailedRandResult",t(p,"Struct").$new("kind","sides","value")),e.def(M,"$roll_barabara",d=function(g,E){var R,s,P=this;return I(j(X(P.rand_results.$size(),g),t(p,"UPPER_LIMIT_RANDS")))&&P.$raise(t(p,"TooManyRandsError")),I(I(s=T(g,0))?s:j(g,t(p,"UPPER_LIMIT_DICE_TIMES")))?[]:Q(t(p,"Array"),"new",[g],((R=function(){return(null==R.$$s?this:R.$$s).$roll_once(E)}).$$s=P,R.$$arity=0,R))},d.$$arity=2),e.def(M,"$roll_sum",_=function(g,E){return this.$roll_barabara(g,E).$sum()},_.$$arity=2),e.def(M,"$roll_once",f=function(g){var R,P=W;return I(I(R=T(g,0))?R:j(g,t(p,"UPPER_LIMIT_DICE_SIDES")))?0:(P=this.$rand_inner(g),this.$push_to_detail("normal",g,P),P)},f.$$arity=1),e.def(M,"$roll_index",C=function(g){return r(this.$roll_once(g),1)},C.$$arity=1),e.def(M,"$roll_tens_d10",o=function(){var R,E=W;return(E=this.$rand_inner(10))["$=="](10)&&(E=0),R=m(E,10),this.$push_to_detail("tens_d10",10,R),R},o.$$arity=0),e.def(M,"$roll_d9",u=function(){var E;return E=r(this.$rand_inner(10),1),this.$push_to_detail("d9",10,E),E},u.$$arity=0),e.def(M,"$roll_d66",b=function(g){var E,s,P=W;return P=Q(t(p,"Array"),"new",[2],((E=function(){return(null==E.$$s?this:E.$$s).$roll_once(6)}).$$s=this,E.$$arity=0,E)),s=g,H(t(p,"D66SortType"),"ASC")["$==="](s)?P["$sort!"]():H(t(p,"D66SortType"),"DESC")["$==="](s)&&P["$sort!"]()["$reverse!"](),X(m(P["$[]"](0),10),P["$[]"](1))},b.$$arity=1),M.$private(),e.def(M,"$rand_inner",N=function(g){var R,E=this;return I(function(l,x){return"number"==typeof l&&"number"==typeof x?l>=x:l["$>="](x)}(E.rand_results.$size(),t(p,"UPPER_LIMIT_RANDS")))&&E.$raise(t(p,"TooManyRandsError")),R=E.$random(g),E.rand_results["$<<"]([R,g]),R},N.$$arity=1),e.def(M,"$random",J=function(g){return X(t(p,"Kernel").$rand(g),1)},J.$$arity=1),e.def(M,"$push_to_detail",D=function(g,E,R){var s;return s=t(p,"DetailedRandResult").$new(g,E,R),this.detailed_rand_results.$push(s)},D.$$arity=3),void function(k,O,Y){[n(k,O,"TooManyRandsError")].concat(Y)}(K[0],t(K,"StandardError"),K)},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var H,I,K,Y,M,p,i,k,O,l,L,X=[],T=e.nil,m=e.$$,$=e.module,U=e.klass,c=e.truthy;return H=X,I=L=[$(X[0],"BCDice")].concat(H),K=l=[$(L[0],"DiceTable")].concat(I),k=U(l[0],null,"RollResult"),O=[k].concat(K),k.$$prototype.table_name=k.$$prototype.value=k.$$prototype.body=T,e.def(k,"$initialize",Y=function(_,f,C){var o=this;return o.table_name=_,o.value=f,o.body=C},Y.$$arity=3),k.$attr_reader("table_name"),k.$attr_reader("value"),k.$attr_reader("body"),e.def(k,"$to_s",M=function(){var _=this;return _.table_name+"("+_.value+") \uff1e "+_.body},M.$$arity=0),e.def(k,"$last_body",p=function(){var _=this;return c(_.body["$is_a?"](m(O,"RollResult")))?_.body.$last_body():_.body},p.$$arity=0),void e.def(k,"$empty?",i=function(){return!1},i.$$arity=0)},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var t,Q,k,M,p,O,Y,x,n,T=[],r=e.nil,$=e.$$,U=e.module,c=e.klass,W=e.truthy;return t=T,Q=n=[U(T[0],"BCDice")].concat(t),k=x=[U(n[0],"DiceTable")].concat(Q),O=c(x[0],null,"ChainTable"),Y=[O].concat(k),O.$$prototype.times=O.$$prototype.sides=O.$$prototype.items=O.$$prototype.name=r,e.def(O,"$initialize",M=function(d,_,f){var C=this,o=r;return C.name=d,C.items=f.$freeze(),o=/(\d+)D(\d+)/i.$match(_),W(o)||C.$raise($(Y,"ArgumentError"),"Unexpected table type: "+_),C.times=o["$[]"](1).$to_i(),C.sides=o["$[]"](2).$to_i()},M.$$arity=3),void e.def(O,"$roll",p=function(d){var f,C,_=this,o=r;return C=function(H,t){return"number"==typeof H&&"number"==typeof t?H-t:H["$-"](t)}(f=d.$roll_sum(_.times,_.sides),_.times),o=_.items["$[]"](C),W(o["$respond_to?"]("roll"))&&(o=o.$roll(d)),$(Y,"RollResult").$new(_.name,f,o)},p.$$arity=1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){function T(L,n){return"number"==typeof L&&"number"==typeof n?L-n:L["$-"](n)}var n,x,Y,i,d,_,M,p,K,Q,m=[],$=e.nil,c=e.$$,W=e.module,H=e.klass,t=e.hash2;return n=m,x=Q=[W(m[0],"BCDice")].concat(n),Y=K=[W(Q[0],"DiceTable")].concat(x),M=H(K[0],null,"D66GridTable"),p=[M].concat(Y),M.$$prototype.name=M.$$prototype.items=$,e.defs(M,"$from_i18n",i=function(C,o){var b=$;return b=c(p,"I18n").$t(C,t(["locale","raise"],{locale:o,raise:!0})),this.$new(b["$[]"]("name"),b["$[]"]("items"))},i.$$arity=2),e.def(M,"$initialize",d=function(C,o){return this.name=C,this.items=o.$freeze()},d.$$arity=2),void e.def(M,"$roll",_=function(C){var u,b,N,J,D;return u=C.$roll_once(6),b=C.$roll_once(6),N=function(L,n){return"number"==typeof L&&"number"==typeof n?L+n:L["$+"](n)}(function(L,n){return"number"==typeof L?10*L:L["$*"](10)}(u),b),J=T(u,1),D=T(b,1),c(p,"RollResult").$new(this.name,N,this.items["$[]"](J)["$[]"](D))},_.$$arity=1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var H,I,K,Y,M,k,O,l,L,X=[],T=e.nil,m=e.$$,$=e.module,U=e.klass,c=e.hash2;return e.top.$require("bcdice/dice_table/d66_grid_table"),H=X,I=L=[$(X[0],"BCDice")].concat(H),K=l=[$(L[0],"DiceTable")].concat(I),k=U(l[0],m(l,"D66GridTable"),"D66HalfGridTable"),O=[k].concat(K),e.defs(k,"$from_i18n",Y=function(i,d){var f=T;return f=m(O,"I18n").$t(i,c(["locale","raise"],{locale:d,raise:!0})),this.$new(f["$[]"]("name"),f["$[]"]("items_1_2_3"),f["$[]"]("items_4_5_6"))},Y.$$arity=2),void e.def(k,"$initialize",M=function(i,d,_){return this.name=i,this.items=[d,d,d,_,_,_].$freeze()},M.$$arity=3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var H,I,K,Y,M,k,O,l,L,X=[],T=e.nil,m=e.$$,$=e.module,U=e.klass,c=e.hash2;return e.top.$require("bcdice/dice_table/d66_grid_table"),H=X,I=L=[$(X[0],"BCDice")].concat(H),K=l=[$(L[0],"DiceTable")].concat(I),k=U(l[0],m(l,"D66GridTable"),"D66OneThirdTable"),O=[k].concat(K),e.defs(k,"$from_i18n",Y=function(i,d){var f=T;return f=m(O,"I18n").$t(i,c(["locale","raise"],{locale:d,raise:!0})),this.$new(f["$[]"]("name"),f["$[]"]("items_1_2"),f["$[]"]("items_3_4"),f["$[]"]("items_5_6"))},Y.$$arity=2),void e.def(k,"$initialize",M=function(i,d,_,f){return this.name=i,this.items=[d,d,_,_,f,f].$freeze()},M.$$arity=4)},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var n,x,Y,i,d,_,f,M,p,K,Q,r=[],m=e.nil,$=e.$$$,U=e.$$,c=e.module,W=e.klass,H=e.hash2,t=e.truthy;return n=r,x=Q=[c(r[0],"BCDice")].concat(n),Y=K=[c(Q[0],"DiceTable")].concat(x),M=W(K[0],null,"D66Table"),p=[M].concat(Y),M.$$prototype.sort_type=M.$$prototype.items=M.$$prototype.name=m,e.defs(M,"$from_i18n",i=function(o,u){var J,N=m;return N=U(p,"I18n").$t(o,H(["locale"],{locale:u})),J=U(p,"D66SortType").$const_get(N["$[]"]("d66_sort_type")),this.$new(N["$[]"]("name"),J,N["$[]"]("items"))},i.$$arity=2),e.def(M,"$initialize",d=function(o,u,b){var N=this;return N.name=o,N.sort_type=u,N.items=b.$freeze()},d.$$arity=3),e.def(M,"$roll",_=function(o){var N,y,u=this,b=m,J=m,D=m;return b=o.$roll_barabara(2,6),N=u.sort_type,$(U(p,"D66SortType"),"ASC")["$==="](N)?b["$sort!"]():$(U(p,"D66SortType"),"DESC")["$==="](N)&&b["$sort!"]()["$reverse!"](),J=function(L,n){return"number"==typeof L&&"number"==typeof n?L+n:L["$+"](n)}(function(L,n){return"number"==typeof L?10*L:L["$*"](10)}(b["$[]"](0)),b["$[]"](1)),D=t(y=u.items["$[]"](J))?y:u.items["$[]"](J.$to_s()),t(D["$respond_to?"]("roll"))&&(D=D.$roll(o)),U(p,"RollResult").$new(u.name,J,D)},_.$$arity=1),void e.def(M,"$choice",f=function(o){return U(p,"RollResult").$new(this.name,o,this.items["$[]"](o))},f.$$arity=1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){function j(I,Q){return"number"==typeof I&&"number"==typeof Q?I+Q:I["$+"](Q)}var Q,p,_,i,K,O,x,m=[],$=e.nil,c=e.$$,W=e.module,H=e.klass,t=e.hash2,L=e.send,n=e.send2;return e.top.$require("bcdice/dice_table/d66_table"),Q=m,K=x=[W(m[0],"BCDice")].concat(Q),p=O=[W(x[0],"DiceTable")].concat(K),[i=H(O[0],c(O,"D66Table"),"D66LeftRangeTable")].concat(p),void e.def(i,"$initialize",_=function(C,o,u){var b,y,D=this;return _.$$p&&(_.$$p=null),y=t([],{}),L(u,"each",[],((b=function(g){function E(R){return g.apply(this,arguments)}return E.toString=function(){return g.toString()},E}(function(g){var R,s,S,E=null==b.$$s?this:b.$$s;return null==g&&(g=$),R=e.to_ary(g),S=null==R[1]?$:R[1],L(null==R[0]?$:R[0],"each",[],((s=function(A){var ve;return null==A&&(A=$),L(S,"each_with_index",[],((ve=function(Ce,Re){var Pe,be,I;return null==Ce&&(Ce=$),null==Re&&(Re=$),Pe=j("number"==typeof(I=A)?10*I:I["$*"](10),j(Re,1)),L(y,"[]=",e.to_a(be=[Pe,Ce])),be[function(I,Q){return"number"==typeof I?I-1:I["$-"](1)}(be.length)]}).$$s=null==s.$$s?this:s.$$s,ve.$$arity=2,ve))}).$$s=E,s.$$arity=1,s))})).$$s=D,b.$$arity=1,b)),n(D,e.find_super_dispatcher(D,"initialize",_,!1,!0),"initialize",[C,o,y],null)},_.$$arity=3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var n,x,Y,i,d,M,p,K,Q,m=[],$=e.nil,c=e.$$,W=e.module,H=e.klass,t=e.truthy;return n=m,x=Q=[W(m[0],"BCDice")].concat(n),Y=K=[W(Q[0],"DiceTable")].concat(x),M=H(K[0],null,"D66ParityTable"),p=[M].concat(Y),M.$$prototype.odd=M.$$prototype.even=M.$$prototype.name=$,e.def(M,"$initialize",i=function(f,C,o){var u=this;return u.name=f,u.odd=C.$freeze(),u.even=o.$freeze()},i.$$arity=3),void e.def(M,"$roll",d=function(f){var u,N,J,C=this,o=$;return o=f.$roll_once(6),u=f.$roll_once(6),N=(t(o["$odd?"]())?C.odd:C.even)["$[]"](function(L,n){return"number"==typeof L?L-1:L["$-"](1)}(u)),J=function(L,n){return"number"==typeof L&&"number"==typeof n?L+n:L["$+"](n)}(function(L,n){return"number"==typeof L?10*L:L["$*"](10)}(o),u),c(p,"RollResult").$new(C.name,J,N)},d.$$arity=1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var L,l,O,p,i,Y,M,Z,I,r=[],m=e.nil,U=e.$$,c=e.module,W=e.klass,H=e.send;return L=r,l=I=[c(r[0],"BCDice")].concat(L),O=Z=[c(I[0],"DiceTable")].concat(l),Y=W(Z[0],null,"D66RangeTable"),M=[Y].concat(O),Y.$$prototype.items=Y.$$prototype.name=m,e.def(Y,"$initialize",p=function(_,f){return this.name=_,this.items=f.$freeze()},p.$$arity=2),void e.def(Y,"$roll",i=function(_){var f,o,u,b,C=this,N=m;return o=_.$roll_once(6),u=_.$roll_once(6),b=function(t,L){return"number"==typeof t&&"number"==typeof L?t+L:t["$+"](L)}(function(t,L){return"number"==typeof t?10*t:t["$*"](10)}(o),u),N=H(C.items,"find",[],((f=function(D){return null==D&&(D=m),D["$[]"](0)["$include?"](b)}).$$s=C,f.$$arity=1,f)),U(M,"RollResult").$new(C.name,b,N["$[]"](1))},i.$$arity=1)},Opal.modules["bcdice/dice_table/range_table"]=function(e){var I,Z,M,d,_,f,C,o,u,b,N,J,p,i,k,l,m=[],$=e.nil,c=e.$$,W=e.module,H=e.klass,t=e.send,L=e.truthy;return I=m,Z=l=[W(m[0],"BCDice")].concat(I),M=k=[W(l[0],"DiceTable")].concat(Z),p=H(k[0],null,"RangeTable"),i=[p].concat(M),p.$$prototype.name=p.$$prototype.items=p.$$prototype.num_of_dice=p.$$prototype.num_of_sides=p.$$prototype.formatter=$,e.const_set(i[0],"RollResult",t(c(i,"Struct"),"new",["sum","values","content","formatted"],((d=function(){return(null==d.$$s?this:d.$$s).$alias_method("to_s","formatted")}).$$s=p,d.$$arity=0,d))),e.const_set(i[0],"Item",c(i,"Struct").$new("range","content")),e.const_set(i[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),e.const_set(i[0],"DEFAULT_FORMATTER",t(p,"lambda",[],($$2=function(D){function y(g,E){return D.apply(this,arguments)}return y.toString=function(){return D.toString()},y}(function(D,y){return null==$$2.$$s||$$2,null==D&&(D=$),null==y&&(y=$),D.$name()+"("+y.$sum()+") \uff1e "+y.$content()}),$$2.$$s=p,$$2.$$arity=2,$$2))),p.$attr_reader("name"),p.$attr_reader("num_of_dice"),p.$attr_reader("num_of_sides"),e.def(p,"$initialize",_=function(y,g,E){var h,R=_.$$p,P=R||$,s=this,S=$;return R&&(_.$$p=null),R&&(_.$$p=null),s.name=y.$freeze(),s.formatter=L(h=P)?h:c(i,"DEFAULT_FORMATTER"),S=c(i,"DICE_ROLL_METHOD_RE").$match(g),L(S)||s.$raise(c(i,"ArgumentError"),s.name+": invalid dice roll method: "+g),s.num_of_dice=S["$[]"](1).$to_i(),s.num_of_sides=S["$[]"](2).$to_i(),s.$store(E)},_.$$arity=3),e.def(p,"$fetch",f=function(y){var g,R,E=this;return R=t(E.items,"find",[],((g=function(s){return null==s&&(s=$),s.$range()["$include?"](y)}).$$s=E,g.$$arity=1,g)),L(R)||E.$raise(c(i,"RangeError"),E.name+": value is out of range: "+y),R},f.$$arity=1),e.def(p,"$roll",C=function(y){var R,P,s,g=this,E=$;return R=(E=y.$roll_barabara(g.num_of_dice,g.num_of_sides)).$sum(),P=c(i,"RollResult").$new(R,E,g.$fetch(R).$content()),s=[g.formatter["$[]"](g,P)],t(P,"formatted=",e.to_a(s)),function(n,I){"number"==typeof n||n["$-"](1)}(s.length),P},C.$$arity=1),p.$private(),e.def(p,"$store",o=function(y){var g,E,R,s,h,P=this;return s=t(y,"map",[],((g=function(w,A){return null==w&&(w=$),null==A&&(A=$),[(null==g.$$s?this:g.$$s).$coerce_to_int_range(w),A]}).$$s=P,g.$$arity=2,g)),h=t(s,"sort_by",[],((E=function(w,A){return null==w&&(w=$),null==A&&(A=$),w.$min()}).$$s=P,E.$$arity=2,E)),P.$assert_min_sum_is_covered(h),P.$assert_max_sum_is_covered(h),P.$assert_no_gap_or_overlap_in_ranges(h),P.items=t(h,"map",[],(R=function(w,A){return null==w&&(w=$),null==A&&(A=$),c(i,"Item").$new(w,A.$freeze()).$freeze()},R.$$s=P,R.$$arity=2,R)).$freeze(),P},o.$$arity=1),e.def(p,"$coerce_to_int_range",u=function(y){var E,R=$;return E=y,c(i,"Integer")["$==="](E)?c(i,"Range").$new(y,y):c(i,"Range")["$==="](E)&&L(L(R=y.$begin()["$is_a?"](c(i,"Integer")))?y.$end()["$is_a?"](c(i,"Integer")):R)?y:this.$raise(c(i,"TypeError"),this.name+": "+y+" ("+y.$class()+") must be an Integer or a Range with Integers ")},u.$$arity=1),e.def(p,"$assert_min_sum_is_covered",b=function(y){var E,g=this,R=$;return E=g.num_of_dice,R=y.$first()["$[]"](0),L(R["$include?"](E))||g.$raise(c(i,"RangeError"),g.name+": min value ("+E+") is not covered: "+R),g},b.$$arity=1),e.def(p,"$assert_max_sum_is_covered",N=function(y){var E,g=this,R=$;return E=function(n,I){return"number"==typeof n&&"number"==typeof I?n*I:n["$*"](I)}(g.num_of_dice,g.num_of_sides),R=y.$last()["$[]"](0),L(R["$include?"](E))||g.$raise(c(i,"RangeError"),g.name+": max value ("+E+") is not covered: "+R),g},N.$$arity=1),void e.def(p,"$assert_no_gap_or_overlap_in_ranges",J=function(y){var g;return t(y,"each_cons",[2],((g=function(P,s){var A,ce,h=null==g.$$s?this:g.$$s,S=$,w=$;return null==h.name&&(h.name=$),null==P&&(P=$),null==s&&(s=$),S=P["$[]"](0),w=s["$[]"](0),ce=function(n,I){return"number"==typeof n?n+1:n["$+"](1)}(A=S.$max()),L(w["$include?"](A))&&h.$raise(c(i,"RangeError"),h.name+": Range overlap: "+S+" and "+w),L(w["$include?"](ce))?$:h.$raise(c(i,"RangeError"),h.name+": Range gap: "+S+" and "+w)}).$$s=this,g.$$arity=2,g)),this},J.$$arity=1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var t,Q,k,i,f,C,o,d,_,Y,x,n,T=[],r=e.nil,m=e.$$$,$=e.$$,U=e.module,c=e.klass,W=e.send;return t=T,Q=n=[U(T[0],"BCDice")].concat(t),k=x=[U(n[0],"DiceTable")].concat(Q),i=Y=[c(x[0],null,"SaiFicSkillTable")].concat(k),d=c(Y[0],null,"Category"),_=[d].concat(i),d.$$prototype.name=r,e.def(d,"$initialize",f=function(b,N,J,D){var y,g=this;return g.name=b,g.skills=W(N.$map(),"with_index",[2],((y=function(E){function R(P,s){return E.apply(this,arguments)}return R.toString=function(){return E.toString()},R}(function(E,R){return null==E&&(E=r),null==R&&(R=r),m($(_,"SaiFicSkillTable"),"Skill").$new(b,E,J,R,D)})).$$s=g,y.$$arity=2,y)),g.dice=J},f.$$arity=4),e.def(d,"$roll",C=function(b){return this.$skills()["$[]"](function(H,t){return"number"==typeof H?H-2:H["$-"](2)}(b.$roll_sum(2,6)))},C.$$arity=1),e.def(d,"$to_s",o=function(){return this.name},o.$$arity=0),void d.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var H,I,p,_,f,i,K,O,l,L,X=[],T=e.nil,$=e.module,U=e.klass,c=e.hash2;return H=X,I=L=[$(X[0],"BCDice")].concat(H),K=l=[$(L[0],"DiceTable")].concat(I),p=O=[U(l[0],null,"SaiFicSkillTable")].concat(K),[i=U(O[0],null,"Skill")].concat(p),i.$$prototype.s_format=i.$$prototype.category_dice=i.$$prototype.row_dice=i.$$prototype.category_name=i.$$prototype.name=T,e.def(i,"$initialize",_=function(o,u,b,N,J){var D=this;return D.category_name=o,D.name=u,D.category_dice=b,D.row_dice=N,D.s_format=J},_.$$arity=5),e.def(i,"$to_s",f=function(){var o=this;return o.$format(o.s_format,c(["category_dice","row_dice","category_name","skill_name"],{category_dice:o.category_dice,row_dice:o.row_dice,category_name:o.category_name,skill_name:o.name}))},f.$$arity=0),void i.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var Q,K,p,_,f,C,o,u,b,N,i,d,O,x,T=e.top,r=[],m=e.nil,$=e.$$$,U=e.$$,c=e.module,W=e.klass,H=e.hash2,t=e.send,n=e.truthy;return T.$require("bcdice/dice_table/sai_fic_skill_table/category"),T.$require("bcdice/dice_table/sai_fic_skill_table/skill"),Q=r,K=x=[c(r[0],"BCDice")].concat(Q),p=O=[c(x[0],"DiceTable")].concat(K),i=W(O[0],null,"SaiFicSkillTable"),d=[i].concat(p),i.$$prototype.rtt=i.$$prototype.rtt_format=i.$$prototype.rct=i.$$prototype.rct_format=i.$$prototype.rttn=i.$$prototype.rttn_format=i.$$prototype.categories=m,e.defs(i,"$from_i18n",_=function(D,y,g){var E,R,P,s,A,w=m;if(null==g)g=H([],{});else if(!g.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(E=g.$$smap.rtt)&&(E=m),null==(R=g.$$smap.rct)&&(R=m),null==(P=g.$$smap.rttn)&&(P=m),A=(w=U(d,"I18n").$t("RTT",H(["locale","raise","default"],{locale:y,raise:!1,default:H([],{})})).$merge(U(d,"I18n").$t(D,H(["locale","raise"],{locale:y,raise:!0}))))["$[]"]("items"),w=t(w,"select",[],((s=function(ce){function ve(ge,Ce){return ce.apply(this,arguments)}return ve.toString=function(){return ce.toString()},ve}(function(ce,ve){return null==ce&&(ce=m),null==ve&&(ve=m),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](ce)})).$$s=this,s.$$arity=2,s)),this.$new(A,e.to_hash(w).$merge(H(["rtt","rct","rttn"],{rtt:E,rct:R,rttn:P})))},_.$$arity=-3),e.const_set(d[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),e.const_set(d[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),e.const_set(d[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),e.const_set(d[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),e.def(i,"$initialize",f=function(D,y){var g,E,R,P,s,h,S,w,A=this;if(null==y)y=H([],{});else if(!y.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(g=y.$$smap.rtt)&&(g=m),null==(E=y.$$smap.rct)&&(E=m),null==(R=y.$$smap.rttn)&&(R=m),null==(P=y.$$smap.rtt_format)&&(P=U(d,"DEFAULT_RTT")),null==(s=y.$$smap.rct_format)&&(s=U(d,"DEFAULT_RCT")),null==(h=y.$$smap.rttn_format)&&(h=U(d,"DEFAULT_RTTN")),null==(S=y.$$smap.s_format)&&(S=U(d,"DEFAULT_S")),A.categories=t(D.$map(),"with_index",[1],((w=function(ve,ge){var Re,Pe,be;return null==ve&&(ve=m),null==ge&&(ge=m),Pe=null==(Re=e.to_ary(ve))[0]?m:Re[0],be=null==Re[1]?m:Re[1],$(U(d,"SaiFicSkillTable"),"Category").$new(Pe,be,ge,S)}).$$s=A,w.$$arity=2,w.$$has_top_level_mlhs_arg=!0,w)),A.rtt=g,A.rct=E,A.rttn=R.$to_a(),A.rtt_format=P,A.rct_format=s,A.rttn_format=h},f.$$arity=-2),e.const_set(d[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),i.$attr_reader("categories"),e.def(i,"$roll_command",C=function(D,y){var E,g=this,R=m,P=m,s=m;return n(["RTT",g.rtt]["$include?"](E=y))?g.$format_skill(g.rtt_format,g.$roll_skill(D)):n(["RCT",g.rct]["$include?"](E))?(R=g.$roll_category(D),g.$format(g.rct_format,H(["category_dice","category_name"],{category_dice:R.$dice(),category_name:R.$name()}))):n(n(P=s=U(d,"RTTN").$index(E))?P:s=g.rttn.$index(E))?g.$format_skill(g.rttn_format,g.categories["$[]"](s).$roll(D)):m},C.$$arity=2),e.def(i,"$roll_category",o=function(D){return this.categories["$[]"]("number"==typeof(I=D.$roll_once(6))?I-1:I["$-"](1));var I},o.$$arity=1),e.def(i,"$roll_skill",u=function(D){return this.$roll_category(D).$roll(D)},u.$$arity=1),e.def(i,"$prefixes",b=function(){var D=this;return function(I,Q){return"number"==typeof I&&"number"==typeof Q?I+Q:I["$+"](Q)}(["RTT[1-6]?","RCT",D.rtt,D.rct],D.rttn).$compact()},b.$$arity=0),i.$private(),void e.def(i,"$format_skill",N=function(D,y){return this.$format(D,H(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:y.$category_dice(),row_dice:y.$row_dice(),category_name:y.$category_name(),skill_name:y.$name(),text:y.$to_s()}))},N.$$arity=2)},Opal.modules["bcdice/dice_table/table"]=function(e){var L,l,O,p,i,d,_,Y,M,Z,I,T=[],r=e.nil,$=e.$$,U=e.module,c=e.klass,W=e.hash2,H=e.truthy;return L=T,l=I=[U(T[0],"BCDice")].concat(L),O=Z=[U(I[0],"DiceTable")].concat(l),Y=c(Z[0],null,"Table"),M=[Y].concat(O),Y.$$prototype.times=Y.$$prototype.sides=Y.$$prototype.name=Y.$$prototype.items=r,e.defs(Y,"$from_i18n",p=function(C,o){var b=r;return b=$(M,"I18n").$t(C,W(["locale"],{locale:o})),this.$new(b["$[]"]("name"),b["$[]"]("type"),b["$[]"]("items"))},p.$$arity=2),e.def(Y,"$initialize",i=function(C,o,u){var b=this,N=r;return b.name=C,b.items=u.$freeze(),N=/(\d+)D(\d+)/i.$match(o),H(N)||b.$raise($(M,"ArgumentError"),"Unexpected table type: "+o),b.times=N["$[]"](1).$to_i(),b.sides=N["$[]"](2).$to_i()},i.$$arity=3),e.def(Y,"$roll",d=function(C){var u,o=this;return u=C.$roll_sum(o.times,o.sides),o.$choice(u)},d.$$arity=1),void e.def(Y,"$choice",_=function(C){var u,o=this;return u=function(t,L){return"number"==typeof t&&"number"==typeof L?t-L:t["$-"](L)}(C,o.times),$(M,"RollResult").$new(o.name,C,o.items["$[]"](u))},_.$$arity=1)},Opal.modules["bcdice/dice_table"]=function(e){var j=e.top;return j.$require("bcdice/dice_table/roll_result"),j.$require("bcdice/dice_table/chain_table"),j.$require("bcdice/dice_table/d66_grid_table"),j.$require("bcdice/dice_table/d66_half_grid_table"),j.$require("bcdice/dice_table/d66_one_third_table"),j.$require("bcdice/dice_table/d66_left_range_table"),j.$require("bcdice/dice_table/d66_parity_table"),j.$require("bcdice/dice_table/d66_range_table"),j.$require("bcdice/dice_table/d66_table"),j.$require("bcdice/dice_table/range_table"),j.$require("bcdice/dice_table/sai_fic_skill_table"),j.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var c,L,I,H,X=[],$=e.module;return c=X,L=H=[$(X[0],"BCDice")].concat(c),I=[$(H[0],"D66SortType")].concat(L),e.const_set(I[0],"NO_SORT","no_sort"),e.const_set(I[0],"ASC","asc"),e.const_set(I[0],"DESC","desc"),void function(t,L){var I=[$(t,"RoundType")].concat(L);e.const_set(I[0],"CEIL","ceil"),e.const_set(I[0],"FLOOR","floor"),e.const_set(I[0],"ROUND","round")}(H[0],H)},Opal.modules["bcdice/translate"]=function(e){var H,I,x,Q,l,L,X=[],T=e.nil,m=e.$$,$=e.module,U=e.hash2;return H=X,I=L=[$(X[0],"BCDice")].concat(H),Q=$(L[0],"Translate"),l=[Q].concat(I),void e.def(Q,"$translate",x=function(K,k){var O,Y=this;if(null==Y.locale&&(Y.locale=T),null==k)k=U([],{});else if(!k.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return O=e.kwrestargs(k,{}),m(l,"I18n").$translate(K,U(["locale","raise"],{locale:Y.locale,raise:!0}).$merge(e.to_hash(O)))},x.$$arity=-2)},Opal.modules["bcdice/result"]=function(e){function j(H,t){return"number"==typeof H&&"number"==typeof t?H-t:H["$-"](t)}var t,d,C,o,u,b,N,l,K,k,O,Y,M,p,i,x,Z,n,T=[],r=e.nil,c=e.klass,W=e.send;return t=T,l=n=[(0,e.module)(T[0],"BCDice")].concat(t),Z=[x=c(n[0],null,"Result")].concat(l),x.$$prototype.secret=x.$$prototype.success=x.$$prototype.failure=x.$$prototype.critical=x.$$prototype.fumble=r,[d=e.get_singleton_class(x)].concat(Z),e.def(d,"$success",C=function(D){var y;return W(this.$new(),"tap",[],((y=function(E){function R(P){return E.apply(this,arguments)}return R.toString=function(){return E.toString()},R}(function(E){var P=r;return null==E&&(E=r),W(E,"text=",e.to_a(P=[D])),j(P.length,1),W(E,"success=",e.to_a(P=[!0])),P[j(P.length,1)]})).$$s=this,y.$$arity=1,y))},C.$$arity=1),e.def(d,"$failure",o=function(D){var y;return W(this.$new(),"tap",[],((y=function(R){var s=r;return null==R&&(R=r),W(R,"text=",e.to_a(s=[D])),j(s.length,1),W(R,"failure=",e.to_a(s=[!0])),s[j(s.length,1)]}).$$s=this,y.$$arity=1,y))},o.$$arity=1),e.def(d,"$critical",u=function(D){var y;return W(this.$new(),"tap",[],((y=function(R){var s=r;return null==R&&(R=r),W(R,"text=",e.to_a(s=[D])),j(s.length,1),W(R,"critical=",e.to_a(s=[!0])),j(s.length,1),W(R,"success=",e.to_a(s=[!0])),s[j(s.length,1)]}).$$s=this,y.$$arity=1,y))},u.$$arity=1),e.def(d,"$fumble",b=function(D){var y;return W(this.$new(),"tap",[],((y=function(R){var s=r;return null==R&&(R=r),W(R,"text=",e.to_a(s=[D])),j(s.length,1),W(R,"fumble=",e.to_a(s=[!0])),j(s.length,1),W(R,"failure=",e.to_a(s=[!0])),s[j(s.length,1)]}).$$s=this,y.$$arity=1,y))},b.$$arity=1),e.def(d,"$nothing",N=function(){return"nothing"},N.$$arity=0),e.def(x,"$initialize",K=function(_){var f=this;return null==_&&(_=r),f.text=_,f.rands=r,f.detailed_rands=r,f.secret=!1,f.success=!1,f.failure=!1,f.critical=!1,f.fumble=!1},K.$$arity=-1),x.$attr_accessor("text","rands","detailed_rands"),x.$attr_writer("secret","success","failure","critical","fumble"),e.def(x,"$secret?",k=function(){return this.secret},k.$$arity=0),e.def(x,"$success?",O=function(){return this.success},O.$$arity=0),e.def(x,"$failure?",Y=function(){return this.failure},Y.$$arity=0),e.def(x,"$critical?",M=function(){return this.critical},M.$$arity=0),e.def(x,"$fumble?",p=function(){return this.fumble},p.$$arity=0),void e.def(x,"$condition=",i=function(_){return this.success=_,this.failure=_["$!"]()},i.$$arity=1)},Opal.modules["racc/parser"]=function(e){function j(K,k){return"number"==typeof K&&"number"==typeof k?K<k:K["$<"](k)}function X(K,k){return"number"==typeof K&&"number"==typeof k?K-k:K["$-"](k)}function T(K,k){return"number"==typeof K&&"number"==typeof k?K+k:K["$+"](k)}function r(K,k){return"number"==typeof K&&"number"==typeof k?K>=k:K["$>="](k)}function m(K,k){return"number"==typeof K&&"number"==typeof k?K>k:K["$>"](k)}function $(K,k){return"number"==typeof K&&"number"==typeof k?K<=k:K["$<="](k)}var M,p,i,k,Y,H=[],t=e.nil,L=e.$$$,n=e.$$,I=e.module,Q=e.klass,l=e.truthy,x=e.gvars,Z=e.send;return k=H,M=(Y=[I(H[0],"Racc")].concat(k))[0],p=n(Y,"StandardError"),i=Y,[Q(M,p,"ParseError")].concat(i),l(L("::","ParseError","skip_raise")?"constant":t)||e.const_set(H[0],"ParseError",L(n(H,"Racc"),"ParseError")),function(K,k){var d,C,o,u,b,N,J,D,y,g,E,R,P,s,h,S,w,A,ce,ve,ge,Ce,Re,ze,Pe,_,f,Y=[I(K,"Racc")].concat(k);l(n(Y,"Racc_No_Extensions","skip_raise")?"constant":t)||e.const_set(Y[0],"Racc_No_Extensions",!1),d=Y,_=Q(Y[0],null,"Parser"),f=[_].concat(d),_.$$prototype.yydebug=_.$$prototype.racc_debug_out=_.$$prototype.racc_error_status=_.$$prototype.racc_t=_.$$prototype.racc_vstack=_.$$prototype.racc_val=_.$$prototype.racc_state=_.$$prototype.racc_tstack=t,e.const_set(f[0],"Racc_Runtime_Version","1.4.6"),e.const_set(f[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),e.const_set(f[0],"Racc_Runtime_Core_Version_R","1.4.6"),e.const_set(f[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),e.const_set(f[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),e.const_set(f[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),e.const_set(f[0],"Racc_Runtime_Core_Version",n(f,"Racc_Runtime_Core_Version_R")),e.const_set(f[0],"Racc_Runtime_Core_Revision",n(f,"Racc_Runtime_Core_Revision_R")),e.const_set(f[0],"Racc_Runtime_Type","ruby"),e.defs(n(f,"Parser"),"$racc_runtime_type",C=function(){return n(f,"Racc_Runtime_Type")},C.$$arity=0),e.def(_,"$_racc_setup",o=function(){var re,te,a=this,V=t,G=t,q=t;return null==x.stderr&&(x.stderr=t),l(L(a.$class(),"Racc_debug_parser"))||(a.yydebug=!1),l(null!=(re=a.yydebug)&&re!==t?"instance-variable":t)||(a.yydebug=!1),l(a.yydebug)&&(l(null!=(te=a.racc_debug_out)&&te!==t?"instance-variable":t)||(a.racc_debug_out=x.stderr),a.racc_debug_out=l(V=a.racc_debug_out)?V:x.stderr),G=L(a.$class(),"Racc_arg"),l(j(G.$size(),14))&&(Z(G,"[]=",e.to_a(q=[13,!0])),X(q.length,1)),G},o.$$arity=0),e.def(_,"$_racc_init_sysvars",u=function(){var re=this;return re.racc_state=[0],re.racc_tstack=[],re.racc_vstack=[],re.racc_t=t,re.racc_val=t,re.racc_read_next=!0,re.racc_user_yyerror=!1,re.racc_error_status=0},u.$$arity=0),e.def(_,"$do_parse",b=function(){return this.$__send__(n(f,"Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},b.$$arity=0),e.def(_,"$next_token",N=function(){return this.$raise(n(f,"NotImplementedError"),this.$class()+"#next_token is not defined")},N.$$arity=0),e.def(_,"$_racc_do_parse_rb",J=function(re,te){var a,G,q=this,$e=t,ae=t,fe=t,Se=t,le=t,he=t,Te=t,me=t;return a=e.to_ary(re),$e=null==a[0]?t:a[0],ae=null==a[1]?t:a[1],fe=null==a[2]?t:a[2],Se=null==a[3]?t:a[3],le=null==a[10]?t:a[10],q.$_racc_init_sysvars(),he=Te=me=t,Z(q,"catch",["racc_end_parse"],((G=function(){var Le,Ke,ye=null==G.$$s?this:G.$$s,qe=t,Ue=t,We=t;for(null==ye.racc_state&&(ye.racc_state=t),null==ye.racc_read_next&&(ye.racc_read_next=t),null==ye.racc_t&&(ye.racc_t=t),null==ye.yydebug&&(ye.yydebug=t),null==ye.racc_val&&(ye.racc_val=t);l(!0);)for(l(me=Se["$[]"](ye.racc_state["$[]"](-1)))?(l(ye.racc_read_next)&&l(ye.racc_t["$!="](0))&&(Ke=ye.$next_token(),Le=e.to_ary(Ke),he=null==Le[0]?t:Le[0],ye.racc_val=null==Le[1]?t:Le[1],ye.racc_t=l(he)?l(qe=le["$[]"](he))?qe:1:0,l(ye.yydebug)&&ye.$racc_read_token(ye.racc_t,he,ye.racc_val),ye.racc_read_next=!1),me=T(me,ye.racc_t),l(l(Ue=l(We=r(me,0))?Te=$e["$[]"](me):We)?ae["$[]"](me)["$=="](ye.racc_state["$[]"](-1)):Ue)||(Te=fe["$[]"](ye.racc_state["$[]"](-1)))):Te=fe["$[]"](ye.racc_state["$[]"](-1));l(Te=ye.$_racc_evalact(Te,re)););}).$$s=q,G.$$arity=0,G))},J.$$arity=2),e.def(_,"$yyparse",D=function(re,te){return this.$__send__(n(f,"Racc_YY_Parse_Method"),re,te,this.$_racc_setup(),!0)},D.$$arity=2),e.def(_,"$_racc_yyparse_rb",y=function(re,te,a,V){var G,$e,fe=t,Se=t,oe=t,le=t,Te=t,me=t,De=t;return G=e.to_ary(a),fe=null==G[0]?t:G[0],Se=null==G[1]?t:G[1],oe=null==G[2]?t:G[2],le=null==G[3]?t:G[3],Te=null==G[10]?t:G[10],this.$_racc_init_sysvars(),me=t,De=t,Z(this,"catch",["racc_end_parse"],(($e=function(){var qe,Ae=null==$e.$$s?this:$e.$$s;for(null==Ae.racc_state&&(Ae.racc_state=t);!l(De=le["$[]"](Ae.racc_state["$[]"](-1)));)for(;l(me=Ae.$_racc_evalact(oe["$[]"](Ae.racc_state["$[]"](-1)),a)););return Z(re,"__send__",[te],((qe=function(We,Ie){var se,xe,Ne=null==qe.$$s?this:qe.$$s,ke=t,ee=t,F=t,de=t,ne=t,v=t,ie=t;for(null==Ne.racc_t&&(Ne.racc_t=t),null==Ne.racc_state&&(Ne.racc_state=t),null==Ne.racc_read_next&&(Ne.racc_read_next=t),null==We&&(We=t),null==Ie&&(Ie=t),Ne.racc_t=l(We)?l(ke=Te["$[]"](We))?ke:1:0,Ne.racc_val=Ie,Ne.racc_read_next=!1,De=T(De,Ne.racc_t),l(l(se=l(xe=r(De,0))?me=fe["$[]"](De):xe)?Se["$[]"](De)["$=="](Ne.racc_state["$[]"](-1)):se)||(me=oe["$[]"](Ne.racc_state["$[]"](-1)));l(me=Ne.$_racc_evalact(me,a)););for(;l(l(ee=l(F=(De=le["$[]"](Ne.racc_state["$[]"](-1)))["$!"]())?F:Ne.racc_read_next["$!"]())?ee:Ne.racc_t["$=="](0));)for(l(l(de=l(ne=l(v=l(ie=De)?De=T(De,Ne.racc_t):ie)?r(De,0):v)?me=fe["$[]"](De):ne)?Se["$[]"](De)["$=="](Ne.racc_state["$[]"](-1)):de)||(me=oe["$[]"](Ne.racc_state["$[]"](-1)));l(me=Ne.$_racc_evalact(me,a)););}).$$s=Ae,qe.$$arity=2,qe))}).$$s=this,$e.$$arity=0,$e))},y.$$arity=4),e.def(_,"$_racc_evalact",g=function(re,te){var a,G,oe,he,q=this,$e=t,ae=t,Se=t,le=t,Te=t,me=t,De=t,ye=t,Ae=t,Le=t;if($e=null==(a=e.to_ary(te))[0]?t:a[0],ae=null==a[1]?t:a[1],Se=null==a[3]?t:a[3],oe=null==a[11]?t:a[11],le=null==a[12]?t:a[12],l(l(he=m(re,0))?j(re,oe):he))l(m(q.racc_error_status,0))&&(q.racc_t["$=="](1)||(q.racc_error_status=X(q.racc_error_status,1))),q.racc_vstack.$push(q.racc_val),q.racc_state.$push(re),q.racc_read_next=!0,l(q.yydebug)&&(q.racc_tstack.$push(q.racc_t),q.$racc_shift(q.racc_t,q.racc_tstack,q.racc_vstack));else if(l(l(Te=j(re,0))?m(re,le["$-@"]()):Te)){if(me=Z(q,"catch",["racc_jump"],((G=function(){var qe=null==G.$$s?this:G.$$s;return null==qe.racc_state&&(qe.racc_state=t),qe.racc_state.$push(qe.$_racc_do_reduce(te,re)),!1}).$$s=q,G.$$arity=0,G)),l(me)){if(1["$==="](De=me))return q.racc_user_yyerror=!0,le["$-@"]();if(2["$==="](De))return oe;q.$raise("[Racc Bug] unknown jump code")}}else if(re["$=="](oe))l(q.yydebug)&&q.$racc_accept(),q.$throw("racc_end_parse",q.racc_vstack["$[]"](0));else{if(re["$=="](le["$-@"]())){for((0)["$==="](De=q.racc_error_status)?l(te["$[]"](21))||q.$on_error(q.racc_t,q.racc_val,q.racc_vstack):3["$==="](De)&&(q.racc_t["$=="](0)&&q.$throw("racc_end_parse",t),q.racc_read_next=!0),q.racc_user_yyerror=!1,q.racc_error_status=3;l(!0)&&(!l(ye=Se["$[]"](q.racc_state["$[]"](-1)))||(ye=T(ye,1),!l(l(Ae=l(Le=r(ye,0))?re=$e["$[]"](ye):Le)?ae["$[]"](ye)["$=="](q.racc_state["$[]"](-1)):Ae)));)l($(q.racc_state.$size(),1))&&q.$throw("racc_end_parse",t),q.racc_state.$pop(),q.racc_vstack.$pop(),l(q.yydebug)&&(q.racc_tstack.$pop(),q.$racc_e_pop(q.racc_state,q.racc_tstack,q.racc_vstack));return re}q.$raise("[Racc Bug] unknown action "+re.$inspect())}return l(q.yydebug)&&q.$racc_next_state(q.racc_state["$[]"](-1),q.racc_state),t},g.$$arity=2),e.def(_,"$_racc_do_reduce",E=function(re,te){var a,oe,he,Le,Ke,qe,Ne,G=this,$e=t,ae=t,fe=t,Se=t,le=t,Te=t,me=t,De=t,ye=t,Ae=t,Ue=t,We=t,Ie=t,He=t,Ge=t,ke=t;return $e=null==(a=e.to_ary(re))[4]?t:a[4],ae=null==a[5]?t:a[5],fe=null==a[6]?t:a[6],Se=null==a[7]?t:a[7],oe=null==a[8]?t:a[8],le=null==a[9]?t:a[9],he=null==a[13]?t:a[13],Te=G.racc_state,me=G.racc_vstack,De=G.racc_tstack,ye=function(K,k){return"number"==typeof K?-3*K:K["$*"](-3)}(te),Ae=le["$[]"](ye),Le=le["$[]"](T(ye,1)),Ke=le["$[]"](T(ye,2)),qe=[],l(G.yydebug)&&(Ue=De["$[]"](Ae["$-@"](),Ae)),We=me["$[]"](Ae["$-@"](),Ae),l(G.yydebug)&&(Ie=[Ae["$-@"](),Ae,qe],Z(De,"[]=",e.to_a(Ie)),X(Ie.length,1)),Ie=[Ae["$-@"](),Ae,qe],Z(me,"[]=",e.to_a(Ie)),X(Ie.length,1),Ie=[Ae["$-@"](),Ae,qe],Z(Te,"[]=",e.to_a(Ie)),X(Ie.length,1),l(he)?me.$push(G.$__send__(Ke,We,me,We["$[]"](0))):me.$push(G.$__send__(Ke,We,me)),De.$push(Le),l(G.yydebug)&&G.$racc_reduce(Ue,Le,De,me),Ne=X(Le,oe),l(ye=Se["$[]"](Ne))&&(ye=T(ye,Te["$[]"](-1)),l(l(He=l(Ge=r(ye,0))?ke=$e["$[]"](ye):Ge)?ae["$[]"](ye)["$=="](Ne):He))?ke:fe["$[]"](Ne)},E.$$arity=2),e.def(_,"$on_error",R=function(re,te,a){var G,V=this;return V.$raise(n(f,"ParseError"),V.$sprintf("\nparse error on value %s (%s)",te.$inspect(),l(G=V.$token_to_str(re))?G:"?"))},R.$$arity=3),e.def(_,"$yyerror",P=function(){return this.$throw("racc_jump",1)},P.$$arity=0),e.def(_,"$yyaccept",s=function(){return this.$throw("racc_jump",2)},s.$$arity=0),e.def(_,"$yyerrok",h=function(){return this.racc_error_status=0},h.$$arity=0),e.def(_,"$racc_read_token",S=function(re,te,a){var V=this;return V.racc_debug_out.$print("read    "),V.racc_debug_out.$print(te.$inspect(),"(",V.$racc_token2str(re),") "),V.racc_debug_out.$puts(a.$inspect()),V.racc_debug_out.$puts()},S.$$arity=3),e.def(_,"$racc_shift",w=function(re,te,a){var V=this;return V.racc_debug_out.$puts("shift   "+V.$racc_token2str(re)),V.$racc_print_stacks(te,a),V.racc_debug_out.$puts()},w.$$arity=3),e.def(_,"$racc_reduce",A=function(re,te,a,V){var G,q=this,$e=t;return($e=q.racc_debug_out).$print("reduce "),l(re["$empty?"]())?$e.$print(" <none>"):Z(re,"each",[],((G=function(fe){return null==fe&&(fe=t),$e.$print(" ",(null==G.$$s?this:G.$$s).$racc_token2str(fe))}).$$s=q,G.$$arity=1,G)),$e.$puts(" --\x3e "+q.$racc_token2str(te)),q.$racc_print_stacks(a,V),q.racc_debug_out.$puts()},A.$$arity=4),e.def(_,"$racc_accept",ce=function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},ce.$$arity=0),e.def(_,"$racc_e_pop",ve=function(re,te,a){var V=this;return V.racc_debug_out.$puts("error recovering mode: pop token"),V.$racc_print_states(re),V.$racc_print_stacks(te,a),V.racc_debug_out.$puts()},ve.$$arity=3),e.def(_,"$racc_next_state",ge=function(re,te){var a=this;return a.racc_debug_out.$puts("goto    "+re),a.$racc_print_states(te),a.racc_debug_out.$puts()},ge.$$arity=2),e.def(_,"$racc_print_stacks",Ce=function(re,te){var a,G=t;return(G=this.racc_debug_out).$print("        ["),Z(re,"each_index",[],((a=function($e){return null==$e&&($e=t),G.$print(" (",(null==a.$$s?this:a.$$s).$racc_token2str(re["$[]"]($e))," ",te["$[]"]($e).$inspect(),")")}).$$s=this,a.$$arity=1,a)),G.$puts(" ]")},Ce.$$arity=2),e.def(_,"$racc_print_states",Re=function(re){var te,V=t;return(V=this.racc_debug_out).$print("        ["),Z(re,"each",[],((te=function(q){return null==q&&(q=t),V.$print(" ",q)}).$$s=this,te.$$arity=1,te)),V.$puts(" ]")},Re.$$arity=1),e.def(_,"$racc_token2str",ze=function(re){var a;return l(a=L(this.$class(),"Racc_token_to_s_table")["$[]"](re))?a:this.$raise("[Racc Bug] can't convert token "+re+" to string")},ze.$$arity=1),e.def(_,"$token_to_str",Pe=function(re){return L(this.$class(),"Racc_token_to_s_table")["$[]"](re)},Pe.$$arity=1)}(H[0],H)},Opal.modules["bcdice/arithmetic/node"]=function(e){function j(H,t){return"number"==typeof H&&"number"==typeof t?H/t:H["$/"](t)}var t,Q,K,Y,M,p,_,f,C,o,u,b,i,d,O,x,n,T=[],r=e.nil,m=e.$$$,$=e.$$,U=e.module,c=e.klass,W=e.send2;return t=T,Q=n=[U(T[0],"BCDice")].concat(t),K=x=[U(n[0],"Arithmetic")].concat(Q),function(Y,M,p){var _,f,C,o,u,i=c(Y,null,"BinaryOp");[i].concat(p),i.$$prototype.lhs=i.$$prototype.rhs=i.$$prototype.op=r,e.def(i,"$initialize",_=function(N,J,D){var y=this;return y.lhs=N,y.op=J,y.rhs=D},_.$$arity=3),e.def(i,"$eval",f=function(N){var y,J=this,D=r;return D=J.lhs.$eval(N),y=J.rhs.$eval(N),D.$send(J.op,y)},f.$$arity=1),e.def(i,"$output",C=function(){var N=this;return""+N.lhs.$output()+N.op+N.rhs.$output()},C.$$arity=0),e.def(i,"$s_exp",o=function(){var N=this;return"("+N.$op_for_s_exp()+" "+N.lhs.$s_exp()+" "+N.rhs.$s_exp()+")"},o.$$arity=0),e.def(i,"$op_for_s_exp",u=function(){return this.op},u.$$arity=0)}((O=[U(x[0],"Node")].concat(K))[0],0,O),Y=O[0],M=$(O,"BinaryOp"),p=O,i=c(Y,M,"DivideBase"),d=[i].concat(p),i.$$prototype.lhs=i.$$prototype.rhs=i.$$prototype.op=r,e.def(i,"$initialize",_=function(J,D){return _.$$p&&(_.$$p=null),W(this,e.find_super_dispatcher(this,"initialize",_,!1,!0),"initialize",[J,"/",D],null)},_.$$arity=2),e.def(i,"$eval",f=function(J){var y,D=this,g=r;return y=D.lhs.$eval(J),(g=D.rhs.$eval(J))["$=="](0)&&D.$raise($(d,"ZeroDivisionError")),D.$divide_and_round(y,g,J)},f.$$arity=1),e.def(i,"$output",C=function(){var J=C.$$p,y=this,g=r,E=r,R=r;for(J&&(C.$$p=null),E=0,R=arguments.length,g=new Array(R);E<R;E++)g[E]=arguments[E];return""+W(y,e.find_super_dispatcher(y,"output",C,!1,!0),"output",g,J)+y.$rounding_method()},C.$$arity=0),i.$private(),e.def(i,"$rounding_method",o=function(){return m(this.$class(),"ROUNDING_METHOD")},o.$$arity=0),e.def(i,"$op_for_s_exp",u=function(){return""+this.op+this.$rounding_method()},u.$$arity=0),e.def(i,"$divide_and_round",b=function(J,D,y){return this.$raise($(d,"NotImplementedError"))},b.$$arity=3),function(Y,M,p){var _,i=c(Y,M,"DivideWithGameSystemDefault"),d=[i].concat(p);e.const_set(d[0],"ROUNDING_METHOD",""),i.$private(),e.def(i,"$divide_and_round",_=function(C,o,u){var N;return N=u,m($(d,"RoundType"),"CEIL")["$==="](N)?j(C.$to_f(),o).$ceil():m($(d,"RoundType"),"ROUND")["$==="](N)?j(C.$to_f(),o).$round():j(C,o).$to_i()},_.$$arity=3)}(O[0],$(O,"DivideBase"),O),function(Y,M,p){var _,i=c(Y,M,"DivideWithCeil"),d=[i].concat(p);e.const_set(d[0],"ROUNDING_METHOD","C"),i.$private(),e.def(i,"$divide_and_round",_=function(C,o,u){return j(C.$to_f(),o).$ceil()},_.$$arity=3)}(O[0],$(O,"DivideBase"),O),function(Y,M,p){var _,i=c(Y,M,"DivideWithRound"),d=[i].concat(p);e.const_set(d[0],"ROUNDING_METHOD","R"),i.$private(),e.def(i,"$divide_and_round",_=function(C,o,u){return j(C.$to_f(),o).$round()},_.$$arity=3)}(O[0],$(O,"DivideBase"),O),function(Y,M,p){var _,i=c(Y,M,"DivideWithFloor"),d=[i].concat(p);e.const_set(d[0],"ROUNDING_METHOD","F"),i.$private(),e.def(i,"$divide_and_round",_=function(C,o,u){return j(C,o).$to_i()},_.$$arity=3)}(O[0],$(O,"DivideBase"),O),function(Y,M,p){var _,f,C,o,i=c(Y,null,"Negative");[i].concat(p),i.$$prototype.body=r,e.def(i,"$initialize",_=function(b){return this.body=b},_.$$arity=1),e.def(i,"$eval",f=function(b){return this.body.$eval(b)["$-@"]()},f.$$arity=1),e.def(i,"$output",C=function(){return"-"+this.body.$output()},C.$$arity=0),e.def(i,"$s_exp",o=function(){return"(- "+this.body.$s_exp()+")"},o.$$arity=0)}(O[0],0,O),function(Y,M,p){var _,f,C,o,i=c(Y,null,"Parenthesis");[i].concat(p),i.$$prototype.expr=r,e.def(i,"$initialize",_=function(b){return this.expr=b},_.$$arity=1),e.def(i,"$eval",f=function(b){return this.expr.$eval(b)},f.$$arity=1),e.def(i,"$output",C=function(){return"("+this.expr.$output()+")"},C.$$arity=0),e.def(i,"$s_exp",o=function(){return"(Parenthesis "+this.expr.$s_exp()+")"},o.$$arity=0)}(O[0],0,O),void function(Y,M,p){var _,f,C,i=c(Y,null,"Number");[i].concat(p),i.$$prototype.value=r,e.def(i,"$initialize",_=function(u){return this.value=u},_.$$arity=1),e.def(i,"$eval",f=function(u){return this.value},f.$$arity=1),e.def(i,"$output",C=function(){return this.value.$to_s()},C.$$arity=0),e.alias(i,"s_exp","output")}(O[0],0,O)},Opal.modules.strscan=function(e){var L,Q,l,x,Z,K,k,O,Y,M,p,i,d,_,f,C,o,u,b,N,J,D,y,g,E,R,n,I,T=[],r=e.nil,$=e.$$,c=e.truthy,W=e.send;return L=T,n=(0,e.klass)(T[0],null,"StringScanner"),I=[n].concat(L),n.$$prototype.pos=n.$$prototype.string=n.$$prototype.working=n.$$prototype.matched=n.$$prototype.prev_pos=n.$$prototype.match=r,n.$attr_reader("pos"),n.$attr_reader("matched"),e.def(n,"$initialize",Q=function(s){var h=this;return h.string=s,h.pos=0,h.matched=r,h.working=s,h.match=[]},Q.$$arity=1),n.$attr_reader("string"),e.def(n,"$beginning_of_line?",l=function(){var s=this;return 0===s.pos||"\n"===s.string.charAt(s.pos-1)},l.$$arity=0),e.alias(n,"bol?","beginning_of_line?"),e.def(n,"$scan",x=function(s){var h=this,S=(s=h.$anchor(s)).exec(h.working);return null==S?h.matched=r:"object"==typeof S?(h.prev_pos=h.pos,h.pos+=S[0].length,h.working=h.working.substring(S[0].length),h.matched=S[0],h.match=S,S[0]):"string"==typeof S?(h.pos+=S.length,h.working=h.working.substring(S.length),S):r},x.$$arity=1),e.def(n,"$scan_until",Z=function(s){var h=this;s=h.$anchor(s);for(var A,S=h.pos,w=h.working;;){if(A=s.exec(w),S+=1,w=w.substr(1),null!=A)return h.matched=h.string.substr(h.pos,S-h.pos-1+A[0].length),h.match=A,h.prev_pos=S-1,h.pos=S,h.working=w.substr(A[0].length),h.matched;if(0===w.length)return h.match=[],h.matched=r}},Z.$$arity=1),e.def(n,"$[]",K=function(s){var S;if(c(this.match["$empty?"]()))return r;S=s,$(I,"Symbol")["$==="](S)?s=s.$to_s():$(I,"String")["$==="](S)||(s=$(I,"Opal")["$coerce_to!"](s,$(I,"Integer"),"to_int"));var w=this.match;return s<0&&(s+=w.length),s<0||s>=w.length||null==w[s]?r:w[s]},K.$$arity=1),e.def(n,"$check",k=function(s){var h=this,S=(s=h.$anchor(s)).exec(h.working);return h.matched=null==S?r:S[0]},k.$$arity=1),e.def(n,"$check_until",O=function(s){var h=this,S=h.prev_pos,w=h.pos,A=h.$scan_until(s);return A!==r&&(h.matched=A.substr(-1),h.working=h.string.substr(w)),h.prev_pos=S,h.pos=w,A},O.$$arity=1),e.def(n,"$peek",Y=function(s){return this.working.substring(0,s)},Y.$$arity=1),e.def(n,"$eos?",M=function(){return 0===this.working.length},M.$$arity=0),e.def(n,"$exist?",p=function(s){var S=s.exec(this.working);return null==S?r:0==S.index?0:S.index+1},p.$$arity=1),e.def(n,"$skip",i=function(s){var h=this,S=(s=h.$anchor(s)).exec(h.working);if(null==S)return h.match=[],h.matched=r;var w=S[0],A=w.length;return h.matched=w,h.match=S,h.prev_pos=h.pos,h.pos+=A,h.working=h.working.substring(A),A},i.$$arity=1),e.def(n,"$skip_until",d=function(s){var S=this.$scan_until(s);return S===r?r:(this.matched=S.substr(-1),S.length)},d.$$arity=1),e.def(n,"$get_byte",_=function(){var s=this,h=r;return s.pos<s.string.length?(s.prev_pos=s.pos,s.pos+=1,h=s.matched=s.working.substring(0,1),s.working=s.working.substring(1)):s.matched=r,h},_.$$arity=0),e.alias(n,"getch","get_byte"),e.def(n,"$match?",f=function(s){var h=this,S=(s=h.$anchor(s)).exec(h.working);return null==S?r:(h.prev_pos=h.pos,S[0].length)},f.$$arity=1),e.def(n,"$pos=",C=function(s){var h=this;return s<0&&(s+=h.string.$length()),h.pos=s,h.working=h.string.slice(s)},C.$$arity=1),e.def(n,"$matched_size",o=function(){return this.matched===r?r:this.matched.length},o.$$arity=0),e.def(n,"$post_match",u=function(){var s=this;return s.matched===r?r:s.string.substr(s.pos)},u.$$arity=0),e.def(n,"$pre_match",b=function(){var s=this;return s.matched===r?r:s.string.substr(0,s.prev_pos)},b.$$arity=0),e.def(n,"$reset",N=function(){var s=this;return s.working=s.string,s.matched=r,s.pos=0},N.$$arity=0),e.def(n,"$rest",J=function(){return this.working},J.$$arity=0),e.def(n,"$rest?",D=function(){return 0!==this.working.length},D.$$arity=0),e.def(n,"$rest_size",y=function(){return this.$rest().$size()},y.$$arity=0),e.def(n,"$terminate",g=function(){var h,s=this;return s.match=r,h=[s.string.$length()],W(s,"pos=",e.to_a(h)),h[function(H,t){return"number"==typeof H?H-1:H["$-"](1)}(h.length)]},g.$$arity=0),e.def(n,"$unscan",E=function(){var s=this;return s.pos=s.prev_pos,s.prev_pos=r,s.match=r,s},E.$$arity=0),n.$private(),e.def(n,"$anchor",R=function(s){var S=s.toString().match(/\/([^\/]+)$/);return S=S?S[1]:void 0,new RegExp("^(?:"+s.source+")",S)},R.$$arity=1),r&&"anchor"},Opal.modules["bcdice/normalize"]=function(e){var L,Q,l,n,c,H,X=[],T=e.nil,$=e.module;return c=X,L=H=[$(X[0],"BCDice")].concat(c),[n=$(H[0],"Normalize")].concat(L),n.$module_function(),e.def(n,"$comparison_operator",Q=function(Z){var k;return/<=|=</["$==="](k=Z)?"<=":/>=|=>/["$==="](k)?">=":/<>|!=|=!/["$==="](k)?"!=":/</["$==="](k)?"<":/>/["$==="](k)?">":/=/["$==="](k)?"==":T},Q.$$arity=1),void e.def(n,"$target_number",l=function(Z){return Z["$=="]("?")?Z:Z.$to_i()},l.$$arity=1)},Opal.modules["bcdice/command/lexer"]=function(e){var L,l,O,p,i,d,Y,M,Z,I,j=e.top,X=[],T=e.nil,m=e.$$,$=e.module,U=e.klass,c=e.hash2,W=e.truthy,H=e.send;return j.$require("strscan"),j.$require("bcdice/normalize"),L=X,l=I=[$(X[0],"BCDice")].concat(L),O=Z=[$(I[0],"Command")].concat(l),Y=U(Z[0],null,"Lexer"),M=[Y].concat(O),Y.$$prototype.scanner=Y.$$prototype.notations=T,e.const_set(M[0],"SYMBOLS",c(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),e.def(Y,"$initialize",p=function(f,C){var o,u,b,J,N=this;return f=W(J=(u=(o=f)===T||null==o?T:H(o,"split",[" ",2]))===T||null==u?T:H(u,"first",[]))?J:"",N.scanner=m(M,"StringScanner").$new(f),N.notations=H(C,"map",[],((b=function(D){function y(g){return D.apply(this,arguments)}return y.toString=function(){return D.toString()},y}(function(D){return null==D&&(D=T),W(D["$is_a?"](m(M,"String")))?m(M,"Regexp").$new(D):D})).$$s=N,b.$$arity=1,b))},p.$$arity=2),e.def(Y,"$next_token",i=function(){try{var f,C=this,o=T,u=T,N=T,J=T;return W(C.scanner["$eos?"]())?[!1,"$"]:(H(C.notations,"each",[],((f=function(y){var E,g=null==f.$$s?this:f.$$s;if(null==g.scanner&&(g.scanner=T),null==y&&(y=T),E=g.scanner.$scan(y),!W(E))return T;e.ret(["NOTATION",E])}).$$s=C,f.$$arity=1,f)),W(o=C.scanner.$scan(/\d+/))?["NUMBER",o.$to_i()]:W(u=C.scanner.$scan(/[<>!=]+/))?(u=m(M,"Normalize").$comparison_operator(u),[W(u)?"CMP_OP":"ILLEGAL",u]):(N=C.scanner.$getch().$upcase(),[W(J=m(M,"SYMBOLS")["$[]"](N))?J:N.$to_sym(),N]))}catch(D){if(D===e.returner)return D.$v;throw D}},i.$$arity=0),void e.def(Y,"$source",d=function(){return this.scanner.$string()},d.$$arity=0)},Opal.modules["bcdice/command/parsed"]=function(e){var H,I,K,Y,M,p,k,O,l,L,X=[],T=e.nil,m=e.$$,$=e.module,U=e.klass,c=e.truthy;return H=X,I=L=[$(X[0],"BCDice")].concat(H),K=l=[$(L[0],"Command")].concat(I),k=U(l[0],null,"Parsed"),O=[k].concat(K),k.$$prototype.question_target=k.$$prototype.critical=k.$$prototype.fumble=k.$$prototype.dollar=k.$$prototype.modify_number=k.$$prototype.target_number=k.$$prototype.prefix_number=k.$$prototype.command=k.$$prototype.suffix_number=k.$$prototype.cmp_op=T,k.$attr_accessor("command"),k.$attr_accessor("prefix_number"),k.$attr_accessor("suffix_number"),k.$attr_accessor("critical"),k.$attr_accessor("fumble"),k.$attr_accessor("dollar"),k.$attr_accessor("modify_number"),k.$attr_accessor("cmp_op"),k.$attr_accessor("target_number"),k.$attr_writer("question_target"),e.def(k,"$initialize",Y=function(){var d=this;return d.prefix_number=T,d.suffix_number=T,d.critical=T,d.fumble=T,d.dollar=T,d.cmp_op=T,d.target_number=T,d.question_target=!1},Y.$$arity=0),e.def(k,"$question_target?",M=function(){return this.question_target},M.$$arity=0),void e.def(k,"$to_s",p=function(d){var N,_=this,f=T,C=T,o=T,u=T,b=T;return null==d&&(d="after_command"),f=c(_.critical)?"@"+_.critical:T,C=c(_.fumble)?"#"+_.fumble:T,o=c(_.dollar)?"$"+_.dollar:T,u=m(O,"Format").$modifier(_.modify_number),b=c(_.question_target)?"?":_.target_number,"after_command"["$==="](N=d)?[_.prefix_number,_.command,_.suffix_number,f,C,o,u,_.cmp_op,b].$join():"after_modify_number"["$==="](N)?[_.prefix_number,_.command,_.suffix_number,u,f,C,o,_.cmp_op,b].$join():"after_target_number"["$==="](N)?[_.prefix_number,_.command,_.suffix_number,u,_.cmp_op,b,f,C,o].$join():T},p.$$arity=-1)},Opal.modules["bcdice/command/parser"]=function(e){function j(I,Q){return"number"==typeof I&&"number"==typeof Q?I-Q:I["$-"](Q)}var Q,K,Y,M,p,_,f,C,o,u,b,N,J,D,y,g,E,R,P,s,h,S,w,A,ce,ve,ge,Ce,Re,ze,Pe,be,re,te,a,V,G,q,$e,ae,fe,Se,oe,le,he,Te,me,De,ye,Ae,Le,Ke,qe,Ue,We,Ie,Ne,He,Ge,ke,ee,i,d,O,x,X=e.top,T=[],r=e.nil,m=e.$$$,$=e.$$,U=e.klass,c=e.module,W=e.hash2,H=e.send2,t=e.send,L=e.hash,n=e.truthy;return X.$require("racc/parser.rb"),X.$require("bcdice/arithmetic/node"),X.$require("bcdice/command/lexer"),X.$require("bcdice/command/parsed"),function(I,Q,l){[U(I,Q,"Parser")].concat(l)}(m($(T,"BCDice"),"Command"),m($(T,"Racc"),"Parser"),T),Q=T,K=x=[c(T[0],"BCDice")].concat(Q),Y=(O=[c(x[0],"Command")].concat(K))[0],M=m($(O,"Racc"),"Parser"),p=O,i=U(Y,M,"Parser"),d=[i].concat(p),i.$$prototype.notations=i.$$prototype.lexer=i.$$prototype.modifier=i.$$prototype.prefix_number=i.$$prototype.suffix_number=i.$$prototype.need_suffix_number=i.$$prototype.need_prefix_number=i.$$prototype.critical=i.$$prototype.fumble=i.$$prototype.dollar=i.$$prototype.allowed_cmp_op=i.$$prototype.question_target=r,e.def(i,"$initialize",_=function(v,ie){var B,z,_e,Ee,ue=_.$$p,we=this;if(ue&&(_.$$p=null),B=e.slice.call(arguments,0,arguments.length),null==(z=e.extract_kwargs(B)))z=W([],{});else if(!z.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(_e=B,!e.hasOwnProperty.call(z.$$smap,"round_type"))throw e.ArgumentError.$new("missing keyword: round_type");return Ee=z.$$smap.round_type,H(we,e.find_super_dispatcher(we,"initialize",_,!1,!0),"initialize",[],null),we.notations=_e,we.round_type=Ee,we.prefix_number=!1,we.suffix_number=!1,we.need_prefix_number=!1,we.need_suffix_number=!1,we.modifier=!0,we.critical=!1,we.fumble=!1,we.dollar=!1,we.allowed_cmp_op=[r,">=",">","<=","<","==","!="],we.question_target=!1},_.$$arity=-2),e.def(i,"$disable_modifier",f=function(){return this.modifier=!1,this},f.$$arity=0),e.def(i,"$enable_prefix_number",C=function(){return this.prefix_number=!0,this},C.$$arity=0),e.def(i,"$enable_suffix_number",o=function(){return this.suffix_number=!0,this},o.$$arity=0),e.def(i,"$has_prefix_number",u=function(){var v=this;return v.prefix_number=!0,v.need_prefix_number=!0,v},u.$$arity=0),e.def(i,"$has_suffix_number",b=function(){var v=this;return v.suffix_number=!0,v.need_suffix_number=!0,v},b.$$arity=0),e.def(i,"$enable_critical",N=function(){return this.critical=!0,this},N.$$arity=0),e.def(i,"$enable_fumble",J=function(){return this.fumble=!0,this},J.$$arity=0),e.def(i,"$enable_dollar",D=function(){return this.dollar=!0,this},D.$$arity=0),e.def(i,"$restrict_cmp_op_to",y=function(v){var ie,z=this;return ie=e.slice.call(arguments,0,arguments.length),z.allowed_cmp_op=ie,z},y.$$arity=-1),e.def(i,"$enable_question_target",g=function(){return this.question_target=!0,this},g.$$arity=0),e.def(i,"$parse",E=function(v){try{return this.lexer=$(d,"Lexer").$new(v,this.notations),this.$do_parse()}catch(B){if(!e.rescue(B,[$(d,"ParseError"),$(d,"ZeroDivisionError")]))throw B;try{return r}finally{e.pop_exception()}}},E.$$arity=1),i.$private(),e.def(i,"$parsed",R=function(v,ie,B,z){var _e;return t($(d,"Parsed").$new(),"tap",[],((_e=function(Be){var Fe,Me,je,Ye,Ve,Qe,we=null==_e.$$s?this:_e.$$s,pe=r;return null==we.round_type&&(we.round_type=r),null==Be&&(Be=r),pe=[v["$[]"]("command")],t(Be,"command=",e.to_a(pe)),j(pe.length,1),pe=[(Fe=v["$[]"]("prefix"),Fe===r||null==Fe?r:t(Fe,"eval",[we.round_type]))],t(Be,"prefix_number=",e.to_a(pe)),j(pe.length,1),pe=[(Me=v["$[]"]("suffix"),Me===r||null==Me?r:t(Me,"eval",[we.round_type]))],t(Be,"suffix_number=",e.to_a(pe)),j(pe.length,1),pe=[(je=ie["$[]"]("critical"),je===r||null==je?r:t(je,"eval",[we.round_type]))],t(Be,"critical=",e.to_a(pe)),j(pe.length,1),pe=[(Ye=ie["$[]"]("fumble"),Ye===r||null==Ye?r:t(Ye,"eval",[we.round_type]))],t(Be,"fumble=",e.to_a(pe)),j(pe.length,1),pe=[(Ve=ie["$[]"]("dollar"),Ve===r||null==Ve?r:t(Ve,"eval",[we.round_type]))],t(Be,"dollar=",e.to_a(pe)),j(pe.length,1),pe=[B.$eval(we.round_type)],t(Be,"modify_number=",e.to_a(pe)),j(pe.length,1),pe=[z["$[]"]("cmp_op")],t(Be,"cmp_op=",e.to_a(pe)),j(pe.length,1),z["$[]"]("target")["$=="]("?")?(t(Be,"question_target=",e.to_a(pe=[!0])),j(pe.length,1),t(Be,"target_number=",e.to_a(pe=[0])),pe[j(pe.length,1)]):(t(Be,"question_target=",e.to_a(pe=[!1])),j(pe.length,1),pe=[(Qe=z["$[]"]("target"),Qe===r||null==Qe?r:t(Qe,"eval",[we.round_type]))],t(Be,"target_number=",e.to_a(pe)),pe[j(pe.length,1)])}).$$s=this,_e.$$arity=1,_e))},R.$$arity=4),e.def(i,"$next_token",P=function(){return this.lexer.$next_token()},P.$$arity=0),Ke=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,33,34,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,r,r,17,18,6,r,5,r,r,17,18,r,r,5,23,24,25,26,56,54,55,57],qe=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,r,17,15,15,18,18,23,r,18,30,30,23,23,24,r,23,31,31,24,24,25,r,24,44,44,25,25,28,r,25,47,47,28,28,29,r,28,48,48,29,29,33,r,29,49,49,33,33,34,r,33,50,50,34,34,36,r,34,r,r,36,36,37,r,36,r,r,37,37,r,r,37,27,27,27,27,52,52,52,52],Ue=[-2,4,16,-3,-1,11,r,33,13,35,23,30,1,r,28,40,r,37,44,r,r,-2,r,51,58,65,0,106,72,79,47,54,r,86,93,r,100,107,r,r,r,r,r,r,63,r,r,68,75,82,89,r,120,r,r,r,r,r],We=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],Ie=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,r,r,21,47,48,40,51,52,49,50,44,46,3,r,r,r,13,r,r,r,r,r,r,r,32],Ne=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,r,r,4,8,8,5,7,7,8,8,9,5,6,r,r,r,6,r,r,r,r,r,r,r,6],He=[r,6,13,3,9,-1,27,-15,-10,-1,-38],Ge=[r,r,r,r,r,r,19,16,15,r,r],ke=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],ee=L(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),e.const_set(d[0],"Racc_arg",[Ke,qe,We,Ue,Ie,Ne,Ge,He,19,ke,ee,58,35,!0]),e.const_set(d[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),e.const_set(d[0],"Racc_debug_parser",!1),e.def(i,"$_reduce_1",s=function(v,ie,B){var z;return n(this.modifier)||this.$raise($(d,"ParseError")),z=e.to_ary(v),this.$parsed(null==z[0]?r:z[0],null==z[1]?r:z[1],null==z[2]?r:z[2],null==z[3]?r:z[3])},s.$$arity=3),e.def(i,"$_reduce_2",h=function(v,ie,B){var z;return n(this.modifier)||this.$raise($(d,"ParseError")),z=e.to_ary(v),this.$parsed(null==z[0]?r:z[0],null==z[2]?r:z[2],null==z[1]?r:z[1],null==z[3]?r:z[3])},h.$$arity=3),e.def(i,"$_reduce_3",S=function(v,ie,B){var z,we;return we=null==(z=e.to_ary(v))[2]?r:z[2],this.$parsed(null==z[0]?r:z[0],null==z[1]?r:z[1],m(m($(d,"Arithmetic"),"Node"),"Number").$new(0),we)},S.$$arity=3),e.def(i,"$_reduce_4",w=function(v,ie,B){var _e,z=this;return n(n(_e=z.prefix_number)?z.suffix_number:_e)||z.$raise($(d,"ParseError")),W(["command","prefix","suffix"],{command:v["$[]"](1),prefix:v["$[]"](0),suffix:v["$[]"](2)})},w.$$arity=3),e.def(i,"$_reduce_5",A=function(v,ie,B){var z=this;return n(z.prefix_number)||z.$raise($(d,"ParseError")),n(z.need_suffix_number)&&z.$raise($(d,"ParseError")),W(["command","prefix"],{command:v["$[]"](1),prefix:v["$[]"](0)})},A.$$arity=3),e.def(i,"$_reduce_6",ce=function(v,ie,B){var z=this;return n(z.suffix_number)||z.$raise($(d,"ParseError")),n(z.need_prefix_number)&&z.$raise($(d,"ParseError")),W(["command","suffix"],{command:v["$[]"](0),suffix:v["$[]"](1)})},ce.$$arity=3),e.def(i,"$_reduce_7",ve=function(v,ie,B){var _e,z=this;return n(n(_e=z.need_prefix_number)?_e:z.need_suffix_number)&&z.$raise($(d,"ParseError")),W(["command"],{command:v["$[]"](0)})},ve.$$arity=3),e.def(i,"$_reduce_8",ge=function(v,ie,B){return W([],{})},ge.$$arity=3),e.def(i,"$_reduce_9",Ce=function(v,ie,B){var z,we,Me,Fe,ue=r;return ue=null==(z=e.to_ary(v))[0]?r:z[0],we=null==z[2]?r:z[2],n(n(Fe=this.critical)?ue["$[]"]("critical")["$nil?"]():Fe)||this.$raise($(d,"ParseError")),t(ue,"[]=",e.to_a(Me=["critical",we])),j(Me.length,1),ue},Ce.$$arity=3),e.def(i,"$_reduce_10",Re=function(v,ie,B){var z,we,Me,Fe,ue=r;return ue=null==(z=e.to_ary(v))[0]?r:z[0],we=null==z[2]?r:z[2],n(n(Fe=this.fumble)?ue["$[]"]("fumble")["$nil?"]():Fe)||this.$raise($(d,"ParseError")),t(ue,"[]=",e.to_a(Me=["fumble",we])),j(Me.length,1),ue},Re.$$arity=3),e.def(i,"$_reduce_11",ze=function(v,ie,B){var z,we,Me,Fe,ue=r;return ue=null==(z=e.to_ary(v))[0]?r:z[0],we=null==z[2]?r:z[2],n(n(Fe=this.dollar)?ue["$[]"]("dollar")["$nil?"]():Fe)||this.$raise($(d,"ParseError")),t(ue,"[]=",e.to_a(Me=["dollar",we])),j(Me.length,1),ue},ze.$$arity=3),e.def(i,"$_reduce_12",Pe=function(v,ie,B){return v["$[]"](1)},Pe.$$arity=3),e.def(i,"$_reduce_13",be=function(v,ie,B){return m(m($(d,"Arithmetic"),"Node"),"Negative").$new(v["$[]"](1))},be.$$arity=3),e.def(i,"$_reduce_14",re=function(v,ie,B){return m(m($(d,"Arithmetic"),"Node"),"BinaryOp").$new(v["$[]"](0),"+",v["$[]"](2))},re.$$arity=3),e.def(i,"$_reduce_15",te=function(v,ie,B){return m(m($(d,"Arithmetic"),"Node"),"BinaryOp").$new(v["$[]"](0),"-",v["$[]"](2))},te.$$arity=3),e.def(i,"$_reduce_16",a=function(v,ie,B){return n(this.allowed_cmp_op["$include?"](r))||this.$raise($(d,"ParseError")),W([],{})},a.$$arity=3),e.def(i,"$_reduce_17",V=function(v,ie,B){var z,ue,Be;return Be=null==(z=e.to_ary(v))[1]?r:z[1],n(this.allowed_cmp_op["$include?"](ue=null==z[0]?r:z[0]))||this.$raise($(d,"ParseError")),W(["cmp_op","target"],{cmp_op:ue,target:Be})},V.$$arity=3),e.def(i,"$_reduce_18",G=function(v,ie,B){var _e,z=this;return _e=v["$[]"](0),n(z.question_target)||z.$raise($(d,"ParseError")),n(z.allowed_cmp_op["$include?"](_e))||z.$raise($(d,"ParseError")),W(["cmp_op","target"],{cmp_op:_e,target:"?"})},G.$$arity=3),e.def(i,"$_reduce_19",q=function(v,ie,B){return m(m($(d,"Arithmetic"),"Node"),"BinaryOp").$new(v["$[]"](0),"+",v["$[]"](2))},q.$$arity=3),e.def(i,"$_reduce_20",$e=function(v,ie,B){return m(m($(d,"Arithmetic"),"Node"),"BinaryOp").$new(v["$[]"](0),"-",v["$[]"](2))},$e.$$arity=3),e.def(i,"$_reduce_22",ae=function(v,ie,B){return m(m($(d,"Arithmetic"),"Node"),"BinaryOp").$new(v["$[]"](0),"*",v["$[]"](2))},ae.$$arity=3),e.def(i,"$_reduce_23",fe=function(v,ie,B){return v["$[]"](3).$new(v["$[]"](0),v["$[]"](2))},fe.$$arity=3),e.def(i,"$_reduce_25",Se=function(v,ie,B){return m(m($(d,"Arithmetic"),"Node"),"DivideWithGameSystemDefault")},Se.$$arity=3),e.def(i,"$_reduce_26",oe=function(v,ie,B){return m(m($(d,"Arithmetic"),"Node"),"DivideWithCeil")},oe.$$arity=3),e.def(i,"$_reduce_27",le=function(v,ie,B){return m(m($(d,"Arithmetic"),"Node"),"DivideWithCeil")},le.$$arity=3),e.def(i,"$_reduce_28",he=function(v,ie,B){return m(m($(d,"Arithmetic"),"Node"),"DivideWithRound")},he.$$arity=3),e.def(i,"$_reduce_29",Te=function(v,ie,B){return m(m($(d,"Arithmetic"),"Node"),"DivideWithFloor")},Te.$$arity=3),e.def(i,"$_reduce_30",me=function(v,ie,B){return v["$[]"](1)},me.$$arity=3),e.def(i,"$_reduce_31",De=function(v,ie,B){return m(m($(d,"Arithmetic"),"Node"),"Negative").$new(v["$[]"](1))},De.$$arity=3),e.def(i,"$_reduce_33",ye=function(v,ie,B){return v["$[]"](1)},ye.$$arity=3),e.def(i,"$_reduce_34",Ae=function(v,ie,B){return m(m($(d,"Arithmetic"),"Node"),"Number").$new(v["$[]"](0))},Ae.$$arity=3),void e.def(i,"$_reduce_none",Le=function(v,ie,B){return v["$[]"](0)},Le.$$arity=3)},Opal.modules["bcdice/deprecated/checker"]=function(e){var H,I,Z,O,Y,M,p,i,d,K,k,l,L,X=[],T=e.nil,m=e.$$,$=e.module,U=e.send,c=e.truthy;return H=X,I=L=[$(X[0],"BCDice")].concat(H),Z=l=[$(L[0],"Deprecated")].concat(I),K=$(l[0],"Checker"),k=[K].concat(Z),K.$private(),e.def(K,"$check_result_legacy",O=function(f,C,o,u){var D,E,b=this,N=T,J=T,y=T,g=T,R=T;return N=U(C,"map",[],"sides".$to_proc()),D=(J=U(C,"map",[],"value".$to_proc())).$sum(),y=[100]["$==="](g=N)?b.$check_1D100(f,D,o,u):[20]["$==="](g)?b.$check_1D20(f,D,o,u):[6,6]["$==="](g)?b.$check_2D6(f,D,J,o,u):T,c(c(E=y["$nil?"]())?E:y["$empty?"]())&&(g=N.$uniq(),y=[10]["$==="](g)?b.$check_nD10(f,D,J,o,u):[6]["$==="](g)?b.$check_nD6(f,D,J,o,u):T,c(c(R=y["$nil?"]())?R:y["$empty?"]()))?T:m(k,"Result").$new(y.$delete_prefix(" \uff1e "))},O.$$arity=4),e.def(K,"$check_1D100",Y=function(f,C,o,u){return T},Y.$$arity=4),e.def(K,"$check_1D20",M=function(f,C,o,u){return T},M.$$arity=4),e.def(K,"$check_nD10",p=function(f,C,o,u,b){return T},p.$$arity=5),e.def(K,"$check_2D6",i=function(f,C,o,u,b){return T},i.$$arity=5),void e.def(K,"$check_nD6",d=function(f,C,o,u,b){return T},d.$$arity=5)},Opal.modules["bcdice/base"]=function(e){function j(x,Z){return"number"==typeof x&&"number"==typeof Z?x+Z:x["$+"](Z)}function X(x,Z){return"number"==typeof x&&"number"==typeof Z?x-Z:x["$-"](Z)}var Z,M,d,_,f,C,o,u,b,N,J,D,y,g,E,R,P,s,h,S,w,A,ce,ve,ge,Ce,Re,ze,Pe,be,re,te,G,q,$e,ae,fe,V,p,i,k,$=e.top,U=[],c=e.nil,W=e.$$$,H=e.$$,t=e.module,L=e.klass,n=e.truthy,I=e.send,Q=e.range,l=c;return $.$require("i18n"),$.$require("i18n/backend/fallbacks"),$.$require("bcdice/randomizer"),$.$require("bcdice/dice_table"),$.$require("bcdice/enum"),$.$require("bcdice/translate"),$.$require("bcdice/result"),$.$require("bcdice/command/parser"),$.$require("bcdice/deprecated/checker"),Z=U,M=k=[t(U[0],"BCDice")].concat(Z),p=L(k[0],null,"Base"),i=[p].concat(M),p.$$prototype.sort_add_dice=p.$$prototype.sort_barabara_dice=p.$$prototype.enabled_d9=p.$$prototype.raw_input=p.$$prototype.randomizer=p.$$prototype.enabled_upcase_input=p.$$prototype.debug=c,te=e.get_singleton_class(p),V=[te].concat(i),te.$attr_reader("prefixes"),e.def(te,"$register_prefix",G=function(oe){var he,Te=this,me=c;return null==Te.prefixes&&(Te.prefixes=c),he=e.slice.call(arguments,0,arguments.length),Te.prefixes=n(me=Te.prefixes)?me:[],Te.prefixes.$concat(he.$flatten())},G.$$arity=-1),e.def(te,"$register_prefix_from_super_class",q=function(){return this.$register_prefix(this.$superclass().$prefixes())},q.$$arity=0),e.def(te,"$prefixes_pattern",$e=function(){var le,oe=this,he=c;return null==oe.prefixes_pattern&&(oe.prefixes_pattern=c),null==oe.prefixes&&(oe.prefixes=c),oe.prefixes_pattern=n(le=oe.prefixes_pattern)?le:c,n(oe.prefixes_pattern)?oe.prefixes_pattern:(oe.prefixes=n(he=oe.prefixes)?he:[],oe.prefixes.$freeze(),oe.prefixes_pattern=(n(oe.prefixes["$empty?"]())?/(?!)/:e.regexp(["^(S)?(",oe.prefixes.$join("|"),")"],"i")).$freeze())},$e.$$arity=0),e.def(te,"$command_pattern",ae=function(){var oe,he,le=this,Te=c,me=c;return null==le.command_pattern&&(le.command_pattern=c),null==le.prefixes&&(le.prefixes=c),le.command_pattern=n(he=le.command_pattern)?he:c,n(le.command_pattern)?le.command_pattern:(le.prefixes=n(Te=le.prefixes)?Te:[],le.prefixes.$freeze(),me=j(I(W(H(V,"CommonCommand"),"COMMANDS"),"map",[],((oe=function(ye){return null==ye&&(ye=c),W(ye,"PREFIX_PATTERN").$source()}).$$s=le,oe.$$arity=1,oe)),le.prefixes),le.command_pattern=e.regexp(["^S?(",me.$join("|"),")"],"i").$freeze())},ae.$$arity=0),e.def(te,"$eval",fe=function(oe){return this.$new(oe).$eval()},fe.$$arity=1),p.$include(H(i,"Translate")),p.$include(W(H(i,"Deprecated"),"Checker")),e.def(p,"$initialize",d=function(a){var V=this;return V.raw_input=a,V.sort_add_dice=!1,V.sort_barabara_dice=!1,V.d66_sort_type=W(H(i,"D66SortType"),"NO_SORT"),V.enabled_d9=!1,V.round_type=W(H(i,"RoundType"),"FLOOR"),V.sides_implicit_d=6,V.upper_dice_reroll_threshold=c,V.reroll_dice_reroll_threshold=c,V.default_cmp_op=c,V.default_target_number=c,V.enabled_upcase_input=!0,V.locale="ja_jp",V.randomizer=W(H(i,"BCDice"),"Randomizer").$new(),V.debug=!1},d.$$arity=1),p.$attr_accessor("randomizer"),p.$attr_reader("d66_sort_type"),p.$attr_reader("round_type"),p.$attr_reader("sides_implicit_d"),p.$attr_reader("upper_dice_reroll_threshold"),p.$attr_reader("reroll_dice_reroll_threshold"),p.$attr_reader("default_cmp_op"),p.$attr_reader("default_target_number"),e.def(p,"$sort_add_dice?",_=function(){return this.sort_add_dice},_.$$arity=0),e.def(p,"$sort_barabara_dice?",f=function(){return this.sort_barabara_dice},f.$$arity=0),e.def(p,"$enabled_d9?",C=function(){return this.enabled_d9},C.$$arity=0),e.def(p,"$enable_debug",o=function(){return this.debug=!0},o.$$arity=0),e.def(p,"$eval",u=function(){var V,G,q,a=this,$e=c;return V=W(H(i,"BCDice"),"Preprocessor").$process(a.raw_input,a),G=n(q=a.$dice_command(V))?q:a.$eval_common_command(a.raw_input),n(G)?($e=[a.randomizer.$rand_results()],I(G,"rands=",e.to_a($e)),X($e.length,1),$e=[a.randomizer.$detailed_rand_results()],I(G,"detailed_rands=",e.to_a($e)),X($e.length,1),G):c},u.$$arity=0),e.def(p,"$change_text",b=function(a){return a},b.$$arity=1),e.def(p,"$check_result",N=function(a,V,G,q){var $e=this,ae=c,fe=c,Se=c,oe=c,le=c;return ae=$e.$check_result_legacy(a,V,G,q),n(ae)?ae:(fe=I(V,"map",[],"sides".$to_proc()),oe=(Se=I(V,"map",[],"value".$to_proc())).$sum(),(ae=[100]["$==="](le=fe)?$e.$result_1d100(a,oe,G,q):[20]["$==="](le)?$e.$result_1d20(a,oe,G,q):[6,6]["$==="](le)?$e.$result_2d6(a,oe,Se,G,q):c)["$=="](H(i,"Result").$nothing())?c:n(ae)?ae:(le=fe.$uniq(),(ae=[10]["$==="](le)?$e.$result_nd10(a,oe,Se,G,q):[6]["$==="](le)?$e.$result_nd6(a,oe,Se,G,q):c)["$=="](H(i,"Result").$nothing())?c:n(ae)?ae:$e.$result_ndx(a,G,q)))},N.$$arity=4),e.def(p,"$grich_text",J=function(a,V,G){return c},J.$$arity=3),p.$private(),e.def(p,"$eval_common_command",D=function(a){try{var V;return a=this.$change_text(a),I(W(H(i,"CommonCommand"),"COMMANDS"),"each",[],((V=function($e){var fe,ae=null==V.$$s?this:V.$$s;if(null==ae.randomizer&&(ae.randomizer=c),null==$e&&($e=c),fe=$e.$eval(a,ae,ae.randomizer),!n(fe))return c;e.ret(fe)}).$$s=this,V.$$arity=1,V)),c}catch(q){if(q===e.returner)return q.$v;throw q}},D.$$arity=1),e.def(p,"$dice_command",y=function(a){var V,G=this,q=c,$e=c,ae=c,fe=c,Se=c,oe=c,le=c;return n(G.enabled_upcase_input)&&(a=a.$upcase()),q=G.$class().$prefixes_pattern().$match(a),n(q)?($e=q["$[]"](1)["$nil?"]()["$!"](),n($e)&&(a=a["$[]"](Q(1,-1,!1))),ae=G.$eval_game_system_specific_command(a),n(ae["$is_a?"](H(i,"Result")))?(fe=[n(Se=ae["$secret?"]())?Se:$e],I(ae,"secret=",e.to_a(fe)),X(fe.length,1),ae):n(n(oe=n(le=ae["$nil?"]())?le:ae["$empty?"]())?oe:ae["$=="]("1"))?c:I(H(i,"Result").$new(),"tap",[],((V=function(Te){return null==Te&&(Te=c),fe=[ae.$to_s()],I(Te,"text=",e.to_a(fe)),X(fe.length,1),I(Te,"secret=",e.to_a(fe=[$e])),fe[X(fe.length,1)]}).$$s=G,V.$$arity=1,V))):c},y.$$arity=1),e.def(p,"$eval_game_system_specific_command",g=function(a){return c},g.$$arity=1),e.def(p,"$result_ndx",E=function(a,V,G){return n(G["$is_a?"](H(i,"String")))?c:n(a.$send(V,G))?H(i,"Result").$success(this.$translate("success")):H(i,"Result").$failure(this.$translate("failure"))},E.$$arity=3),e.def(p,"$result_1d100",R=function(a,V,G,q){return c},R.$$arity=4),e.def(p,"$result_1d20",P=function(a,V,G,q){return c},P.$$arity=4),e.def(p,"$result_nd10",s=function(a,V,G,q,$e){return c},s.$$arity=5),e.def(p,"$result_2d6",h=function(a,V,G,q,$e){return c},h.$$arity=5),e.def(p,"$result_nd6",S=function(a,V,G,q,$e){return c},S.$$arity=5),e.def(p,"$get_table_by_2d6",w=function(a){return this.$get_table_by_nD6(a,2)},w.$$arity=1),e.def(p,"$get_table_by_1d6",A=function(a){return this.$get_table_by_nD6(a,1)},A.$$arity=1),e.def(p,"$get_table_by_nD6",ce=function(a,V){return this.$get_table_by_nDx(a,V,6)},ce.$$arity=2),e.def(p,"$get_table_by_nDx",ve=function(a,V,G){var $e,ae=c;return $e=this.randomizer.$roll_sum(V,G),ae=this.$get_table_value(a["$[]"](X($e,V))),n(ae["$nil?"]())?["1",0]:[ae,$e]},ve.$$arity=3),e.def(p,"$get_table_by_1d3",ge=function(a){var q,$e,V=this,ae=c;return V.$debug("get_table_by_1d3"),q=V.randomizer.$roll_sum(1,6),V.$debug("num",q),$e=function(x,Z){return"number"==typeof x?x/2:x["$/"](2)}(X(q,1)).$to_i(),V.$debug("index",$e),ae=a["$[]"]($e),n(ae["$nil?"]())?["1",0]:[ae,q]},ge.$$arity=1),e.def(p,"$get_table_by_d66_swap",Ce=function(a){var G;return G=this.randomizer.$roll_d66(W(H(i,"D66SortType"),"ASC")),[this.$get_table_by_number(G,a),G]},Ce.$$arity=1),e.def(p,"$get_table_by_d66",Re=function(a){var G,q,$e,fe,ae=c;return G=this.randomizer.$roll_once(6),q=this.randomizer.$roll_once(6),$e=j(function(x,Z){return"number"==typeof x?6*x:x["$*"](6)}(X(G,1)),X(q,1)),ae=a["$[]"]($e),fe=""+G+q,n(ae["$nil?"]())?["1",fe]:[ae,fe]},Re.$$arity=1),e.def(p,"$get_table_by_number",ze=function(a,V,G){try{var q;return null==G&&(G="1"),I(V,"each",[],((q=function(fe){var oe,Se=null==q.$$s?this:q.$$s;if(null==fe&&(fe=c),oe=fe["$[]"](0),!n(function(x,Z){return"number"==typeof x&&"number"==typeof Z?x>=Z:x["$>="](Z)}(oe,a)))return c;e.ret(Se.$get_table_value(fe["$[]"](1)))}).$$s=this,q.$$arity=1,q)),this.$get_table_value(G)}catch(ae){if(ae===e.returner)return ae.$v;throw ae}},ze.$$arity=-3),e.def(p,"$get_table_value",Pe=function(a){return n(a["$is_a?"](H(i,"Proc")))?a.$call():a},Pe.$$arity=1),e.def(p,"$roll_tables",be=function(a,V){var q=c;return q=V["$[]"](a),n(q)?q.$roll(this.randomizer).$to_s():c},be.$$arity=2),e.def(p,"$debug",re=function(a,V){var q,$e,ae=this,fe=c,Se=c;return q=e.slice.call(arguments,1,arguments.length),n(ae.debug)?(fe=n(a["$is_a?"](H(i,"String")))?a:a.$inspect(),n(q["$empty?"]())?ae.$warn(fe):(Se=I(q,"map",[],(($e=function(le){return null==le&&(le=c),n(le["$is_a?"](H(i,"String")))?'"'+le+'"':le.$inspect()}).$$s=ae,$e.$$arity=1,$e)),ae.$warn(fe+": "+Se.$join(", ")))):c},re.$$arity=-2),W(W(H(U,"I18n"),"Backend"),"Simple").$include(W(W(H(U,"I18n"),"Backend"),"Fallbacks")),H(U,"I18n").$load_path()["$<<"](H(U,"Dir")["$[]"](H(U,"File").$join($.$__dir__(),"../../i18n/**/*.yml"))),l=["ja_jp"],I(H(U,"I18n"),"default_locale=",e.to_a(l)),X(l.length,1),l=[["ja_jp"]],I(H(U,"I18n").$fallbacks(),"defaults=",e.to_a(l)),l[X(l.length,1)]},Opal.modules["bcdice/game_system/sword_world/rating_lexer"]=function(e){var L,l,O,d,C,o,u,_,f,M,Z,I,X=[],T=e.nil,m=e.$$,$=e.module,U=e.klass,c=e.hash2,W=e.truthy,H=e.send;return e.top.$require("strscan"),L=X,l=I=[$(X[0],"BCDice")].concat(L),O=Z=[$(I[0],"GameSystem")].concat(l),d=M=[U(Z[0],m(Z,"Base"),"SwordWorld")].concat(O),_=U(M[0],null,"RatingLexer"),f=[_].concat(d),_.$$prototype.scanner=T,e.const_set(f[0],"SYMBOLS",c(["+","-","*","/","(",")","[","]","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),e.def(_,"$initialize",C=function(N){var J,D,g;return N=W(g=(D=(J=N)===T||null==J?T:H(J,"split",[" ",2]))===T||null==D?T:H(D,"first",[]))?g:"",this.scanner=m(f,"StringScanner").$new(N)},C.$$arity=1),e.def(_,"$next_token",o=function(){var N=this,J=T,D=T,g=T;return W(N.scanner["$eos?"]())?[!1,"$"]:W(J=N.scanner.$scan(/\d+/))?["NUMBER",J.$to_i()]:(D=N.scanner.$getch().$upcase(),[W(g=m(f,"SYMBOLS")["$[]"](D))?g:D.$to_sym(),D])},o.$$arity=0),void e.def(_,"$source",u=function(){return this.scanner.$string()},u.$$arity=0)},Opal.modules["bcdice/game_system/sword_world/rating_parsed"]=function(e){function j(L,n){return"number"==typeof L&&"number"==typeof n?L<n:L["$<"](n)}function X(L,n){return"number"==typeof L&&"number"==typeof n?L+n:L["$+"](n)}function T(L,n){return"number"==typeof L&&"number"==typeof n?L>n:L["$>"](n)}var n,x,Y,_,o,u,b,N,J,D,y,g,E,R,P,s,h,f,C,p,K,Q,m=[],$=e.nil,c=e.$$,W=e.module,H=e.klass,t=e.truthy;return n=m,x=Q=[W(m[0],"BCDice")].concat(n),Y=K=[W(Q[0],"GameSystem")].concat(x),_=p=[H(K[0],c(K,"Base"),"SwordWorld")].concat(Y),f=H(p[0],null,"RatingParsed"),C=[f].concat(_),f.$$prototype.modifier_after_half=f.$$prototype.critical=f.$$prototype.semi_fixed_val=f.$$prototype.kept_modify=f.$$prototype.first_modify=f.$$prototype.first_to=f.$$prototype.rateup=f.$$prototype.tmp_fixed_val=f.$$prototype.rate=f.$$prototype.greatest_fortune=f.$$prototype.modifier=$,f.$attr_accessor("rate"),f.$attr_writer("critical"),f.$attr_writer("kept_modify"),f.$attr_writer("first_to"),f.$attr_writer("first_modify"),f.$attr_writer("rateup"),f.$attr_accessor("greatest_fortune"),f.$attr_writer("semi_fixed_val"),f.$attr_writer("tmp_fixed_val"),f.$attr_accessor("modifier"),f.$attr_writer("modifier_after_half"),e.def(f,"$initialize",o=function(){var w=this;return w.critical=$,w.min_critical=$,w.kept_modify=$,w.first_to=$,w.first_modify=$,w.greatest_fortune=!1,w.rateup=$,w.semi_fixed_val=$,w.tmp_fixed_val=$},o.$$arity=0),e.def(f,"$half",u=function(){return this.modifier_after_half["$nil?"]()["$!"]()},u.$$arity=0),e.def(f,"$critical",b=function(){var A;return t(A=this.critical)?A:t(this.$half())?13:10},b.$$arity=0),e.def(f,"$min_critical",N=function(){var w=this,A=$;return A=3,t(w.semi_fixed_val["$nil?"]())||(t(w.kept_modify["$nil?"]())?t(j(A,X(w.semi_fixed_val,2)))&&(A=X(w.semi_fixed_val,2)):t(j(A,X(X(w.semi_fixed_val,w.kept_modify),2)))&&(A=X(X(w.semi_fixed_val,w.kept_modify),2)),w.semi_fixed_val["$=="](1)&&(A=3)),t(T(A,13))&&(A=13),A},N.$$arity=0),e.def(f,"$first_modify",J=function(){var A;return t(A=this.first_modify)?A:0},J.$$arity=0),e.def(f,"$first_to",D=function(){var A;return t(A=this.first_to)?A:0},D.$$arity=0),e.def(f,"$rateup",y=function(){var A;return t(A=this.rateup)?A:0},y.$$arity=0),e.def(f,"$semi_fixed_val",g=function(){var ce,A=$;return A=t(ce=this.semi_fixed_val)?ce:0,t(T(A,6))&&(A=6),A},g.$$arity=0),e.def(f,"$tmp_fixed_val",E=function(){var ce,A=$;return A=t(ce=this.tmp_fixed_val)?ce:0,t(T(A,6))&&(A=6),A},E.$$arity=0),e.def(f,"$kept_modify",R=function(){var A;return t(A=this.kept_modify)?A:0},R.$$arity=0),e.def(f,"$modifier_after_half",P=function(){var A;return t(A=this.modifier_after_half)?A:0},P.$$arity=0),e.def(f,"$to_s",s=function(){var w=this,A=$;return A="KeyNo."+w.rate,t(j(w.$critical(),13))&&(A=X(A,"c["+w.$critical()+"]")),t(w.$first_modify()["$!="](0))&&(A=X(A,"m["+c(C,"Format").$modifier(w.$first_modify())+"]")),t(w.$first_to()["$!="](0))&&(A=X(A,"m["+w.$first_to()+"]")),t(w.$rateup()["$!="](0))&&(A=X(A,"r["+w.$rateup()+"]")),t(w.greatest_fortune)&&(A=X(A,"gf")),t(w.$semi_fixed_val()["$!="](0))&&(A=X(A,"sf["+w.$semi_fixed_val()+"]")),t(w.$tmp_fixed_val()["$!="](0))&&(A=X(A,"tf["+w.$tmp_fixed_val()+"]")),t(w.$kept_modify()["$!="](0))&&(A=X(A,"a["+c(C,"Format").$modifier(w.$kept_modify())+"]")),t(w.modifier["$!="](0))&&(A=X(A,c(C,"Format").$modifier(w.modifier))),A},s.$$arity=0),void e.def(f,"$infinite_roll?",h=function(){return j(this.$critical(),this.$min_critical())},h.$$arity=0)},Opal.modules["bcdice/game_system/sword_world/rating_parser"]=function(e){function j(I,Q){return"number"==typeof I&&"number"==typeof Q?I-Q:I["$-"](Q)}var Q,K,p,C,b,N,J,D,y,g,E,R,P,s,h,S,w,A,ce,ve,ge,Ce,Re,ze,Pe,be,re,te,a,V,G,q,$e,ae,fe,Se,oe,le,he,Te,me,De,ye,Ae,Le,Ke,qe,Ue,Ne,o,u,d,O,x,X=e.top,T=[],r=e.nil,m=e.$$$,$=e.$$,U=e.module,c=e.klass,W=e.hash2,H=e.send2,t=e.send,L=e.hash,n=e.truthy;return X.$require("racc/parser.rb"),X.$require("bcdice/arithmetic/node"),X.$require("bcdice/enum"),X.$require("bcdice/game_system/sword_world/rating_lexer"),X.$require("bcdice/game_system/sword_world/rating_parsed"),Q=T,K=x=[U(T[0],"BCDice")].concat(Q),p=O=[U(x[0],"GameSystem")].concat(K),C=d=[c(O[0],$(O,"Base"),"SwordWorld")].concat(p),o=c(d[0],m($(d,"Racc"),"Parser"),"RatingParser"),u=[o].concat(C),o.$$prototype.lexer=o.$$prototype.version=r,e.def(o,"$initialize",b=function(se){var xe,ee;if(b.$$p&&(b.$$p=null),null==se)se=W([],{});else if(!se.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(xe=se.$$smap.version)&&(xe="v1_0"),null==(ee=se.$$smap.round_type)&&(ee=m($(u,"RoundType"),"CEIL")),H(this,e.find_super_dispatcher(this,"initialize",b,!1,!0),"initialize",[],null),this.version=xe,this.round_type=ee},b.$$arity=-1),e.def(o,"$set_debug",N=function(){return this.yydebug=!0,this},N.$$arity=0),e.def(o,"$parse",J=function(se){try{return this.lexer=$(u,"RatingLexer").$new(se),this.$do_parse()}catch(ee){if(!e.rescue(ee,[$(u,"ParseError"),$(u,"ZeroDivisionError")]))throw ee;try{return r}finally{e.pop_exception()}}},J.$$arity=1),o.$private(),e.def(o,"$parsed",D=function(se,xe,ee){var F;return t($(u,"RatingParsed").$new(),"tap",[],((F=function(v){var B,z,_e,Ee,ie=null==F.$$s?this:F.$$s,ue=r;return null==ie.round_type&&(ie.round_type=r),null==v&&(v=r),t(v,"rate=",e.to_a(ue=[se])),j(ue.length,1),ue=[(B=ee["$[]"]("critical"),B===r||null==B?r:t(B,"eval",[ie.round_type]))],t(v,"critical=",e.to_a(ue)),j(ue.length,1),ue=[(z=ee["$[]"]("kept_modify"),z===r||null==z?r:t(z,"eval",[ie.round_type]))],t(v,"kept_modify=",e.to_a(ue)),j(ue.length,1),ue=[ee["$[]"]("first_to")],t(v,"first_to=",e.to_a(ue)),j(ue.length,1),ue=[ee["$[]"]("first_modify")],t(v,"first_modify=",e.to_a(ue)),j(ue.length,1),ue=[(_e=ee["$[]"]("rateup"),_e===r||null==_e?r:t(_e,"eval",[ie.round_type]))],t(v,"rateup=",e.to_a(ue)),j(ue.length,1),ue=[ee.$fetch("greatest_fortune",!1)],t(v,"greatest_fortune=",e.to_a(ue)),j(ue.length,1),ue=[ee["$[]"]("semi_fixed_val")],t(v,"semi_fixed_val=",e.to_a(ue)),j(ue.length,1),ue=[ee["$[]"]("tmp_fixed_val")],t(v,"tmp_fixed_val=",e.to_a(ue)),j(ue.length,1),ue=[xe.$eval(ie.round_type)],t(v,"modifier=",e.to_a(ue)),j(ue.length,1),ue=[(Ee=ee["$[]"]("modifier_after_half"),Ee===r||null==Ee?r:t(Ee,"eval",[ie.round_type]))],t(v,"modifier_after_half=",e.to_a(ue)),ue[j(ue.length,1)]}).$$s=this,F.$$arity=1,F))},D.$$arity=3),e.def(o,"$next_token",y=function(){return this.lexer.$next_token()},y.$$arity=0),Te=[15,14,16,5,17,18,20,21,57,58,23,24,11,59,12,19,13,15,14,16,4,17,18,20,21,4,30,3,30,11,8,12,19,13,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,9,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,37,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,38,39,32,26,27,26,27,29,46,29,33,34,51,52,53,54],me=[6,6,6,1,6,6,6,6,49,49,10,10,6,49,6,6,6,22,22,22,3,22,22,22,22,0,11,0,12,22,4,22,22,22,11,11,12,12,11,14,12,15,41,41,43,43,19,14,14,15,15,14,20,15,19,19,5,21,19,23,20,20,44,44,20,21,21,23,23,21,24,23,26,45,45,50,50,27,24,24,26,26,24,29,26,27,27,16,55,27,56,29,29,62,62,29,55,55,56,56,55,57,56,58,63,63,17,18,13,57,57,58,58,57,25,58,13,13,33,34,38,39],De=[22,3,r,17,28,56,-4,r,r,r,0,24,26,106,37,39,80,99,100,44,50,55,13,57,68,97,70,75,r,81,r,r,r,116,117,r,r,r,118,119,r,30,r,32,50,61,r,r,r,-2,63,r,r,r,r,86,88,99,101,r,r,r,81,92],ye=[-33,-33,-4,-33,-33,-33,-1,-4,-3,64,-5,-33,-33,-33,-11,-33,-33,-33,-33,-33,-33,-33,-2,-33,-33,-33,-33,-33,-30,-33,-32,-7,-8,-33,-33,-12,-13,-14,-33,-33,-17,-18,-27,-19,-20,-21,-6,-28,-29,-33,-24,-9,-10,-15,-16,-33,-33,-33,-33,-31,-25,-26,-22,-23],Ae=[25,31,6,35,36,1,49,22,40,41,43,2,44,45,7,47,48,r,50,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,60,61,62,63],Le=[5,5,3,5,5,1,7,3,5,6,6,2,6,6,2,5,5,r,6,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,5,5,6,6],Ke=[r,5,11,0,r,-11,-11,-23,r],qe=[r,r,r,r,10,42,r,r,28],Ue=[0,0,"racc_error",2,22,"_reduce_1",3,22,"_reduce_2",2,23,"_reduce_3",0,24,"_reduce_4",2,24,"_reduce_5",4,24,"_reduce_6",3,24,"_reduce_7",3,24,"_reduce_8",4,24,"_reduce_9",4,24,"_reduce_10",2,24,"_reduce_11",3,24,"_reduce_12",3,24,"_reduce_13",3,24,"_reduce_14",4,24,"_reduce_15",4,24,"_reduce_16",3,24,"_reduce_17",2,25,"_reduce_18",2,25,"_reduce_19",3,25,"_reduce_20",3,25,"_reduce_21",3,28,"_reduce_22",3,28,"_reduce_23",1,28,"_reduce_none",3,27,"_reduce_25",3,27,"_reduce_26",1,27,"_reduce_none",2,26,"_reduce_28",2,26,"_reduce_29",1,26,"_reduce_none",3,29,"_reduce_31",1,29,"_reduce_32"],Ne=L(!1,0,"error",1,"NUMBER",2,"K",3,"R",4,"H",5,"G",6,"F",7,"S",8,"T",9,"PLUS",10,"MINUS",11,"ASTERISK",12,"SLASH",13,"PARENL",14,"PARENR",15,"BRACKETL",16,"BRACKETR",17,"AT",18,"SHARP",19,"DOLLAR",20),e.const_set(u[0],"Racc_arg",[Te,me,ye,De,Ae,Le,qe,Ke,21,Ue,Ne,64,33,!0]),e.const_set(u[0],"Racc_token_to_s_table",["$end","error","NUMBER","K","R","H","G","F","S","T","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","AT","SHARP","DOLLAR","$start","expr","rate","option","modifier","unary","mul","add","term"]),e.const_set(u[0],"Racc_debug_parser",!1),e.def(o,"$_reduce_1",g=function(se,xe,ee){var F,v,B,z,ie=r;return v=null==(F=e.to_ary(se))[0]?r:F[0],B=n(z=(ie=null==F[1]?r:F[1])["$[]"]("modifier"))?z:m(m($(u,"Arithmetic"),"Node"),"Number").$new(0),this.$parsed(v,B,ie)},g.$$arity=3),e.def(o,"$_reduce_2",E=function(se,xe,ee){var F,ie,Ee,ue,B=r,_e=r;return ie=null==(F=e.to_ary(se))[1]?r:F[1],n((B=null==F[2]?r:F[2])["$[]"]("modifier_after_half"))||(_e=["modifier_after_half",m(m($(u,"Arithmetic"),"Node"),"Number").$new(0)],t(B,"[]=",e.to_a(_e)),j(_e.length,1)),Ee=n(ue=B["$[]"]("modifier"))?ue:m(m($(u,"Arithmetic"),"Node"),"Number").$new(0),this.$parsed(ie,Ee,B)},E.$$arity=3),e.def(o,"$_reduce_3",R=function(se,xe,ee){return se["$[]"](1).$to_i()},R.$$arity=3),e.def(o,"$_reduce_4",P=function(se,xe,ee){return W([],{})},P.$$arity=3),e.def(o,"$_reduce_5",s=function(se,xe,ee){var F,ie,B,v=r;return ie=null==(F=e.to_ary(se))[1]?r:F[1],n((v=null==F[0]?r:F[0])["$[]"]("modifier")["$nil?"]())||this.$raise($(u,"ParseError")),t(v,"[]=",e.to_a(B=["modifier",ie])),j(B.length,1),v},s.$$arity=3),e.def(o,"$_reduce_6",h=function(se,xe,ee){var F,B,z,v=r;return B=null==(F=e.to_ary(se))[2]?r:F[2],n((v=null==F[0]?r:F[0])["$[]"]("critical")["$nil?"]())||this.$raise($(u,"ParseError")),t(v,"[]=",e.to_a(z=["critical",B])),j(z.length,1),v},h.$$arity=3),e.def(o,"$_reduce_7",S=function(se,xe,ee){var F,B,z,v=r;return B=null==(F=e.to_ary(se))[2]?r:F[2],n((v=null==F[0]?r:F[0])["$[]"]("critical")["$nil?"]())||this.$raise($(u,"ParseError")),t(v,"[]=",e.to_a(z=["critical",B])),j(z.length,1),v},S.$$arity=3),e.def(o,"$_reduce_8",w=function(se,xe,ee){var F,_e,z,v=r,B=r;return B=null==(F=e.to_ary(se))[2]?r:F[2],n(n(z=(v=null==F[0]?r:F[0])["$[]"]("first_to")["$nil?"]())?v["$[]"]("first_modify")["$nil?"]():z)||this.$raise($(u,"ParseError")),_e=["first_to",B.$to_i()],t(v,"[]=",e.to_a(_e)),j(_e.length,1),v},w.$$arity=3),e.def(o,"$_reduce_9",A=function(se,xe,ee){var F,_e,z,v=r,B=r;return B=null==(F=e.to_ary(se))[3]?r:F[3],n(n(z=(v=null==F[0]?r:F[0])["$[]"]("first_to")["$nil?"]())?v["$[]"]("first_modify")["$nil?"]():z)||this.$raise($(u,"ParseError")),_e=["first_modify",B.$to_i()],t(v,"[]=",e.to_a(_e)),j(_e.length,1),v},A.$$arity=3),e.def(o,"$_reduce_10",ce=function(se,xe,ee){var F,_e,z,v=r,B=r;return B=null==(F=e.to_ary(se))[3]?r:F[3],n(n(z=(v=null==F[0]?r:F[0])["$[]"]("first_to")["$nil?"]())?v["$[]"]("first_modify")["$nil?"]():z)||this.$raise($(u,"ParseError")),_e=["first_modify",B.$to_i()["$-@"]()],t(v,"[]=",e.to_a(_e)),j(_e.length,1),v},ce.$$arity=3),e.def(o,"$_reduce_11",ve=function(se,xe,ee){var F,B,v=r;return F=e.to_ary(se),n((v=null==F[0]?r:F[0])["$[]"]("modifier_after_half")["$nil?"]())||this.$raise($(u,"ParseError")),B=["modifier_after_half",m(m($(u,"Arithmetic"),"Node"),"Number").$new(0)],t(v,"[]=",e.to_a(B)),j(B.length,1),v},ve.$$arity=3),e.def(o,"$_reduce_12",ge=function(se,xe,ee){var F,B,z,v=r;return B=null==(F=e.to_ary(se))[2]?r:F[2],n((v=null==F[0]?r:F[0])["$[]"]("modifier_after_half")["$nil?"]())||this.$raise($(u,"ParseError")),t(v,"[]=",e.to_a(z=["modifier_after_half",B])),j(z.length,1),v},ge.$$arity=3),e.def(o,"$_reduce_13",Ce=function(se,xe,ee){var F,B,_e,z,v=r;return v=null==(F=e.to_ary(se))[0]?r:F[0],B=null==F[2]?r:F[2],n(n(z=["v2_5","v2_0"]["$include?"](this.version))?v["$[]"]("rateup")["$nil?"]():z)||this.$raise($(u,"ParseError")),t(v,"[]=",e.to_a(_e=["rateup",B])),j(_e.length,1),v},Ce.$$arity=3),e.def(o,"$_reduce_14",Re=function(se,xe,ee){var F,B,ne=this,v=r;return v=null==(F=e.to_ary(se))[0]?r:F[0],n(["v2_5","v2_0"]["$include?"](ne.version))||ne.$raise($(u,"ParseError")),n(v["$[]"]("greatest_fortune")["$nil?"]())||ne.$raise($(u,"ParseError")),n(v["$[]"]("semi_fixed_val")["$nil?"]())||ne.$raise($(u,"ParseError")),n(v["$[]"]("tmp_fixed_val")["$nil?"]())||ne.$raise($(u,"ParseError")),t(v,"[]=",e.to_a(B=["greatest_fortune",!0])),j(B.length,1),v},Re.$$arity=3),e.def(o,"$_reduce_15",ze=function(se,xe,ee){var F,z,ne=this,v=r,B=r;return v=null==(F=e.to_ary(se))[0]?r:F[0],B=null==F[3]?r:F[3],n(["v2_5","v2_0"]["$include?"](ne.version))||ne.$raise($(u,"ParseError")),n(v["$[]"]("greatest_fortune")["$nil?"]())||ne.$raise($(u,"ParseError")),n(v["$[]"]("semi_fixed_val")["$nil?"]())||ne.$raise($(u,"ParseError")),n(v["$[]"]("tmp_fixed_val")["$nil?"]())||ne.$raise($(u,"ParseError")),z=["semi_fixed_val",B.$to_i()],t(v,"[]=",e.to_a(z)),j(z.length,1),v},ze.$$arity=3),e.def(o,"$_reduce_16",Pe=function(se,xe,ee){var F,z,ne=this,v=r,B=r;return v=null==(F=e.to_ary(se))[0]?r:F[0],B=null==F[3]?r:F[3],n(["v2_5","v2_0"]["$include?"](ne.version))||ne.$raise($(u,"ParseError")),n(v["$[]"]("greatest_fortune")["$nil?"]())||ne.$raise($(u,"ParseError")),n(v["$[]"]("semi_fixed_val")["$nil?"]())||ne.$raise($(u,"ParseError")),n(v["$[]"]("tmp_fixed_val")["$nil?"]())||ne.$raise($(u,"ParseError")),z=["tmp_fixed_val",B.$to_i()],t(v,"[]=",e.to_a(z)),j(z.length,1),v},Pe.$$arity=3),e.def(o,"$_reduce_17",be=function(se,xe,ee){var F,B,_e,z,v=r;return v=null==(F=e.to_ary(se))[0]?r:F[0],B=null==F[2]?r:F[2],n(n(z=this.version["$=="]("v2_5"))?v["$[]"]("kept_modify")["$nil?"]():z)||this.$raise($(u,"ParseError")),t(v,"[]=",e.to_a(_e=["kept_modify",B])),j(_e.length,1),v},be.$$arity=3),e.def(o,"$_reduce_18",re=function(se,xe,ee){return se["$[]"](1)},re.$$arity=3),e.def(o,"$_reduce_19",te=function(se,xe,ee){return m(m($(u,"Arithmetic"),"Node"),"Negative").$new(se["$[]"](1))},te.$$arity=3),e.def(o,"$_reduce_20",a=function(se,xe,ee){return m(m($(u,"Arithmetic"),"Node"),"BinaryOp").$new(se["$[]"](0),"+",se["$[]"](2))},a.$$arity=3),e.def(o,"$_reduce_21",V=function(se,xe,ee){return m(m($(u,"Arithmetic"),"Node"),"BinaryOp").$new(se["$[]"](0),"-",se["$[]"](2))},V.$$arity=3),e.def(o,"$_reduce_22",G=function(se,xe,ee){return m(m($(u,"Arithmetic"),"Node"),"BinaryOp").$new(se["$[]"](0),"+",se["$[]"](2))},G.$$arity=3),e.def(o,"$_reduce_23",q=function(se,xe,ee){return m(m($(u,"Arithmetic"),"Node"),"BinaryOp").$new(se["$[]"](0),"-",se["$[]"](2))},q.$$arity=3),e.def(o,"$_reduce_25",$e=function(se,xe,ee){return m(m($(u,"Arithmetic"),"Node"),"BinaryOp").$new(se["$[]"](0),"*",se["$[]"](2))},$e.$$arity=3),e.def(o,"$_reduce_26",ae=function(se,xe,ee){return m(m($(u,"Arithmetic"),"Node"),"DivideWithGameSystemDefault").$new(se["$[]"](0),se["$[]"](2))},ae.$$arity=3),e.def(o,"$_reduce_28",fe=function(se,xe,ee){return se["$[]"](1)},fe.$$arity=3),e.def(o,"$_reduce_29",Se=function(se,xe,ee){return m(m($(u,"Arithmetic"),"Node"),"Negative").$new(se["$[]"](1))},Se.$$arity=3),e.def(o,"$_reduce_31",oe=function(se,xe,ee){return se["$[]"](1)},oe.$$arity=3),e.def(o,"$_reduce_32",le=function(se,xe,ee){return m(m($(u,"Arithmetic"),"Node"),"Number").$new(se["$[]"](0))},le.$$arity=3),void e.def(o,"$_reduce_none",he=function(se,xe,ee){return se["$[]"](0)},he.$$arity=3)},Opal.modules["bcdice/game_system/SwordWorld"]=function(e){function j(K,k){return"number"==typeof K&&"number"==typeof k?K>=k:K["$>="](k)}function X(K,k){return"number"==typeof K&&"number"==typeof k?K<=k:K["$<="](k)}function T(K,k){return"number"==typeof K&&"number"==typeof k?K-k:K["$-"](k)}function r(K,k){return"number"==typeof K&&"number"==typeof k?K>k:K["$>"](k)}function m(K,k){return"number"==typeof K&&"number"==typeof k?K+k:K["$+"](k)}function U(K,k){return"number"==typeof K&&"number"==typeof k?K*k:K["$*"](k)}var k,p,C,b,N,J,D,y,g,E,R,P,o,u,d,Y,W=e.top,H=[],t=e.nil,n=e.$$,I=e.module,Q=e.klass,l=e.send2,x=e.truthy,Z=e.send;return W.$require("bcdice/base"),W.$require("bcdice/game_system/sword_world/rating_parser"),k=H,p=Y=[I(H[0],"BCDice")].concat(k),C=d=[I(Y[0],"GameSystem")].concat(p),o=Q(d[0],n(d,"Base"),"SwordWorld"),u=[o].concat(C),o.$$prototype.rating_table=o.$$prototype.randomizer=t,e.const_set(u[0],"ID","SwordWorld"),e.const_set(u[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG"),e.const_set(u[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u3068"),e.const_set(u[0],"HELP_MESSAGE","\u30fbSW\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx[c]+m$f) (x:\u30ad\u30fc, c:\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024, m:\u30dc\u30fc\u30ca\u30b9, f:\u51fa\u76ee\u4fee\u6b63)\n"),o.$register_prefix("H?K"),e.def(o,"$initialize",b=function(h){var A=this;return b.$$p&&(b.$$p=null),l(A,e.find_super_dispatcher(A,"initialize",b,!1,!0),"initialize",[h],null),A.rating_table=0},b.$$arity=1),e.def(o,"$result_2d6",N=function(h,S,w,A,ce){var ge=t;return x(j(S,12))?n(u,"Result").$critical("\u81ea\u52d5\u7684\u6210\u529f"):x(X(S,2))?n(u,"Result").$fumble("\u81ea\u52d5\u7684\u5931\u6557"):x(x(ge=A["$!="](">="))?ge:ce["$=="]("?"))?t:x(j(h,ce))?n(u,"Result").$success("\u6210\u529f"):n(u,"Result").$failure("\u5931\u6557")},N.$$arity=5),e.def(o,"$eval_game_system_specific_command",J=function(h){return this.$rating(h)},J.$$arity=1),o.$private(),e.def(o,"$rating_parser",D=function(){return n(u,"RatingParser").$new()},D.$$arity=0),e.def(o,"$rating",y=function(h){var S,w,A,ce,ve=this,ge=t,Ce=t,Re=t,ze=t,Pe=t,be=t,re=t,te=t,a=t,V=t,G=t,q=t,$e=t,ae=t,Se=t,oe=t;return ve.$debug("rating string",h),ge=ve.$rating_parser().$parse(h),x(ge)?(Ce=ve.$getSW2_0_RatingTable(),Re=T(Ce.$length(),1),ve.$debug("keyMax",Re),x(r(ge.$rate(),Re))?"\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc\u306f"+Re+"\u307e\u3067\u3067\u3059":x(ge["$infinite_roll?"]())?n(u,"Result").$new("C\u5024\u3092"+ge.$min_critical()+"\u4ee5\u4e0a\u306b\u3057\u3066\u304f\u3060\u3055\u3044"):(ze=ve.$getNewRates(Ce),Pe=ge+" \uff1e ",be=[],re=[],te=[],a=0,V=0,G=0,q=0,$e=ge.$first_to(),ae=ge.$first_modify(),function(){var le=e.new_brk();try{Z(ve,"loop",[],((S=function(){var me,De,Ke,qe,Le,Te=null==S.$$s?this:S.$$s,ye=t,Ae=t;if(De=Te.$rollDice(ge,q),Ae=null==(me=e.to_ary(De))[1]?t:me[1],a=ye=null==me[0]?t:me[0],x($e["$!="](0))?(a=ye=$e,$e=0):x(ae["$!="](0))&&(a=m(a,ae),ae=0),x(X(ye,2))&&(be["$<<"](ye.$to_s()),re["$<<"](Ae.$to_s()),te["$<<"]("**"),q=m(q,1),e.brk(t,le)),x(x(Le=ge.$kept_modify()["$!="](0))?a["$!="](2):Le)&&(a=m(a,ge.$kept_modify())),x(function(K,k){return"number"==typeof K?K<2:K["$<"](2)}(a))&&(a=2),x(r(a,12))&&(a=12),Ke=[m(ge.$rate(),U(q,ge.$rateup())),Re].$min(),Te.$debug("currentKey",Ke),qe=ze["$[]"](a)["$[]"](Ke),Te.$debug("rateValue",qe),G=m(G,qe),V=m(V,a),be["$<<"](a.$to_s()),re["$<<"](Ae.$to_s()),te["$<<"](x(r(a,2))?qe:"**"),q=m(q,1),x(j(a,ge.$critical())))return t;e.brk(t,le)}).$$s=ve,S.$$brk=le,S.$$arity=0,S))}catch(he){if(he===le)return he.$v;throw he}}(),A=ve.$getResultText(G,ge,re,be,te,V,q),w=e.to_ary(A),Se=null==w[1]?t:w[1],oe=null==w[2]?t:w[2],Pe=m(Pe,null==w[0]?t:w[0]),Z(n(u,"Result").$new(),"tap",[],((ce=function(he){var me=t;return null==he&&(he=t),Z(he,"text=",e.to_a(me=[Pe])),T(me.length,1),Z(he,"critical=",e.to_a(me=[Se])),T(me.length,1),Z(he,"fumble=",e.to_a(me=[oe])),me[T(me.length,1)]}).$$s=ve,ce.$$arity=1,ce)))):(ve.$debug("not matched"),"1")},y.$$arity=1),e.def(o,"$getSW2_0_RatingTable",g=function(){return["*,0,0,0,1,2,2,3,3,4,4","*,0,0,0,1,2,3,3,3,4,4","*,0,0,0,1,2,3,4,4,4,4","*,0,0,1,1,2,3,4,4,4,5","*,0,0,1,2,2,3,4,4,5,5","*,0,1,1,2,2,3,4,5,5,5","*,0,1,1,2,3,3,4,5,5,5","*,0,1,1,2,3,4,4,5,5,6","*,0,1,2,2,3,4,4,5,6,6","*,0,1,2,3,3,4,4,5,6,7","*,1,1,2,3,3,4,5,5,6,7","*,1,2,2,3,3,4,5,6,6,7","*,1,2,2,3,4,4,5,6,6,7","*,1,2,3,3,4,4,5,6,7,7","*,1,2,3,4,4,4,5,6,7,8","*,1,2,3,4,4,5,5,6,7,8","*,1,2,3,4,4,5,6,7,7,8","*,1,2,3,4,5,5,6,7,7,8","*,1,2,3,4,5,6,6,7,7,8","*,1,2,3,4,5,6,7,7,8,9","*,1,2,3,4,5,6,7,8,9,10","*,1,2,3,4,6,6,7,8,9,10","*,1,2,3,5,6,6,7,8,9,10","*,2,2,3,5,6,7,7,8,9,10","*,2,3,4,5,6,7,7,8,9,10","*,2,3,4,5,6,7,8,8,9,10","*,2,3,4,5,6,8,8,9,9,10","*,2,3,4,6,6,8,8,9,9,10","*,2,3,4,6,6,8,9,9,10,10","*,2,3,4,6,7,8,9,9,10,10","*,2,4,4,6,7,8,9,10,10,10","*,2,4,5,6,7,8,9,10,10,11","*,3,4,5,6,7,8,10,10,10,11","*,3,4,5,6,8,8,10,10,10,11","*,3,4,5,6,8,9,10,10,11,11","*,3,4,5,7,8,9,10,10,11,12","*,3,5,5,7,8,9,10,11,11,12","*,3,5,6,7,8,9,10,11,12,12","*,3,5,6,7,8,10,10,11,12,13","*,4,5,6,7,8,10,11,11,12,13","*,4,5,6,7,9,10,11,11,12,13","*,4,6,6,7,9,10,11,12,12,13","*,4,6,7,7,9,10,11,12,13,13","*,4,6,7,8,9,10,11,12,13,14","*,4,6,7,8,10,10,11,12,13,14","*,4,6,7,9,10,10,11,12,13,14","*,4,6,7,9,10,10,12,13,13,14","*,4,6,7,9,10,11,12,13,13,15","*,4,6,7,9,10,12,12,13,13,15","*,4,6,7,10,10,12,12,13,14,15","*,4,6,8,10,10,12,12,13,15,15","*,5,7,8,10,10,12,12,13,15,15","*,5,7,8,10,11,12,12,13,15,15","*,5,7,9,10,11,12,12,14,15,15","*,5,7,9,10,11,12,13,14,15,16","*,5,7,10,10,11,12,13,14,16,16","*,5,8,10,10,11,12,13,15,16,16","*,5,8,10,11,11,12,13,15,16,17","*,5,8,10,11,12,12,13,15,16,17","*,5,9,10,11,12,12,14,15,16,17","*,5,9,10,11,12,13,14,15,16,18","*,5,9,10,11,12,13,14,16,17,18","*,5,9,10,11,13,13,14,16,17,18","*,5,9,10,11,13,13,15,17,17,18","*,5,9,10,11,13,14,15,17,17,18","*,5,9,10,12,13,14,15,17,18,18","*,5,9,10,12,13,15,15,17,18,19","*,5,9,10,12,13,15,16,17,19,19","*,5,9,10,12,14,15,16,17,19,19","*,5,9,10,12,14,16,16,17,19,19","*,5,9,10,12,14,16,17,18,19,19","*,5,9,10,13,14,16,17,18,19,20","*,5,9,10,13,15,16,17,18,19,20","*,5,9,10,13,15,16,17,19,20,21","*,6,9,10,13,15,16,18,19,20,21","*,6,9,10,13,16,16,18,19,20,21","*,6,9,10,13,16,17,18,19,20,21","*,6,9,10,13,16,17,18,20,21,22","*,6,9,10,13,16,17,19,20,22,23","*,6,9,10,13,16,18,19,20,22,23","*,6,9,10,13,16,18,20,21,22,23","*,6,9,10,13,17,18,20,21,22,23","*,6,9,10,14,17,18,20,21,22,24","*,6,9,11,14,17,18,20,21,23,24","*,6,9,11,14,17,19,20,21,23,24","*,6,9,11,14,17,19,21,22,23,24","*,7,10,11,14,17,19,21,22,23,25","*,7,10,12,14,17,19,21,22,24,25","*,7,10,12,14,18,19,21,22,24,25","*,7,10,12,15,18,19,21,22,24,26","*,7,10,12,15,18,19,21,23,25,26","*,7,11,13,15,18,19,21,23,25,26","*,7,11,13,15,18,20,21,23,25,27","*,8,11,13,15,18,20,22,23,25,27","*,8,11,13,16,18,20,22,23,25,28","*,8,11,14,16,18,20,22,23,26,28","*,8,11,14,16,19,20,22,23,26,28","*,8,12,14,16,19,20,22,24,26,28","*,8,12,15,16,19,20,22,24,27,28","*,8,12,15,17,19,20,22,24,27,29","*,8,12,15,18,19,20,22,24,27,30"]},g.$$arity=0),e.def(o,"$getNewRates",E=function(h){var S,A=t,ce=t,ve=t,ge=t,Ce=t,Re=t,ze=t,Pe=t,be=t,re=t,te=t,a=t;return A=[],ce=[],ve=[],ge=[],Ce=[],Re=[],ze=[],Pe=[],be=[],re=[],te=[],Z(h,"each",[],((S=function(q){var ae=t;return null==q&&(q=t),ae=q.$split(/,/),te.$push(0),A.$push(ae["$[]"](1).$to_i()),ce.$push(ae["$[]"](2).$to_i()),ve.$push(ae["$[]"](3).$to_i()),ge.$push(ae["$[]"](4).$to_i()),Ce.$push(ae["$[]"](5).$to_i()),Re.$push(ae["$[]"](6).$to_i()),ze.$push(ae["$[]"](7).$to_i()),Pe.$push(ae["$[]"](8).$to_i()),be.$push(ae["$[]"](9).$to_i()),re.$push(ae["$[]"](10).$to_i())}).$$s=this,S.$$arity=1,S)),this.rating_table["$=="](1)&&(a=[31,(a=[32,(a=[33,10],Z(re,"[]=",e.to_a(a)),a[T(a.length,1)])],Z(re,"[]=",e.to_a(a)),a[T(a.length,1)])],Z(re,"[]=",e.to_a(a)),T(a.length,1)),[te,te,te,A,ce,ve,ge,Ce,Re,ze,Pe,be,re]},E.$$arity=1),e.def(o,"$rollDice",R=function(h,S){var A=t;return[(A=this.randomizer.$roll_barabara(2,6)).$sum(),A.$join(",")]},R.$$arity=2),void e.def(o,"$getResultText",P=function(h,S,w,A,ce,ve,ge){var Re=t,ze=t,Pe=t,be=t,re=t,te=t;return(Re=[]).$push("2D:["+w.$join(" ")+"]="+A.$join(",")),x(X(ve,2))?(Re.$push(ce.$join(",")),Re.$push("\u81ea\u52d5\u7684\u5931\u6557"),[Re.$join(" \uff1e "),!1,!0]):(x(x(ze=r(ce.$size(),1))?ze:S.$modifier()["$!="](0))?(Pe=m(ce.$join(","),n(u,"Format").$modifier(S.$modifier())),x(S.$half())&&(Pe="("+Pe+")/2",x(S.$modifier_after_half()["$!="](0))&&(Pe=m(Pe,n(u,"Format").$modifier(S.$modifier_after_half())))),Re.$push(Pe)):x(S.$half())&&(Pe=ce.$first()+"/2",x(S.$modifier_after_half()["$!="](0))&&(Pe=m(Pe,n(u,"Format").$modifier(S.$modifier_after_half()))),Re.$push(Pe)),x(r(ge,1))&&(be=T(ge,1)+"\u56de\u8ee2",Re.$push(be)),re=m(h,S.$modifier()),x(S.$half())&&(re=function(K,k){return"number"==typeof K?K/2:K["$/"](2)}(re).$ceil(),x(S.$modifier_after_half()["$!="](0))&&(re=m(re,S.$modifier_after_half()))),te=re.$to_s(),Re.$push(te),[Re.$join(" \uff1e "),r(ge,1),!1])},P.$$arity=7)},Opal.modules["bcdice/game_system/sword_world/transcendent_test"]=function(e){function X(Q,l){return"number"==typeof Q&&"number"==typeof l?Q>=l:Q["$>="](l)}function r(Q,l){return"number"==typeof Q&&"number"==typeof l?Q-l:Q["$-"](l)}var l,k,i,o,N,J,D,y,g,E,u,b,_,Y,Z,$=[],U=e.nil,W=e.$$,H=e.module,t=e.klass,L=e.hash2,n=e.truthy,I=e.send;return e.top.$require("bcdice/result"),l=$,k=Z=[H($[0],"BCDice")].concat(l),i=Y=[H(Z[0],"GameSystem")].concat(k),o=_=[t(Y[0],W(Y,"SwordWorld"),"SwordWorld2_0")].concat(i),u=t(_[0],null,"TranscendentTest"),b=[u].concat(o),u.$$prototype.modifier=u.$$prototype.critical_value=u.$$prototype.expression=u.$$prototype.modifier_str=u.$$prototype.target=u.$$prototype.cmp_op=U,e.const_set(b[0],"RESULT_STR",L(["success","failure","super_success","critical","fumble"],{success:"\u6210\u529f",failure:"\u5931\u6557",super_success:"\u8d85\u6210\u529f",critical:"\u81ea\u52d5\u7684\u6210\u529f",fumble:"\u81ea\u52d5\u7684\u5931\u6557"}).$freeze()),e.def(u,"$initialize",N=function(P,s,h,S){var w=this;return w.critical_value=P,w.modifier=s,w.cmp_op=h,w.target=S,w.modifier_str=W(b,"Format").$modifier(w.modifier),w.expression=w.$node_expression()},N.$$arity=4),e.def(u,"$execute",J=function(P){var h,Ce,ge,S=this,w=U,A=U,ce=U,ve=U,Re=U,ze=U,Pe=U;if(n(function(Q,l){return"number"==typeof Q?Q<3:Q["$<"](3)}(S.critical_value)))return"("+S.expression+") \uff1e \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u304c\u5c0f\u3055\u3059\u304e\u307e\u3059\u30023\u4ee5\u4e0a\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002";if(A=[w=P.$roll_barabara(2,6)],ce=w["$=="]([1,1]),ve=w["$=="]([6,6]),n(n(ge=ce["$!"]())?ve["$!"]():ge))for(;n(X(S.$sum_of_dice(A.$last()),S.critical_value));)A.$push(P.$roll_barabara(2,6));return Re=function(Q,l){return"number"==typeof Q&&"number"==typeof l?Q+l:Q["$+"](l)}(Ce=S.$sum_of_dice(A),S.modifier),ze=S.$result_status(Re,A.$length(),ce,ve),Pe=["("+S.expression+")",""+S.$dice_str(A,Ce)+S.modifier_str,Re,W(b,"RESULT_STR")["$[]"](ze)].$compact(),I(W(b,"Result").$new(),"tap",[],((h=function(re){var a=U;return null==re&&(re=U),a=[Pe.$join(" \uff1e ")],I(re,"text=",e.to_a(a)),r(a.length,1),a=[ze["$=="]("fumble")],I(re,"fumble=",e.to_a(a)),r(a.length,1),a=[ze["$=="]("critical")],I(re,"critical=",e.to_a(a)),r(a.length,1),a=[["success","super_success","critical"]["$include?"](ze)],I(re,"success=",e.to_a(a)),r(a.length,1),a=[["failure","fumble"]["$include?"](ze)],I(re,"failure=",e.to_a(a)),a[r(a.length,1)]}).$$s=S,h.$$arity=1,h))},J.$$arity=1),u.$private(),e.def(u,"$node_expression",D=function(){var s,P=this;return s="2D6@"+P.critical_value+P.modifier_str,n(P.target)?""+s+P.cmp_op+P.target:s},D.$$arity=0),e.def(u,"$sum_of_dice",y=function(P){return P.$flatten().$sum()},y.$$arity=1),e.def(u,"$dice_str",g=function(P,s){var h;return""+s+I(P,"map",[],(h=function(ce){return null==ce&&(ce=U),"["+ce.$join(",")+"]"},h.$$s=this,h.$$arity=1,h)).$join()},g.$$arity=2),void e.def(u,"$result_status",E=function(P,s,h,S){var w=this,A=U;return n(w.target)?n(h)?"fumble":n(S)?"critical":n(P.$send(w.cmp_op,w.target))?n(n(A=X(s,2))?X(P,41):A)?"super_success":"success":"failure":"no_target"},E.$$arity=4)},Opal.modules["bcdice/game_system/SwordWorld2_0"]=function(e){function j(l,x){return"number"==typeof l&&"number"==typeof x?l>x:l["$>"](x)}function X(l,x){return"number"==typeof l&&"number"==typeof x?l+x:l["$+"](x)}function T(l,x){return"number"==typeof l&&"number"==typeof x?l*x:l["$*"](x)}var x,O,d,C,o,u,b,N,J,D,y,g,_,f,M,K,m=e.top,$=[],U=e.nil,c=e.$$$,W=e.$$,H=e.module,t=e.klass,L=e.send2,n=e.truthy,I=e.hash2,Q=e.send;return m.$require("bcdice/arithmetic_evaluator"),m.$require("bcdice/game_system/SwordWorld"),m.$require("bcdice/game_system/sword_world/transcendent_test"),x=$,O=K=[H($[0],"BCDice")].concat(x),d=M=[H(K[0],"GameSystem")].concat(O),_=t(M[0],W(M,"SwordWorld"),"SwordWorld2_0"),f=[_].concat(d),_.$$prototype.randomizer=U,e.const_set(f[0],"ID","SwordWorld2.0"),e.const_set(f[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.0"),e.const_set(f[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u30682.0"),e.const_set(f[0],"HELP_MESSAGE",'\u81ea\u52d5\u7684\u6210\u529f\u3001\u6210\u529f\u3001\u5931\u6557\u3001\u81ea\u52d5\u7684\u5931\u6557\u306e\u81ea\u52d5\u5224\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx)\n\u3000"K\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc+\u30dc\u30fc\u30ca\u30b9"\u306e\u5f62\u3067\u8a18\u5165\u3057\u307e\u3059\u3002\n\u3000\u30dc\u30fc\u30ca\u30b9\u306e\u90e8\u5206\u306b\u300cK20+K30\u300d\u306e\u3088\u3046\u306b\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u53d6\u308b\u3053\u3068\u306f\u51fa\u6765\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001\u30dc\u30fc\u30ca\u30b9\u306f\u8907\u6570\u53d6\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3082\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3068\u540c\u69d8\u306b\u3001\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306b\u96a0\u308c\u3066\u30ed\u30fc\u30eb\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2\n\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u8a2d\u5b9a\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306f"[\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024]"\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u3000\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502410\u3068\u3057\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u51e6\u7406\u304c\u5fc5\u8981\u306a\u3044\u3068\u304d\u306f13\u306a\u3069\u3068\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u9632\u5fa1\u6642\u306a\u3069\u306e\u5bfe\u5fdc)\n\u3000\u307e\u305f\u30bf\u30a4\u30d7\u306e\u8efd\u6e1b\u5316\u306e\u305f\u3081\u306b\u672b\u5c3e\u306b\u300c@\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u300d\u3067\u3082\u51e6\u7406\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u3000\u4f8b\uff09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u534a\u6e1b (HKx, KxH+N)\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u5148\u982d\u307e\u305f\u306f\u672b\u5c3e\u306b"H"\u3092\u3064\u3051\u308b\u3068\u3001\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3092\u632f\u3063\u3066\u6700\u7d42\u7d50\u679c\u3092\u534a\u6e1b\u3055\u305b\u307e\u3059\u3002\n\u3000\u672b\u5c3e\u306b\u3064\u3051\u305f\u5834\u5408\u3001\u76f4\u5f8c\u306b\u4fee\u6b63\u3092\u3092\u3064\u3051\u308b\u3053\u3068\u3067\u3001\u534a\u6e1b\u5f8c\u306e\u52a0\u6e1b\u7b97\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3000\u3053\u306e\u969b\u3001\u8907\u6570\u306e\u9805\u306b\u3088\u308b\u4fee\u6b63\u306b\u306f\u30ab\u30c3\u30b3\u3067\u56f2\u3046\u3053\u3068\u304c\u5fc5\u8981\u3067\u3059\uff08\u30ab\u30c3\u30b3\u304c\u306a\u3044\u3068\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3059\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u306a\u3057\u3068\u6271\u308f\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H(1+1)\n\n\u30fb\u30c0\u30a4\u30b9\u76ee\u306e\u4fee\u6b63\uff08\u904b\u547d\u5909\u8ee2\u3084\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30ec\u30a4\u7528\uff09\n\u3000\u672b\u5c3e\u306b\u300c$\u4fee\u6b63\u5024\u300d\u3067\u30c0\u30a4\u30b9\u76ee\u306b\u4fee\u6b63\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\u3000$\uff0b\uff11\u3068\u4fee\u6b63\u8868\u8a18\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u306b\uff0b\u4fee\u6b63\u3001\uff04\uff19\u306e\u3088\u3046\u306b\u56fa\u5b9a\u5024\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u3092\u305d\u306e\u51fa\u76ee\u306b\u5dee\u3057\u66ff\u3048\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3057\u305f\u5834\u5408\u3067\u3082\u56fa\u5b9a\u5024\u3084\u4fee\u6b63\u5024\u306e\u9069\u7528\u306f\u6700\u521d\u306e\u4e00\u56de\u3060\u3051\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9\n\n\u30fb\u9996\u5207\u308a\u5200\u7528\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u4e0a\u6607 r10\n\u3000\u4f8b\uff09K20r10\u3000K30+24@8R10\u3000K40+24@8$12r10\n\n\u30fb\u30b0\u30ec\u30a4\u30c6\u30b9\u30c8\u30d5\u30a9\u30fc\u30c1\u30e5\u30f3\u306f\u672b\u5c3e\u306b gf\n\u3000\u4f8b\uff09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r10gf\n\n\u30fb\u5a01\u529b\u8868\u30921d+sf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u3082\u7d99\u7d9a sf4\n\u3000\u4f8b\uff09k10sf4\u3000k0+5SF4@13\u3000k70+26sf3@9\n\n\u30fb\u5a01\u529b\u8868\u30921d+tf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u306f2d\u3067\u53c2\u7167 tf3\n\u3000\u4f8b\uff09k10tf3\u3000k0+5TF4@13\u3000k70+26tf3@9\n\n\u30fb\u8d85\u8d8a\u5224\u5b9a\u7528\u306b2d6\u30ed\u30fc\u30eb\u306b 2D6@10 \u66f8\u5f0f\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u4ed8\u4e0e\u304c\u53ef\u80fd\u306b\u3002\n\u3000\u4f8b\uff092D6@10\u30002D6@10+11>=30\n\n\u30fb\u6210\u9577\u3000(Gr)\n\u3000\u672b\u5c3e\u306b\u6570\u5b57\u3092\u4ed8\u52a0\u3059\u308b\u3053\u3068\u3067\u3001\u8907\u6570\u56de\u306e\u6210\u9577\u3092\u307e\u3068\u3081\u3066\u884c\u3048\u307e\u3059\u3002\n\u3000\u4f8b\uff09Gr3\n\n\u30fb\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000(FT)\n\u3000\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u7d61\u307f\u52b9\u679c\u8868\u3000(TT)\n\u3000\u7d61\u307f\u52b9\u679c\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n'),_.$register_prefix("H?K","Gr","2D6?@\\d+","FT","TT"),e.def(_,"$initialize",C=function(R){var h=this;return C.$$p&&(C.$$p=null),L(h,e.find_super_dispatcher(h,"initialize",C,!1,!0),"initialize",[R],null),h.rating_table=2},C.$$arity=1),e.def(_,"$eval_game_system_specific_command",o=function(R){var S,h=this,A=U;return o.$$p&&(o.$$p=null),/^Gr(\d+)?/i["$==="](S=R)?n(R["$=~"](/^Gr(\d+)/i))?h.$growth(W(f,"Regexp").$last_match(1).$to_i()):h.$growth():/^2D6?@\d+/i["$==="](S)?(A=c(W(f,"Command"),"Parser").$new(/2D6?/i,I(["round_type"],{round_type:c(c(W(f,"BCDice"),"RoundType"),"CEIL")})).$enable_critical().$restrict_cmp_op_to(U,">=",">").$parse(R),n(A)?W(f,"TranscendentTest").$new(A.$critical(),A.$modify_number(),A.$cmp_op(),A.$target_number()).$execute(h.randomizer):U):"FT"["$==="](S)?h.$get_fumble_table():"TT"["$==="](S)?h.$get_tangle_table():L(h,e.find_super_dispatcher(h,"eval_game_system_specific_command",o,!1,!0),"eval_game_system_specific_command",[R],null)},o.$$arity=1),e.def(_,"$rating_parser",u=function(){return W(f,"RatingParser").$new(I(["version"],{version:"v2_0"}))},u.$$arity=0),e.def(_,"$rollDice",b=function(R,P){var S=this,w=U,A=U;return b.$$p&&(b.$$p=null),n(j(R.$semi_fixed_val(),0))?[X(w=S.randomizer.$roll_once(6),R.$semi_fixed_val()),w+","+R.$semi_fixed_val()]:n(n(A=P["$=="](0))?j(R.$tmp_fixed_val(),0):A)?[X(w=S.randomizer.$roll_once(6),R.$tmp_fixed_val()),w+","+R.$tmp_fixed_val()]:n(R.$greatest_fortune())?n(R.$greatest_fortune())?[T(w=S.randomizer.$roll_once(6),2),w+","+w]:U:L(S,e.find_super_dispatcher(S,"rollDice",b,!1,!0),"rollDice",[R,P],null)},b.$$arity=2),e.def(_,"$growth",N=function(R){var P;return null==R&&(R=1),Q(e.Range.$new(1,R,!1),"map",[],(P=function(){return(null==P.$$s?this:P.$$s).$growth_step()},P.$$s=this,P.$$arity=0,P)).$join(" | ")},N.$$arity=-1),e.def(_,"$growth_step",J=function(){var P,s,S,R=this,h=U;return P=R.randomizer.$roll_once(6),s=R.randomizer.$roll_once(6),h=R.$get_ability_by_dice(P),S=R.$get_ability_by_dice(s),n(h["$!="](S))?"["+P+","+s+"]->("+h+" or "+S+")":"["+P+","+s+"]->("+h+")"},J.$$arity=0),e.def(_,"$get_ability_by_dice",D=function(R){return["\u5668\u7528\u5ea6","\u654f\u6377\u5ea6","\u7b4b\u529b","\u751f\u547d\u529b","\u77e5\u529b","\u7cbe\u795e\u529b"]["$[]"]("number"==typeof(l=R)?l-1:l["$-"](1));var l},D.$$arity=1),e.def(_,"$get_fumble_table",y=function(){var R,P;return P=this.$get_table_by_1d6(["\u3053\u306e\u8868\u30922\u56de\u632f\u308a\u3001\u305d\u306e\u4e21\u65b9\u3092\u9069\u7528\u3059\u308b\u3002\uff08\u540c\u3058\u51fa\u76ee\u306b\u3088\u308b\u5f71\u97ff\u306f\u7d2f\u7a4d\u3057\u306a\u3044\uff09\u3002\u3053\u306e\u81ea\u52d5\u5931\u6557\u306b\u3088\u308a\u5f97\u3089\u308c\u308b\u7d4c\u9a13\u70b9\u306f\u3001+50\u70b9\u3055\u308c\u308b","\u30c0\u30e1\u30fc\u30b8\u306b\u3001\u653b\u6483\u8005\u3092\u5f37\u5316\u3057\u3066\u3044\u308b\u300c\u5263\u306e\u304b\u3051\u3089\u300d\u306e\u6570\u304c\u8ffd\u52a0\u3055\u308c\u308b","\u30c0\u30e1\u30fc\u30b8\u306b\u3001\u653b\u6483\u8005\u306e\u300c\u30ec\u30d9\u30eb\u300d\u304c\u8ffd\u52a0\u3055\u308c\u308b","\u30c0\u30e1\u30fc\u30b8\u6c7a\u5b9a\u30922\u56de\u884c\u3044\u3001\u3088\u308a\u9ad8\u3044\u65b9\u3092\u63a1\u7528\u3059\u308b","\u5408\u7b97\u30c0\u30e1\u30fc\u30b8\u30922\u500d\u3059\u308b","\u9632\u8b77\u70b9\u7121\u52b9"]),"\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868("+(null==(R=e.to_ary(P))[1]?U:R[1])+") \u2192 "+(null==R[0]?U:R[0])},y.$$arity=0),void e.def(_,"$get_tangle_table",g=function(){var R,P;return P=this.$get_table_by_1d6(["\u982d\u3084\u9854\uff1a\u7259\u3084\u565b\u307f\u3064\u304d\u306a\u3069\u306b\u304a\u3051\u308b\u547d\u4e2d\u529b\u5224\u5b9a\u53ca\u3073\u3001\u9b54\u6cd5\u306e\u884c\u4f7f\u3084\u30d6\u30ec\u30b9\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b","\u6b66\u5668\u3084\u76fe\uff1a\u6b66\u5668\u306e\u4f7f\u7528\u4e0d\u53ef\u3001\u53c8\u306f\u76fe\u306e\u56de\u907f\u529b\u4fee\u6b63\u53ca\u3073\u9632\u8b77\u70b9\u3092\u7121\u52b9\u5316\u3059\u308b","\u8155\u3084\u624b\uff1a\u6b66\u5668\u3084\u722a\u306a\u3069\u306b\u304a\u3051\u308b\u547d\u4e2d\u529b\u5224\u5b9a\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3001\u76fe\u3092\u6301\u3064\u8155\u65b9\u306e\u8155\u306a\u3089\u305d\u306e\u76fe\u306e\u56de\u907f\u529b\u4fee\u6b63\u53ca\u3073\u9632\u8b77\u70b9\u3092\u7121\u52b9\u5316\u3059\u308b","\u811a\u3084\u8db3\uff1a\u79fb\u52d5\u4e0d\u53ef\u3001\u66f4\u306b\u56de\u907f\u529b\u5224\u5b9a\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b \u203b\u4e21\u8db3\u306b\u7d61\u3093\u3067\u3082\u7d2f\u7a4d\u3057\u306a\u3044","\u80f4\u4f53\uff1a\u751f\u547d\u30fb\u7cbe\u795e\u62b5\u6297\u529b\u3092\u57fa\u6e96\u5024\u306b\u7528\u3044\u308b\u5224\u5b9a\u3092\u9664\u304d\u3001\u3042\u3089\u3086\u308b\u884c\u70ba\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b","\u7279\u6b8a\uff1a\u5c3b\u5c3e\u3084\u7ffc\u306a\u3069\u306b\u547d\u4e2d\u3002\u7d61\u3081\u3089\u308c\u305f\u90e8\u4f4d\u3092\u4f7f\u7528\u3059\u308b\u5224\u5b9a\u306b\u304a\u3044\u3066-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3001\u307e\u305f\u306f\u305d\u3053\u304c\u4f7f\u3048\u3066\u3044\u305f\u3053\u3068\u306b\u3088\u308b\u30dc\u30fc\u30ca\u30b9\u4fee\u6b63\u3092\u5931\u3046 \u203b\u5b58\u5728\u3057\u306a\u3044\u5834\u5408\u306f\u6c7a\u3081\u76f4\u3057"]),"\u7d61\u307f\u52b9\u679c\u8868("+(null==(R=e.to_ary(P))[1]?U:R[1])+") \u2192 "+(null==R[0]?U:R[0])},g.$$arity=0)},e=Opal,T=[],r=e.nil,m=e.$$$,$=e.$$,U=e.module,c=e.klass,W=e.send,H=e.hash2,t=e.truthy,L=e.send2,n=e.range,e.top.$require("bcdice/game_system/SwordWorld2_0"),Q=T,K=x=[U(T[0],"BCDice")].concat(Q),p=O=[U(x[0],"GameSystem")].concat(K),i=c(O[0],$(O,"SwordWorld2_0"),"SwordWorld2_5"),d=[i].concat(p),i.$$prototype.randomizer=r,e.const_set(d[0],"ID","SwordWorld2.5"),e.const_set(d[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.5"),e.const_set(d[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u30682.5"),e.const_set(d[0],"HELP_MESSAGE",'\u81ea\u52d5\u7684\u6210\u529f\u3001\u6210\u529f\u3001\u5931\u6557\u3001\u81ea\u52d5\u7684\u5931\u6557\u306e\u81ea\u52d5\u5224\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx)\n\u3000"K\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc+\u30dc\u30fc\u30ca\u30b9"\u306e\u5f62\u3067\u8a18\u5165\u3057\u307e\u3059\u3002\n\u3000\u30dc\u30fc\u30ca\u30b9\u306e\u90e8\u5206\u306b\u300cK20+K30\u300d\u306e\u3088\u3046\u306b\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u53d6\u308b\u3053\u3068\u306f\u51fa\u6765\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001\u30dc\u30fc\u30ca\u30b9\u306f\u8907\u6570\u53d6\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3082\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3068\u540c\u69d8\u306b\u3001\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306b\u96a0\u308c\u3066\u30ed\u30fc\u30eb\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2\n\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u8a2d\u5b9a\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306f"[\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024]"\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u3000\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502410\u3068\u3057\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u51e6\u7406\u304c\u5fc5\u8981\u306a\u3044\u3068\u304d\u306f13\u306a\u3069\u3068\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u9632\u5fa1\u6642\u306a\u3069\u306e\u5bfe\u5fdc)\n\u3000\u307e\u305f\u30bf\u30a4\u30d7\u306e\u8efd\u6e1b\u5316\u306e\u305f\u3081\u306b\u672b\u5c3e\u306b\u300c@\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u300d\u3067\u3082\u51e6\u7406\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u3000\u4f8b\uff09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u534a\u6e1b (HKx, KxH+N)\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u5148\u982d\u307e\u305f\u306f\u672b\u5c3e\u306b"H"\u3092\u3064\u3051\u308b\u3068\u3001\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3092\u632f\u3063\u3066\u6700\u7d42\u7d50\u679c\u3092\u534a\u6e1b\u3055\u305b\u307e\u3059\u3002\n\u3000\u672b\u5c3e\u306b\u3064\u3051\u305f\u5834\u5408\u3001\u76f4\u5f8c\u306b\u4fee\u6b63\u3092\u3092\u3064\u3051\u308b\u3053\u3068\u3067\u3001\u534a\u6e1b\u5f8c\u306e\u52a0\u6e1b\u7b97\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3000\u3053\u306e\u969b\u3001\u8907\u6570\u306e\u9805\u306b\u3088\u308b\u4fee\u6b63\u306b\u306f\u30ab\u30c3\u30b3\u3067\u56f2\u3046\u3053\u3068\u304c\u5fc5\u8981\u3067\u3059\uff08\u30ab\u30c3\u30b3\u304c\u306a\u3044\u3068\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3059\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u306a\u3057\u3068\u6271\u308f\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H+(1+1)\n\n\u30fb\u30c0\u30a4\u30b9\u76ee\u306e\u4fee\u6b63\uff08\u904b\u547d\u5909\u8ee2\u3084\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30ec\u30a4\u7528\uff09\n\u3000\u672b\u5c3e\u306b\u300c$\u4fee\u6b63\u5024\u300d\u3067\u30c0\u30a4\u30b9\u76ee\u306b\u4fee\u6b63\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\u3000$\uff0b\uff11\u3068\u4fee\u6b63\u8868\u8a18\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u306b\uff0b\u4fee\u6b63\u3001\uff04\uff19\u306e\u3088\u3046\u306b\u56fa\u5b9a\u5024\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u3092\u305d\u306e\u51fa\u76ee\u306b\u5dee\u3057\u66ff\u3048\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3057\u305f\u5834\u5408\u3067\u3082\u56fa\u5b9a\u5024\u3084\u4fee\u6b63\u5024\u306e\u9069\u7528\u306f\u6700\u521d\u306e\u4e00\u56de\u3060\u3051\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9\n\n\u30fb\u30c0\u30a4\u30b9\u76ee\u306e\u4fee\u6b63\uff08\u5fc5\u6bba\u653b\u6483\u7528\uff09\n\u3000\u300c\uff03\u4fee\u6b63\u5024\u300d\u3067\u30c0\u30a4\u30b9\u76ee\u306b\u4fee\u6b63\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3057\u305f\u5834\u5408\u3067\u3082\u4fee\u6b63\u5024\u306e\u9069\u7528\u306f\u7d99\u7d9a\u3055\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09K20#1\u3000\u3000\u3000k10-5@9#2\n\n\u30fb\u9996\u5207\u308a\u5200\u7528\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u4e0a\u6607 r5\n\u3000\u4f8b\uff09K20r5\u3000K30+24@8R5\u3000K40+24@8$12r5\n\n\u30fb\u30b0\u30ec\u30a4\u30c6\u30b9\u30c8\u30d5\u30a9\u30fc\u30c1\u30e5\u30f3\u306f\u672b\u5c3e\u306b gf\n\u3000\u4f8b\uff09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r5gf\n\n\u30fb\u5a01\u529b\u8868\u30921d+sf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u3082\u7d99\u7d9a sf4\n\u3000\u4f8b\uff09k10sf4\u3000k0+5sf4@13\u3000k70+26sf3@9\n\n\u30fb\u5a01\u529b\u8868\u30921d+tf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u306f2d\u3067\u53c2\u7167 tf3\n\u3000\u4f8b\uff09k10tf3\u3000k0+5tf4@13\u3000k70+26tf3@9\n\n\u30fb\u8d85\u8d8a\u5224\u5b9a\u7528\u306b2d6\u30ed\u30fc\u30eb\u306b 2D6@10 \u66f8\u5f0f\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u4ed8\u4e0e\u304c\u53ef\u80fd\u306b\u3002\n\u3000\u4f8b\uff092D6@10\u30002D6@10+11>=30\n\n\u30fb\u6210\u9577\u3000(Gr)\n\u3000\u672b\u5c3e\u306b\u6570\u5b57\u3092\u4ed8\u52a0\u3059\u308b\u3053\u3068\u3067\u3001\u8907\u6570\u56de\u306e\u6210\u9577\u3092\u307e\u3068\u3081\u3066\u884c\u3048\u307e\u3059\u3002\n\u3000\u4f8b\uff09Gr3\n\n\u30fb\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000(FT)\n\u3000\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u7d61\u307f\u52b9\u679c\u8868\u3000(TT)\n\u3000\u7d61\u307f\u52b9\u679c\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u30c9\u30eb\u30a4\u30c9\u306e\u7269\u7406\u9b54\u6cd5\u7528\u8868\u3000(Dru[2-6\u306e\u5024,7-9\u306e\u5024,10-12\u306e\u5024])\n\u3000\u4f8b\uff09Dru[0,3,6]+10-3\n\n\u30fb\u30a2\u30d3\u30b9\u30ab\u30fc\u30b9\u8868\u3000(ABT)\n\u3000\u30a2\u30d3\u30b9\u30ab\u30fc\u30b9\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n'),i.$register_prefix("H?K","Gr","2D6?@\\d+","FT","TT","Dru","ABT"),e.const_set(d[0],"ABYSS_CURSE_TABLE",m($(d,"DiceTable"),"D66GridTable").$new("\u30a2\u30d3\u30b9\u30ab\u30fc\u30b9\u8868",[["\u300c\u81ea\u50b7\u306e\u300d\u3000\u88c5\u5099\u6642\u3000\u3053\u306e\u6b66\u5177\u3092\u88c5\u5099\u4e2d\u306b\u88c5\u5099\u8005\u304c\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3092\u767a\u751f\u3055\u305b\u305f\u6642\u3001\u88c5\u5099\u8005\u306eHP\u304c5\u70b9\u6e1b\u5c11\u3059\u308b\u3002","\u300c\u5606\u304d\u306e\u300d\u3000\u88c5\u5099\u6642\u3000\u8fd1\u304f\u306b\u6575\u304c\u3044\u305f\u308a\u3001\u9577\u3044\u7dca\u5f35\u72b6\u614b\u304c\u7d9a\u304f\u3068\u6d99\u304c\u6b62\u307e\u3089\u306a\u304f\u306a\u308b\u3002\u6226\u95d8\u4e2d\u306a\u3089\u300c\u5c04\u7a0b\uff1a\u8853\u8005\uff08\u81ea\u8eab\uff09\u300d\u300c\u5c04\u7a0b\uff1a\u63a5\u89e6\u300d\u4ee5\u5916\u306e\u52b9\u679c\u3067\u5bfe\u8c61\u3092\u9078\u3079\u306a\u304f\u306a\u308b\u3002","\u300c\u512a\u3057\u304d\u300d\u3000\u88c5\u5099\u6642\u3000\u6575\u306b\u540c\u60c5\u3057\u3066\u3057\u307e\u3046\u3002\u6575\u5bfe\u3059\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u5bfe\u8c61\u306b\u3059\u308b\u5834\u5408\u3001\u5bfe\u8c61\u306eHP\u304c1\u70b9\u4ee5\u4e0a\u6e1b\u5c11\u3057\u3066\u3044\u308b\u306a\u3089\u547d\u4e2d\u529b\u5224\u5b9a\u3001\u9b54\u6cd5\u884c\u4f7f\u5224\u5b9a\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u5dee\u5225\u306e\u300d\u3000\u88c5\u5099\u6642\u3000\u7279\u5b9a\u306e\u5206\u985e\u306b\u5bfe\u3057\u3066\u4e0e\u3048\u308b\u7269\u7406\u30c0\u30e1\u30fc\u30b8\u30fb\u9b54\u6cd5\u30c0\u30e1\u30fc\u30b8\u304c2\u70b9\u6e1b\u5c11\u3059\u308b\u3002\u5206\u985e\u306f\u300c\u5206\u985e\u6c7a\u5b9a\u8868\u300d\u3067\u7121\u4f5c\u70ba\u306b\u6c7a\u5b9a\u3059\u308b\u3002","\u300c\u8106\u5f31\u306a\u300d\u3000\u88c5\u5099\u6642\u3000\u9b54\u6cd5\u30c0\u30e1\u30fc\u30b8\u3092\u53d7\u3051\u308b\u305f\u3073\u3001\u305d\u306e\u30c0\u30e1\u30fc\u30b8\u304c+1\u70b9\u3055\u308c\u308b\u3002","\u300c\u7121\u8b00\u306a\u300d\u3000\u88c5\u5099\u6642\u3000\u9632\u8b77\u70b9\u304c2\u70b9\u6e1b\u5c11\u3059\u308b\uff08\u6700\u4f4e0\uff09\u3002"],["\u300c\u91cd\u3044\u300d\u3000\u88c5\u5099\u6642\u3000\u5f37\u5316\u3057\u305f\u6b66\u5177\u306e\u5fc5\u8981\u7b4b\u529b\u304c+2\u3055\u308c\u308b\u3002\u5a01\u529b\u3001\u9632\u8b77\u70b9\u306a\u3069\u306f\u5909\u5316\u306a\u3057\u3002","\u300c\u96e3\u3057\u3044\u300d\u3000\u88c5\u5099\u6642\u3000\u3044\u304b\u306a\u308b\u5a01\u529b\u8868\u4f7f\u7528\u6642\u3067\u3082\u3001\u2462\u2463\u6b04\u306e\u6570\u5024\u304c\u5a01\u529b\u306b\u95a2\u4fc2\u306a\u304f\u300c0\u300d\u306b\u306a\u308b\uff08\u81ea\u52d5\u5931\u6557\u3067\u306f\u306a\u3044\uff09\u3002","\u300c\u8edf\u5f31\u306a\u300d\u3000\u88c5\u5099\u6642\u3000\u7cbe\u795e\u62b5\u6297\u529b\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u75c5\u5f31\u306a\u300d\u3000\u88c5\u5099\u6642\u3000\u751f\u547d\u62b5\u6297\u529b\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u904e\u654f\u306a\u300d\u3000\u88c5\u5099\u6642\u3000\u7279\u5b9a\u306e\u5c5e\u6027\u304b\u3089\u53d7\u3051\u308b\u7269\u7406\u30c0\u30e1\u30fc\u30b8\u3001\u9b54\u6cd5\u30c0\u30e1\u30fc\u30b8\u304c2\u70b9\u4e0a\u6607\u3059\u308b\u3002\u5c5e\u6027\u306f\u300c\u5c5e\u6027\u6c7a\u5b9a\u8868\u300d\u3067\u7121\u4f5c\u70ba\u306b\u6c7a\u5b9a\u3059\u308b\u3002","\u300c\u967d\u6c17\u306a\u300d\u3000\u88c5\u5099\u6642\u3000\u7cbe\u795e\u62b5\u6297\u5224\u5b9a\u306b\u5931\u6557\u3059\u308b\u305f\u3073\u3001\u7b11\u3044\u304c\u6b62\u307e\u3089\u306a\u304f\u306a\u308b\u3002\u6b21\u306e\u624b\u756a\u7d42\u4e86\u6642\u307e\u3067\u884c\u52d5\u5224\u5b9a\uff08\u300e\u2160\u300f123\u9801\uff09\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002\u3053\u306e\u52b9\u679c\u306f\u7d2f\u7a4d\u3059\u308b\u3002"],["\u300c\u305f\u3069\u305f\u3069\u3057\u3044\u300d\u3000\u88c5\u5099\u6642\u3000\u8a71\u3092\u3059\u308b\u6642\u306b\u8a00\u8449\u306b\u8a70\u307e\u3063\u305f\u308a\u3001\u8a00\u3044\u9593\u9055\u3048\u305f\u308a\u3057\u3084\u3059\u304f\u306a\u308b\u3002\u9b54\u6cd5\u884c\u4f7f\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u4ee3\u5f01\u3059\u308b\u300d\u3000\u88c5\u5099\u6642\u3000\u81ea\u8eab\u306e\u4f1a\u8a71\u306f\u3001\u305d\u306e\u307e\u307e\u6b66\u5177\u304c\u9b54\u6cd5\u6587\u660e\u8a9e\u306e\u805e\u304d\u53d6\u308a\u3065\u3089\u3044\u58f0\u3067\u8a71\u3059\u3002\u88c5\u5099\u4e2d\u306f\u9b54\u6cd5\u6587\u660e\u8a9e\u4ee5\u5916\u306e\u8a00\u8a9e\u3067\u4f1a\u8a71\u306f\u884c\u3048\u305a\u3001\u5996\u7cbe\u9b54\u6cd5\u3001\u9b54\u52d5\u6a5f\u8853\u3092\u884c\u4f7f\u3067\u304d\u306a\u304f\u306a\u308b\u3002","\u300c\u65bd\u3057\u306f\u53d7\u3051\u306a\u3044\u300d\u3000\u88c5\u5099\u6642\u3000\u6226\u95d8\u4e2d\u3001\u300c\u62b5\u6297\uff1a\u4efb\u610f\u300d\u306e\u52b9\u679c\u3092\u53d7\u3051\u5165\u308c\u305f\u5834\u5408\u3001\u6b21\u306e\u624b\u756a\u7d42\u4e86\u6642\u307e\u3067\u751f\u547d\u62b5\u6297\u529b\u3001\u7cbe\u795e\u62b5\u6297\u529b\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u6b7b\u306b\u8fd1\u3044\u300d\u3000\u643a\u884c\u6642\u3000\u5e38\u306b\u751f\u6b7b\u5224\u5b9a\u306b\u300c\u5192\u967a\u8005\u30ec\u30d9\u30eb\u300d\u3068\u540c\u3058\u5024\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u304a\u3057\u3083\u308c\u306a\u300d\u3000\u643a\u884c\u6642\u3000\u305d\u306e\u6b66\u5177\u3092\u5e38\u306b\u83ef\u7f8e\u306b\u98fe\u308a\u305f\u304f\u306a\u308b\u3002\u53ce\u5165\u3092\u5f97\u308b\u305f\u3073\u3001\u305d\u306e1\u5272\u4ee5\u4e0a\u3092\u3053\u306e\u6b66\u5177\u306e\u88c5\u98fe\u306b\u8cbb\u3084\u3055\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\uff08\u52b9\u679c\u306a\u3069\u306b\u5909\u5316\u306f\u306a\u3044\uff09\u3002","\u300c\u30de\u30ca\u3092\u5438\u3046\u300d\u3000\u643a\u884c\u6642\u3000\u9b54\u6cd5\u3084\u7df4\u6280\u306a\u3069\u3001\u81ea\u8eab\u306e\u610f\u601d\u3067MP\u3092\u6d88\u8cbb\u3059\u308b\u52b9\u679c\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u3001\u3059\u3079\u3066\u306eMP\u6d88\u8cbb\u304c1\u70b9\u4e0a\u6607\u3059\u308b\u3002"],["\u300c\u920d\u91cd\u306a\u300d\u3000\u643a\u884c\u6642\u3000\u79fb\u52d5\u529b\u304c\u534a\u5206\uff08\u7aef\u6570\u5207\u308a\u4e0a\u3052\uff09\u306b\u306a\u308b\u3002","\u300c\u5b9a\u307e\u3089\u306a\u3044\u300d\u3000\u643a\u884c\u6642\u3000\u6226\u95d8\u4e2d\u306e\u624b\u756a\u958b\u59cb\u6642\u306b1d\u3057\u3001\u51fa\u76ee\u304c\u300c1\u300d\u306a\u3089\u300a\u30bf\u30fc\u30b2\u30c3\u30c6\u30a3\u30f3\u30b0\u300b\u3068\u305d\u308c\u3092\u524d\u63d0\u3068\u3057\u305f\u6226\u95d8\u7279\u6280\u3092\u7fd2\u5f97\u3057\u3066\u3044\u306a\u3044\u3082\u306e\u3068\u3057\u3066\u6271\u3046\u3002","\u300c\u932f\u4e71\u306e\u300d\u3000\u643a\u884c\u6642\u3000\u6226\u95d8\u4e2d\u306e\u624b\u756a\u958b\u59cb\u6642\u306b1d\u3057\u3001\u51fa\u76ee\u304c\u300c1\u300d\u306a\u3089\u8fd1\u63a5\u653b\u6483\u3092\u542b\u3080\u300c\u5c04\u7a0b\uff1a\u63a5\u89e6\u300d\u306e\u5bfe\u8c61\u306b\u52b9\u679c\u3092\u4f7f\u7528\u3059\u308b\u969b\u3001\u5bfe\u8c61\u306f\u540c\u3058\u4f4d\u7f6e\uff08\u30a8\u30ea\u30a2\u3001\u5ea7\u6a19\uff09\u306e\u5168\u3066\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\uff08\u6575\u5473\u65b9\u542b\u3080\uff09\u304b\u3089\u7121\u4f5c\u70ba\u306b\u9078\u3070\u308c\u308b\u3002","\u300c\u8db3\u7d61\u307f\u306e\u300d\u3000\u643a\u884c\u6642\u3000\u6226\u95d8\u4e2d\u306e\u624b\u756a\u958b\u59cb\u6642\u306b1d\u3057\u3001\u51fa\u76ee\u304c\u300c1\u300d\u306a\u3089\u305d\u306e\u5834\u3067\u5373\u5ea7\u306b\u8ee2\u5012\u3059\u308b\u3002\u624b\u756a\u4e2d\u306b\u306f\u8d77\u304d\u4e0a\u304c\u308c\u306a\u3044\u3002","\u300c\u6ed1\u308a\u843d\u3061\u308b\u300d\u3000\u643a\u884c\u6642\u3000\u6226\u95d8\u4e2d\u306e\u624b\u756a\u958b\u59cb\u6642\u306b1d\u3057\u3001\u51fa\u76ee\u304c\u300c1\u300d\u306a\u3089\u624b\u306b\u88c5\u5099\u307e\u305f\u306f\u4fdd\u6301\u3057\u3066\u3044\u308b\u3082\u306e\u3092\u3059\u3079\u3066\u305d\u306e\u5834\u306b\u843d\u3068\u3059\uff08\u305d\u306e\u624b\u756a\u306e\u4e3b\u52d5\u4f5c\u3067\u62fe\u3046\u4e8b\u306f\u53ef\u80fd\uff09\u3002","\u300c\u60aa\u81ed\u653e\u3064\u300d\u3000\u643a\u884c\u6642\u3000\u5f37\u3044\u60aa\u81ed\u3092\u653e\u3064\u3002\u6240\u6301\u3057\u3066\u3044\u308b\u3060\u3051\u3067\u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e0d\u5feb\u611f\u3092\u4e0e\u3048\u3001\u96a0\u5bc6\u5224\u5b9a\u306b-2\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002\u3055\u3089\u306b\u5192\u967a\u8005\u30e9\u30f3\u30af\uff08\u300e\u2161\u300f137\u9801\uff09\u304c1\u6bb5\u968e\u4f4e\u3044\u3082\u306e\u3068\u3057\u3066\u6271\u308f\u308c\u308b\u3002"],["\u300c\u919c\u60aa\u306a\u300d\u3000\u643a\u884c\u6642\u3000\u6b66\u5177\u306e\u898b\u305f\u76ee\u304c\u60aa\u304f\u3001\u9b45\u529b\u304c\u306a\u3044\u3002\u58f2\u5374\u3059\u308b\u969b\u3001\u57fa\u672c\u53d6\u5f15\u4fa1\u683c\u306e4\u5206\u306e1\u306e\u4fa1\u683c\u3067\u58f2\u5374\u3059\u308b\u3002\u3055\u3089\u306b\u5192\u967a\u8005\u30e9\u30f3\u30af\uff08\u300e\u2161\u300f137\u9801\uff09\u304c1\u6bb5\u968e\u4f4e\u3044\u3082\u306e\u3068\u3057\u3066\u6271\u308f\u308c\u308b\u3002","\u300c\u5538\u308b\u300d\u3000\u643a\u884c\u6642\u3000\u305d\u306e\u6b66\u5177\u304b\u3089\u5e38\u306b\u7fbd\u866b\u304c\u98db\u3073\u4ea4\u3046\u3088\u3046\u306a\u97f3\u304c\u97ff\u304f\u3002\u96a0\u5bc6\u5224\u5b9a\u3001\u5371\u967a\u611f\u77e5\u5224\u5b9a\u306b-4\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u3075\u3084\u3051\u305f\u300d\u3000\u643a\u884c\u6642\u3000\u6c34\u3092\u5438\u3063\u305f\u3088\u3046\u306b\u3075\u3084\u3051\u305f\u8cea\u611f\u3092\u3057\u3066\u3044\u308b\u3002\u8ffd\u52a0\u30c0\u30e1\u30fc\u30b8-1\uff08\u6b66\u5668\uff09\u3001\u9632\u8b77\u70b9-1\uff08\u93a7\u3001\u76fe\uff09\u3002\u75c5\u6c17\u5c5e\u6027\u306e\u52b9\u679c\u306b\u5bfe\u3059\u308b\u751f\u547d\u62b5\u6297\u529b\u3001\u7cbe\u795e\u62b5\u6297\u529b\u5224\u5b9a\u306b-4\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u53e4\u50b7\u306e\u300d\u3000\u643a\u884c\u6642\u3000HP\u3092\u56de\u5fa9\u3059\u308b\u52b9\u679c\uff08\u4f11\u606f\u306b\u3088\u308b\u56de\u5fa9\u3092\u542b\u3080\uff09\u3092\u53d7\u3051\u305f\u5834\u5408\u3001\u305d\u306e\u56de\u5fa9\u91cf\u304c1\u70b9\u6e1b\u5c11\u3059\u308b\u3002","\u300c\u307e\u3070\u3086\u3044\u300d\u3000\u643a\u884c\u6642\u3000\u5149\u306a\u3069\u3092\u5f3e\u3044\u3066\u5f37\u304f\u8f1d\u304f\u3002\u81ea\u8eab\u306f\u5e38\u306b\u8996\u754c\u304c\u60aa\u3044\u4e8b\u306b\u3088\u308b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u6804\u5149\u306a\u304d\u300d\u3000\u643a\u884c\u6642\u3000\u884c\u70ba\u5224\u5b9a\u3067\u81ea\u52d5\u6210\u529f\u3057\u305f\u969b\u3001\u81ea\u52d5\u6210\u529f\u3068\u306f\u6271\u308f\u305a\u30012d\u3092\u632f\u308a\u76f4\u3057\u3001\u305d\u306e\u5f8c\u306e\u51fa\u76ee\u306b\u5f93\u3046\u3002\u3053\u306e\u52b9\u679c\u306f1\u65e5\u306b1\u56de\u306e\u307f\u767a\u63ee\u3055\u308c\u308b\u3002"],["\u300c\u6b63\u76f4\u8005\u306e\u300d\u3000\u643a\u884c\u6642\u3000\u5618\u3001\u65b9\u4fbf\u304c\u3059\u3050\u3070\u308c\u308b\u3088\u3046\u306b\u306a\u308b\u3002\u771f\u507d\u5224\u5b9a\u306e\u5bfe\u8c61\u3068\u306a\u308b\u5834\u5408\u3001-4\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u4e57\u308a\u7269\u9154\u3044\u306e\u300d\u3000\u643a\u884c\u6642\u3000\u63fa\u308c\u306b\u5f31\u304f\u306a\u308b\u3002\u81ea\u8eab\u306e\u8db3\u4ee5\u5916\u306e\u624b\u6bb5\u306710\u5206\u4ee5\u4e0a\u79fb\u52d5\u3057\u305f\u5f8c\u30011\u6642\u9593\u3001\u884c\u52d5\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u78a7\u3092\u53ad\u3046\u300d\u3000\u643a\u884c\u6642\u3000\u81ea\u7136\u306e\u4e2d\u3067\u306f\u843d\u3061\u7740\u304b\u306a\u304f\u306a\u308b\u3002\u81ea\u7136\u74b0\u5883\uff08\u300e\u2160\u300f108\u9801\uff09\u3067\u306f\u884c\u52d5\u5224\u5b9a\u306b-1\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u6211\u6162\u3067\u304d\u306a\u3044\u300d\u3000\u643a\u884c\u6642\u3000\u30bb\u30c3\u30b7\u30e7\u30f3\u4e2d\u306b1\u65e5\u306e\u59cb\u307e\u308a\u3092\u8fce\u3048\u308b\u305f\u3073\u3001\u8da3\u5473\u3084\u55dc\u597d\u54c1\u306a\u3069\u306b\u300c\u5192\u967a\u8005\u30ec\u30d9\u30eb\xd710\u300d\u30ac\u30e1\u30eb\u3092\u51fa\u8cbb\u3057\u306a\u3051\u308c\u3070\u306a\u3089\u306a\u3044\u3002\u8da3\u5473\u3084\u55dc\u597d\u54c1\u304c\u6d88\u8cbb\u3067\u304d\u306a\u3044\u74b0\u5883\u3067\u3042\u308c\u3070\u3001\u7fcc\u65e5\u306e\u671d\u307e\u3067\u6700\u5927HP\u3001\u6700\u5927MP\u304c\u300c\u5192\u967a\u8005\u30ec\u30d9\u30eb\u300d\u70b9\u6e1b\u5c11\u3059\u308b\u3002","\u300c\u3064\u304d\u307e\u3068\u3046\u300d\u3000\u643a\u884c\u6642\u3000\u3053\u306e\u6b66\u5177\u304c\u6c17\u304c\u3064\u3051\u3070\u8eab\u306e\u56de\u308a\u306b\u3042\u308b\u3002\u3053\u306e\u6b66\u5177\u4ee5\u5916\u3067\u306e\u547d\u4e2d\u529b\u5224\u5b9a\u3001\u9b54\u6cd5\u884c\u4f7f\u5224\u5b9a\uff08\u6b66\u5668\uff09\u3001\u56de\u907f\u529b\u5224\u5b9a\uff08\u93a7\u3001\u76fe\uff09\u306b-4\u306e\u30da\u30ca\u30eb\u30c6\u30a3\u4fee\u6b63\u3092\u53d7\u3051\u308b\u3002","\u300c\u306e\u308d\u307e\u306a\u300d\u3000\u643a\u884c\u6642\u3000\u6226\u95d8\u958b\u59cb\u51e6\u7406\u306e\u300c\u6226\u95d8\u6e96\u5099\u300d\u3092\u3044\u3063\u3055\u3044\u884c\u3048\u306a\u304f\u306a\u308b\u3002"]])),e.const_set(d[0],"ABYSS_CURSE_CATEGORY_TABLE",m($(d,"DiceTable"),"D66ParityTable").$new("\u30a2\u30d3\u30b9\u30ab\u30fc\u30b9\u5206\u985e\u6c7a\u5b9a\u8868",["\u86ee\u65cf","\u52d5\u7269","\u690d\u7269","\u30a2\u30f3\u30c7\u30c3\u30c9","\u9b54\u6cd5\u751f\u7269","\u300c\u86ee\u65cf\u300d\u300c\u52d5\u7269\u300d\u300c\u690d\u7269\u300d\u300c\u30a2\u30f3\u30c7\u30c3\u30c9\u300d\u300c\u9b54\u6cd5\u751f\u7269\u300d\u304b\u3089\u4efb\u610f"],["\u9b54\u52d5\u6a5f","\u5e7b\u7363","\u5996\u7cbe","\u9b54\u795e","\u4eba\u65cf","\u300c\u9b54\u52d5\u6a5f\u300d\u300c\u5e7b\u7363\u300d\u300c\u5996\u7cbe\u300d\u300c\u9b54\u795e\u300d\u300c\u4eba\u65cf\u300d\u304b\u3089\u4efb\u610f"])),e.const_set(d[0],"ABYSS_CURSE_ATTR_TABLE",m($(d,"DiceTable"),"D66ParityTable").$new("\u30a2\u30d3\u30b9\u30ab\u30fc\u30b9\u5c5e\u6027\u6c7a\u5b9a\u8868",["\u571f","\u6c34\u30fb\u6c37","\u708e","\u98a8","\u96f7","\u7d14\u7c8b\u30a8\u30cd\u30eb\u30ae\u30fc"],["\u65ad\u7a7a","\u885d\u6483","\u6bd2","\u75c5\u6c17","\u546a\u3044","\u7cbe\u795e\u52b9\u679c"])),e.def(i,"$eval_game_system_specific_command",_=function(b){var y,D=this,g=r,R=r;return _.$$p&&(_.$$p=null),/^dru\[(\d+),(\d+),(\d+)\]/i["$==="](y=b)?(g=W($(d,"Regexp").$last_match().$captures(),"map",[],"to_i".$to_proc()),R=m($(d,"Command"),"Parser").$new(/dru\[\d+,\d+,\d+\]/i,H(["round_type"],{round_type:m(m($(d,"BCDice"),"RoundType"),"CEIL")})).$parse(b),t(R)?D.$druid_dice(R,g):r):"ABT"["$==="](y)?D.$get_abyss_curse_table():L(D,e.find_super_dispatcher(D,"eval_game_system_specific_command",_,!1,!0),"eval_game_system_specific_command",[b],null)},_.$$arity=1),e.def(i,"$rating_parser",f=function(){return $(d,"RatingParser").$new(H(["version"],{version:"v2_5"}))},f.$$arity=0),e.def(i,"$druid_dice",C=function(b,N){var y,R,P,g,E,D=r;return E=y=(D=this.randomizer.$roll_barabara(2,6)).$sum(),g=n(2,6,!1)["$==="](E)?0:n(7,9,!1)["$==="](E)?1:n(10,12,!1)["$==="](E)?2:r,P=function(I,Q){return"number"==typeof I&&"number"==typeof Q?I+Q:I["$+"](Q)}(R=N["$[]"](g),b.$modify_number()),["("+b.$command().$capitalize()+$(d,"Format").$modifier(b.$modify_number())+")","2D["+D.$join(",")+"]="+y,""+R+$(d,"Format").$modifier(b.$modify_number()),P].$join(" \uff1e ")},C.$$arity=2),e.def(i,"$get_abyss_curse_table",o=function(){var D,b=this,N=r,J=r;return D=(N=$(d,"ABYSS_CURSE_TABLE").$roll(b.randomizer)).$value(),J=14["$==="](D)?$(d,"ABYSS_CURSE_CATEGORY_TABLE").$roll(b.randomizer).$to_s():25["$==="](D)?$(d,"ABYSS_CURSE_ATTR_TABLE").$roll(b.randomizer).$to_s():r,[N.$to_s(),J].$compact().$join("\n")},o.$$arity=0)}}]);