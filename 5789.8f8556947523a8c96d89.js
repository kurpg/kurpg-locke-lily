(self.webpackChunkudonarium_lily=self.webpackChunkudonarium_lily||[]).push([[5789],{5789:function(Ie,Ue,Be){Be(4656),Opal.modules["racc/parser"]=function(e){function se(I,P){return"number"==typeof I&&"number"==typeof P?I<P:I["$<"](P)}function ae(I,P){return"number"==typeof I&&"number"==typeof P?I-P:I["$-"](P)}function o(I,P){return"number"==typeof I&&"number"==typeof P?I+P:I["$+"](P)}function _(I,P){return"number"==typeof I&&"number"==typeof P?I>=P:I["$>="](P)}function Y(I,P){return"number"==typeof I&&"number"==typeof P?I>P:I["$>"](P)}function h(I,P){return"number"==typeof I&&"number"==typeof P?I<=P:I["$<="](P)}var K,G,p,P,z,te=[],r=e.nil,ne=e.$$$,y=e.$$,ve=e.module,M=e.klass,u=e.truthy,V=e.gvars,E=e.send;return P=te,K=(z=[ve(te[0],"Racc")].concat(P))[0],G=y(z,"StandardError"),p=z,[M(K,G,"ParseError")].concat(p),u(ne("::","ParseError","skip_raise")?"constant":r)||e.const_set(te[0],"ParseError",ne(y(te,"Racc"),"ParseError")),function(I,P){var g,A,k,U,b,w,H,Z,x,O,$e,fe,T,t,n,c,a,R,X,le,ee,ie,Q,ye,W,$,S,z=[ve(I,"Racc")].concat(P);u(y(z,"Racc_No_Extensions","skip_raise")?"constant":r)||e.const_set(z[0],"Racc_No_Extensions",!1),g=z,$=M(z[0],null,"Parser"),S=[$].concat(g),$.$$prototype.yydebug=$.$$prototype.racc_debug_out=$.$$prototype.racc_error_status=$.$$prototype.racc_t=$.$$prototype.racc_vstack=$.$$prototype.racc_val=$.$$prototype.racc_state=$.$$prototype.racc_tstack=r,e.const_set(S[0],"Racc_Runtime_Version","1.4.6"),e.const_set(S[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),e.const_set(S[0],"Racc_Runtime_Core_Version_R","1.4.6"),e.const_set(S[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),e.const_set(S[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),e.const_set(S[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),e.const_set(S[0],"Racc_Runtime_Core_Version",y(S,"Racc_Runtime_Core_Version_R")),e.const_set(S[0],"Racc_Runtime_Core_Revision",y(S,"Racc_Runtime_Core_Revision_R")),e.const_set(S[0],"Racc_Runtime_Type","ruby"),e.defs(y(S,"Parser"),"$racc_runtime_type",A=function(){return y(S,"Racc_Runtime_Type")},A.$$arity=0),e.def($,"$_racc_setup",k=function(){var l,L,i=this,B=r,m=r,f=r;return null==V.stderr&&(V.stderr=r),u(ne(i.$class(),"Racc_debug_parser"))||(i.yydebug=!1),u(null!=(l=i.yydebug)&&l!==r?"instance-variable":r)||(i.yydebug=!1),u(i.yydebug)&&(u(null!=(L=i.racc_debug_out)&&L!==r?"instance-variable":r)||(i.racc_debug_out=V.stderr),i.racc_debug_out=u(B=i.racc_debug_out)?B:V.stderr),m=ne(i.$class(),"Racc_arg"),u(se(m.$size(),14))&&(E(m,"[]=",e.to_a(f=[13,!0])),ae(f.length,1)),m},k.$$arity=0),e.def($,"$_racc_init_sysvars",U=function(){var l=this;return l.racc_state=[0],l.racc_tstack=[],l.racc_vstack=[],l.racc_t=r,l.racc_val=r,l.racc_read_next=!0,l.racc_user_yyerror=!1,l.racc_error_status=0},U.$$arity=0),e.def($,"$do_parse",b=function(){return this.$__send__(y(S,"Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},b.$$arity=0),e.def($,"$next_token",w=function(){return this.$raise(y(S,"NotImplementedError"),this.$class()+"#next_token is not defined")},w.$$arity=0),e.def($,"$_racc_do_parse_rb",H=function(l,L){var i,m,f=this,re=r,pe=r,ce=r,ge=r,me=r,_e=r,j=r,v=r;return i=e.to_ary(l),re=null==i[0]?r:i[0],pe=null==i[1]?r:i[1],ce=null==i[2]?r:i[2],ge=null==i[3]?r:i[3],me=null==i[10]?r:i[10],f.$_racc_init_sysvars(),_e=j=v=r,E(f,"catch",["racc_end_parse"],((m=function(){var q,be,s=null==m.$$s?this:m.$$s,he=r,xe=r,Se=r;for(null==s.racc_state&&(s.racc_state=r),null==s.racc_read_next&&(s.racc_read_next=r),null==s.racc_t&&(s.racc_t=r),null==s.yydebug&&(s.yydebug=r),null==s.racc_val&&(s.racc_val=r);u(!0);)for(u(v=ge["$[]"](s.racc_state["$[]"](-1)))?(u(s.racc_read_next)&&u(s.racc_t["$!="](0))&&(be=s.$next_token(),q=e.to_ary(be),_e=null==q[0]?r:q[0],s.racc_val=null==q[1]?r:q[1],s.racc_t=u(_e)?u(he=me["$[]"](_e))?he:1:0,u(s.yydebug)&&s.$racc_read_token(s.racc_t,_e,s.racc_val),s.racc_read_next=!1),v=o(v,s.racc_t),u(u(xe=u(Se=_(v,0))?j=re["$[]"](v):Se)?pe["$[]"](v)["$=="](s.racc_state["$[]"](-1)):xe)||(j=ce["$[]"](s.racc_state["$[]"](-1)))):j=ce["$[]"](s.racc_state["$[]"](-1));u(j=s.$_racc_evalact(j,l)););}).$$s=f,m.$$arity=0,m))},H.$$arity=2),e.def($,"$yyparse",Z=function(l,L){return this.$__send__(y(S,"Racc_YY_Parse_Method"),l,L,this.$_racc_setup(),!0)},Z.$$arity=2),e.def($,"$_racc_yyparse_rb",x=function(l,L,i,B){var m,re,ce=r,ge=r,ue=r,me=r,j=r,v=r,D=r;return m=e.to_ary(i),ce=null==m[0]?r:m[0],ge=null==m[1]?r:m[1],ue=null==m[2]?r:m[2],me=null==m[3]?r:m[3],j=null==m[10]?r:m[10],this.$_racc_init_sysvars(),v=r,D=r,E(this,"catch",["racc_end_parse"],((re=function(){var he,C=null==re.$$s?this:re.$$s;for(null==C.racc_state&&(C.racc_state=r);!u(D=me["$[]"](C.racc_state["$[]"](-1)));)for(;u(v=C.$_racc_evalact(ue["$[]"](C.racc_state["$[]"](-1)),i)););return E(l,"__send__",[L],((he=function(Se,Re){var Ne,Pe,de=null==he.$$s?this:he.$$s,Ee=r,Ae=r,we=r,ze=r,Te=r,Ce=r,Le=r;for(null==de.racc_t&&(de.racc_t=r),null==de.racc_state&&(de.racc_state=r),null==de.racc_read_next&&(de.racc_read_next=r),null==Se&&(Se=r),null==Re&&(Re=r),de.racc_t=u(Se)?u(Ee=j["$[]"](Se))?Ee:1:0,de.racc_val=Re,de.racc_read_next=!1,D=o(D,de.racc_t),u(u(Ne=u(Pe=_(D,0))?v=ce["$[]"](D):Pe)?ge["$[]"](D)["$=="](de.racc_state["$[]"](-1)):Ne)||(v=ue["$[]"](de.racc_state["$[]"](-1)));u(v=de.$_racc_evalact(v,i)););for(;u(u(Ae=u(we=(D=me["$[]"](de.racc_state["$[]"](-1)))["$!"]())?we:de.racc_read_next["$!"]())?Ae:de.racc_t["$=="](0));)for(u(u(ze=u(Te=u(Ce=u(Le=D)?D=o(D,de.racc_t):Le)?_(D,0):Ce)?v=ce["$[]"](D):Te)?ge["$[]"](D)["$=="](de.racc_state["$[]"](-1)):ze)||(v=ue["$[]"](de.racc_state["$[]"](-1)));u(v=de.$_racc_evalact(v,i)););}).$$s=C,he.$$arity=2,he))}).$$s=this,re.$$arity=0,re))},x.$$arity=4),e.def($,"$_racc_evalact",O=function(l,L){var i,m,ue,_e,f=this,re=r,pe=r,ge=r,me=r,j=r,v=r,D=r,s=r,C=r,q=r;if(re=null==(i=e.to_ary(L))[0]?r:i[0],pe=null==i[1]?r:i[1],ge=null==i[3]?r:i[3],ue=null==i[11]?r:i[11],me=null==i[12]?r:i[12],u(u(_e=Y(l,0))?se(l,ue):_e))u(Y(f.racc_error_status,0))&&(f.racc_t["$=="](1)||(f.racc_error_status=ae(f.racc_error_status,1))),f.racc_vstack.$push(f.racc_val),f.racc_state.$push(l),f.racc_read_next=!0,u(f.yydebug)&&(f.racc_tstack.$push(f.racc_t),f.$racc_shift(f.racc_t,f.racc_tstack,f.racc_vstack));else if(u(u(j=se(l,0))?Y(l,me["$-@"]()):j)){if(v=E(f,"catch",["racc_jump"],((m=function(){var he=null==m.$$s?this:m.$$s;return null==he.racc_state&&(he.racc_state=r),he.racc_state.$push(he.$_racc_do_reduce(L,l)),!1}).$$s=f,m.$$arity=0,m)),u(v)){if(1["$==="](D=v))return f.racc_user_yyerror=!0,me["$-@"]();if(2["$==="](D))return ue;f.$raise("[Racc Bug] unknown jump code")}}else if(l["$=="](ue))u(f.yydebug)&&f.$racc_accept(),f.$throw("racc_end_parse",f.racc_vstack["$[]"](0));else{if(l["$=="](me["$-@"]())){for((0)["$==="](D=f.racc_error_status)?u(L["$[]"](21))||f.$on_error(f.racc_t,f.racc_val,f.racc_vstack):3["$==="](D)&&(f.racc_t["$=="](0)&&f.$throw("racc_end_parse",r),f.racc_read_next=!0),f.racc_user_yyerror=!1,f.racc_error_status=3;u(!0)&&(!u(s=ge["$[]"](f.racc_state["$[]"](-1)))||(s=o(s,1),!u(u(C=u(q=_(s,0))?l=re["$[]"](s):q)?pe["$[]"](s)["$=="](f.racc_state["$[]"](-1)):C)));)u(h(f.racc_state.$size(),1))&&f.$throw("racc_end_parse",r),f.racc_state.$pop(),f.racc_vstack.$pop(),u(f.yydebug)&&(f.racc_tstack.$pop(),f.$racc_e_pop(f.racc_state,f.racc_tstack,f.racc_vstack));return l}f.$raise("[Racc Bug] unknown action "+l.$inspect())}return u(f.yydebug)&&f.$racc_next_state(f.racc_state["$[]"](-1),f.racc_state),r},O.$$arity=2),e.def($,"$_racc_do_reduce",$e=function(l,L){var i,ue,_e,q,be,he,de,m=this,re=r,pe=r,ce=r,ge=r,me=r,j=r,v=r,D=r,s=r,C=r,xe=r,Se=r,Re=r,ke=r,De=r,Ee=r;return re=null==(i=e.to_ary(l))[4]?r:i[4],pe=null==i[5]?r:i[5],ce=null==i[6]?r:i[6],ge=null==i[7]?r:i[7],ue=null==i[8]?r:i[8],me=null==i[9]?r:i[9],_e=null==i[13]?r:i[13],j=m.racc_state,v=m.racc_vstack,D=m.racc_tstack,s=function(I,P){return"number"==typeof I?-3*I:I["$*"](-3)}(L),C=me["$[]"](s),q=me["$[]"](o(s,1)),be=me["$[]"](o(s,2)),he=[],u(m.yydebug)&&(xe=D["$[]"](C["$-@"](),C)),Se=v["$[]"](C["$-@"](),C),u(m.yydebug)&&(Re=[C["$-@"](),C,he],E(D,"[]=",e.to_a(Re)),ae(Re.length,1)),Re=[C["$-@"](),C,he],E(v,"[]=",e.to_a(Re)),ae(Re.length,1),Re=[C["$-@"](),C,he],E(j,"[]=",e.to_a(Re)),ae(Re.length,1),u(_e)?v.$push(m.$__send__(be,Se,v,Se["$[]"](0))):v.$push(m.$__send__(be,Se,v)),D.$push(q),u(m.yydebug)&&m.$racc_reduce(xe,q,D,v),de=ae(q,ue),u(s=ge["$[]"](de))&&(s=o(s,j["$[]"](-1)),u(u(ke=u(De=_(s,0))?Ee=re["$[]"](s):De)?pe["$[]"](s)["$=="](de):ke))?Ee:ce["$[]"](de)},$e.$$arity=2),e.def($,"$on_error",fe=function(l,L,i){var m,B=this;return B.$raise(y(S,"ParseError"),B.$sprintf("\nparse error on value %s (%s)",L.$inspect(),u(m=B.$token_to_str(l))?m:"?"))},fe.$$arity=3),e.def($,"$yyerror",T=function(){return this.$throw("racc_jump",1)},T.$$arity=0),e.def($,"$yyaccept",t=function(){return this.$throw("racc_jump",2)},t.$$arity=0),e.def($,"$yyerrok",n=function(){return this.racc_error_status=0},n.$$arity=0),e.def($,"$racc_read_token",c=function(l,L,i){var B=this;return B.racc_debug_out.$print("read    "),B.racc_debug_out.$print(L.$inspect(),"(",B.$racc_token2str(l),") "),B.racc_debug_out.$puts(i.$inspect()),B.racc_debug_out.$puts()},c.$$arity=3),e.def($,"$racc_shift",a=function(l,L,i){var B=this;return B.racc_debug_out.$puts("shift   "+B.$racc_token2str(l)),B.$racc_print_stacks(L,i),B.racc_debug_out.$puts()},a.$$arity=3),e.def($,"$racc_reduce",R=function(l,L,i,B){var m,f=this,re=r;return(re=f.racc_debug_out).$print("reduce "),u(l["$empty?"]())?re.$print(" <none>"):E(l,"each",[],((m=function(ce){return null==ce&&(ce=r),re.$print(" ",(null==m.$$s?this:m.$$s).$racc_token2str(ce))}).$$s=f,m.$$arity=1,m)),re.$puts(" --\x3e "+f.$racc_token2str(L)),f.$racc_print_stacks(i,B),f.racc_debug_out.$puts()},R.$$arity=4),e.def($,"$racc_accept",X=function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},X.$$arity=0),e.def($,"$racc_e_pop",le=function(l,L,i){var B=this;return B.racc_debug_out.$puts("error recovering mode: pop token"),B.$racc_print_states(l),B.$racc_print_stacks(L,i),B.racc_debug_out.$puts()},le.$$arity=3),e.def($,"$racc_next_state",ee=function(l,L){var i=this;return i.racc_debug_out.$puts("goto    "+l),i.$racc_print_states(L),i.racc_debug_out.$puts()},ee.$$arity=2),e.def($,"$racc_print_stacks",ie=function(l,L){var i,m=r;return(m=this.racc_debug_out).$print("        ["),E(l,"each_index",[],((i=function(re){return null==re&&(re=r),m.$print(" (",(null==i.$$s?this:i.$$s).$racc_token2str(l["$[]"](re))," ",L["$[]"](re).$inspect(),")")}).$$s=this,i.$$arity=1,i)),m.$puts(" ]")},ie.$$arity=2),e.def($,"$racc_print_states",Q=function(l){var L,B=r;return(B=this.racc_debug_out).$print("        ["),E(l,"each",[],((L=function(f){return null==f&&(f=r),B.$print(" ",f)}).$$s=this,L.$$arity=1,L)),B.$puts(" ]")},Q.$$arity=1),e.def($,"$racc_token2str",ye=function(l){var i;return u(i=ne(this.$class(),"Racc_token_to_s_table")["$[]"](l))?i:this.$raise("[Racc Bug] can't convert token "+l+" to string")},ye.$$arity=1),e.def($,"$token_to_str",W=function(l){return ne(this.$class(),"Racc_token_to_s_table")["$[]"](l)},W.$$arity=1)}(te[0],te)},Opal.modules.strscan=function(e){var ne,M,u,V,E,I,P,F,z,K,G,p,g,$,S,A,k,U,b,w,H,Z,x,O,$e,fe,y,ve,o=[],_=e.nil,h=e.$$,N=e.truthy,d=e.send;return ne=o,y=(0,e.klass)(o[0],null,"StringScanner"),ve=[y].concat(ne),y.$$prototype.pos=y.$$prototype.string=y.$$prototype.working=y.$$prototype.matched=y.$$prototype.prev_pos=y.$$prototype.match=_,y.$attr_reader("pos"),y.$attr_reader("matched"),e.def(y,"$initialize",M=function(t){var n=this;return n.string=t,n.pos=0,n.matched=_,n.working=t,n.match=[]},M.$$arity=1),y.$attr_reader("string"),e.def(y,"$beginning_of_line?",u=function(){var t=this;return 0===t.pos||"\n"===t.string.charAt(t.pos-1)},u.$$arity=0),e.alias(y,"bol?","beginning_of_line?"),e.def(y,"$scan",V=function(t){var n=this,c=(t=n.$anchor(t)).exec(n.working);return null==c?n.matched=_:"object"==typeof c?(n.prev_pos=n.pos,n.pos+=c[0].length,n.working=n.working.substring(c[0].length),n.matched=c[0],n.match=c,c[0]):"string"==typeof c?(n.pos+=c.length,n.working=n.working.substring(c.length),c):_},V.$$arity=1),e.def(y,"$scan_until",E=function(t){var n=this;t=n.$anchor(t);for(var R,c=n.pos,a=n.working;;){if(R=t.exec(a),c+=1,a=a.substr(1),null!=R)return n.matched=n.string.substr(n.pos,c-n.pos-1+R[0].length),n.match=R,n.prev_pos=c-1,n.pos=c,n.working=a.substr(R[0].length),n.matched;if(0===a.length)return n.match=[],n.matched=_}},E.$$arity=1),e.def(y,"$[]",I=function(t){var c;if(N(this.match["$empty?"]()))return _;c=t,h(ve,"Symbol")["$==="](c)?t=t.$to_s():h(ve,"String")["$==="](c)||(t=h(ve,"Opal")["$coerce_to!"](t,h(ve,"Integer"),"to_int"));var a=this.match;return t<0&&(t+=a.length),t<0||t>=a.length||null==a[t]?_:a[t]},I.$$arity=1),e.def(y,"$check",P=function(t){var n=this,c=(t=n.$anchor(t)).exec(n.working);return n.matched=null==c?_:c[0]},P.$$arity=1),e.def(y,"$check_until",F=function(t){var n=this,c=n.prev_pos,a=n.pos,R=n.$scan_until(t);return R!==_&&(n.matched=R.substr(-1),n.working=n.string.substr(a)),n.prev_pos=c,n.pos=a,R},F.$$arity=1),e.def(y,"$peek",z=function(t){return this.working.substring(0,t)},z.$$arity=1),e.def(y,"$eos?",K=function(){return 0===this.working.length},K.$$arity=0),e.def(y,"$exist?",G=function(t){var c=t.exec(this.working);return null==c?_:0==c.index?0:c.index+1},G.$$arity=1),e.def(y,"$skip",p=function(t){var n=this,c=(t=n.$anchor(t)).exec(n.working);if(null==c)return n.match=[],n.matched=_;var a=c[0],R=a.length;return n.matched=a,n.match=c,n.prev_pos=n.pos,n.pos+=R,n.working=n.working.substring(R),R},p.$$arity=1),e.def(y,"$skip_until",g=function(t){var c=this.$scan_until(t);return c===_?_:(this.matched=c.substr(-1),c.length)},g.$$arity=1),e.def(y,"$get_byte",$=function(){var t=this,n=_;return t.pos<t.string.length?(t.prev_pos=t.pos,t.pos+=1,n=t.matched=t.working.substring(0,1),t.working=t.working.substring(1)):t.matched=_,n},$.$$arity=0),e.alias(y,"getch","get_byte"),e.def(y,"$match?",S=function(t){var n=this,c=(t=n.$anchor(t)).exec(n.working);return null==c?_:(n.prev_pos=n.pos,c[0].length)},S.$$arity=1),e.def(y,"$pos=",A=function(t){var n=this;return t<0&&(t+=n.string.$length()),n.pos=t,n.working=n.string.slice(t)},A.$$arity=1),e.def(y,"$matched_size",k=function(){return this.matched===_?_:this.matched.length},k.$$arity=0),e.def(y,"$post_match",U=function(){var t=this;return t.matched===_?_:t.string.substr(t.pos)},U.$$arity=0),e.def(y,"$pre_match",b=function(){var t=this;return t.matched===_?_:t.string.substr(0,t.prev_pos)},b.$$arity=0),e.def(y,"$reset",w=function(){var t=this;return t.working=t.string,t.matched=_,t.pos=0},w.$$arity=0),e.def(y,"$rest",H=function(){return this.working},H.$$arity=0),e.def(y,"$rest?",Z=function(){return 0!==this.working.length},Z.$$arity=0),e.def(y,"$rest_size",x=function(){return this.$rest().$size()},x.$$arity=0),e.def(y,"$terminate",O=function(){var n,te,t=this;return t.match=_,n=[t.string.$length()],d(t,"pos=",e.to_a(n)),n[(te=n.length,"number"==typeof te?te-1:te["$-"](1))]},O.$$arity=0),e.def(y,"$unscan",$e=function(){var t=this;return t.pos=t.prev_pos,t.prev_pos=_,t.match=_,t},$e.$$arity=0),y.$private(),e.def(y,"$anchor",fe=function(t){var c=t.toString().match(/\/([^\/]+)$/);return c=c?c[1]:void 0,new RegExp("^(?:"+t.source+")",c)},fe.$$arity=1),_&&"anchor"},Opal.modules["bcdice/normalize"]=function(e){var ne,M,u,y,N,te,ae=[],o=e.nil,h=e.module;return N=ae,ne=te=[h(ae[0],"BCDice")].concat(N),[y=h(te[0],"Normalize")].concat(ne),y.$module_function(),e.def(y,"$comparison_operator",M=function(E){var P;return/<=|=</["$==="](P=E)?"<=":/>=|=>/["$==="](P)?">=":/<>|!=|=!/["$==="](P)?"!=":/</["$==="](P)?"<":/>/["$==="](P)?">":/=/["$==="](P)?"==":o},M.$$arity=1),void e.def(y,"$target_number",u=function(E){return E["$=="]("?")?E:E.$to_i()},u.$$arity=1)},Opal.modules["bcdice/common_command/lexer"]=function(e){var r,M,P,K,G,p,F,z,V,y,se=e.top,ae=[],o=e.nil,Y=e.$$,h=e.module,oe=e.klass,N=e.hash2,d=e.truthy;return se.$require("strscan"),se.$require("bcdice/normalize"),r=ae,M=y=[h(ae[0],"BCDice")].concat(r),P=V=[h(y[0],"CommonCommand")].concat(M),F=oe(V[0],null,"Lexer"),z=[F].concat(P),F.$$prototype.scanner=o,e.const_set(z[0],"SYMBOLS",N(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),e.def(F,"$initialize",K=function($){var A;return $=d(A=$.$split(" ",2).$first())?A:"",this.scanner=Y(z,"StringScanner").$new($)},K.$$arity=1),e.def(F,"$next_token",G=function(){var $=this,S=o,A=o,k=o,b=o;return d($.scanner["$eos?"]())?[!1,"$"]:d(S=$.scanner.$scan(/\d+/))?["NUMBER",S.$to_i()]:d(A=$.scanner.$scan(/[<>!=]+/))?["CMP_OP",Y(z,"Normalize").$comparison_operator(A)]:(k=$.scanner.$getch().$upcase(),[d(b=Y(z,"SYMBOLS")["$[]"](k))?b:k.$to_sym(),k])},G.$$arity=0),void e.def(F,"$source",p=function(){return this.scanner.$string()},p.$$arity=0)},Opal.modules["bcdice/common_command/reroll_dice/node"]=function(e){function se(V,E){return"number"==typeof V&&"number"==typeof E?V<E:V["$<"](E)}function ae(V,E){return"number"==typeof V&&"number"==typeof E?V+E:V["$+"](E)}function o(V,E){return"number"==typeof V&&"number"==typeof E?V>E:V["$>"](E)}function _(V,E){return"number"==typeof V&&"number"==typeof E?V-E:V["$-"](E)}var E,z,g,k,Z,$e,fe,T,t,n,x,O,b,S,G,P,N=[],d=e.nil,r=e.$$,ne=e.module,y=e.klass,ve=e.hash2,M=e.truthy,u=e.send;return E=N,z=P=[ne(N[0],"BCDice")].concat(E),g=G=[ne(P[0],"CommonCommand")].concat(z),k=S=[ne(G[0],"RerollDice")].concat(g),Z=b=[ne(S[0],"Node")].concat(k),x=y(b[0],null,"Command"),O=[x].concat(Z),x.$$prototype.cmp_op=x.$$prototype.reroll_cmp_op=x.$$prototype.target_number_node=x.$$prototype.reroll_threshold_node=x.$$prototype.notations=x.$$prototype.source=d,e.def(x,"$initialize",$e=function(a){var R,X,le,ee,ie,Q,ye,W=this;if(null==a)a=ve([],{});else if(!a.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(!e.hasOwnProperty.call(a.$$smap,"secret"))throw e.ArgumentError.$new("missing keyword: secret");if(R=a.$$smap.secret,!e.hasOwnProperty.call(a.$$smap,"notations"))throw e.ArgumentError.$new("missing keyword: notations");if(X=a.$$smap.notations,!e.hasOwnProperty.call(a.$$smap,"source"))throw e.ArgumentError.$new("missing keyword: source");return le=a.$$smap.source,null==(ee=a.$$smap.cmp_op)&&(ee=d),null==(ie=a.$$smap.target_number)&&(ie=d),null==(Q=a.$$smap.reroll_cmp_op)&&(Q=d),null==(ye=a.$$smap.reroll_threshold)&&(ye=d),W.secret=R,W.notations=X,W.cmp_op=ee,W.target_number_node=ie,W.reroll_cmp_op=Q,W.reroll_threshold_node=ye,W.source=le},$e.$$arity=1),e.def(x,"$eval",fe=function(a,R){var X,le,ee,ie,Q,ye,J,l,i,f,pe,me,L,B,m,re,ce,ge,W=this,ue=d,_e=d,j=d,v=d,D=d,s=d;return J=a.$round_type(),l=M(L=W.cmp_op)?L:a.$default_cmp_op(),i=M(B=M(m=W.reroll_cmp_op)?m:l)?B:">=",f=M(re=(X=W.target_number_node)===d||null==X?d:u(X,"eval",[J]))?re:a.$default_target_number(),pe=M(ce=M(ge=(le=W.reroll_threshold_node)===d||null==le?d:u(le,"eval",[J]))?ge:a.$reroll_dice_reroll_threshold())?ce:f,ue=r(O,"RerollCondition").$new(i,pe),me=u(W.notations,"map",[],((ee=function(q){return null==q&&(q=d),q.$to_dice(J)}).$$s=W,ee.$$arity=1,ee)),M(u(me,"all?",[],((ie=function(q){return null==q&&(q=d),ue["$valid?"](q.$sides())}).$$s=W,ie.$$arity=1,ie)))?(j=(_e=W.$roll(me,R,ue,a["$sort_barabara_dice?"]())).$flatten(),v=_e.$take(W.notations.$size()).$flatten().$count(1),D=M(l)?u(j,"count",[],((Q=function(q){return null==q&&(q=d),q.$send(l,f)}).$$s=W,Q.$$arity=1,Q)):0,s=[W.$expr(J,ue,l,f),u(_e,"map",[],(ye=function(q){return null==q&&(q=d),q.$join(",")},ye.$$s=W,ye.$$arity=1,ye)).$join(" + "),"\u6210\u529f\u6570"+D,a.$grich_text(v,j.$size(),D)].$compact(),W.$result_with_text(s.$join(" \uff1e "))):W.$result_with_text(W.source+" \uff1e \u6761\u4ef6\u304c\u9593\u9055\u3063\u3066\u3044\u307e\u3059\u30022R6>=5 \u3042\u308b\u3044\u306f 2R6[5] \u306e\u3088\u3046\u306b\u632f\u308a\u8db3\u3057\u76ee\u6a19\u5024\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002")},fe.$$arity=2),x.$private(),e.def(x,"$roll",T=function(a,R,X,le){var ie,ye=d,W=d,J=d,l=d,L=d,i=d;for(ye=[],W=0;M(M(J=a["$empty?"]()["$!"]())?se(W,r(O,"REROLL_LIMIT")):J);)l=a.$shift(),W=ae(W,1),L=l.$roll(R),M(le)&&L["$sort!"](),ye.$push(L),i=u(L,"count",[],((ie=function(m){return null==m&&(m=d),X["$reroll?"](m)}).$$s=this,ie.$$arity=1,ie)),M(o(i,0))&&a.$push(r(O,"Dice").$new(i,l.$sides()));return ye},T.$$arity=4),e.def(x,"$expr",t=function(a,R,X,le){var ee,Q,ye,W;return Q=u(this.notations,"map",[],(ee=function(l){return null==l&&(l=d),l.$to_dice(a)},ee.$$s=this,ee.$$arity=1,ee)).$join("+"),ye=R.$cmp_op()["$=="](X)?"":r(O,"Format").$comparison_operator(R.$cmp_op()),W=r(O,"Format").$comparison_operator(X),"("+Q+"["+ye+R.$threshold()+"]"+W+le+")"},t.$$arity=4),e.def(x,"$result_with_text",n=function(a){var R;return u(r(O,"Result").$new(),"tap",[],((R=function(ee){var ie=null==R.$$s?this:R.$$s,Q=d;return null==ie.secret&&(ie.secret=d),null==ee&&(ee=d),u(ee,"secret=",e.to_a(Q=[ie.secret])),_(Q.length,1),u(ee,"text=",e.to_a(Q=[a])),Q[_(Q.length,1)]}).$$s=this,R.$$arity=1,R))},n.$$arity=1),function(w,H,Z){var $e,fe,T,x=y(w,null,"RerollCondition");[x].concat(Z),x.$$prototype.threshold=x.$$prototype.cmp_op=d,x.$attr_reader("cmp_op"),x.$attr_reader("threshold"),e.def(x,"$initialize",$e=function(n,c){return this.cmp_op=n,this.threshold=c},$e.$$arity=2),e.def(x,"$valid?",fe=function(n){var V,c=this,a=d;return!!M(c.threshold)&&("<="["$==="](a=c.cmp_op)?se(c.threshold,n):"<"["$==="](a)?function(V,E){return"number"==typeof V&&"number"==typeof E?V<=E:V["$<="](E)}(c.threshold,n):">="["$==="](a)?o(c.threshold,1):">"["$==="](a)?"number"==typeof(V=c.threshold)?V>=1:V["$>="](1):!"!="["$==="](a)||e.Range.$new(1,n,!1)["$include?"](c.threshold))},fe.$$arity=1),e.def(x,"$reroll?",T=function(n){return n.$send(this.cmp_op,this.threshold)},T.$$arity=1)}(b[0],0,b),function(w,H,Z){var $e,fe,x=y(w,null,"Notation"),O=[x].concat(Z);x.$$prototype.times=x.$$prototype.sides=d,e.def(x,"$initialize",$e=function(t,n){return this.times=t,this.sides=n},$e.$$arity=2),e.def(x,"$to_dice",fe=function(t){var c,a;return c=this.times.$eval(t),a=this.sides.$eval(t),r(O,"Dice").$new(c,a)},fe.$$arity=1)}(b[0],0,b),void function(w,H,Z){var $e,fe,T,x=y(w,null,"Dice");[x].concat(Z),x.$attr_reader("times","sides"),e.def(x,"$initialize",$e=function(n,c){return this.times=n,this.sides=c},$e.$$arity=2),e.def(x,"$roll",fe=function(n){return n.$roll_barabara(this.$times(),this.$sides())},fe.$$arity=1),e.def(x,"$to_s",T=function(){return this.$times()+"R"+this.$sides()},T.$$arity=0)}(b[0],0,b)},Opal.modules["bcdice/arithmetic/node"]=function(e){function se(te,r){return"number"==typeof te&&"number"==typeof r?te/r:te["$/"](r)}var r,M,I,z,K,G,$,S,A,k,U,b,p,g,F,V,y,o=[],_=e.nil,Y=e.$$$,h=e.$$,oe=e.module,N=e.klass,d=e.send2;return r=o,M=y=[oe(o[0],"BCDice")].concat(r),I=V=[oe(y[0],"Arithmetic")].concat(M),function(z,K,G){var $,S,A,k,U,p=N(z,null,"BinaryOp");[p].concat(G),p.$$prototype.lhs=p.$$prototype.rhs=p.$$prototype.op=_,e.def(p,"$initialize",$=function(w,H,Z){var x=this;return x.lhs=w,x.op=H,x.rhs=Z},$.$$arity=3),e.def(p,"$eval",S=function(w){var x,H=this,Z=_;return Z=H.lhs.$eval(w),x=H.rhs.$eval(w),Z.$send(H.op,x)},S.$$arity=1),e.def(p,"$output",A=function(){var w=this;return""+w.lhs.$output()+w.op+w.rhs.$output()},A.$$arity=0),e.def(p,"$s_exp",k=function(){var w=this;return"("+w.$op_for_s_exp()+" "+w.lhs.$s_exp()+" "+w.rhs.$s_exp()+")"},k.$$arity=0),e.def(p,"$op_for_s_exp",U=function(){return this.op},U.$$arity=0)}((F=[oe(V[0],"Node")].concat(I))[0],0,F),z=F[0],K=h(F,"BinaryOp"),G=F,p=N(z,K,"DivideBase"),g=[p].concat(G),p.$$prototype.lhs=p.$$prototype.rhs=p.$$prototype.op=_,e.def(p,"$initialize",$=function(H,Z){return $.$$p&&($.$$p=null),d(this,e.find_super_dispatcher(this,"initialize",$,!1,!0),"initialize",[H,"/",Z],null)},$.$$arity=2),e.def(p,"$eval",S=function(H){var x,Z=this,O=_;return x=Z.lhs.$eval(H),(O=Z.rhs.$eval(H))["$=="](0)&&Z.$raise(h(g,"ZeroDivisionError")),Z.$divide_and_round(x,O,H)},S.$$arity=1),e.def(p,"$output",A=function(){var H=A.$$p,x=this,O=_,$e=_,fe=_;for(H&&(A.$$p=null),$e=0,fe=arguments.length,O=new Array(fe);$e<fe;$e++)O[$e]=arguments[$e];return""+d(x,e.find_super_dispatcher(x,"output",A,!1,!0),"output",O,H)+x.$rounding_method()},A.$$arity=0),p.$private(),e.def(p,"$rounding_method",k=function(){return Y(this.$class(),"ROUNDING_METHOD")},k.$$arity=0),e.def(p,"$op_for_s_exp",U=function(){return""+this.op+this.$rounding_method()},U.$$arity=0),e.def(p,"$divide_and_round",b=function(H,Z,x){return this.$raise(h(g,"NotImplementedError"))},b.$$arity=3),function(z,K,G){var $,p=N(z,K,"DivideWithGameSystemDefault"),g=[p].concat(G);e.const_set(g[0],"ROUNDING_METHOD",""),p.$private(),e.def(p,"$divide_and_round",$=function(A,k,U){var w;return w=U,Y(h(g,"RoundType"),"CEIL")["$==="](w)?se(A.$to_f(),k).$ceil():Y(h(g,"RoundType"),"ROUND")["$==="](w)?se(A.$to_f(),k).$round():se(A,k).$to_i()},$.$$arity=3)}(F[0],h(F,"DivideBase"),F),function(z,K,G){var $,p=N(z,K,"DivideWithCeil"),g=[p].concat(G);e.const_set(g[0],"ROUNDING_METHOD","C"),p.$private(),e.def(p,"$divide_and_round",$=function(A,k,U){return se(A.$to_f(),k).$ceil()},$.$$arity=3)}(F[0],h(F,"DivideBase"),F),function(z,K,G){var $,p=N(z,K,"DivideWithRound"),g=[p].concat(G);e.const_set(g[0],"ROUNDING_METHOD","R"),p.$private(),e.def(p,"$divide_and_round",$=function(A,k,U){return se(A.$to_f(),k).$round()},$.$$arity=3)}(F[0],h(F,"DivideBase"),F),function(z,K,G){var $,p=N(z,K,"DivideWithFloor"),g=[p].concat(G);e.const_set(g[0],"ROUNDING_METHOD","F"),p.$private(),e.def(p,"$divide_and_round",$=function(A,k,U){return se(A,k).$to_i()},$.$$arity=3)}(F[0],h(F,"DivideBase"),F),function(z,K,G){var $,S,A,k,p=N(z,null,"Negative");[p].concat(G),p.$$prototype.body=_,e.def(p,"$initialize",$=function(b){return this.body=b},$.$$arity=1),e.def(p,"$eval",S=function(b){return this.body.$eval(b)["$-@"]()},S.$$arity=1),e.def(p,"$output",A=function(){return"-"+this.body.$output()},A.$$arity=0),e.def(p,"$s_exp",k=function(){return"(- "+this.body.$s_exp()+")"},k.$$arity=0)}(F[0],0,F),function(z,K,G){var $,S,A,k,p=N(z,null,"Parenthesis");[p].concat(G),p.$$prototype.expr=_,e.def(p,"$initialize",$=function(b){return this.expr=b},$.$$arity=1),e.def(p,"$eval",S=function(b){return this.expr.$eval(b)},S.$$arity=1),e.def(p,"$output",A=function(){return"("+this.expr.$output()+")"},A.$$arity=0),e.def(p,"$s_exp",k=function(){return"(Parenthesis "+this.expr.$s_exp()+")"},k.$$arity=0)}(F[0],0,F),void function(z,K,G){var $,S,A,p=N(z,null,"Number");[p].concat(G),p.$$prototype.value=_,e.def(p,"$initialize",$=function(U){return this.value=U},$.$$arity=1),e.def(p,"$eval",S=function(U){return this.value},S.$$arity=1),e.def(p,"$output",A=function(){return this.value.$to_s()},A.$$arity=0),e.alias(p,"s_exp","output")}(F[0],0,F)},Opal.modules["bcdice/common_command/barabara_dice/parser"]=function(e){var ne,u,P,p,S,A,k,U,b,w,H,Z,x,O,$e,fe,T,t,n,c,a,R,X,le,ee,ie,Q,ye,W,J,l,L,i,B,m,f,re,pe,ue,g,$,z,E,ve,se=e.top,ae=[],o=e.nil,_=e.$$$,Y=e.$$,h=e.module,oe=e.klass,N=e.hash,d=e.hash2,te=e.truthy;return se.$require("racc/parser.rb"),se.$require("bcdice/common_command/lexer"),se.$require("bcdice/common_command/reroll_dice/node"),se.$require("bcdice/arithmetic/node"),ne=ae,u=ve=[h(ae[0],"BCDice")].concat(ne),P=E=[h(ve[0],"CommonCommand")].concat(u),p=z=[h(E[0],"BarabaraDice")].concat(P),g=oe(z[0],_(Y(z,"Racc"),"Parser"),"Parser"),$=[g].concat(p),g.$$prototype.lexer=o,e.defs(g,"$parse",S=function(v){return this.$new().$parse(v)},S.$$arity=1),e.def(g,"$parse",A=function(v){try{return this.lexer=Y($,"Lexer").$new(v),this.$do_parse()}catch(s){if(!e.rescue(s,[Y($,"ParseError")]))throw s;try{return o}finally{e.pop_exception()}}},A.$$arity=1),g.$private(),e.def(g,"$next_token",k=function(){return this.lexer.$next_token()},k.$$arity=0),J=[13,9,3,9,24,25,9,9,9,26,18,19,8,12,8,18,19,8,8,8,9,4,9,38,36,37,39,18,19,18,19,8,9,8,9,27,28,24,25,18,19,18,19,8,9,8,9,27,28,27,28,18,19,18,19,8,10,8,14],l=[5,2,0,8,15,15,13,14,12,15,8,8,2,5,8,12,12,13,14,12,18,1,19,34,34,34,34,18,18,19,19,18,24,19,25,16,16,21,21,24,24,25,25,24,27,25,28,31,31,32,32,27,27,28,28,27,4,28,7],L=[-6,21,-1,o,56,-9,o,55,1,o,o,o,6,4,5,-5,24,o,18,20,o,28,o,o,30,32,o,42,44,o,o,36,38,o,19,o,o,o,o,o],i=[-2,-25,-25,-3,-25,-4,-7,-25,-25,-24,40,-1,-25,-25,-25,-25,-11,-14,-25,-25,-22,-5,-6,-8,-25,-25,-23,-25,-25,-20,-21,-9,-10,-12,-15,-13,-16,-17,-18,-19],B=[7,1,6,15,2,29,30,21,31,32,5,7,23,22,33,34,11,35],m=[7,1,6,5,2,9,9,5,8,8,3,7,7,6,9,9,4,10],f=[o,1,4,8,11,-5,0,-2,-16,-13,-17],re=[o,o,o,o,o,o,o,20,16,17,o],pe=[0,0,"racc_error",3,24,"_reduce_1",0,25,"_reduce_2",1,25,"_reduce_3",0,27,"_reduce_4",2,27,"_reduce_5",3,26,"_reduce_6",1,26,"_reduce_7",3,29,"_reduce_8",3,28,"_reduce_9",3,28,"_reduce_10",1,28,"_reduce_none",3,31,"_reduce_12",4,31,"_reduce_13",1,31,"_reduce_none",0,33,"_reduce_15",1,33,"_reduce_16",1,33,"_reduce_17",1,33,"_reduce_18",1,33,"_reduce_19",2,32,"_reduce_20",2,32,"_reduce_21",1,32,"_reduce_none",3,30,"_reduce_23",1,30,"_reduce_24"],ue=N(!1,0,"error",1,"NUMBER",2,"B",3,"R",4,"U",5,"C",6,"F",7,"S",8,"PLUS",9,"MINUS",10,"ASTERISK",11,"SLASH",12,"PARENL",13,"PARENR",14,"BRACKETL",15,"BRACKETR",16,"LESS",17,"GREATER",18,"EQUAL",19,"NOT",20,"AT",21,"CMP_OP",22),e.const_set($[0],"Racc_arg",[J,l,i,L,B,m,re,f,23,pe,ue,40,25,!0]),e.const_set($[0],"Racc_token_to_s_table",["$end","error","NUMBER","B","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","LESS","GREATER","EQUAL","NOT","AT","CMP_OP","$start","expr","secret","notations","target","add","dice","term","mul","unary","round_type"]),e.const_set($[0],"Racc_debug_parser",!1),e.def(g,"$_reduce_1",U=function(v,D,s){return _(Y($,"Node"),"Command").$new(d(["secret","notations","cmp_op","target_number"],{secret:v["$[]"](0),notations:v["$[]"](1),cmp_op:v["$[]"](2)["$[]"]("cmp_op"),target_number:v["$[]"](2)["$[]"]("target")}))},U.$$arity=3),e.def(g,"$_reduce_2",b=function(v,D,s){return!1},b.$$arity=3),e.def(g,"$_reduce_3",w=function(v,D,s){return!0},w.$$arity=3),e.def(g,"$_reduce_4",H=function(v,D,s){return d([],{})},H.$$arity=3),e.def(g,"$_reduce_5",Z=function(v,D,s){var C,he,xe;return xe=null==(C=e.to_ary(v))[1]?o:C[1],te(he=null==C[0]?o:C[0])||this.$raise(Y($,"ParseError")),d(["cmp_op","target"],{cmp_op:he,target:xe})},Z.$$arity=3),e.def(g,"$_reduce_6",x=function(v,D,s){var q=o;return(q=v["$[]"](0)).$push(v["$[]"](2)),q},x.$$arity=3),e.def(g,"$_reduce_7",O=function(v,D,s){return[v["$[]"](0)]},O.$$arity=3),e.def(g,"$_reduce_8",$e=function(v,D,s){var q,be;return q=v["$[]"](0),be=v["$[]"](2),_(Y($,"Node"),"Notation").$new(q,be)},$e.$$arity=3),e.def(g,"$_reduce_9",fe=function(v,D,s){return _(_(Y($,"Arithmetic"),"Node"),"BinaryOp").$new(v["$[]"](0),"+",v["$[]"](2))},fe.$$arity=3),e.def(g,"$_reduce_10",T=function(v,D,s){return _(_(Y($,"Arithmetic"),"Node"),"BinaryOp").$new(v["$[]"](0),"-",v["$[]"](2))},T.$$arity=3),e.def(g,"$_reduce_12",t=function(v,D,s){return _(_(Y($,"Arithmetic"),"Node"),"BinaryOp").$new(v["$[]"](0),"*",v["$[]"](2))},t.$$arity=3),e.def(g,"$_reduce_13",n=function(v,D,s){return v["$[]"](3).$new(v["$[]"](0),v["$[]"](2))},n.$$arity=3),e.def(g,"$_reduce_15",c=function(v,D,s){return _(_(Y($,"Arithmetic"),"Node"),"DivideWithGameSystemDefault")},c.$$arity=3),e.def(g,"$_reduce_16",a=function(v,D,s){return _(_(Y($,"Arithmetic"),"Node"),"DivideWithCeil")},a.$$arity=3),e.def(g,"$_reduce_17",R=function(v,D,s){return _(_(Y($,"Arithmetic"),"Node"),"DivideWithCeil")},R.$$arity=3),e.def(g,"$_reduce_18",X=function(v,D,s){return _(_(Y($,"Arithmetic"),"Node"),"DivideWithRound")},X.$$arity=3),e.def(g,"$_reduce_19",le=function(v,D,s){return _(_(Y($,"Arithmetic"),"Node"),"DivideWithFloor")},le.$$arity=3),e.def(g,"$_reduce_20",ee=function(v,D,s){return v["$[]"](1)},ee.$$arity=3),e.def(g,"$_reduce_21",ie=function(v,D,s){return _(_(Y($,"Arithmetic"),"Node"),"Negative").$new(v["$[]"](1))},ie.$$arity=3),e.def(g,"$_reduce_23",Q=function(v,D,s){return v["$[]"](1)},Q.$$arity=3),e.def(g,"$_reduce_24",ye=function(v,D,s){return _(_(Y($,"Arithmetic"),"Node"),"Number").$new(v["$[]"](0))},ye.$$arity=3),void e.def(g,"$_reduce_none",W=function(v,D,s){return v["$[]"](0)},W.$$arity=3)},Opal.modules["bcdice/common_command/barabara_dice"]=function(e){var d,y,V,P,K,z,E,I,M,r,ae=[],o=e.nil,Y=e.$$,h=e.module,oe=e.send;return e.top.$require("bcdice/common_command/barabara_dice/parser"),d=ae,y=r=[h(ae[0],"BCDice")].concat(d),V=M=[h(r[0],"CommonCommand")].concat(y),I=[E=h(M[0],"BarabaraDice")].concat(V),e.const_set(I[0],"PREFIX_PATTERN",/\d+B\d+/.$freeze()),P=e.get_singleton_class(E),z=[P].concat(I),void e.def(P,"$eval",K=function(p,g,$){var S;return(S=Y(z,"Parser").$parse(p))===o||null==S?o:oe(S,"eval",[g,$])},K.$$arity=3)},Opal.modules["bcdice/dice_table/table"]=function(e){var ne,u,F,G,p,g,$,z,K,E,ve,o=[],_=e.nil,h=e.$$,oe=e.module,N=e.klass,d=e.hash2,te=e.truthy;return ne=o,u=ve=[oe(o[0],"BCDice")].concat(ne),F=E=[oe(ve[0],"DiceTable")].concat(u),z=N(E[0],null,"Table"),K=[z].concat(F),z.$$prototype.times=z.$$prototype.sides=z.$$prototype.name=z.$$prototype.items=_,e.defs(z,"$from_i18n",G=function(A,k){var b=_;return b=h(K,"I18n").$t(A,d(["locale"],{locale:k})),this.$new(b["$[]"]("name"),b["$[]"]("type"),b["$[]"]("items"))},G.$$arity=2),e.def(z,"$initialize",p=function(A,k,U){var b=this,w=_;return b.name=A,b.items=U.$freeze(),w=/(\d+)D(\d+)/i.$match(k),te(w)||b.$raise(h(K,"ArgumentError"),"Unexpected table type: "+k),b.times=w["$[]"](1).$to_i(),b.sides=w["$[]"](2).$to_i()},p.$$arity=3),e.def(z,"$roll",g=function(A){var U,k=this;return U=A.$roll_sum(k.times,k.sides),k.$choice(U)},g.$$arity=1),void e.def(z,"$choice",$=function(A){var U,k=this;return U=function(r,ne){return"number"==typeof r&&"number"==typeof ne?r-ne:r["$-"](ne)}(A,k.times),h(K,"RollResult").$new(k.name,A,k.items["$[]"](U))},$.$$arity=1)},function(e){function ae(M,u){return"number"==typeof M&&"number"==typeof u?M>=u:M["$>="](u)}function o(M,u){return"number"==typeof M&&"number"==typeof u?M+u:M["$+"](u)}var u,P,p,S,A,k,U,b,w,H,Z,x,O,$e,fe,g,$,z,E,_=e.top,Y=[],h=e.nil,oe=e.$$$,N=e.$$,d=e.module,te=e.klass,r=e.send2,ne=e.hash2,y=e.truthy,ve=e.send;_.$require("bcdice/common_command/barabara_dice"),_.$require("bcdice/dice_table/table"),u=Y,P=E=[d(Y[0],"BCDice")].concat(u),p=z=[d(E[0],"GameSystem")].concat(P),g=te(z[0],N(z,"Base"),"NinjaSlayer"),$=[g].concat(p),g.$$prototype.randomizer=h,e.const_set($[0],"ID","NinjaSlayer"),e.const_set($[0],"NAME","\u30cb\u30f3\u30b8\u30e3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG"),e.const_set($[0],"SORT_KEY","\u306b\u3093\u3057\u3084\u3059\u308c\u3044\u3084\u3042RPG"),e.const_set($[0],"HELP_MESSAGE","\u30fb\u901a\u5e38\u5224\u5b9a\u3000NJ\n\u3000NJx[y] or NJx@y or NJx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 \u7701\u7565\u6642\u306fNORMAL(4)\n\u3000\u4f8b:NJ4@H \u96e3\u6613\u5ea6HARD\u3001\u5224\u5b9a\u30c0\u30a4\u30b94\u3067\u5224\u5b9a\n\u30fb\u56de\u907f\u5224\u5b9a\u3000EV\n\u3000EVx[y]/z or EVx@y/z or EVx/z or EVx[y] or EVx@y or EVx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 z=\u653b\u6483\u5074\u306e\u6210\u529f\u6570(\u7701\u7565\u53ef) \u96e3\u6613\u5ea6\u3092\u7701\u7565\u6642\u306fNORMAL(4)\n\u3000\u653b\u6483\u5074\u306e\u6210\u529f\u6570\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\u3001\u30ab\u30a6\u30f3\u30bf\u30fc\u30ab\u30e9\u30c6\u767a\u751f\u6642\u306b\u306f\u8868\u793a\n\u3000\u4f8b:EV5/3 \u96e3\u6613\u5ea6NORMAL(\u7701\u7565\u6642)\u3001\u5224\u5b9a\u30c0\u30a4\u30b95\u3001\u653b\u6483\u5074\u306e\u6210\u529f\u65703\u3067\u5224\u5b9a\n\u30fb\u8fd1\u63a5\u653b\u6483\u3000AT\n\u3000ATx[y] or ATx@y or ATx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 \u7701\u7565\u6642\u306fNORMAL(4) \u30b5\u30c4\u30d0\u30c4\uff01\u767a\u751f\u6642\u306b\u306f\u8868\u793a\n\u3000\u4f8b:AT6[H] \u96e3\u6613\u5ea6HARD,\u5224\u5b9a\u30c0\u30a4\u30b95\u3067\u8fd1\u63a5\u653b\u6483\u306e\u5224\u5b9a\n\u30fb\u30b5\u30c4\u30d0\u30c4\u5224\u5b9a\u3000SB\n\u30fb\u96fb\u5b50\u6226\u3000EL\n\u3000ELx[y] or ELx@y or ELx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 \u7701\u7565\u6642\u306fNORMAL(4)\n\u3000\u4f8b:EL6[H] \u96e3\u6613\u5ea6HARD,\u5224\u5b9a\u30c0\u30a4\u30b95\u3067\u96fb\u5b50\u6226\u306e\u5224\u5b9a\n\n\u30fb\u96e3\u6613\u5ea6\n\u3000KIDS=K,EASY=E,NORMAL=N,HARD=H,ULTRA HARD=UH \u6570\u5b57\u306b\u3082\u5bfe\u5fdc\n"),e.def(g,"$initialize",S=function(t){var a=this;return S.$$p&&(S.$$p=null),r(a,e.find_super_dispatcher(a,"initialize",S,!1,!0),"initialize",[t],null),a.default_cmp_op=">=",a.default_target_number=4},S.$$arity=1),e.const_set($[0],"DIFFICULTY_VALUE_RE","UH|[2-6KENH]".$freeze()),e.const_set($[0],"DIFFICULTY_RE",("(\\[("+N($,"DIFFICULTY_VALUE_RE")+")\\]|@("+N($,"DIFFICULTY_VALUE_RE")+"))").$freeze()),e.const_set($[0],"NJ_RE",e.regexp(["^(S)?NJ(\\d+)",N($,"DIFFICULTY_RE"),"?$"],"i").$freeze()),e.const_set($[0],"EV_RE",e.regexp(["^EV(\\d+)",N($,"DIFFICULTY_RE"),"?(?:/(\\d+))?$"],"i").$freeze()),e.const_set($[0],"AT_RE",e.regexp(["^AT(\\d+)",N($,"DIFFICULTY_RE"),"?$"],"i").$freeze()),e.const_set($[0],"EL_RE",e.regexp(["^EL(\\d+)",N($,"DIFFICULTY_RE"),"?$"],"i").$freeze()),e.const_set($[0],"EV",N($,"Struct").$new("num","difficulty","targetValue")),e.const_set($[0],"AT",N($,"Struct").$new("num","difficulty")),e.const_set($[0],"EL",N($,"Struct").$new("num","difficulty")),e.const_set($[0],"DIFFICULTY_SYMBOL_TO_INTEGER",ne(["K","E","N","H","UH"],{K:2,E:3,N:4,H:5,UH:6}).$freeze()),e.def(g,"$change_text",A=function(t){var c=h,a=h,R=h;return c=N($,"NJ_RE").$match(t),y(c)?(a=this.$bRollCommand(c["$[]"](2),this.$integerValueOfDifficulty(y(R=c["$[]"](4))?R:c["$[]"](5))),""+c["$[]"](1)+a):t},A.$$arity=1),e.def(g,"$eval_game_system_specific_command",k=function(t){var n=this,c=h,a=h,R=h;return n.$debug("eval_game_system_specific_command begin string",t),y(c=N($,"TABLES")["$[]"](t))?c.$roll(n.$randomizer()):(a=R=n.$parse(t),N($,"EV")["$==="](a)?n.$executeEV(R):N($,"AT")["$==="](a)?n.$executeAT(R):N($,"EL")["$==="](a)?n.$executeEL(R):h)},k.$$arity=1),g.$private(),e.def(g,"$parse",U=function(t){var c,n=this;return c=t,N($,"EV_RE")["$==="](c)?n.$parseEV(N($,"Regexp").$last_match()):N($,"AT_RE")["$==="](c)?n.$parseAT(N($,"Regexp").$last_match()):N($,"EL_RE")["$==="](c)?n.$parseEL(N($,"Regexp").$last_match()):h},U.$$arity=1),e.def(g,"$parseEV",b=function(t){var n,a,R,X,le;return a=t["$[]"](1).$to_i(),R=this.$integerValueOfDifficulty(y(X=t["$[]"](3))?X:t["$[]"](4)),le=(n=t["$[]"](5))===h||null==n?h:ve(n,"to_i",[]),N($,"EV").$new(a,R,le)},b.$$arity=1),e.def(g,"$parseAT",w=function(t){var c,a,R;return c=t["$[]"](1).$to_i(),a=this.$integerValueOfDifficulty(y(R=t["$[]"](3))?R:t["$[]"](4)),N($,"AT").$new(c,a)},w.$$arity=1),e.def(g,"$parseEL",H=function(t){var c,a,R;return c=t["$[]"](1).$to_i(),a=this.$integerValueOfDifficulty(y(R=t["$[]"](3))?R:t["$[]"](4)),N($,"EL").$new(c,a)},H.$$arity=1),e.def(g,"$executeEV",Z=function(t){var c,X,n=this,a=h,R=h;return c=n.$bRollCommand(t.$num(),t.$difficulty()),R=[(a=oe(oe(N($,"BCDice"),"CommonCommand"),"BarabaraDice").$eval(c,n,n.randomizer)).$text()],y(y(X=t.$targetValue())?function(M,u){return"number"==typeof M&&"number"==typeof u?M>u:M["$>"](u)}(a.$success_num(),t.$targetValue()):X)&&R.$push("\u30ab\u30a6\u30f3\u30bf\u30fc\u30ab\u30e9\u30c6!!"),R.$join(" \uff1e ")},Z.$$arity=1),e.def(g,"$executeAT",x=function(t){var c,R,n=this,a=h,X=h;return c=n.$bRollCommand(t.$num(),t.$difficulty()),R=(a=oe(oe(N($,"BCDice"),"CommonCommand"),"BarabaraDice").$eval(c,n,n.randomizer)).$last_dice_list().$count(6),X=[a.$text()],y(ae(R,2))&&X.$push("\u30b5\u30c4\u30d0\u30c4!!"),X.$join(" \uff1e ")},x.$$arity=1),e.def(g,"$executeEL",O=function(t){var n,a,le,ee,c=this,R=h,X=h;return a=c.$bRollCommand(t.$num(),t.$difficulty()),le=(X=(R=oe(oe(N($,"BCDice"),"CommonCommand"),"BarabaraDice").$eval(a,c,c.randomizer)).$last_dice_list()).$count(6),ee=ve(X,"count",[],((n=function(Q){return null==Q&&(Q=h),ae(Q,t.$difficulty())}).$$s=c,n.$$arity=1,n)),y(ae(le,1))?[R.$text()+" + "+le,o(ee,le)].$join(" \uff1e "):R.$text()},O.$$arity=1),e.def(g,"$integerValueOfDifficulty",$e=function(t){return y(t)?y(/^[2-6]$/.$match(t))?t.$to_i():N($,"DIFFICULTY_SYMBOL_TO_INTEGER").$fetch(t.$upcase()):4},$e.$$arity=1),e.def(g,"$bRollCommand",fe=function(t,n){return t+"B6>="+n},fe.$$arity=2),e.const_set($[0],"SATSUBATSU_TABLE",["\u300c\u6b7b\u306d\u30fc\u30c3\uff01\u300d\u8179\u90e8\u306b\u5f37\u70c8\u306a\u4e00\u6483\uff01\u3000\u6575\u306f\u304f\u306e\u5b57\u306b\u6298\u308c\u66f2\u304c\u308a\u3001\u30ef\u30a4\u30e4\u30fc\u30a2\u30af\u30b7\u30e7\u30f3\u3081\u3044\u3066\u5439\u3063\u98db\u3093\u3060\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8+1\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u6575\u306f\u5f8c\u65b9\u306e\u58c1\u307e\u305f\u306f\u969c\u5bb3\u7269\u306b\u5411\u304b\u3063\u3066\u3001\u4f55\u30de\u30b9\u3067\u3082\u307e\u3063\u3059\u3050\u5f3e\u304d\u98db\u3070\u3055\u308c\u308b\uff08\u4ed6\u306e\u30ad\u30e3\u30e9\u306e\u3044\u308b\u30de\u30b9\u306f\u901a\u904e\u3059\u308b\uff09\u3002\u58c1\u307e\u305f\u306f\u969c\u5bb3\u7269\u306b\u63a5\u89e6\u3057\u305f\u6642\u70b9\u3067\u3001\u6575\u306f\u3055\u3089\u306b1\u30c0\u30e1\u30fc\u30b8\u3092\u53d7\u3051\u308b\u3002\u6575\u306f\u3053\u306e\u6fc0\u7a81\u30c0\u30e1\u30fc\u30b8\u306b\u5bfe\u3057\u3066\u6539\u3081\u3066\u300e\u56de\u907f\u5224\u5b9a\u300f\u3092\u884c\u3063\u3066\u3082\u826f\u3044\u3002","\u300c\u30a4\u30e4\u30fc\u30c3\uff01\u300d\u982d\u90e8\u3078\u306e\u75db\u70c8\u306a\u30ab\u30e9\u30c6\uff01\u3000\u773c\u7403\u7834\u58ca\u3082\u3057\u304f\u306f\u6fc0\u3057\u3044\u8133\u9707\u76ea\u304c\u6575\u3092\u8972\u3046\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u3055\u3089\u306b\u6575\u306e\u3010\u30cb\u30e5\u30fc\u30ed\u30f3\u3011\u3068\u3010\u30ef\u30b6\u30de\u30a8\u3011\u304c\u305d\u308c\u305e\u308c1\u305a\u3064\u6e1b\u5c11\u3059\u308b\uff08\u3053\u308c\u306b\u3088\u308b\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u82e6\u3057\u307f\u629c\u3044\u3066\u6b7b\u306c\u304c\u3044\u3044\u300d\u6025\u6240\u3092\u60c5\u3051\u5bb9\u8d66\u306a\u304f\u7834\u58ca\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8+1\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u8010\u3048\u96e3\u3044\u82e6\u75db\u306b\u3088\u308a\u3001\u6575\u306f\u3010\u7cbe\u795e\u529b\u3011\u304c-2\u3055\u308c\u3001\u3010\u30cb\u30e5\u30fc\u30ed\u30f3\u3011\u304c1\u6e1b\u5c11\u3059\u308b\uff08\u3053\u308c\u306b\u3088\u308b\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u9003\u3052\u3089\u308c\u308b\u3082\u306e\u306a\u3089\u9003\u3052\u3066\u307f\u3088\u300d\u6575\u306e\u811a\u3092\u7c89\u7815\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u3055\u3089\u306b\u6575\u306e\u3010\u811a\u529b\u3011\u304cD3\u6e1b\u5c11\u3059\u308b\uff08\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u3053\u308c\u3067\u624b\u3082\u8db3\u3082\u51fa\u307e\u3044\uff01\u300d\u6575\u306e\u4e21\u8155\u3092\u5207\u308a\u98db\u3070\u3057\u305f\uff01\u3000\u9bae\u8840\u304c\u30b9\u30d7\u30ea\u30f3\u30af\u30e9\u30fc\u3081\u3044\u3066\u5674\u304d\u51fa\u3059\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8+1\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u3055\u3089\u306b\u6575\u306e\u3010\u30ef\u30b6\u30de\u30a8\u3011\u3068\u3010\u30ab\u30e9\u30c6\u3011\u304c\u305d\u308c\u305e\u308c2\u6e1b\u5c11\u3059\u308b\uff08\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u30a4\u30a4\u30a4\u30e4\u30a2\u30a2\u30a2\u30a2\u30fc\u30fc\u30fc\u30fc\u30c3\uff01\u300d\u30e4\u30ea\u3081\u3044\u305f\u30c1\u30e7\u30c3\u30d7\u304c\u6575\u306e\u80f8\u3092\u8cab\u901a\uff01\u3000\u3055\u3089\u306b\u5fc3\u81d3\u3092\u63b4\u307f\u53d6\u308a\u3001\u63e1\u308a\u3064\u3076\u3057\u305f\uff01\u3000\u30ca\u30e0\u30a2\u30df\u30c0\u30d6\u30c4\uff01\uff1a\u6575\u306f\u6b8b\u308a\u3010\u4f53\u529b\u3011\u306b\u95a2\u4fc2\u306a\u304f\u5373\u6b7b\u3059\u308b\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD6\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD6\u4e0a\u6607\u3059\u308b\u3002"].$freeze()),e.const_set($[0],"TABLES",ne(["SB"],{SB:oe(N($,"DiceTable"),"Table").$new("\u30b5\u30c4\u30d0\u30c4\u8868","1D6",N($,"SATSUBATSU_TABLE"))}).$freeze()),g.$register_prefix("NJ","EV","AT","EL",N($,"TABLES").$keys())}(Opal)}}]);