(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[3840],{3840:(pe,ye,ge)=>{ge(9993),Opal.modules["bcdice/arithmetic_evaluator"]=function(r){var U,F,Q,M,K,L,j,x,G=[],i=r.nil,t=r.$$$,e=r.module,k=r.hash2,N=r.truthy,H=r.def;return U=G,F=x=[e(G[0],"BCDice")].concat(U),j=[L=e(x[0],"ArithmeticEvaluator")].concat(F),M=[Q=r.get_singleton_class(L)].concat(j),K=r.$r(M),H(Q,"$eval",function(f,C){var B,Y=i;if(null==C)C=k([],{});else if(!C.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(B=C.$$smap.round_type)&&(B=t(K("RoundType"),"FLOOR")),N(f)&&N(Y=K("Arithmetic").$eval(f,B))?Y:0},-2)},Opal.modules["i18n/backend/fallbacks"]=function(r){var M,f,B,Y,K,o,G=[],i=r.nil,t=r.$$$,e=r.module,k=r.class_variable_set,N=r.truthy,H=r.class_variable_get,a=r.def,U=r.send,A=r.to_a,x=r.rb_minus,R=r.send2,F=r.find_super,L=r.hash2,j=r.find_block_super,Q=r.neqeq;return M=G,o=[K=e(G[0],"I18n")].concat(M),k(o[0],"@@fallbacks",i),f=r.get_singleton_class(K),B=[f].concat(o),Y=r.$r(B),a(f,"$fallbacks",function(){var T=i;return k(B[1],"@@fallbacks",N(null!=B[1].$$cvars["@@fallbacks"]?"class variable":i)&&N(T=H(B[1],"@@fallbacks",!1))?T:t(t(Y("I18n"),"Locale"),"Fallbacks").$new()),N(T=Y("Thread").$current()["$[]"]("i18n_fallbacks"))?T:H(B[1],"@@fallbacks",!1)},0),a(f,"$fallbacks=",function(v){var T;return k(B[1],"@@fallbacks",N(v["$is_a?"](Y("Array")))?t(t(Y("I18n"),"Locale"),"Fallbacks").$new(v):v),T=["i18n_fallbacks",H(B[1],"@@fallbacks",!1)],U(Y("Thread").$current(),"[]=",A(T)),T[x(T.length,1)]},1),function(f,C){var v,T,y,h,Y=[e(f,"Backend")].concat(C);return v=Y,y=[T=e(Y[0],"Fallbacks")].concat(v),h=r.$r(y),a(T,"$translate",function m(l,u,$){try{var n=m.$$p||i,s=this,d=i,g=i;return delete m.$$p,null==$&&($=h("EMPTY_HASH")),N($.$fetch("fallback",!0))?N($["$[]"]("fallback_in_progress"))?R(s,F(s,"translate",m,!1,!0),"translate",[l,u,$],n):(N($["$[]"]("default"))&&(d=s["$extract_non_symbol_default!"]($)),g=$.$merge(L(["fallback_in_progress"],{fallback_in_progress:!0})),U(h("I18n").$fallbacks()["$[]"](l),"each",[],function _(p){var b=null==_.$$s?this:_.$$s;null==p&&(p=i);try{return U(b,"catch",["exception"],function Z(){var c=null==Z.$$s?this:Z.$$s,X=i;if(X=R(c,j(c,"translate",Z.$$def||_.$$def||m,!1,!1),"translate",[p,u,g],null),N(X["$nil?"]()))return i;Q(l.$to_s(),p.$to_s())&&c.$on_fallback(l,p,u,$),r.ret(X)},{$$arity:0,$$s:b})}catch(Z){if(!r.rescue(Z,[t(h("I18n"),"InvalidLocale")]))throw Z;try{return i}finally{r.pop_exception()}}},{$$arity:1,$$s:s}),N($["$key?"]("default"))&&N($["$[]"]("default")["$nil?"]())?i:N(d)?R(s,F(s,"translate",m,!1,!0),"translate",[l,i,$.$merge(L(["default"],{default:d}))],null):s.$throw("exception",t(h("I18n"),"MissingTranslation").$new(l,u,$))):R(s,F(s,"translate",m,!1,!0),"translate",[l,u,$],n)}catch(_){if(_===r.returner)return _.$v;throw _}},-3),a(T,"$extract_non_symbol_default!",function(l){var $,u=i,n=i;return u=[l["$[]"]("default")].$flatten(),$=U(u,"detect",[],function(d){return null==d&&(d=i),d["$is_a?"](h("Symbol"))["$!"]()},1),N($)&&(n=["default",u["$[]"](0,u.$index($))],U(l,"[]=",A(n)),x(n.length,1)),$},1),a(T,"$exists?",function m(l,u,$){try{var n=m.$$p||i,s=this;return delete m.$$p,null==$&&($=h("EMPTY_HASH")),N($.$fetch("fallback",!0))?(U(h("I18n").$fallbacks()["$[]"](l),"each",[],function d(g){var _=null==d.$$s?this:d.$$s;null==g&&(g=i);try{if(!N(R(_,j(_,"exists?",d.$$def||m,!1,!1),"exists?",[g,u],null)))return i;r.ret(!0)}catch(p){if(!r.rescue(p,[t(h("I18n"),"InvalidLocale")]))throw p;try{return i}finally{r.pop_exception()}}},{$$arity:1,$$s:s}),!1):R(s,F(s,"exists?",m,!1,!0),"exists?",[l,u,$],n)}catch(d){if(d===r.returner)return d.$v;throw d}},-3),T.$private(),a(T,"$on_fallback",function(l,u,$,n){return i},4)}(o[0],o)},Opal.modules["bcdice/randomizer"]=function(r){var K,q,v,T,y,h,f,C,G=[],i=r.nil,t=r.$$$,k=r.klass,N=r.const_set,H=r.def,a=r.truthy,U=r.rb_gt,A=r.rb_plus,x=r.rb_le,R=r.send,F=r.rb_minus,L=r.eqeq,j=r.rb_times,Q=r.eqeqeq,ie=r.rb_ge;return K=G,f=[(0,r.module)(G[0],"BCDice")].concat(K),C=r.$r(f),q=f,T=[v=k(f[0],null,"Randomizer")].concat(q),y=r.$r(T),(h=v.$$prototype).rand_results=h.detailed_rand_results=i,N(T[0],"UPPER_LIMIT_DICE_TIMES",200),N(T[0],"UPPER_LIMIT_DICE_SIDES",1e4),N(T[0],"UPPER_LIMIT_RANDS",1e4),H(v,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]},0),v.$attr_reader("rand_results"),v.$attr_reader("detailed_rand_results"),N(T[0],"DetailedRandResult",y("Struct").$new("kind","sides","value")),H(v,"$roll_barabara",function(l,u){var $=this;return a(U(A($.rand_results.$size(),l),y("UPPER_LIMIT_RANDS")))&&$.$raise(y("TooManyRandsError")),a(x(l,0))||a(U(l,y("UPPER_LIMIT_DICE_TIMES")))?[]:R(y("Array"),"new",[l],function n(){return(null==n.$$s?this:n.$$s).$roll_once(u)},{$$arity:0,$$s:$})},2),H(v,"$roll_sum",function(l,u){return this.$roll_barabara(l,u).$sum()},2),H(v,"$roll_once",function(l){var $=i;return a(x(l,0))||a(U(l,y("UPPER_LIMIT_DICE_SIDES")))?0:($=this.$rand_inner(l),this.$push_to_detail("normal",l,$),$)},1),H(v,"$roll_index",function(l){return F(this.$roll_once(l),1)},1),H(v,"$roll_tens_d10",function(){var $,u=i;return u=this.$rand_inner(10),L(u,10)&&(u=0),$=j(u,10),this.$push_to_detail("tens_d10",10,$),$},0),H(v,"$roll_d9",function(){var u;return u=F(this.$rand_inner(10),1),this.$push_to_detail("d9",10,u),u},0),H(v,"$roll_d66",function(l){var n,$=i;return $=R(y("Array"),"new",[2],function s(){return(null==s.$$s?this:s.$$s).$roll_once(6)},{$$arity:0,$$s:this}),Q(t(y("D66SortType"),"ASC"),n=l)?$["$sort!"]():Q(t(y("D66SortType"),"DESC"),n)&&$["$sort!"]()["$reverse!"](),A(j($["$[]"](0),10),$["$[]"](1))},1),v.$private(),H(v,"$rand_inner",function(l){var $,u=this;return a(ie(u.rand_results.$size(),y("UPPER_LIMIT_RANDS")))&&u.$raise(y("TooManyRandsError")),$=u.$random(l),u.rand_results["$<<"]([$,l]),$},1),H(v,"$random",function(l){return A(y("Kernel").$rand(l),1)},1),H(v,"$push_to_detail",function(l,u,$){var s;return s=y("DetailedRandResult").$new(l,u,$),this.detailed_rand_results.$push(s)},3),k(f[0],C("StandardError"),"TooManyRandsError"),i},Opal.modules["bcdice/dice_table/roll_result"]=function(r){var a,R,ie,M,K,o,f,L,A,G=[],i=r.nil,t=r.module,e=r.klass,k=r.def,N=r.truthy;return a=G,R=A=[t(G[0],"BCDice")].concat(a),ie=L=[t(A[0],"DiceTable")].concat(R),K=[M=e(L[0],null,"RollResult")].concat(ie),o=r.$r(K),(f=M.$$prototype).table_name=f.value=f.body=i,k(M,"$initialize",function(B,Y,q){var v=this;return v.table_name=B,v.value=Y,v.body=q},3),M.$attr_reader("table_name"),M.$attr_reader("value"),M.$attr_reader("body"),k(M,"$to_s",function(){var B=this;return B.table_name+"("+B.value+") \uff1e "+B.body},0),k(M,"$last_body",function(){var B=this;return N(B.body["$is_a?"](o("RollResult")))?B.body.$last_body():B.body},0),k(M,"$empty?",function(){return!1},0)},Opal.modules["bcdice/dice_table/chain_table"]=function(r){var U,F,M,K,o,f,C,j,x,G=[],i=r.nil,t=r.module,e=r.klass,k=r.truthy,N=r.def,H=r.rb_minus;return U=G,F=x=[t(G[0],"BCDice")].concat(U),M=j=[t(x[0],"DiceTable")].concat(F),o=[K=e(j[0],null,"ChainTable")].concat(M),f=r.$r(o),(C=K.$$prototype).times=C.sides=C.items=C.name=i,N(K,"$initialize",function(Y,q,v){var T=this,y=i;return T.name=Y,T.items=v.$freeze(),y=/(\d+)D(\d+)/i.$match(q),k(y)||T.$raise(f("ArgumentError"),"Unexpected table type: "+q),T.times=y["$[]"](1).$to_i(),T.sides=y["$[]"](2).$to_i()},3),N(K,"$roll",function(Y){var v,T,q=this,y=i;return v=Y.$roll_sum(q.times,q.sides),T=H(v,q.times),y=q.items["$[]"](T),k(y["$respond_to?"]("roll"))&&(y=y.$roll(Y)),f("RollResult").$new(q.name,v,y)},1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(r){var R,Q,f,C,B,Y,q,M,L,G=[],i=r.nil,t=r.module,e=r.klass,k=r.hash2,N=r.defs,H=r.def,a=r.rb_plus,U=r.rb_times,A=r.rb_minus;return R=G,Q=L=[t(G[0],"BCDice")].concat(R),f=M=[t(L[0],"DiceTable")].concat(Q),B=[C=e(M[0],null,"D66GridTable")].concat(f),Y=r.$r(B),(q=C.$$prototype).name=q.items=i,N(C,"$from_i18n",function(T,y){var m=i;return m=Y("I18n").$t(T,k(["locale","raise"],{locale:y,raise:!0})),this.$new(m["$[]"]("name"),m["$[]"]("items"))},2),H(C,"$initialize",function(T,y){return this.name=T,this.items=y.$freeze()},2),H(C,"$roll",function(T){var h,m,l,u,$;return h=T.$roll_once(6),m=T.$roll_once(6),l=a(U(h,10),m),u=A(h,1),$=A(m,1),Y("RollResult").$new(this.name,l,this.items["$[]"](u)["$[]"]($))},1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(r){var A,L,o,f,C,B,Q,ie,R,i=[],t=r.nil,e=r.module,k=r.klass,N=r.hash2,H=r.defs,a=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),A=i,L=R=[e(i[0],"BCDice")].concat(A),Q=[e(R[0],"DiceTable")].concat(L),ie=r.$r(Q),o=Q,C=[f=k(Q[0],ie("D66GridTable"),"D66HalfGridTable")].concat(o),B=r.$r(C),H(f,"$from_i18n",function(q,v){var y=t;return y=B("I18n").$t(q,N(["locale","raise"],{locale:v,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items_1_2_3"),y["$[]"]("items_4_5_6"))},2),a(f,"$initialize",function(q,v,T){return this.name=q,this.items=[v,v,v,T,T,T].$freeze()},3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(r){var A,L,o,f,C,B,Q,ie,R,i=[],t=r.nil,e=r.module,k=r.klass,N=r.hash2,H=r.defs,a=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),A=i,L=R=[e(i[0],"BCDice")].concat(A),Q=[e(R[0],"DiceTable")].concat(L),ie=r.$r(Q),o=Q,C=[f=k(Q[0],ie("D66GridTable"),"D66OneThirdTable")].concat(o),B=r.$r(C),H(f,"$from_i18n",function(q,v){var y=t;return y=B("I18n").$t(q,N(["locale","raise"],{locale:v,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items_1_2"),y["$[]"]("items_3_4"),y["$[]"]("items_5_6"))},2),a(f,"$initialize",function(q,v,T,y){return this.name=q,this.items=[v,v,T,T,y,y].$freeze()},4)},Opal.modules["bcdice/dice_table/d66_table"]=function(r){var L,M,B,Y,q,v,T,o,Q,G=[],i=r.nil,t=r.$$$,e=r.module,k=r.klass,N=r.hash2,H=r.defs,a=r.def,U=r.eqeqeq,A=r.rb_plus,x=r.rb_times,R=r.truthy;return L=G,M=Q=[e(G[0],"BCDice")].concat(L),B=o=[e(Q[0],"DiceTable")].concat(M),q=[Y=k(o[0],null,"D66Table")].concat(B),v=r.$r(q),(T=Y.$$prototype).sort_type=T.items=T.name=i,H(Y,"$from_i18n",function(h,m){var $,u=i;return u=v("I18n").$t(h,N(["locale"],{locale:m})),$=v("D66SortType").$const_get(u["$[]"]("d66_sort_type")),this.$new(u["$[]"]("name"),$,u["$[]"]("items"))},2),a(Y,"$initialize",function(h,m,l){var u=this;return u.name=h,u.sort_type=m,u.items=l.$freeze()},3),a(Y,"$roll",function(h){var m=this,l=i,u=i,$=i,n=i;return l=h.$roll_barabara(2,6),U(t(v("D66SortType"),"ASC"),u=m.sort_type)?l["$sort!"]():U(t(v("D66SortType"),"DESC"),u)&&l["$sort!"]()["$reverse!"](),$=A(x(l["$[]"](0),10),l["$[]"](1)),n=R(u=m.items["$[]"]($))?u:m.items["$[]"]($.$to_s()),R(n["$respond_to?"]("roll"))&&(n=n.$roll(h)),v("RollResult").$new(m.name,$,n)},1),a(Y,"$choice",function(h){return v("RollResult").$new(this.name,h,this.items["$[]"](h))},1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(r){var ie,f,B,Y,K,i=[],t=r.nil,e=r.module,k=r.klass,N=r.hash2,H=r.send,a=r.to_ary,U=r.rb_plus,A=r.rb_times,x=r.to_a,R=r.rb_minus,F=r.send2,L=r.find_super,j=r.def;return r.top.$require("bcdice/dice_table/d66_table"),ie=i,f=K=[e(i[0],"BCDice")].concat(ie),B=[e(K[0],"DiceTable")].concat(f),Y=r.$r(B),j(k(B[0],Y("D66Table"),"D66LeftRangeTable"),"$initialize",function y(h,m,l){var n;return delete y.$$p,n=N([],{}),H(l,"each",[],function(d){var g,b;return null==d&&(d=t),g=a(d),b=null==g[1]?t:g[1],H(null==g[0]?t:g[0],"each",[],function(c){return null==c&&(c=t),H(b,"each_with_index",[],function(E,$e){var ue,ce;return null==E&&(E=t),null==$e&&($e=t),ue=U(A(c,10),U($e,1)),H(n,"[]=",x(ce=[ue,E])),ce[R(ce.length,1)]},2)},1)},1),F(this,L(this,"initialize",y,!1,!0),"initialize",[h,m,n],null)},3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(r){var F,ie,C,B,Y,q,v,K,j,G=[],i=r.nil,t=r.module,e=r.klass,k=r.hash2,N=r.defs,H=r.def,a=r.truthy,U=r.rb_minus,A=r.rb_plus,x=r.rb_times;return F=G,ie=j=[t(G[0],"BCDice")].concat(F),C=K=[t(j[0],"DiceTable")].concat(ie),Y=[B=e(K[0],null,"D66ParityTable")].concat(C),q=r.$r(Y),(v=B.$$prototype).odd=v.even=v.name=i,N(B,"$from_i18n",function(y,h){var l=i;return l=q("I18n").$t(y,k(["locale","raise"],{locale:h,raise:!0})),this.$new(l["$[]"]("name"),l["$[]"]("odd"),l["$[]"]("even"))},2),H(B,"$initialize",function(y,h,m){var l=this;return l.name=y,l.odd=h.$freeze(),l.even=m.$freeze()},3),H(B,"$roll",function(y){var l,$,n,h=this,m=i;return m=y.$roll_once(6),l=y.$roll_once(6),$=(a(m["$odd?"]())?h.odd:h.even)["$[]"](U(l,1)),n=A(x(m,10),l),q("RollResult").$new(h.name,n,$)},1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(r){var A,L,K,o,f,C,B,Q,R,G=[],i=r.nil,t=r.module,e=r.klass,k=r.def,N=r.rb_plus,H=r.rb_times,a=r.send;return A=G,L=R=[t(G[0],"BCDice")].concat(A),K=Q=[t(R[0],"DiceTable")].concat(L),f=[o=e(Q[0],null,"D66RangeTable")].concat(K),C=r.$r(f),(B=o.$$prototype).items=B.name=i,k(o,"$initialize",function(q,v){return this.name=q,this.items=v.$freeze()},2),k(o,"$roll",function(q){var T,y,h,m=i;return T=q.$roll_once(6),y=q.$roll_once(6),h=N(H(T,10),y),m=a(this.items,"find",[],function(u){return null==u&&(u=i),u["$[]"](0)["$include?"](h)},1),C("RollResult").$new(this.name,h,m["$[]"](1))},1)},Opal.modules["bcdice/dice_table/range_table"]=function(r){var j,K,Y,q,v,T,y,f,ie,G=[],i=r.nil,t=r.module,e=r.klass,k=r.const_set,N=r.send,H=r.truthy,a=r.def,U=r.to_a,A=r.rb_minus,x=r.eqeqeq,R=r.rb_times,F=r.rb_plus;return j=G,K=ie=[t(G[0],"BCDice")].concat(j),Y=f=[t(ie[0],"DiceTable")].concat(K),v=[q=e(f[0],null,"RangeTable")].concat(Y),T=r.$r(v),(y=q.$$prototype).name=y.items=y.num_of_dice=y.num_of_sides=y.formatter=i,k(v[0],"RollResult",N(T("Struct"),"new",["sum","values","content","formatted"],function h(){return(null==h.$$s?this:h.$$s).$alias_method("to_s","formatted")},{$$arity:0,$$s:q})),k(v[0],"Item",T("Struct").$new("range","content")),k(v[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),k(v[0],"DEFAULT_FORMATTER",N(q,"lambda",[],function(m,l){return null==m&&(m=i),null==l&&(l=i),m.$name()+"("+l.$sum()+") \uff1e "+l.$content()},2)),q.$attr_reader("name"),q.$attr_reader("num_of_dice"),q.$attr_reader("num_of_sides"),a(q,"$initialize",function h(m,l,u){var s,$=h.$$p||i,n=this,d=i;return delete h.$$p,n.name=m.$freeze(),n.formatter=H(s=$)?s:T("DEFAULT_FORMATTER"),d=T("DICE_ROLL_METHOD_RE").$match(l),H(d)||n.$raise(T("ArgumentError"),n.name+": invalid dice roll method: "+l),n.num_of_dice=d["$[]"](1).$to_i(),n.num_of_sides=d["$[]"](2).$to_i(),n.$store(u)},3),a(q,"$fetch",function(m){var u,l=this;return u=N(l.items,"find",[],function(n){return null==n&&(n=i),n.$range()["$include?"](m)},1),H(u)||l.$raise(T("RangeError"),l.name+": value is out of range: "+m),u},1),a(q,"$roll",function(m){var $,n,s,l=this,u=i;return $=(u=m.$roll_barabara(l.num_of_dice,l.num_of_sides)).$sum(),n=T("RollResult").$new($,u,l.$fetch($).$content()),s=[l.formatter["$[]"](l,n)],N(n,"formatted=",U(s)),A(s.length,1),n},1),q.$private(),a(q,"$store",function(m){var u,$,l=this;return u=N(m,"map",[],function n(s,d){return null==s&&(s=i),null==d&&(d=i),[(null==n.$$s?this:n.$$s).$coerce_to_int_range(s),d]},{$$arity:2,$$s:l}),$=N(u,"sort_by",[],function(s,d){return null==s&&(s=i),null==d&&(d=i),s.$min()},2),l.$assert_min_sum_is_covered($),l.$assert_max_sum_is_covered($),l.$assert_no_gap_or_overlap_in_ranges($),l.items=N($,"map",[],function(s,d){return null==s&&(s=i),null==d&&(d=i),T("Item").$new(s,d.$freeze()).$freeze()},2).$freeze(),l},1),a(q,"$coerce_to_int_range",function(m){var u;return x(T("Integer"),u=m)?T("Range").$new(m,m):x(T("Range"),u)&&H(m.$begin()["$is_a?"](T("Integer")))&&H(m.$end()["$is_a?"](T("Integer")))?m:this.$raise(T("TypeError"),this.name+": "+m+" ("+m.$class()+") must be an Integer or a Range with Integers ")},1),a(q,"$assert_min_sum_is_covered",function(m){var u,l=this,$=i;return u=l.num_of_dice,$=m.$first()["$[]"](0),H($["$include?"](u))||l.$raise(T("RangeError"),l.name+": min value ("+u+") is not covered: "+$),l},1),a(q,"$assert_max_sum_is_covered",function(m){var u,l=this,$=i;return u=R(l.num_of_dice,l.num_of_sides),$=m.$last()["$[]"](0),H($["$include?"](u))||l.$raise(T("RangeError"),l.name+": max value ("+u+") is not covered: "+$),l},1),a(q,"$assert_no_gap_or_overlap_in_ranges",function(m){return N(m,"each_cons",[2],function u($,n){var _,p,s=null==u.$$s?this:u.$$s,d=i,g=i;return null==s.name&&(s.name=i),null==$&&($=i),null==n&&(n=i),d=$["$[]"](0),g=n["$[]"](0),_=d.$max(),p=F(_,1),H(g["$include?"](_))&&s.$raise(T("RangeError"),s.name+": Range overlap: "+d+" and "+g),H(g["$include?"](p))?i:s.$raise(T("RangeError"),s.name+": Range gap: "+d+" and "+g)},{$$arity:2,$$s:this}),this},1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(r){var A,L,K,Y,q,v,T,f,Q,R,G=[],i=r.nil,t=r.$$$,e=r.module,k=r.klass,N=r.send,H=r.def,a=r.rb_minus;return A=G,L=R=[e(G[0],"BCDice")].concat(A),K=Q=[e(R[0],"DiceTable")].concat(L),Y=f=[k(Q[0],null,"SaiFicSkillTable")].concat(K),v=[q=k(f[0],null,"Category")].concat(Y),T=r.$r(v),q.$$prototype.name=i,H(q,"$initialize",function(m,l,u,$){var n=this;return n.name=m,n.skills=N(l.$map(),"with_index",[2],function(d,g){return null==d&&(d=i),null==g&&(g=i),t(T("SaiFicSkillTable"),"Skill").$new(m,d,u,g,$)},2),n.dice=u},4),H(q,"$roll",function(m){return this.$skills()["$[]"](a(m.$roll_sum(2,6),2))},1),H(q,"$to_s",function(){return this.name},0),q.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(r){var a,R,ie,C,B,K,L,A,G=[],i=r.nil,t=r.module,e=r.klass,k=r.def,N=r.hash2;return a=G,R=A=[t(G[0],"BCDice")].concat(a),ie=L=[t(A[0],"DiceTable")].concat(R),K=[e(L[0],null,"SaiFicSkillTable")].concat(ie),(B=(C=e(K[0],null,"Skill")).$$prototype).s_format=B.category_dice=B.row_dice=B.category_name=B.name=i,k(C,"$initialize",function(q,v,T,y,h){var m=this;return m.category_name=q,m.name=v,m.category_dice=T,m.row_dice=y,m.s_format=h},5),k(C,"$to_s",function(){var q=this;return q.$format(q.s_format,N(["category_dice","row_dice","category_name","skill_name"],{category_dice:q.category_dice,row_dice:q.row_dice,category_name:q.category_name,skill_name:q.name}))},0),C.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(r){var M,C,T,y,h,m,l,Y,o,G=r.top,i=[],t=r.nil,e=r.$$$,k=r.module,N=r.klass,H=r.hash2,a=r.send,A=r.defs,x=r.const_set,R=r.to_ary,F=r.def,L=r.truthy,j=r.rb_minus,Q=r.rb_plus;return G.$require("bcdice/dice_table/sai_fic_skill_table/category"),G.$require("bcdice/dice_table/sai_fic_skill_table/skill"),M=i,C=o=[k(i[0],"BCDice")].concat(M),T=Y=[k(o[0],"DiceTable")].concat(C),h=[y=N(Y[0],null,"SaiFicSkillTable")].concat(T),m=r.$r(h),(l=y.$$prototype).rtt=l.rtt_format=l.rct=l.rct_format=l.rttn=l.rttn_format=l.categories=t,A(y,"$from_i18n",function($,n,s){var d,g,_,c,Z=t;if(null==s)s=H([],{});else if(!s.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(d=s.$$smap.rtt)&&(d=t),null==(g=s.$$smap.rct)&&(g=t),null==(_=s.$$smap.rttn)&&(_=t),c=(Z=m("I18n").$t("RTT",H(["locale","raise","default"],{locale:n,raise:!1,default:H([],{})})).$merge(m("I18n").$t($,H(["locale","raise"],{locale:n,raise:!0}))))["$[]"]("items"),Z=a(Z,"select",[],function(E,$e){return null==E&&(E=t),null==$e&&($e=t),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](E)},2),this.$new(c,r.to_hash(Z).$merge(H(["rtt","rct","rttn"],{rtt:d,rct:g,rttn:_})))},-3),x(h[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),x(h[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),x(h[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),x(h[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),F(y,"$initialize",function($,n){var s,d,g,_,p,b,Z,c=this;if(null==n)n=H([],{});else if(!n.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(s=n.$$smap.rtt)&&(s=t),null==(d=n.$$smap.rct)&&(d=t),null==(g=n.$$smap.rttn)&&(g=t),null==(_=n.$$smap.rtt_format)&&(_=m("DEFAULT_RTT")),null==(p=n.$$smap.rct_format)&&(p=m("DEFAULT_RCT")),null==(b=n.$$smap.rttn_format)&&(b=m("DEFAULT_RTTN")),null==(Z=n.$$smap.s_format)&&(Z=m("DEFAULT_S")),c.categories=a($.$map(),"with_index",[1],function(E,$e){var ue,fe,le;return null==E&&(E=t),null==$e&&($e=t),fe=null==(ue=R(E))[0]?t:ue[0],le=null==ue[1]?t:ue[1],e(m("SaiFicSkillTable"),"Category").$new(fe,le,$e,Z)},{$$arity:2,$$has_top_level_mlhs_arg:!0}),c.rtt=s,c.rct=d,c.rttn=g.$to_a(),c.rtt_format=_,c.rct_format=p,c.rttn_format=b},-2),x(h[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),y.$attr_reader("categories"),F(y,"$roll_command",function($,n){var d,s=this,g=t,_=t;return L(["RTT",s.rtt]["$include?"](d=n))?s.$format_skill(s.rtt_format,s.$roll_skill($)):L(["RCT",s.rct]["$include?"](d))?(g=s.$roll_category($),s.$format(s.rct_format,H(["category_dice","category_name"],{category_dice:g.$dice(),category_name:g.$name()}))):L(_=m("RTTN").$index(d))||L(_=s.rttn.$index(d))?s.$format_skill(s.rttn_format,s.categories["$[]"](_).$roll($)):t},2),F(y,"$roll_category",function($){return this.categories["$[]"](j($.$roll_once(6),1))},1),F(y,"$roll_skill",function($){return this.$roll_category($).$roll($)},1),F(y,"$prefixes",function(){var $=this;return Q(["RTT[1-6]?","RCT",$.rtt,$.rct],$.rttn).$compact()},0),y.$private(),F(y,"$format_skill",function($,n){return this.$format($,H(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:n.$category_dice(),row_dice:n.$row_dice(),category_name:n.$category_name(),skill_name:n.$name(),text:n.$to_s()}))},2)},Opal.modules["bcdice/dice_table/table"]=function(r){var x,j,o,f,C,B,Y,ie,F,G=[],i=r.nil,t=r.module,e=r.klass,k=r.hash2,N=r.defs,H=r.truthy,a=r.def,U=r.rb_minus;return x=G,j=F=[t(G[0],"BCDice")].concat(x),o=ie=[t(F[0],"DiceTable")].concat(j),C=[f=e(ie[0],null,"Table")].concat(o),B=r.$r(C),(Y=f.$$prototype).times=Y.sides=Y.name=Y.items=i,N(f,"$from_i18n",function(v,T){var h=i;return h=B("I18n").$t(v,k(["locale"],{locale:T})),this.$new(h["$[]"]("name"),h["$[]"]("type"),h["$[]"]("items"))},2),a(f,"$initialize",function(v,T,y){var h=this,m=i;return h.name=v,h.items=y.$freeze(),m=/(\d+)D(\d+)/i.$match(T),H(m)||h.$raise(B("ArgumentError"),"Unexpected table type: "+T),h.times=m["$[]"](1).$to_i(),h.sides=m["$[]"](2).$to_i()},3),a(f,"$roll",function(v){var y,T=this;return y=v.$roll_sum(T.times,T.sides),T.$choice(y)},1),a(f,"$choice",function(v){var y,T=this;return y=U(v,T.times),B("RollResult").$new(T.name,v,T.items["$[]"](y))},1)},Opal.modules["bcdice/dice_table"]=function(r){var G=r.top;return G.$require("bcdice/dice_table/roll_result"),G.$require("bcdice/dice_table/chain_table"),G.$require("bcdice/dice_table/d66_grid_table"),G.$require("bcdice/dice_table/d66_half_grid_table"),G.$require("bcdice/dice_table/d66_one_third_table"),G.$require("bcdice/dice_table/d66_left_range_table"),G.$require("bcdice/dice_table/d66_parity_table"),G.$require("bcdice/dice_table/d66_range_table"),G.$require("bcdice/dice_table/d66_table"),G.$require("bcdice/dice_table/range_table"),G.$require("bcdice/dice_table/sai_fic_skill_table"),G.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(r){var N,A,R,a,G=[],t=r.module,e=r.const_set;return N=G,A=a=[t(G[0],"BCDice")].concat(N),R=[t(a[0],"D66SortType")].concat(A),e(R[0],"NO_SORT","no_sort"),e(R[0],"ASC","asc"),e(R[0],"DESC","desc"),function(U,A){var R=[t(U,"RoundType")].concat(A);return e(R[0],"CEIL","ceil"),e(R[0],"FLOOR","floor"),e(R[0],"ROUND","round")}(a[0],a)},Opal.modules["bcdice/translate"]=function(r){var a,R,F,L,j,A,G=[],i=r.nil,t=r.module,e=r.hash2,N=r.def;return a=G,R=A=[t(G[0],"BCDice")].concat(a),L=[F=t(A[0],"Translate")].concat(R),j=r.$r(L),N(F,"$translate",function(ie,M){var K,o=this;if(null==o.locale&&(o.locale=i),null==M)M=e([],{});else if(!M.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return K=r.kwrestargs(M,{}),j("I18n").$translate(ie,e(["locale","raise"],{locale:o.locale,raise:!0}).$merge(r.to_hash(K)))},-2)},Opal.modules["bcdice/result"]=function(r){var A,j,K,Q,M,R,G=[],i=r.nil,e=r.klass,k=r.send,N=r.to_a,H=r.rb_minus,a=r.def;return A=G,j=R=[(0,r.module)(G[0],"BCDice")].concat(A),[Q=e(R[0],null,"Result")].concat(j),(M=Q.$$prototype).secret=M.success=M.failure=M.critical=M.fumble=i,a(K=r.get_singleton_class(Q),"$success",function(C){return k(this.$new(),"tap",[],function(q){var v=i;return null==q&&(q=i),k(q,"text=",N(v=[C])),H(v.length,1),k(q,"success=",N(v=[!0])),v[H(v.length,1)]},1)},1),a(K,"$failure",function(C){return k(this.$new(),"tap",[],function(q){var v=i;return null==q&&(q=i),k(q,"text=",N(v=[C])),H(v.length,1),k(q,"failure=",N(v=[!0])),v[H(v.length,1)]},1)},1),a(K,"$critical",function(C){return k(this.$new(),"tap",[],function(q){var v=i;return null==q&&(q=i),k(q,"text=",N(v=[C])),H(v.length,1),k(q,"critical=",N(v=[!0])),H(v.length,1),k(q,"success=",N(v=[!0])),v[H(v.length,1)]},1)},1),a(K,"$fumble",function(C){return k(this.$new(),"tap",[],function(q){var v=i;return null==q&&(q=i),k(q,"text=",N(v=[C])),H(v.length,1),k(q,"fumble=",N(v=[!0])),H(v.length,1),k(q,"failure=",N(v=[!0])),v[H(v.length,1)]},1)},1),a(K,"$nothing",function(){return"nothing"},0),a(Q,"$initialize",function(o){var f=this;return null==o&&(o=i),f.text=o,f.rands=i,f.detailed_rands=i,f.secret=!1,f.success=!1,f.failure=!1,f.critical=!1,f.fumble=!1},-1),Q.$attr_accessor("text","rands","detailed_rands"),Q.$attr_writer("secret","success","failure","critical","fumble"),a(Q,"$secret?",function(){return this.secret},0),a(Q,"$success?",function(){return this.success},0),a(Q,"$failure?",function(){return this.failure},0),a(Q,"$critical?",function(){return this.critical},0),a(Q,"$fumble?",function(){return this.fumble},0),a(Q,"$condition=",function(o){return this.success=o,this.failure=o["$!"]()},1)},Opal.modules["racc/parser"]=function(r){var T,h,m,i=[],t=r.$r(i),e=r.nil,k=r.$$$,N=r.module,H=r.klass,a=r.truthy,U=r.const_set,A=r.defs,x=r.gvars,R=r.rb_lt,F=r.send,L=r.to_a,j=r.rb_minus,Q=r.def,ie=r.to_ary,M=r.neqeq,K=r.rb_plus,o=r.eqeq,f=r.rb_ge,C=r.rb_gt,B=r.eqeqeq,Y=r.rb_le,q=r.rb_times;return T=i,h=[N(i[0],"Racc")].concat(T),m=r.$r(h),H(h[0],m("StandardError"),"ParseError"),a(k("::","ParseError","skip_raise")?"constant":e)||U(i[0],"ParseError",k(t("Racc"),"ParseError")),function(v,T){var n,s,d,g,_,m=[N(v,"Racc")].concat(T),l=r.$r(m);return a(l("Racc_No_Extensions","skip_raise")?"constant":e)||U(m[0],"Racc_No_Extensions",!1),n=m,d=[s=H(m[0],null,"Parser")].concat(n),g=r.$r(d),(_=s.$$prototype).yydebug=_.racc_debug_out=_.racc_error_status=_.racc_t=_.racc_vstack=_.racc_val=_.racc_state=_.racc_tstack=e,U(d[0],"Racc_Runtime_Version","1.4.6"),U(d[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),U(d[0],"Racc_Runtime_Core_Version_R","1.4.6"),U(d[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),U(d[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),U(d[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),U(d[0],"Racc_Runtime_Core_Version",g("Racc_Runtime_Core_Version_R")),U(d[0],"Racc_Runtime_Core_Revision",g("Racc_Runtime_Core_Revision_R")),U(d[0],"Racc_Runtime_Type","ruby"),A(g("Parser"),"$racc_runtime_type",function(){return g("Racc_Runtime_Type")},0),Q(s,"$_racc_setup",function(){var b,Z,c=this,X=e,E=e,$e=e;return null==x.stderr&&(x.stderr=e),a(k(c.$class(),"Racc_debug_parser"))||(c.yydebug=!1),a(null!=(b=c.yydebug)&&b!==e?"instance-variable":e)||(c.yydebug=!1),a(c.yydebug)&&(a(null!=(Z=c.racc_debug_out)&&Z!==e?"instance-variable":e)||(c.racc_debug_out=x.stderr),c.racc_debug_out=a(X=c.racc_debug_out)?X:x.stderr),E=k(c.$class(),"Racc_arg"),a(R(E.$size(),14))&&(F(E,"[]=",L($e=[13,!0])),j($e.length,1)),E},0),Q(s,"$_racc_init_sysvars",function(){var b=this;return b.racc_state=[0],b.racc_tstack=[],b.racc_vstack=[],b.racc_t=e,b.racc_val=e,b.racc_read_next=!0,b.racc_user_yyerror=!1,b.racc_error_status=0},0),Q(s,"$do_parse",function(){return this.$__send__(g("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),Q(s,"$next_token",function(){return this.$raise(g("NotImplementedError"),this.$class()+"#next_token is not defined")},0),Q(s,"$_racc_do_parse_rb",function(b,Z){var c,E=this,$e=e,ue=e,ce=e,fe=e,te=e,z=e,J=e,P=e;return c=ie(b),$e=null==c[0]?e:c[0],ue=null==c[1]?e:c[1],ce=null==c[2]?e:c[2],fe=null==c[3]?e:c[3],te=null==c[10]?e:c[10],E.$_racc_init_sysvars(),z=J=P=e,F(E,"catch",["racc_end_parse"],function D(){var re,I,V=null==D.$$s?this:D.$$s,S=e;for(null==V.racc_state&&(V.racc_state=e),null==V.racc_read_next&&(V.racc_read_next=e),null==V.racc_t&&(V.racc_t=e),null==V.yydebug&&(V.yydebug=e),null==V.racc_val&&(V.racc_val=e);a(!0);)for(a(P=fe["$[]"](V.racc_state["$[]"](-1)))?(a(V.racc_read_next)&&M(V.racc_t,0)&&(I=V.$next_token(),re=ie(I),z=null==re[0]?e:re[0],V.racc_val=null==re[1]?e:re[1],V.racc_t=a(z)?a(S=te["$[]"](z))?S:1:0,a(V.yydebug)&&V.$racc_read_token(V.racc_t,z,V.racc_val),V.racc_read_next=!1),P=K(P,V.racc_t),a(f(P,0))&&a(J=$e["$[]"](P))&&o(ue["$[]"](P),V.racc_state["$[]"](-1))||(J=ce["$[]"](V.racc_state["$[]"](-1)))):J=ce["$[]"](V.racc_state["$[]"](-1));a(J=V.$_racc_evalact(J,b)););},{$$arity:0,$$s:E})},2),Q(s,"$yyparse",function(b,Z){return this.$__send__(g("Racc_YY_Parse_Method"),b,Z,this.$_racc_setup(),!0)},2),Q(s,"$_racc_yyparse_rb",function(b,Z,c,X){var E,ce=e,fe=e,le=e,te=e,J=e,P=e,D=e;return E=ie(c),ce=null==E[0]?e:E[0],fe=null==E[1]?e:E[1],le=null==E[2]?e:E[2],te=null==E[3]?e:E[3],J=null==E[10]?e:E[10],this.$_racc_init_sysvars(),P=e,D=e,F(this,"catch",["racc_end_parse"],function se(){var V=null==se.$$s?this:se.$$s;for(null==V.racc_state&&(V.racc_state=e);!a(D=te["$[]"](V.racc_state["$[]"](-1)));)for(;a(P=V.$_racc_evalact(le["$[]"](V.racc_state["$[]"](-1)),c)););return F(b,"__send__",[Z],function S(w,ne){var ee=null==S.$$s?this:S.$$s,W=e,ae=e;for(null==ee.racc_t&&(ee.racc_t=e),null==ee.racc_state&&(ee.racc_state=e),null==ee.racc_read_next&&(ee.racc_read_next=e),null==w&&(w=e),null==ne&&(ne=e),ee.racc_t=a(w)?a(W=J["$[]"](w))?W:1:0,ee.racc_val=ne,ee.racc_read_next=!1,D=K(D,ee.racc_t),a(f(D,0))&&a(P=ce["$[]"](D))&&o(fe["$[]"](D),ee.racc_state["$[]"](-1))||(P=le["$[]"](ee.racc_state["$[]"](-1)));a(P=ee.$_racc_evalact(P,c)););for(;a(a(W=a(ae=(D=te["$[]"](ee.racc_state["$[]"](-1)))["$!"]())?ae:ee.racc_read_next["$!"]())?W:ee.racc_t["$=="](0));)for(a(D)&&a(D=K(D,ee.racc_t))&&a(f(D,0))&&a(P=ce["$[]"](D))&&o(fe["$[]"](D),ee.racc_state["$[]"](-1))||(P=le["$[]"](ee.racc_state["$[]"](-1)));a(P=ee.$_racc_evalact(P,c)););},{$$arity:2,$$s:V})},{$$arity:0,$$s:this})},4),Q(s,"$_racc_evalact",function(b,Z){var c,le,E=this,$e=e,ue=e,fe=e,te=e,z=e,J=e,P=e;if($e=null==(c=ie(Z))[0]?e:c[0],ue=null==c[1]?e:c[1],fe=null==c[3]?e:c[3],le=null==c[11]?e:c[11],te=null==c[12]?e:c[12],a(C(b,0))&&a(R(b,le)))a(C(E.racc_error_status,0))&&(o(E.racc_t,1)||(E.racc_error_status=j(E.racc_error_status,1))),E.racc_vstack.$push(E.racc_val),E.racc_state.$push(b),E.racc_read_next=!0,a(E.yydebug)&&(E.racc_tstack.$push(E.racc_t),E.$racc_shift(E.racc_t,E.racc_tstack,E.racc_vstack));else if(a(R(b,0))&&a(C(b,te["$-@"]()))){if(z=F(E,"catch",["racc_jump"],function D(){var se=null==D.$$s?this:D.$$s;return null==se.racc_state&&(se.racc_state=e),se.racc_state.$push(se.$_racc_do_reduce(Z,b)),!1},{$$arity:0,$$s:E}),a(z)){if(B(1,J=z))return E.racc_user_yyerror=!0,te["$-@"]();if(B(2,J))return le;E.$raise("[Racc Bug] unknown jump code")}}else if(o(b,le))a(E.yydebug)&&E.$racc_accept(),E.$throw("racc_end_parse",E.racc_vstack["$[]"](0));else{if(o(b,te["$-@"]())){for(B(0,J=E.racc_error_status)?a(Z["$[]"](21))||E.$on_error(E.racc_t,E.racc_val,E.racc_vstack):B(3,J)&&(o(E.racc_t,0)&&E.$throw("racc_end_parse",e),E.racc_read_next=!0),E.racc_user_yyerror=!1,E.racc_error_status=3;a(!0)&&!(a(P=fe["$[]"](E.racc_state["$[]"](-1)))&&(P=K(P,1),a(f(P,0))&&a(b=$e["$[]"](P))&&o(ue["$[]"](P),E.racc_state["$[]"](-1))));)a(Y(E.racc_state.$size(),1))&&E.$throw("racc_end_parse",e),E.racc_state.$pop(),E.racc_vstack.$pop(),a(E.yydebug)&&(E.racc_tstack.$pop(),E.$racc_e_pop(E.racc_state,E.racc_tstack,E.racc_vstack));return b}E.$raise("[Racc Bug] unknown action "+b.$inspect())}return a(E.yydebug)&&E.$racc_next_state(E.racc_state["$[]"](-1),E.racc_state),e},2),Q(s,"$_racc_do_reduce",function(b,Z){var c,te,J,V,S,w,ee,E=this,ue=e,ce=e,fe=e,le=e,z=e,P=e,D=e,se=e,re=e,I=e,ne=e,_e=e,O=e,W=e;return ue=null==(c=ie(b))[4]?e:c[4],ce=null==c[5]?e:c[5],fe=null==c[6]?e:c[6],le=null==c[7]?e:c[7],te=null==c[8]?e:c[8],z=null==c[9]?e:c[9],J=null==c[13]?e:c[13],P=E.racc_state,D=E.racc_vstack,se=E.racc_tstack,re=q(Z,-3),I=z["$[]"](re),V=z["$[]"](K(re,1)),S=z["$[]"](K(re,2)),w=[],a(E.yydebug)&&(ne=se["$[]"](I["$-@"](),I)),_e=D["$[]"](I["$-@"](),I),a(E.yydebug)&&(O=[I["$-@"](),I,w],F(se,"[]=",L(O)),j(O.length,1)),O=[I["$-@"](),I,w],F(D,"[]=",L(O)),j(O.length,1),O=[I["$-@"](),I,w],F(P,"[]=",L(O)),j(O.length,1),a(J)?D.$push(E.$__send__(S,_e,D,_e["$[]"](0))):D.$push(E.$__send__(S,_e,D)),se.$push(V),a(E.yydebug)&&E.$racc_reduce(ne,V,se,D),ee=j(V,te),a(re=le["$[]"](ee))&&(re=K(re,P["$[]"](-1)),a(f(re,0))&&a(W=ue["$[]"](re))&&o(ce["$[]"](re),ee))?W:fe["$[]"](ee)},2),Q(s,"$on_error",function(b,Z,c){var E,X=this;return X.$raise(g("ParseError"),X.$sprintf("\nparse error on value %s (%s)",Z.$inspect(),a(E=X.$token_to_str(b))?E:"?"))},3),Q(s,"$yyerror",function(){return this.$throw("racc_jump",1)},0),Q(s,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),Q(s,"$yyerrok",function(){return this.racc_error_status=0},0),Q(s,"$racc_read_token",function(b,Z,c){var X=this;return X.racc_debug_out.$print("read    "),X.racc_debug_out.$print(Z.$inspect(),"(",X.$racc_token2str(b),") "),X.racc_debug_out.$puts(c.$inspect()),X.racc_debug_out.$puts()},3),Q(s,"$racc_shift",function(b,Z,c){var X=this;return X.racc_debug_out.$puts("shift   "+X.$racc_token2str(b)),X.$racc_print_stacks(Z,c),X.racc_debug_out.$puts()},3),Q(s,"$racc_reduce",function(b,Z,c,X){var E=this,$e=e;return($e=E.racc_debug_out).$print("reduce "),a(b["$empty?"]())?$e.$print(" <none>"):F(b,"each",[],function ue(ce){return null==ce&&(ce=e),$e.$print(" ",(null==ue.$$s?this:ue.$$s).$racc_token2str(ce))},{$$arity:1,$$s:E}),$e.$puts(" --\x3e "+E.$racc_token2str(Z)),E.$racc_print_stacks(c,X),E.racc_debug_out.$puts()},4),Q(s,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),Q(s,"$racc_e_pop",function(b,Z,c){var X=this;return X.racc_debug_out.$puts("error recovering mode: pop token"),X.$racc_print_states(b),X.$racc_print_stacks(Z,c),X.racc_debug_out.$puts()},3),Q(s,"$racc_next_state",function(b,Z){var c=this;return c.racc_debug_out.$puts("goto    "+b),c.$racc_print_states(Z),c.racc_debug_out.$puts()},2),Q(s,"$racc_print_stacks",function(b,Z){var X=e;return(X=this.racc_debug_out).$print("        ["),F(b,"each_index",[],function E($e){return null==$e&&($e=e),X.$print(" (",(null==E.$$s?this:E.$$s).$racc_token2str(b["$[]"]($e))," ",Z["$[]"]($e).$inspect(),")")},{$$arity:1,$$s:this}),X.$puts(" ]")},2),Q(s,"$racc_print_states",function(b){var c=e;return(c=this.racc_debug_out).$print("        ["),F(b,"each",[],function(E){return null==E&&(E=e),c.$print(" ",E)},1),c.$puts(" ]")},1),Q(s,"$racc_token2str",function(b){var c;return a(c=k(this.$class(),"Racc_token_to_s_table")["$[]"](b))?c:this.$raise("[Racc Bug] can't convert token "+b+" to string")},1),Q(s,"$token_to_str",function(b){return k(this.$class(),"Racc_token_to_s_table")["$[]"](b)},1)}(i[0],i)},Opal.modules["bcdice/arithmetic/node"]=function(r){var Q,o,Y,m,l,v,T,C,M,G=[],i=r.nil,t=r.$$$,e=r.module,k=r.klass,N=r.def,H=r.send2,a=r.find_super,U=r.eqeq,A=r.const_set,x=r.eqeqeq,R=r.rb_divide,F=r.truthy,L=r.alias;return Q=G,o=M=[e(G[0],"BCDice")].concat(Q),Y=C=[e(M[0],"Arithmetic")].concat(o),v=[e(C[0],"Node")].concat(Y),T=r.$r(v),(l=(m=k(v[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=i,N(m,"$initialize",function($,n,s){var d=this;return d.lhs=$,d.op=n,d.rhs=s},3),N(m,"$eval",function($){var d,n=this,s=i;return s=n.lhs.$eval($),d=n.rhs.$eval($),s.$send(n.op,d)},1),N(m,"$output",function(){var $=this;return""+$.lhs.$output()+$.op+$.rhs.$output()},0),N(m,"$s_exp",function(){var $=this;return"("+$.$op_for_s_exp()+" "+$.lhs.$s_exp()+" "+$.rhs.$s_exp()+")"},0),N(m,"$op_for_s_exp",function(){return this.op},0),function(y,h,m){var l=k(y,h,"DivideBase"),u=[l].concat(m),$=r.$r(u),n=l.$$prototype;n.lhs=n.rhs=n.op=i,N(l,"$initialize",function s(d,g){return delete s.$$p,H(this,a(this,"initialize",s,!1,!0),"initialize",[d,"/",g],null)},2),N(l,"$eval",function(d){var _,p,g=this;return _=g.lhs.$eval(d),p=g.rhs.$eval(d),U(p,0)&&g.$raise($("ZeroDivisionError")),g.$divide_and_round(_,p,d)},1),N(l,"$output",function s(){var d=s.$$p||i,g=this;return delete s.$$p,""+H(g,a(g,"output",s,!1,!0),"output",[],d)+g.$rounding_method()},0),l.$private(),N(l,"$rounding_method",function(){return t(this.$class(),"ROUNDING_METHOD")},0),N(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),N(l,"$divide_and_round",function(d,g,_){return this.$raise($("NotImplementedError"))},3)}(v[0],T("BinaryOp"),v),function(y,h,m){var l=k(y,h,"DivideWithGameSystemDefault"),u=[l].concat(m),$=r.$r(u);A(u[0],"ROUNDING_METHOD",""),l.$private(),N(l,"$divide_and_round",function(s,d,g){var _,p=i;return x(t($("RoundType"),"CEIL"),_=g)?R(s.$to_f(),d).$ceil():x(t($("RoundType"),"ROUND"),_)?(p=R(s.$to_f(),d),F(p["$negative?"]())?p.$abs().$round()["$-@"]():p.$round()):R(s,d).$floor()},3)}(v[0],T("DivideBase"),v),function(y,h,m){var l=k(y,h,"DivideWithCeil"),u=[l].concat(m);A(u[0],"ROUNDING_METHOD","C"),l.$private(),N(l,"$divide_and_round",function(n,s,d){return R(n.$to_f(),s).$ceil()},3)}(v[0],T("DivideBase"),v),function(y,h,m){var l=k(y,h,"DivideWithRound"),u=[l].concat(m);A(u[0],"ROUNDING_METHOD","R"),l.$private(),N(l,"$divide_and_round",function(n,s,d){var g=i;return g=R(n.$to_f(),s),F(g["$negative?"]())?g.$abs().$round()["$-@"]():g.$round()},3)}(v[0],T("DivideBase"),v),function(y,h,m){var l=k(y,h,"DivideWithFloor"),u=[l].concat(m);A(u[0],"ROUNDING_METHOD","F"),l.$private(),N(l,"$divide_and_round",function(n,s,d){return R(n,s).$floor()},3)}(v[0],T("DivideBase"),v),function(y,h){var m=k(y,null,"Negative");m.$$prototype.body=i,N(m,"$initialize",function($){return this.body=$},1),N(m,"$eval",function($){return this.body.$eval($)["$-@"]()},1),N(m,"$output",function(){return"-"+this.body.$output()},0),N(m,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(v[0]),function(y,h){var m=k(y,null,"Parenthesis");m.$$prototype.expr=i,N(m,"$initialize",function($){return this.expr=$},1),N(m,"$eval",function($){return this.expr.$eval($)},1),N(m,"$output",function(){return"("+this.expr.$output()+")"},0),N(m,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(v[0]),function(y,h){var m=k(y,null,"Number");return m.$$prototype.value=i,N(m,"$initialize",function($){return this.value=$},1),N(m,"$eval",function($){return this.value},1),N(m,"$output",function(){return this.value.$to_s()},0),L(m,"s_exp","output")}(v[0])},Opal.modules.strscan=function(r){var L,j,Q,ie,M,G=[],i=r.nil,e=r.def,k=r.truthy,N=r.eqeqeq,H=r.Opal,a=r.send,U=r.to_a,A=r.rb_minus,x=r.alias;return L=G,Q=[j=(0,r.klass)(G[0],null,"StringScanner")].concat(L),ie=r.$r(Q),(M=j.$$prototype).pos=M.string=M.working=M.matched=M.prev_pos=M.match=i,j.$attr_reader("pos","matched"),e(j,"$initialize",function(o){var f=this;return f.string=o,f.pos=0,f.matched=i,f.working=o,f.match=[]},1),j.$attr_reader("string"),e(j,"$beginning_of_line?",function(){var o=this;return 0===o.pos||"\n"===o.string.charAt(o.pos-1)},0),e(j,"$scan",function(o){var f=this,C=(o=f.$anchor(o)).exec(f.working);return null==C?f.matched=i:"object"==typeof C?(f.prev_pos=f.pos,f.pos+=C[0].length,f.working=f.working.substring(C[0].length),f.matched=C[0],f.match=C,C[0]):"string"==typeof C?(f.pos+=C.length,f.working=f.working.substring(C.length),C):i},1),e(j,"$scan_until",function(o){var f=this;o=f.$anchor(o);for(var Y,C=f.pos,B=f.working;;){if(Y=o.exec(B),C+=1,B=B.substr(1),null!=Y)return f.matched=f.string.substr(f.pos,C-f.pos-1+Y[0].length),f.match=Y,f.prev_pos=C-1,f.pos=C,f.working=B.substr(Y[0].length),f.matched;if(0===B.length)return f.match=[],f.matched=i}},1),e(j,"$[]",function(o){var C;if(k(this.match["$empty?"]()))return i;N(ie("Symbol"),C=o)?o=o.$to_s():N(ie("String"),C)||(o=H["$coerce_to!"](o,ie("Integer"),"to_int"));var B=this.match;return o<0&&(o+=B.length),o<0||o>=B.length||null==B[o]?i:B[o]},1),e(j,"$check",function(o){var f=this,C=(o=f.$anchor(o)).exec(f.working);return f.matched=null==C?i:C[0]},1),e(j,"$check_until",function(o){var f=this,C=f.prev_pos,B=f.pos,Y=f.$scan_until(o);return Y!==i&&(f.matched=Y.substr(-1),f.working=f.string.substr(B)),f.prev_pos=C,f.pos=B,Y},1),e(j,"$peek",function(o){return this.working.substring(0,o)},1),e(j,"$eos?",function(){return 0===this.working.length},0),e(j,"$exist?",function(o){var C=o.exec(this.working);return null==C?i:0==C.index?0:C.index+1},1),e(j,"$skip",function(o){var f=this,C=(o=f.$anchor(o)).exec(f.working);if(null==C)return f.match=[],f.matched=i;var B=C[0],Y=B.length;return f.matched=B,f.match=C,f.prev_pos=f.pos,f.pos+=Y,f.working=f.working.substring(Y),Y},1),e(j,"$skip_until",function(o){var C=this.$scan_until(o);return C===i?i:(this.matched=C.substr(-1),C.length)},1),e(j,"$get_byte",function(){var o=this,f=i;return o.pos<o.string.length?(o.prev_pos=o.pos,o.pos+=1,f=o.matched=o.working.substring(0,1),o.working=o.working.substring(1)):o.matched=i,f},0),e(j,"$match?",function(o){var f=this,C=(o=f.$anchor(o)).exec(f.working);return null==C?i:(f.prev_pos=f.pos,C[0].length)},1),e(j,"$pos=",function(o){var f=this;return o<0&&(o+=f.string.$length()),f.pos=o,f.working=f.string.slice(o)},1),e(j,"$matched_size",function(){return this.matched===i?i:this.matched.length},0),e(j,"$post_match",function(){var o=this;return o.matched===i?i:o.string.substr(o.pos)},0),e(j,"$pre_match",function(){var o=this;return o.matched===i?i:o.string.substr(0,o.prev_pos)},0),e(j,"$reset",function(){var o=this;return o.working=o.string,o.matched=i,o.pos=0},0),e(j,"$rest",function(){return this.working},0),e(j,"$rest?",function(){return 0!==this.working.length},0),e(j,"$rest_size",function(){return this.$rest().$size()},0),e(j,"$terminate",function(){var f,o=this;return o.match=i,f=[o.string.$length()],a(o,"pos=",U(f)),f[A(f.length,1)]},0),e(j,"$unscan",function(){var o=this;return o.pos=o.prev_pos,o.prev_pos=i,o.match=i,o},0),x(j,"bol?","beginning_of_line?"),x(j,"getch","get_byte"),j.$private(),e(j,"$anchor",function(o){var f=o.toString().match(/\/([^\/]+)$/);return f=f?f[1]:void 0,new RegExp("^(?:"+o.source+")",f)},1)},Opal.modules["bcdice/normalize"]=function(r){var a,R,A,G=[],i=r.nil,t=r.module,e=r.eqeqeq,k=r.def,N=r.eqeq;return a=G,A=[t(G[0],"BCDice")].concat(a),(R=t(A[0],"Normalize")).$module_function(),k(R,"$comparison_operator",function(L){var j;return e(/<=|=</,j=L)?"<=":e(/>=|=>/,j)?">=":e(/<>|!=|=!/,j)?"!=":e(/</,j)?"<":e(/>/,j)?">":e(/=/,j)?"==":i},1),k(R,"$target_number",function(L){return N(L,"?")?L:L.$to_i()},1)},Opal.modules["bcdice/command/lexer"]=function(r){var R,Q,f,C,B,Y,q,M,L,G=r.top,i=[],t=r.nil,e=r.module,k=r.klass,N=r.const_set,H=r.hash2,a=r.truthy,U=r.send,A=r.def;return G.$require("strscan"),G.$require("bcdice/normalize"),R=i,Q=L=[e(i[0],"BCDice")].concat(R),f=M=[e(L[0],"Command")].concat(Q),B=[C=k(M[0],null,"Lexer")].concat(f),Y=r.$r(B),(q=C.$$prototype).scanner=q.notations=t,N(B[0],"SYMBOLS",H(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),A(C,"$initialize",function(T,y){var h,m,u;return T=a(u=(m=(h=T)===t||null==h?t:U(h,"split",[" ",2]))===t||null==m?t:U(m,"first",[]))?u:"",this.scanner=Y("StringScanner").$new(T),this.notations=U(y,"map",[],function(n){return null==n&&(n=t),a(n["$is_a?"](Y("String")))?Y("Regexp").$new(n):n},1)},2),A(C,"$next_token",function(){try{var T=this,y=t,h=t,l=t,u=t;return a(T.scanner["$eos?"]())?[!1,"$"]:(U(T.notations,"each",[],function $(n){var d,s=null==$.$$s?this:$.$$s;if(null==s.scanner&&(s.scanner=t),null==n&&(n=t),d=s.scanner.$scan(n),!a(d))return t;r.ret(["NOTATION",d])},{$$arity:1,$$s:T}),a(y=T.scanner.$scan(/\d+/))?["NUMBER",y.$to_i()]:a(h=T.scanner.$scan(/[<>!=]+/))?(h=Y("Normalize").$comparison_operator(h),[a(h)?"CMP_OP":"ILLEGAL",h]):(l=T.scanner.$getch().$upcase(),[a(u=Y("SYMBOLS")["$[]"](l))?u:l.$to_sym(),l]))}catch($){if($===r.returner)return $.$v;throw $}},0),A(C,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/command/parsed"]=function(r){var U,F,M,K,o,f,C,j,x,G=[],i=r.nil,t=r.module,e=r.klass,k=r.def,N=r.truthy,H=r.eqeqeq;return U=G,F=x=[t(G[0],"BCDice")].concat(U),M=j=[t(x[0],"Command")].concat(F),o=[K=e(j[0],null,"Parsed")].concat(M),f=r.$r(o),(C=K.$$prototype).question_target=C.critical=C.fumble=C.dollar=C.modify_number=C.target_number=C.prefix_number=C.command=C.suffix_number=C.cmp_op=i,K.$attr_accessor("command"),K.$attr_accessor("prefix_number"),K.$attr_accessor("suffix_number"),K.$attr_accessor("critical"),K.$attr_accessor("fumble"),K.$attr_accessor("dollar"),K.$attr_accessor("modify_number"),K.$attr_accessor("cmp_op"),K.$attr_accessor("target_number"),K.$attr_writer("question_target"),k(K,"$initialize",function(){var Y=this;return Y.prefix_number=i,Y.suffix_number=i,Y.critical=i,Y.fumble=i,Y.dollar=i,Y.cmp_op=i,Y.target_number=i,Y.question_target=!1},0),k(K,"$question_target?",function(){return this.question_target},0),k(K,"$to_s",function(Y){var l,q=this,v=i,T=i,y=i,h=i,m=i;return null==Y&&(Y="after_command"),v=N(q.critical)?"@"+q.critical:i,T=N(q.fumble)?"#"+q.fumble:i,y=N(q.dollar)?"$"+q.dollar:i,h=f("Format").$modifier(q.modify_number),m=N(q.question_target)?"?":q.target_number,H("after_command",l=Y)?[q.prefix_number,q.command,q.suffix_number,v,T,y,h,q.cmp_op,m].$join():H("after_modify_number",l)?[q.prefix_number,q.command,q.suffix_number,h,v,T,y,q.cmp_op,m].$join():H("after_target_number",l)?[q.prefix_number,q.command,q.suffix_number,h,q.cmp_op,m,v,T,y].$join():i},-1)},Opal.modules["bcdice/command/parser"]=function(r){var f,q,l,s,d,g,_,p,b,Z,c,X,ue,u,$,n,le,T,y,B,G=r.top,i=[],t=r.$r(i),e=r.nil,k=r.$$$,N=r.klass,H=r.module,a=r.hash2,U=r.send2,A=r.find_super,x=r.def,R=r.send,F=r.to_a,L=r.rb_minus,j=r.eqeq,Q=r.hash,ie=r.const_set,M=r.truthy,K=r.to_ary;return G.$require("racc/parser.rb"),G.$require("bcdice/arithmetic/node"),G.$require("bcdice/command/lexer"),G.$require("bcdice/command/parsed"),N(k(t("BCDice"),"Command"),k(t("Racc"),"Parser"),"Parser"),f=i,q=B=[H(i[0],"BCDice")].concat(f),T=[H(B[0],"Command")].concat(q),y=r.$r(T),l=T,$=[u=N(T[0],k(y("Racc"),"Parser"),"Parser")].concat(l),n=r.$r($),(le=u.$$prototype).notations=le.lexer=le.modifier=le.suffix_number=le.prefix_number=le.need_suffix_number=le.need_prefix_number=le.critical=le.fumble=le.dollar=le.allowed_cmp_op=le.question_target=e,x(u,"$initialize",function te(z,J){var P,D,se,re,V=this;if(delete te.$$p,P=r.slice.call(arguments),null==(D=r.extract_kwargs(P)))D=a([],{});else if(!D.$$is_hash)throw r.ArgumentError.$new("expected kwargs");if(se=P,!r.hasOwnProperty.call(D.$$smap,"round_type"))throw r.ArgumentError.$new("missing keyword: round_type");return re=D.$$smap.round_type,U(V,A(V,"initialize",te,!1,!0),"initialize",[],null),V.notations=se,V.round_type=re,V.prefix_number=!1,V.suffix_number=!1,V.need_prefix_number=!1,V.need_suffix_number=!1,V.modifier=!0,V.critical=!1,V.fumble=!1,V.dollar=!1,V.allowed_cmp_op=[e,">=",">","<=","<","==","!="],V.question_target=!1},-2),x(u,"$disable_modifier",function(){return this.modifier=!1,this},0),x(u,"$enable_prefix_number",function(){return this.prefix_number=!0,this},0),x(u,"$enable_suffix_number",function(){return this.suffix_number=!0,this},0),x(u,"$has_prefix_number",function(){var z=this;return z.prefix_number=!0,z.need_prefix_number=!0,z},0),x(u,"$has_suffix_number",function(){var z=this;return z.suffix_number=!0,z.need_suffix_number=!0,z},0),x(u,"$enable_critical",function(){return this.critical=!0,this},0),x(u,"$enable_fumble",function(){return this.fumble=!0,this},0),x(u,"$enable_dollar",function(){return this.dollar=!0,this},0),x(u,"$restrict_cmp_op_to",function(z){var J,D=this;return J=r.slice.call(arguments),D.allowed_cmp_op=J,D},-1),x(u,"$enable_question_target",function(){return this.question_target=!0,this},0),x(u,"$parse",function(z){var J=this;try{return J.lexer=n("Lexer").$new(z,J.notations),J.$do_parse()}catch(P){if(!r.rescue(P,[n("ParseError"),n("ZeroDivisionError")]))throw P;try{return e}finally{r.pop_exception()}}},1),u.$private(),x(u,"$parsed",function(z,J,P,D){return R(n("Parsed").$new(),"tap",[],function re(I){var V,S,w,ne,_e,O,ee=null==re.$$s?this:re.$$s,W=e;return null==ee.round_type&&(ee.round_type=e),null==I&&(I=e),W=[z["$[]"]("command")],R(I,"command=",F(W)),L(W.length,1),W=[(V=z["$[]"]("prefix"),V===e||null==V?e:R(V,"eval",[ee.round_type]))],R(I,"prefix_number=",F(W)),L(W.length,1),W=[(S=z["$[]"]("suffix"),S===e||null==S?e:R(S,"eval",[ee.round_type]))],R(I,"suffix_number=",F(W)),L(W.length,1),W=[(w=J["$[]"]("critical"),w===e||null==w?e:R(w,"eval",[ee.round_type]))],R(I,"critical=",F(W)),L(W.length,1),W=[(ne=J["$[]"]("fumble"),ne===e||null==ne?e:R(ne,"eval",[ee.round_type]))],R(I,"fumble=",F(W)),L(W.length,1),W=[(_e=J["$[]"]("dollar"),_e===e||null==_e?e:R(_e,"eval",[ee.round_type]))],R(I,"dollar=",F(W)),L(W.length,1),W=[P.$eval(ee.round_type)],R(I,"modify_number=",F(W)),L(W.length,1),W=[D["$[]"]("cmp_op")],R(I,"cmp_op=",F(W)),L(W.length,1),j(D["$[]"]("target"),"?")?(R(I,"question_target=",F(W=[!0])),L(W.length,1),R(I,"target_number=",F(W=[0])),W[L(W.length,1)]):(R(I,"question_target=",F(W=[!1])),L(W.length,1),W=[(O=D["$[]"]("target"),O===e||null==O?e:R(O,"eval",[ee.round_type]))],R(I,"target_number=",F(W)),W[L(W.length,1)])},{$$arity:1,$$s:this})},4),x(u,"$next_token",function(){return this.lexer.$next_token()},0),s=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,33,34,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,e,e,17,18,6,e,5,e,e,17,18,e,e,5,23,24,25,26,56,54,55,57],d=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,e,17,15,15,18,18,23,e,18,30,30,23,23,24,e,23,31,31,24,24,25,e,24,44,44,25,25,28,e,25,47,47,28,28,29,e,28,48,48,29,29,33,e,29,49,49,33,33,34,e,33,50,50,34,34,36,e,34,e,e,36,36,37,e,36,e,e,37,37,e,e,37,27,27,27,27,52,52,52,52],g=[-2,4,16,-3,-1,11,e,33,13,35,23,30,1,e,28,40,e,37,44,e,e,-2,e,51,58,65,0,106,72,79,47,54,e,86,93,e,100,107,e,e,e,e,e,e,63,e,e,68,75,82,89,e,120,e,e,e,e,e],_=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],p=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,e,e,21,47,48,40,51,52,49,50,44,46,3,e,e,e,13,e,e,e,e,e,e,e,32],b=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,e,e,4,8,8,5,7,7,8,8,9,5,6,e,e,e,6,e,e,e,e,e,e,e,6],Z=[e,6,13,3,9,-1,27,-15,-10,-1,-38],c=[e,e,e,e,e,e,19,16,15,e,e],X=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],ue=Q(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),ie($[0],"Racc_arg",[s,d,_,g,p,b,c,Z,19,X,ue,58,35,!0]),ie($[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),ie($[0],"Racc_debug_parser",!1),x(u,"$_reduce_1",function(z,J,P){var D;return M(this.modifier)||this.$raise(n("ParseError")),D=K(z),this.$parsed(null==D[0]?e:D[0],null==D[1]?e:D[1],null==D[2]?e:D[2],null==D[3]?e:D[3])},3),x(u,"$_reduce_2",function(z,J,P){var D;return M(this.modifier)||this.$raise(n("ParseError")),D=K(z),this.$parsed(null==D[0]?e:D[0],null==D[2]?e:D[2],null==D[1]?e:D[1],null==D[3]?e:D[3])},3),x(u,"$_reduce_3",function(z,J,P){var D,S;return S=null==(D=K(z))[2]?e:D[2],this.$parsed(null==D[0]?e:D[0],null==D[1]?e:D[1],k(k(n("Arithmetic"),"Node"),"Number").$new(0),S)},3),x(u,"$_reduce_4",function(z,J,P){var D=this;return M(D.prefix_number)&&M(D.suffix_number)||D.$raise(n("ParseError")),a(["command","prefix","suffix"],{command:z["$[]"](1),prefix:z["$[]"](0),suffix:z["$[]"](2)})},3),x(u,"$_reduce_5",function(z,J,P){var D=this;return M(D.prefix_number)||D.$raise(n("ParseError")),M(D.need_suffix_number)&&D.$raise(n("ParseError")),a(["command","prefix"],{command:z["$[]"](1),prefix:z["$[]"](0)})},3),x(u,"$_reduce_6",function(z,J,P){var D=this;return M(D.suffix_number)||D.$raise(n("ParseError")),M(D.need_prefix_number)&&D.$raise(n("ParseError")),a(["command","suffix"],{command:z["$[]"](0),suffix:z["$[]"](1)})},3),x(u,"$_reduce_7",function(z,J,P){var D=this;return(M(D.need_prefix_number)||M(D.need_suffix_number))&&D.$raise(n("ParseError")),a(["command"],{command:z["$[]"](0)})},3),x(u,"$_reduce_8",function(z,J,P){return a([],{})},3),x(u,"$_reduce_9",function(z,J,P){var D,S,w,I=e;return I=null==(D=K(z))[0]?e:D[0],S=null==D[2]?e:D[2],M(this.critical)&&M(I["$[]"]("critical")["$nil?"]())||this.$raise(n("ParseError")),R(I,"[]=",F(w=["critical",S])),L(w.length,1),I},3),x(u,"$_reduce_10",function(z,J,P){var D,S,w,I=e;return I=null==(D=K(z))[0]?e:D[0],S=null==D[2]?e:D[2],M(this.fumble)&&M(I["$[]"]("fumble")["$nil?"]())||this.$raise(n("ParseError")),R(I,"[]=",F(w=["fumble",S])),L(w.length,1),I},3),x(u,"$_reduce_11",function(z,J,P){var D,S,w,I=e;return I=null==(D=K(z))[0]?e:D[0],S=null==D[2]?e:D[2],M(this.dollar)&&M(I["$[]"]("dollar")["$nil?"]())||this.$raise(n("ParseError")),R(I,"[]=",F(w=["dollar",S])),L(w.length,1),I},3),x(u,"$_reduce_12",function(z,J,P){return z["$[]"](1)},3),x(u,"$_reduce_13",function(z,J,P){return k(k(n("Arithmetic"),"Node"),"Negative").$new(z["$[]"](1))},3),x(u,"$_reduce_14",function(z,J,P){return k(k(n("Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"+",z["$[]"](2))},3),x(u,"$_reduce_15",function(z,J,P){return k(k(n("Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"-",z["$[]"](2))},3),x(u,"$_reduce_16",function(z,J,P){return M(this.allowed_cmp_op["$include?"](e))||this.$raise(n("ParseError")),a([],{})},3),x(u,"$_reduce_17",function(z,J,P){var D,I,V;return V=null==(D=K(z))[1]?e:D[1],M(this.allowed_cmp_op["$include?"](I=null==D[0]?e:D[0]))||this.$raise(n("ParseError")),a(["cmp_op","target"],{cmp_op:I,target:V})},3),x(u,"$_reduce_18",function(z,J,P){var se,D=this;return se=z["$[]"](0),M(D.question_target)||D.$raise(n("ParseError")),M(D.allowed_cmp_op["$include?"](se))||D.$raise(n("ParseError")),a(["cmp_op","target"],{cmp_op:se,target:"?"})},3),x(u,"$_reduce_19",function(z,J,P){return k(k(n("Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"+",z["$[]"](2))},3),x(u,"$_reduce_20",function(z,J,P){return k(k(n("Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"-",z["$[]"](2))},3),x(u,"$_reduce_22",function(z,J,P){return k(k(n("Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"*",z["$[]"](2))},3),x(u,"$_reduce_23",function(z,J,P){return z["$[]"](3).$new(z["$[]"](0),z["$[]"](2))},3),x(u,"$_reduce_25",function(z,J,P){return k(k(n("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),x(u,"$_reduce_26",function(z,J,P){return k(k(n("Arithmetic"),"Node"),"DivideWithCeil")},3),x(u,"$_reduce_27",function(z,J,P){return k(k(n("Arithmetic"),"Node"),"DivideWithCeil")},3),x(u,"$_reduce_28",function(z,J,P){return k(k(n("Arithmetic"),"Node"),"DivideWithRound")},3),x(u,"$_reduce_29",function(z,J,P){return k(k(n("Arithmetic"),"Node"),"DivideWithFloor")},3),x(u,"$_reduce_30",function(z,J,P){return z["$[]"](1)},3),x(u,"$_reduce_31",function(z,J,P){return k(k(n("Arithmetic"),"Node"),"Negative").$new(z["$[]"](1))},3),x(u,"$_reduce_33",function(z,J,P){return z["$[]"](1)},3),x(u,"$_reduce_34",function(z,J,P){return k(k(n("Arithmetic"),"Node"),"Number").$new(z["$[]"](0))},3),x(u,"$_reduce_none",function(z,J,P){return z["$[]"](0)},3)},Opal.modules["bcdice/deprecated/checker"]=function(r){var U,F,ie,M,K,o,j,x,G=[],i=r.nil,t=r.module,e=r.send,k=r.eqeqeq,N=r.truthy,H=r.def;return U=G,F=x=[t(G[0],"BCDice")].concat(U),ie=j=[t(x[0],"Deprecated")].concat(F),K=[M=t(j[0],"Checker")].concat(ie),o=r.$r(K),M.$private(),H(M,"$check_result_legacy",function(C,B,Y,q){var h,v=this,T=i,y=i,m=i,l=i;return T=e(B,"map",[],"sides".$to_proc()),h=(y=e(B,"map",[],"value".$to_proc())).$sum(),m=k([100],l=T)?v.$check_1D100(C,h,Y,q):k([20],l)?v.$check_1D20(C,h,Y,q):k([6,6],l)?v.$check_2D6(C,h,y,Y,q):i,(N(m["$nil?"]())||N(m["$empty?"]()))&&(m=k([10],l=T.$uniq())?v.$check_nD10(C,h,y,Y,q):k([6],l)?v.$check_nD6(C,h,y,Y,q):i,N(m["$nil?"]())||N(m["$empty?"]()))?i:o("Result").$new(m.$delete_prefix(" \uff1e "))},4),H(M,"$check_1D100",function(C,B,Y,q){return i},4),H(M,"$check_1D20",function(C,B,Y,q){return i},4),H(M,"$check_nD10",function(C,B,Y,q,v){return i},5),H(M,"$check_2D6",function(C,B,Y,q,v){return i},5),H(M,"$check_nD6",function(C,B,Y,q,v){return i},5)},Opal.modules["bcdice/base"]=function(r){var B,y,$,s,d,h,m,l,u,q,G=r.top,i=[],t=r.$r(i),e=r.nil,k=r.$$$,N=r.module,H=r.klass,a=r.truthy,U=r.def,A=r.regexp,x=r.rb_plus,R=r.send,F=r.to_a,L=r.rb_minus,j=r.eqeqeq,Q=r.eqeq,ie=r.range,M=r.rb_divide,K=r.rb_times,o=r.rb_ge,f=e;return G.$require("i18n"),G.$require("i18n/backend/fallbacks"),G.$require("bcdice/randomizer"),G.$require("bcdice/dice_table"),G.$require("bcdice/enum"),G.$require("bcdice/translate"),G.$require("bcdice/result"),G.$require("bcdice/command/parser"),G.$require("bcdice/deprecated/checker"),B=i,y=q=[N(i[0],"BCDice")].concat(B),m=[h=H(q[0],null,"Base")].concat(y),l=r.$r(m),(u=h.$$prototype).sort_add_dice=u.sort_barabara_dice=u.enabled_d9=u.raw_input=u.randomizer=u.enabled_upcase_input=u.debug=e,s=[$=r.get_singleton_class(h)].concat(m),d=r.$r(s),$.$attr_reader("prefixes"),U($,"$register_prefix",function(_){var b,Z=this,c=e;return null==Z.prefixes&&(Z.prefixes=e),b=r.slice.call(arguments),Z.prefixes=a(c=Z.prefixes)?c:[],Z.prefixes.$concat(b.$flatten())},-1),U($,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())},0),U($,"$prefixes_pattern",function(){var _=this,p=e;return null==_.prefixes_pattern&&(_.prefixes_pattern=e),null==_.prefixes&&(_.prefixes=e),_.prefixes_pattern=a(p=_.prefixes_pattern)?p:e,a(_.prefixes_pattern)?_.prefixes_pattern:(_.prefixes=a(p=_.prefixes)?p:[],_.prefixes.$freeze(),_.prefixes_pattern=(a(_.prefixes["$empty?"]())?/(?!)/:A(["^(S)?(",_.prefixes.$join("|"),")"],"i")).$freeze())},0),U($,"$command_pattern",function(){var _=this,p=e,b=e;return null==_.command_pattern&&(_.command_pattern=e),null==_.prefixes&&(_.prefixes=e),_.command_pattern=a(p=_.command_pattern)?p:e,a(_.command_pattern)?_.command_pattern:(_.prefixes=a(p=_.prefixes)?p:[],_.prefixes.$freeze(),b=x(R(k(d("CommonCommand"),"COMMANDS"),"map",[],function(c){return null==c&&(c=e),k(c,"PREFIX_PATTERN").$source()},1),_.prefixes),_.command_pattern=A(["^S?(",b.$join("|"),")"],"i").$freeze())},0),U($,"$eval",function(_){return this.$new(_).$eval()},1),h.$include(l("Translate")),h.$include(k(l("Deprecated"),"Checker")),U(h,"$initialize",function(n){var s=this;return s.raw_input=n,s.sort_add_dice=!1,s.sort_barabara_dice=!1,s.d66_sort_type=k(l("D66SortType"),"NO_SORT"),s.enabled_d9=!1,s.round_type=k(l("RoundType"),"FLOOR"),s.sides_implicit_d=6,s.upper_dice_reroll_threshold=e,s.reroll_dice_reroll_threshold=e,s.default_cmp_op=e,s.default_target_number=e,s.enabled_upcase_input=!0,s.locale="ja_jp",s.randomizer=k(l("BCDice"),"Randomizer").$new(),s.debug=!1},1),h.$attr_accessor("randomizer"),h.$attr_reader("d66_sort_type"),h.$attr_reader("round_type"),h.$attr_reader("sides_implicit_d"),h.$attr_reader("upper_dice_reroll_threshold"),h.$attr_reader("reroll_dice_reroll_threshold"),h.$attr_reader("default_cmp_op"),h.$attr_reader("default_target_number"),U(h,"$sort_add_dice?",function(){return this.sort_add_dice},0),U(h,"$sort_barabara_dice?",function(){return this.sort_barabara_dice},0),U(h,"$enabled_d9?",function(){return this.enabled_d9},0),U(h,"$enable_debug",function(){return this.debug=!0},0),U(h,"$eval",function(){var s,d,g,n=this,_=e;return s=k(l("BCDice"),"Preprocessor").$process(n.raw_input,n),d=a(g=n.$dice_command(s))?g:n.$eval_common_command(n.raw_input),a(d)?(_=[n.randomizer.$rand_results()],R(d,"rands=",F(_)),L(_.length,1),_=[n.randomizer.$detailed_rand_results()],R(d,"detailed_rands=",F(_)),L(_.length,1),d):e},0),U(h,"$change_text",function(n){return n},1),U(h,"$check_result",function(n,s,d,g){var _=this,p=e,b=e,Z=e,c=e,X=e;return p=_.$check_result_legacy(n,s,d,g),a(p)?p:(b=R(s,"map",[],"sides".$to_proc()),c=(Z=R(s,"map",[],"value".$to_proc())).$sum(),p=j([100],X=b)?_.$result_1d100(n,c,d,g):j([20],X)?_.$result_1d20(n,c,d,g):j([6,6],X)?_.$result_2d6(n,c,Z,d,g):e,Q(p,l("Result").$nothing())?e:a(p)?p:(p=j([10],X=b.$uniq())?_.$result_nd10(n,c,Z,d,g):j([6],X)?_.$result_nd6(n,c,Z,d,g):e,Q(p,l("Result").$nothing())?e:a(p)?p:_.$result_ndx(n,d,g)))},4),U(h,"$grich_text",function(n,s,d){return e},3),h.$private(),U(h,"$eval_common_command",function(n){try{return n=this.$change_text(n),R(k(l("CommonCommand"),"COMMANDS"),"each",[],function d(g){var p,_=null==d.$$s?this:d.$$s;if(null==_.randomizer&&(_.randomizer=e),null==g&&(g=e),p=g.$eval(n,_,_.randomizer),!a(p))return e;r.ret(p)},{$$arity:1,$$s:this}),e}catch(d){if(d===r.returner)return d.$v;throw d}},1),U(h,"$dice_command",function(n){var s=this,d=e,g=e,_=e,p=e,b=e;return a(s.enabled_upcase_input)&&(n=n.$upcase()),d=s.$class().$prefixes_pattern().$match(n),a(d)?(g=d["$[]"](1)["$nil?"]()["$!"](),a(g)&&(n=n["$[]"](ie(1,-1,!1))),_=s.$eval_game_system_specific_command(n),a(_["$is_a?"](l("Result")))?(p=[a(b=_["$secret?"]())?b:g],R(_,"secret=",F(p)),L(p.length,1),_):a(_["$nil?"]())||a(_["$empty?"]())||Q(_,"1")?e:R(l("Result").$new(),"tap",[],function(c){return null==c&&(c=e),p=[_.$to_s()],R(c,"text=",F(p)),L(p.length,1),R(c,"secret=",F(p=[g])),p[L(p.length,1)]},1)):e},1),U(h,"$eval_game_system_specific_command",function(n){return e},1),U(h,"$result_ndx",function(n,s,d){return a(d["$is_a?"](l("String")))?e:a(n.$send(s,d))?l("Result").$success(this.$translate("success")):l("Result").$failure(this.$translate("failure"))},3),U(h,"$result_1d100",function(n,s,d,g){return e},4),U(h,"$result_1d20",function(n,s,d,g){return e},4),U(h,"$result_nd10",function(n,s,d,g,_){return e},5),U(h,"$result_2d6",function(n,s,d,g,_){return e},5),U(h,"$result_nd6",function(n,s,d,g,_){return e},5),U(h,"$get_table_by_2d6",function(n){return this.$get_table_by_nD6(n,2)},1),U(h,"$get_table_by_1d6",function(n){return this.$get_table_by_nD6(n,1)},1),U(h,"$get_table_by_nD6",function(n,s){return this.$get_table_by_nDx(n,s,6)},2),U(h,"$get_table_by_nDx",function(n,s,d){var _,p=e;return _=this.randomizer.$roll_sum(s,d),p=this.$get_table_value(n["$[]"](L(_,s))),a(p["$nil?"]())?["1",0]:[p,_]},3),U(h,"$get_table_by_1d3",function(n){var g,_,s=this,p=e;return s.$debug("get_table_by_1d3"),g=s.randomizer.$roll_sum(1,6),s.$debug("num",g),_=M(L(g,1),2).$to_i(),s.$debug("index",_),p=n["$[]"](_),a(p["$nil?"]())?["1",0]:[p,g]},1),U(h,"$get_table_by_d66_swap",function(n){var d;return d=this.randomizer.$roll_d66(k(l("D66SortType"),"ASC")),[this.$get_table_by_number(d,n),d]},1),U(h,"$get_table_by_d66",function(n){var d,g,_,b,p=e;return d=this.randomizer.$roll_once(6),g=this.randomizer.$roll_once(6),_=x(K(L(d,1),6),L(g,1)),p=n["$[]"](_),b=""+d+g,a(p["$nil?"]())?["1",b]:[p,b]},1),U(h,"$get_table_by_number",function(n,s,d){try{return null==d&&(d="1"),R(s,"each",[],function _(p){var Z,b=null==_.$$s?this:_.$$s;if(null==p&&(p=e),Z=p["$[]"](0),!a(o(Z,n)))return e;r.ret(b.$get_table_value(p["$[]"](1)))},{$$arity:1,$$s:this}),this.$get_table_value(d)}catch(_){if(_===r.returner)return _.$v;throw _}},-3),U(h,"$get_table_value",function(n){return a(n["$is_a?"](l("Proc")))?n.$call():n},1),U(h,"$roll_tables",function(n,s){var g=e;return g=s["$[]"](n),a(g)?g.$roll(this.randomizer).$to_s():e},2),U(h,"$debug",function(n,s){var g,_=this,p=e,b=e;return g=r.slice.call(arguments,1),a(_.debug)?(p=a(n["$is_a?"](l("String")))?n:n.$inspect(),a(g["$empty?"]())?_.$warn(p):(b=R(g,"map",[],function(c){return null==c&&(c=e),a(c["$is_a?"](l("String")))?'"'+c+'"':c.$inspect()},1),_.$warn(p+": "+b.$join(", ")))):e},-2),k(k(t("I18n"),"Backend"),"Simple").$include(k(k(t("I18n"),"Backend"),"Fallbacks")),t("I18n").$load_path()["$<<"](t("Dir")["$[]"](t("File").$join("bcdice","../../i18n/**/*.yml"))),f=["ja_jp"],R(t("I18n"),"default_locale=",F(f)),L(f.length,1),f=[["ja_jp"]],R(t("I18n").$fallbacks(),"defaults=",F(f)),f[L(f.length,1)]},Opal.modules["bcdice/game_system/sword_world/rating_lexer"]=function(r){var R,Q,C,T,y,h,m,Y,M,K,L,i=[],t=r.nil,e=r.module,k=r.klass,N=r.const_set,H=r.hash2,a=r.truthy,U=r.send,A=r.def;return r.top.$require("strscan"),R=i,Q=L=[e(i[0],"BCDice")].concat(R),M=[e(L[0],"GameSystem")].concat(Q),K=r.$r(M),C=M,T=Y=[k(M[0],K("Base"),"SwordWorld")].concat(C),h=[y=k(Y[0],null,"RatingLexer")].concat(T),m=r.$r(h),y.$$prototype.scanner=t,N(h[0],"SYMBOLS",H(["+","-","*","/","(",")","[","]","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),A(y,"$initialize",function($){var n,s,g;return $=a(g=(s=(n=$)===t||null==n?t:U(n,"split",[" ",2]))===t||null==s?t:U(s,"first",[]))?g:"",this.scanner=m("StringScanner").$new($)},1),A(y,"$next_token",function(){var $=this,n=t,s=t,g=t;return a($.scanner["$eos?"]())?[!1,"$"]:a(n=$.scanner.$scan(/\d+/))?["NUMBER",n.$to_i()]:(s=$.scanner.$getch().$upcase(),[a(g=m("SYMBOLS")["$[]"](s))?g:s.$to_sym(),s])},0),A(y,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/game_system/sword_world/rating_parsed"]=function(r){var R,Q,C,T,y,h,m,l,Y,M,K,L,G=[],i=r.nil,t=r.module,e=r.klass,k=r.def,N=r.truthy,H=r.rb_le,a=r.rb_plus,U=r.rb_lt,A=r.neqeq;return R=G,Q=L=[t(G[0],"BCDice")].concat(R),M=[t(L[0],"GameSystem")].concat(Q),K=r.$r(M),C=M,T=Y=[e(M[0],K("Base"),"SwordWorld")].concat(C),h=[y=e(Y[0],null,"RatingParsed")].concat(T),m=r.$r(h),(l=y.$$prototype).modifier_after_half=l.semi_fixed_val=l.kept_modify=l.rate=l.greatest_fortune=l.modifier=i,y.$attr_accessor("rate"),y.$attr_accessor("critical"),y.$attr_accessor("kept_modify"),y.$attr_accessor("first_to"),y.$attr_accessor("first_modify"),y.$attr_accessor("rateup"),y.$attr_accessor("greatest_fortune"),y.$attr_accessor("semi_fixed_val"),y.$attr_accessor("tmp_fixed_val"),y.$attr_accessor("modifier"),y.$attr_accessor("modifier_after_half"),k(y,"$initialize",function($,n){var s=this;return s.rate=$,s.modifier=n,s.critical=13,s.kept_modify=0,s.first_to=0,s.first_modify=0,s.greatest_fortune=!1,s.rateup=0,s.semi_fixed_val=0,s.tmp_fixed_val=0,s.modifier_after_half=i},2),k(y,"$half",function(){return this.modifier_after_half["$nil?"]()["$!"]()},0),k(y,"$min_critical",function(){var $=this;return N(H($.semi_fixed_val,1))?3:a(a($.semi_fixed_val,$.kept_modify),2).$clamp(3,13)},0),k(y,"$infinite_roll?",function(){return U(this.$critical(),this.$min_critical())},0),k(y,"$to_s",function(){var $=this,n=i;return n="KeyNo."+$.rate,N(U($.$critical(),13))&&(n=a(n,"c["+$.$critical()+"]")),A($.$first_modify(),0)&&(n=a(n,"m["+m("Format").$modifier($.$first_modify())+"]")),A($.$first_to(),0)&&(n=a(n,"m["+$.$first_to()+"]")),A($.$rateup(),0)&&(n=a(n,"r["+$.$rateup()+"]")),N($.greatest_fortune)&&(n=a(n,"gf")),A($.$semi_fixed_val(),0)&&(n=a(n,"sf["+$.$semi_fixed_val()+"]")),A($.$tmp_fixed_val(),0)&&(n=a(n,"tf["+$.$tmp_fixed_val()+"]")),A($.$kept_modify(),0)&&(n=a(n,"a["+m("Format").$modifier($.$kept_modify())+"]")),A($.modifier,0)&&(n=a(n,m("Format").$modifier($.modifier))),n},0)},Opal.modules["bcdice/game_system/sword_world/rating_options"]=function(r){var a,R,M,B,o,L,j,A,G=[],t=r.module,e=r.klass,k=r.truthy,N=r.def;return a=G,R=A=[t(G[0],"BCDice")].concat(a),L=[t(A[0],"GameSystem")].concat(R),j=r.$r(L),M=L,o=[e(L[0],j("Base"),"SwordWorld")].concat(M),(B=e(o[0],null,"RatingOptions")).$attr_accessor("critical"),B.$attr_accessor("kept_modify"),B.$attr_accessor("first_to"),B.$attr_accessor("first_modify"),B.$attr_accessor("rateup"),B.$attr_accessor("greatest_fortune"),B.$attr_accessor("semi_fixed_val"),B.$attr_accessor("tmp_fixed_val"),B.$attr_accessor("modifier"),B.$attr_accessor("modifier_after_half"),N(B,"$settable_first_roll_adjust_option?",function(){var v;return k(v=this.$first_modify()["$nil?"]())?this.$first_to()["$nil?"]():v},0),N(B,"$settable_non_2d_roll_option?",function(){var v,T,q=this;return k(v=k(T=q.$greatest_fortune()["$nil?"]())?q.$semi_fixed_val()["$nil?"]():T)?q.$tmp_fixed_val()["$nil?"]():v},0)},Opal.modules["bcdice/game_system/sword_world/rating_parser"]=function(r){var f,q,l,g,Z,c,X,E,$e,ue,ce,fe,le,J,_,p,b,se,$,n,T,y,B,G=r.top,i=[],t=r.nil,e=r.$$$,k=r.module,N=r.klass,H=r.hash2,a=r.send2,U=r.find_super,A=r.def,x=r.send,R=r.truthy,F=r.to_a,L=r.rb_minus,j=r.not,Q=r.hash,ie=r.const_set,M=r.to_ary,K=r.eqeq;return G.$require("racc/parser.rb"),G.$require("bcdice/arithmetic/node"),G.$require("bcdice/enum"),G.$require("bcdice/game_system/sword_world/rating_lexer"),G.$require("bcdice/game_system/sword_world/rating_parsed"),G.$require("bcdice/game_system/sword_world/rating_options"),f=i,q=B=[k(i[0],"BCDice")].concat(f),T=[k(B[0],"GameSystem")].concat(q),y=r.$r(T),l=T,$=[N(T[0],y("Base"),"SwordWorld")].concat(l),n=r.$r($),g=$,p=[_=N($[0],e(n("Racc"),"Parser"),"RatingParser")].concat(g),b=r.$r(p),(se=_.$$prototype).lexer=se.round_type=se.version=t,A(_,"$initialize",function re(I){var V,S;if(delete re.$$p,null==I)I=H([],{});else if(!I.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(V=I.$$smap.version)&&(V="v1_0"),null==(S=I.$$smap.round_type)&&(S=e(b("RoundType"),"CEIL")),a(this,U(this,"initialize",re,!1,!0),"initialize",[],null),this.version=V,this.round_type=S},-1),A(_,"$set_debug",function(){return this.yydebug=!0,this},0),A(_,"$parse",function(I){try{return this.lexer=b("RatingLexer").$new(I),this.$do_parse()}catch(S){if(!r.rescue(S,[b("ParseError"),b("ZeroDivisionError")]))throw S;try{return t}finally{r.pop_exception()}}},1),_.$private(),A(_,"$parsed",function(I,V,S){return x(b("RatingParsed").$new(I,V),"tap",[],function ne(_e){var O,ee,W,ae,me,ve,be,he=null==ne.$$s?this:ne.$$s,oe=t,de=t;return null==he.round_type&&(he.round_type=t),null==_e&&(_e=t),oe=[R((O=S.$kept_modify(),de=O===t||null==O?t:x(O,"eval",[he.round_type])))?de:0],x(_e,"kept_modify=",F(oe)),L(oe.length,1),oe=[R(de=S.$first_to())?de:0],x(_e,"first_to=",F(oe)),L(oe.length,1),oe=[R(de=S.$first_modify())?de:0],x(_e,"first_modify=",F(oe)),L(oe.length,1),oe=[R((ee=S.$rateup(),de=ee===t||null==ee?t:x(ee,"eval",[he.round_type])))?de:0],x(_e,"rateup=",F(oe)),L(oe.length,1),j(S.$greatest_fortune()["$nil?"]())&&(oe=[S.$greatest_fortune()],x(_e,"greatest_fortune=",F(oe)),L(oe.length,1)),oe=[R((W=S.$semi_fixed_val(),de=W===t||null==W?t:x(W,"clamp",[1,6])))?de:0],x(_e,"semi_fixed_val=",F(oe)),L(oe.length,1),oe=[R((ae=S.$tmp_fixed_val(),de=ae===t||null==ae?t:x(ae,"clamp",[1,6])))?de:0],x(_e,"tmp_fixed_val=",F(oe)),L(oe.length,1),oe=[(me=S.$modifier_after_half(),me===t||null==me?t:x(me,"eval",[he.round_type]))],x(_e,"modifier_after_half=",F(oe)),L(oe.length,1),oe=[R((ve=S.$critical(),be=ve===t||null==ve?t:x(ve,"eval",[he.round_type]),de=be===t||null==be?t:x(be,"clamp",[0,13])))?de:R(_e.$half())?13:10],x(_e,"critical=",F(oe)),oe[L(oe.length,1)]},{$$arity:1,$$s:this})},3),A(_,"$next_token",function(){return this.lexer.$next_token()},0),Z=[15,14,16,5,17,18,20,21,57,58,23,24,11,59,12,19,13,15,14,16,4,17,18,20,21,4,30,3,30,11,8,12,19,13,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,9,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,37,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,38,39,32,26,27,26,27,29,46,29,33,34,51,52,53,54],c=[6,6,6,1,6,6,6,6,49,49,10,10,6,49,6,6,6,22,22,22,3,22,22,22,22,0,11,0,12,22,4,22,22,22,11,11,12,12,11,14,12,15,41,41,43,43,19,14,14,15,15,14,20,15,19,19,5,21,19,23,20,20,44,44,20,21,21,23,23,21,24,23,26,45,45,50,50,27,24,24,26,26,24,29,26,27,27,16,55,27,56,29,29,62,62,29,55,55,56,56,55,57,56,58,63,63,17,18,13,57,57,58,58,57,25,58,13,13,33,34,38,39],X=[22,3,t,17,28,56,-4,t,t,t,0,24,26,106,37,39,80,99,100,44,50,55,13,57,68,97,70,75,t,81,t,t,t,116,117,t,t,t,118,119,t,30,t,32,50,61,t,t,t,-2,63,t,t,t,t,86,88,99,101,t,t,t,81,92],E=[-33,-33,-4,-33,-33,-33,-1,-4,-3,64,-5,-33,-33,-33,-11,-33,-33,-33,-33,-33,-33,-33,-2,-33,-33,-33,-33,-33,-30,-33,-32,-7,-8,-33,-33,-12,-13,-14,-33,-33,-17,-18,-27,-19,-20,-21,-6,-28,-29,-33,-24,-9,-10,-15,-16,-33,-33,-33,-33,-31,-25,-26,-22,-23],$e=[25,31,6,35,36,1,49,22,40,41,43,2,44,45,7,47,48,t,50,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,60,61,62,63],ue=[5,5,3,5,5,1,7,3,5,6,6,2,6,6,2,5,5,t,6,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,5,5,6,6],ce=[t,5,11,0,t,-11,-11,-23,t],fe=[t,t,t,t,10,42,t,t,28],le=[0,0,"racc_error",2,22,"_reduce_1",3,22,"_reduce_2",2,23,"_reduce_3",0,24,"_reduce_4",2,24,"_reduce_5",4,24,"_reduce_6",3,24,"_reduce_7",3,24,"_reduce_8",4,24,"_reduce_9",4,24,"_reduce_10",2,24,"_reduce_11",3,24,"_reduce_12",3,24,"_reduce_13",3,24,"_reduce_14",4,24,"_reduce_15",4,24,"_reduce_16",3,24,"_reduce_17",2,25,"_reduce_18",2,25,"_reduce_19",3,25,"_reduce_20",3,25,"_reduce_21",3,28,"_reduce_22",3,28,"_reduce_23",1,28,"_reduce_none",3,27,"_reduce_25",3,27,"_reduce_26",1,27,"_reduce_none",2,26,"_reduce_28",2,26,"_reduce_29",1,26,"_reduce_none",3,29,"_reduce_31",1,29,"_reduce_32"],J=Q(!1,0,"error",1,"NUMBER",2,"K",3,"R",4,"H",5,"G",6,"F",7,"S",8,"T",9,"PLUS",10,"MINUS",11,"ASTERISK",12,"SLASH",13,"PARENL",14,"PARENR",15,"BRACKETL",16,"BRACKETR",17,"AT",18,"SHARP",19,"DOLLAR",20),ie(p[0],"Racc_arg",[Z,c,E,X,$e,ue,fe,ce,21,le,J,64,33,!0]),ie(p[0],"Racc_token_to_s_table",["$end","error","NUMBER","K","R","H","G","F","S","T","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","AT","SHARP","DOLLAR","$start","expr","rate","option","modifier","unary","mul","add","term"]),ie(p[0],"Racc_debug_parser",!1),A(_,"$_reduce_1",function(I,V,S){var w,O,ae,ee=t,W=t;return O=null==(w=M(I))[0]?t:w[0],W=R(ae=(ee=null==w[1]?t:w[1]).$modifier())?ae:e(e(b("Arithmetic"),"Node"),"Number").$new(0),this.$parsed(O,W.$eval(this.round_type),ee)},3),A(_,"$_reduce_2",function(I,V,S){var w,ee,ae,W=t,me=t,ve=t;return ee=null==(w=M(I))[1]?t:w[1],R((W=null==w[2]?t:w[2]).$modifier_after_half())||(me=[e(e(b("Arithmetic"),"Node"),"Number").$new(0)],x(W,"modifier_after_half=",F(me)),L(me.length,1)),ve=R(ae=W.$modifier())?ae:e(e(b("Arithmetic"),"Node"),"Number").$new(0),this.$parsed(ee,ve.$eval(this.round_type),W)},3),A(_,"$_reduce_3",function(I,V,S){return I["$[]"](1).$to_i()},3),A(_,"$_reduce_4",function(I,V,S){return b("RatingOptions").$new()},3),A(_,"$_reduce_5",function(I,V,S){var w,ee,W,O=t;return ee=null==(w=M(I))[1]?t:w[1],R((O=null==w[0]?t:w[0]).$modifier()["$nil?"]())||this.$raise(b("ParseError")),x(O,"modifier=",F(W=[ee])),L(W.length,1),O},3),A(_,"$_reduce_6",function(I,V,S){var w,W,ae,O=t;return W=null==(w=M(I))[2]?t:w[2],R((O=null==w[0]?t:w[0]).$critical()["$nil?"]())||this.$raise(b("ParseError")),x(O,"critical=",F(ae=[W])),L(ae.length,1),O},3),A(_,"$_reduce_7",function(I,V,S){var w,W,ae,O=t;return W=null==(w=M(I))[2]?t:w[2],R((O=null==w[0]?t:w[0]).$critical()["$nil?"]())||this.$raise(b("ParseError")),x(O,"critical=",F(ae=[W])),L(ae.length,1),O},3),A(_,"$_reduce_8",function(I,V,S){var w,ae,O=t,W=t;return W=null==(w=M(I))[2]?t:w[2],R((O=null==w[0]?t:w[0])["$settable_first_roll_adjust_option?"]())||this.$raise(b("ParseError")),ae=[W.$to_i()],x(O,"first_to=",F(ae)),L(ae.length,1),O},3),A(_,"$_reduce_9",function(I,V,S){var w,ae,O=t,W=t;return W=null==(w=M(I))[3]?t:w[3],R((O=null==w[0]?t:w[0])["$settable_first_roll_adjust_option?"]())||this.$raise(b("ParseError")),ae=[W.$to_i()],x(O,"first_modify=",F(ae)),L(ae.length,1),O},3),A(_,"$_reduce_10",function(I,V,S){var w,ae,O=t,W=t;return W=null==(w=M(I))[3]?t:w[3],R((O=null==w[0]?t:w[0])["$settable_first_roll_adjust_option?"]())||this.$raise(b("ParseError")),ae=[W.$to_i()["$-@"]()],x(O,"first_modify=",F(ae)),L(ae.length,1),O},3),A(_,"$_reduce_11",function(I,V,S){var w,W,O=t;return w=M(I),R((O=null==w[0]?t:w[0]).$modifier_after_half()["$nil?"]())||this.$raise(b("ParseError")),W=[e(e(b("Arithmetic"),"Node"),"Number").$new(0)],x(O,"modifier_after_half=",F(W)),L(W.length,1),O},3),A(_,"$_reduce_12",function(I,V,S){var w,W,ae,O=t;return W=null==(w=M(I))[2]?t:w[2],R((O=null==w[0]?t:w[0]).$modifier_after_half()["$nil?"]())||this.$raise(b("ParseError")),x(O,"modifier_after_half=",F(ae=[W])),L(ae.length,1),O},3),A(_,"$_reduce_13",function(I,V,S){var w,W,ae,O=t;return O=null==(w=M(I))[0]?t:w[0],W=null==w[2]?t:w[2],R(["v2_5","v2_0"]["$include?"](this.version))&&R(O.$rateup()["$nil?"]())||this.$raise(b("ParseError")),x(O,"rateup=",F(ae=[W])),L(ae.length,1),O},3),A(_,"$_reduce_14",function(I,V,S){var w,W,O=t;return O=null==(w=M(I))[0]?t:w[0],R(["v2_5","v2_0"]["$include?"](this.version))&&R(O["$settable_non_2d_roll_option?"]())||this.$raise(b("ParseError")),x(O,"greatest_fortune=",F(W=[!0])),L(W.length,1),O},3),A(_,"$_reduce_15",function(I,V,S){var w,ae,O=t,W=t;return O=null==(w=M(I))[0]?t:w[0],W=null==w[3]?t:w[3],R(["v2_5","v2_0"]["$include?"](this.version))&&R(O["$settable_non_2d_roll_option?"]())||this.$raise(b("ParseError")),ae=[W.$to_i()],x(O,"semi_fixed_val=",F(ae)),L(ae.length,1),O},3),A(_,"$_reduce_16",function(I,V,S){var w,ae,O=t,W=t;return O=null==(w=M(I))[0]?t:w[0],W=null==w[3]?t:w[3],R(["v2_5","v2_0"]["$include?"](this.version))&&R(O["$settable_non_2d_roll_option?"]())||this.$raise(b("ParseError")),ae=[W.$to_i()],x(O,"tmp_fixed_val=",F(ae)),L(ae.length,1),O},3),A(_,"$_reduce_17",function(I,V,S){var w,W,ae,O=t;return O=null==(w=M(I))[0]?t:w[0],W=null==w[2]?t:w[2],K(this.version,"v2_5")&&R(O.$kept_modify()["$nil?"]())||this.$raise(b("ParseError")),x(O,"kept_modify=",F(ae=[W])),L(ae.length,1),O},3),A(_,"$_reduce_18",function(I,V,S){return I["$[]"](1)},3),A(_,"$_reduce_19",function(I,V,S){return e(e(b("Arithmetic"),"Node"),"Negative").$new(I["$[]"](1))},3),A(_,"$_reduce_20",function(I,V,S){return e(e(b("Arithmetic"),"Node"),"BinaryOp").$new(I["$[]"](0),"+",I["$[]"](2))},3),A(_,"$_reduce_21",function(I,V,S){return e(e(b("Arithmetic"),"Node"),"BinaryOp").$new(I["$[]"](0),"-",I["$[]"](2))},3),A(_,"$_reduce_22",function(I,V,S){return e(e(b("Arithmetic"),"Node"),"BinaryOp").$new(I["$[]"](0),"+",I["$[]"](2))},3),A(_,"$_reduce_23",function(I,V,S){return e(e(b("Arithmetic"),"Node"),"BinaryOp").$new(I["$[]"](0),"-",I["$[]"](2))},3),A(_,"$_reduce_25",function(I,V,S){return e(e(b("Arithmetic"),"Node"),"BinaryOp").$new(I["$[]"](0),"*",I["$[]"](2))},3),A(_,"$_reduce_26",function(I,V,S){return e(e(b("Arithmetic"),"Node"),"DivideWithGameSystemDefault").$new(I["$[]"](0),I["$[]"](2))},3),A(_,"$_reduce_28",function(I,V,S){return I["$[]"](1)},3),A(_,"$_reduce_29",function(I,V,S){return e(e(b("Arithmetic"),"Node"),"Negative").$new(I["$[]"](1))},3),A(_,"$_reduce_31",function(I,V,S){return I["$[]"](1)},3),A(_,"$_reduce_32",function(I,V,S){return e(e(b("Arithmetic"),"Node"),"Number").$new(I["$[]"](0))},3),A(_,"$_reduce_none",function(I,V,S){return I["$[]"](0)},3)},Opal.modules["bcdice/game_system/SwordWorld"]=function(r){var v,m,d,g,_,p,b,u,$,y,G=r.top,i=[],t=r.nil,e=r.module,k=r.klass,N=r.const_set,H=r.send2,a=r.find_super,U=r.def,A=r.truthy,x=r.rb_ge,R=r.rb_le,F=r.eqeq,L=r.neqeq,j=r.rb_minus,Q=r.rb_gt,ie=r.hash2,M=r.send,K=r.to_ary,o=r.rb_plus,f=r.rb_lt,C=r.rb_times,B=r.to_a,Y=r.rb_divide;return G.$require("bcdice/base"),G.$require("bcdice/game_system/sword_world/rating_parser"),v=i,m=y=[e(i[0],"BCDice")].concat(v),u=[e(y[0],"GameSystem")].concat(m),$=r.$r(u),d=u,_=[g=k(u[0],$("Base"),"SwordWorld")].concat(d),p=r.$r(_),(b=g.$$prototype).rating_table=b.randomizer=t,N(_[0],"ID","SwordWorld"),N(_[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG"),N(_[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u3068"),N(_[0],"HELP_MESSAGE","\u30fbSW\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx[c]+m$f) (x:\u30ad\u30fc, c:\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024, m:\u30dc\u30fc\u30ca\u30b9, f:\u51fa\u76ee\u4fee\u6b63)\n"),g.$register_prefix("H?K"),U(g,"$initialize",function Z(c){var E=this;return delete Z.$$p,H(E,a(E,"initialize",Z,!1,!0),"initialize",[c],null),E.rating_table=0},1),U(g,"$result_2d6",function(c,X,E,$e,ue){return A(x(X,12))?p("Result").$critical(this.$translate("SwordWorld.critical")):A(R(X,2))?p("Result").$fumble(this.$translate("SwordWorld.fumble")):L($e,">=")||F(ue,"?")?t:A(x(c,ue))?p("Result").$success(this.$translate("success")):p("Result").$failure(this.$translate("failure"))},5),U(g,"$eval_game_system_specific_command",function(c){return this.$rating(c)},1),g.$private(),U(g,"$rating_parser",function(){return p("RatingParser").$new()},0),U(g,"$rating",function(c){var X,E,$e=this,ue=t,ce=t,fe=t,le=t,te=t,z=t,J=t,P=t,D=t,se=t,re=t,I=t,V=t,S=t,ne=t,_e=t;return $e.$debug("rating string",c),ue=$e.$rating_parser().$parse(c),A(ue)?(ce=$e.$getSW2_0_RatingTable(),fe=j(ce.$length(),1),$e.$debug("keyMax",fe),A(Q(ue.$rate(),fe))?p("Result").$new($e.$translate("SwordWorld.keynumber_exceeds",ie(["keyMax"],{keyMax:fe}))):A(ue["$infinite_roll?"]())?p("Result").$new($e.$translate("SwordWorld.infinite_critical",ie(["min_critical"],{min_critical:ue.$min_critical()}))):(le=$e.$getNewRates(ce),te=ue+" \uff1e ",z=[],J=[],P=[],D=0,se=0,re=0,I=0,V=ue.$first_to(),S=ue.$first_modify(),function(){var O=r.new_brk();try{M($e,"loop",[],function ee(){var W,ae,he,oe,me=null==ee.$$s?this:ee.$$s,ve=t,be=t;if(ae=me.$rollDice(ue,I),be=null==(W=K(ae))[1]?t:W[1],D=ve=null==W[0]?t:W[0],L(V,0)?(D=ve=V,V=0):L(S,0)&&(D=o(D,S),S=0),A(R(ve,2))&&(z["$<<"](ve.$to_s()),J["$<<"](be.$to_s()),P["$<<"]("**"),I=o(I,1),r.brk(t,O)),L(ue.$kept_modify(),0)&&L(D,2)&&(D=o(D,ue.$kept_modify())),A(f(D,2))&&(D=2),A(Q(D,12))&&(D=12),he=[o(ue.$rate(),C(I,ue.$rateup())),fe].$min(),me.$debug("currentKey",he),oe=le["$[]"](D)["$[]"](he),me.$debug("rateValue",oe),re=o(re,oe),se=o(se,D),z["$<<"](D.$to_s()),J["$<<"](be.$to_s()),P["$<<"](A(Q(D,2))?oe:"**"),I=o(I,1),A(x(D,ue.$critical())))return t;r.brk(t,O)},{$$arity:0,$$s:$e,$$brk:O})}catch(ee){if(ee===O)return ee.$v;throw ee}}(),E=$e.$getResultText(re,ue,J,z,P,se,I),X=K(E),ne=null==X[1]?t:X[1],_e=null==X[2]?t:X[2],te=o(te,null==X[0]?t:X[0]),M(p("Result").$new(),"tap",[],function(ee){var W=t;return null==ee&&(ee=t),M(ee,"text=",B(W=[te])),j(W.length,1),M(ee,"critical=",B(W=[ne])),j(W.length,1),M(ee,"fumble=",B(W=[_e])),W[j(W.length,1)]},1))):($e.$debug("not matched"),"1")},1),U(g,"$getSW2_0_RatingTable",function(){return["*,0,0,0,1,2,2,3,3,4,4","*,0,0,0,1,2,3,3,3,4,4","*,0,0,0,1,2,3,4,4,4,4","*,0,0,1,1,2,3,4,4,4,5","*,0,0,1,2,2,3,4,4,5,5","*,0,1,1,2,2,3,4,5,5,5","*,0,1,1,2,3,3,4,5,5,5","*,0,1,1,2,3,4,4,5,5,6","*,0,1,2,2,3,4,4,5,6,6","*,0,1,2,3,3,4,4,5,6,7","*,1,1,2,3,3,4,5,5,6,7","*,1,2,2,3,3,4,5,6,6,7","*,1,2,2,3,4,4,5,6,6,7","*,1,2,3,3,4,4,5,6,7,7","*,1,2,3,4,4,4,5,6,7,8","*,1,2,3,4,4,5,5,6,7,8","*,1,2,3,4,4,5,6,7,7,8","*,1,2,3,4,5,5,6,7,7,8","*,1,2,3,4,5,6,6,7,7,8","*,1,2,3,4,5,6,7,7,8,9","*,1,2,3,4,5,6,7,8,9,10","*,1,2,3,4,6,6,7,8,9,10","*,1,2,3,5,6,6,7,8,9,10","*,2,2,3,5,6,7,7,8,9,10","*,2,3,4,5,6,7,7,8,9,10","*,2,3,4,5,6,7,8,8,9,10","*,2,3,4,5,6,8,8,9,9,10","*,2,3,4,6,6,8,8,9,9,10","*,2,3,4,6,6,8,9,9,10,10","*,2,3,4,6,7,8,9,9,10,10","*,2,4,4,6,7,8,9,10,10,10","*,2,4,5,6,7,8,9,10,10,11","*,3,4,5,6,7,8,10,10,10,11","*,3,4,5,6,8,8,10,10,10,11","*,3,4,5,6,8,9,10,10,11,11","*,3,4,5,7,8,9,10,10,11,12","*,3,5,5,7,8,9,10,11,11,12","*,3,5,6,7,8,9,10,11,12,12","*,3,5,6,7,8,10,10,11,12,13","*,4,5,6,7,8,10,11,11,12,13","*,4,5,6,7,9,10,11,11,12,13","*,4,6,6,7,9,10,11,12,12,13","*,4,6,7,7,9,10,11,12,13,13","*,4,6,7,8,9,10,11,12,13,14","*,4,6,7,8,10,10,11,12,13,14","*,4,6,7,9,10,10,11,12,13,14","*,4,6,7,9,10,10,12,13,13,14","*,4,6,7,9,10,11,12,13,13,15","*,4,6,7,9,10,12,12,13,13,15","*,4,6,7,10,10,12,12,13,14,15","*,4,6,8,10,10,12,12,13,15,15","*,5,7,8,10,10,12,12,13,15,15","*,5,7,8,10,11,12,12,13,15,15","*,5,7,9,10,11,12,12,14,15,15","*,5,7,9,10,11,12,13,14,15,16","*,5,7,10,10,11,12,13,14,16,16","*,5,8,10,10,11,12,13,15,16,16","*,5,8,10,11,11,12,13,15,16,17","*,5,8,10,11,12,12,13,15,16,17","*,5,9,10,11,12,12,14,15,16,17","*,5,9,10,11,12,13,14,15,16,18","*,5,9,10,11,12,13,14,16,17,18","*,5,9,10,11,13,13,14,16,17,18","*,5,9,10,11,13,13,15,17,17,18","*,5,9,10,11,13,14,15,17,17,18","*,5,9,10,12,13,14,15,17,18,18","*,5,9,10,12,13,15,15,17,18,19","*,5,9,10,12,13,15,16,17,19,19","*,5,9,10,12,14,15,16,17,19,19","*,5,9,10,12,14,16,16,17,19,19","*,5,9,10,12,14,16,17,18,19,19","*,5,9,10,13,14,16,17,18,19,20","*,5,9,10,13,15,16,17,18,19,20","*,5,9,10,13,15,16,17,19,20,21","*,6,9,10,13,15,16,18,19,20,21","*,6,9,10,13,16,16,18,19,20,21","*,6,9,10,13,16,17,18,19,20,21","*,6,9,10,13,16,17,18,20,21,22","*,6,9,10,13,16,17,19,20,22,23","*,6,9,10,13,16,18,19,20,22,23","*,6,9,10,13,16,18,20,21,22,23","*,6,9,10,13,17,18,20,21,22,23","*,6,9,10,14,17,18,20,21,22,24","*,6,9,11,14,17,18,20,21,23,24","*,6,9,11,14,17,19,20,21,23,24","*,6,9,11,14,17,19,21,22,23,24","*,7,10,11,14,17,19,21,22,23,25","*,7,10,12,14,17,19,21,22,24,25","*,7,10,12,14,18,19,21,22,24,25","*,7,10,12,15,18,19,21,22,24,26","*,7,10,12,15,18,19,21,23,25,26","*,7,11,13,15,18,19,21,23,25,26","*,7,11,13,15,18,20,21,23,25,27","*,8,11,13,15,18,20,22,23,25,27","*,8,11,13,16,18,20,22,23,25,28","*,8,11,14,16,18,20,22,23,26,28","*,8,11,14,16,19,20,22,23,26,28","*,8,12,14,16,19,20,22,24,26,28","*,8,12,15,16,19,20,22,24,27,28","*,8,12,15,17,19,20,22,24,27,29","*,8,12,15,18,19,20,22,24,27,30"]},0),U(g,"$getNewRates",function(c){var E=t,$e=t,ue=t,ce=t,fe=t,le=t,te=t,z=t,J=t,P=t,D=t,se=t;return E=[],$e=[],ue=[],ce=[],fe=[],le=[],te=[],z=[],J=[],P=[],D=[],M(c,"each",[],function(V){var S=t;return null==V&&(V=t),S=V.$split(/,/),D.$push(0),E.$push(S["$[]"](1).$to_i()),$e.$push(S["$[]"](2).$to_i()),ue.$push(S["$[]"](3).$to_i()),ce.$push(S["$[]"](4).$to_i()),fe.$push(S["$[]"](5).$to_i()),le.$push(S["$[]"](6).$to_i()),te.$push(S["$[]"](7).$to_i()),z.$push(S["$[]"](8).$to_i()),J.$push(S["$[]"](9).$to_i()),P.$push(S["$[]"](10).$to_i())},1),F(this.rating_table,1)&&(se=[31,(se=[32,(se=[33,10],M(P,"[]=",B(se)),se[j(se.length,1)])],M(P,"[]=",B(se)),se[j(se.length,1)])],M(P,"[]=",B(se)),j(se.length,1)),[D,D,D,E,$e,ue,ce,fe,le,te,z,J,P]},1),U(g,"$rollDice",function(c,X){var $e=t;return[($e=this.randomizer.$roll_barabara(2,6)).$sum(),$e.$join(",")]},2),U(g,"$getResultText",function(c,X,E,$e,ue,ce,fe){var le=t,te=t,z=t,J=t,P=t;return(le=[]).$push("2D:["+E.$join(" ")+"]="+$e.$join(",")),A(R(ce,2))?(le.$push(ue.$join(",")),le.$push("\u81ea\u52d5\u7684\u5931\u6557"),[le.$join(" \uff1e "),!1,!0]):(A(Q(ue.$size(),1))||L(X.$modifier(),0)?(te=o(ue.$join(","),p("Format").$modifier(X.$modifier())),A(X.$half())&&(te="("+te+")/2",L(X.$modifier_after_half(),0)&&(te=o(te,p("Format").$modifier(X.$modifier_after_half())))),le.$push(te)):A(X.$half())&&(te=ue.$first()+"/2",L(X.$modifier_after_half(),0)&&(te=o(te,p("Format").$modifier(X.$modifier_after_half()))),le.$push(te)),A(Q(fe,1))&&(z=j(fe,1)+"\u56de\u8ee2",le.$push(z)),J=o(c,X.$modifier()),A(X.$half())&&(J=Y(J,2).$ceil(),L(X.$modifier_after_half(),0)&&(J=o(J,X.$modifier_after_half()))),P=J.$to_s(),le.$push(P),[le.$join(" \uff1e "),Q(fe,1),!1])},7)},Opal.modules["bcdice/game_system/sword_world/transcendent_test"]=function(r){var ie,f,T,u,$,n,s,d,h,B,Y,K,G=r.top,i=[],t=r.nil,e=r.module,k=r.klass,N=r.def,H=r.truthy,a=r.rb_lt,U=r.hash2,A=r.not,x=r.rb_ge,R=r.rb_plus,F=r.send,L=r.to_a,j=r.rb_minus;return G.$require("bcdice/result"),G.$require("bcdice/translate"),ie=i,f=K=[e(i[0],"BCDice")].concat(ie),B=[e(K[0],"GameSystem")].concat(f),Y=r.$r(B),T=B,u=h=[k(B[0],Y("SwordWorld"),"SwordWorld2_0")].concat(T),n=[$=k(h[0],null,"TranscendentTest")].concat(u),s=r.$r(n),(d=$.$$prototype).modifier=d.critical_value=d.expression=d.modifier_str=d.target=d.cmp_op=t,$.$include(s("Translate")),N($,"$initialize",function(_,p,b,Z,c){var X=this;return X.critical_value=_,X.modifier=p,X.cmp_op=b,X.target=Z,X.locale=c,X.modifier_str=s("Format").$modifier(X.modifier),X.expression=X.$node_expression()},5),N($,"$execute",function(_){var X,E,$e,b=this,Z=t,c=t,ue=t,ce=t,fe=t,le=t;if(H(a(b.critical_value,3)))return b.$translate("SwordWorld2_0.transcendent_critical_too_small",U(["expression"],{expression:b.expression}));if(c=[Z=_.$roll_barabara(2,6)],X=Z["$=="]([1,1]),E=Z["$=="]([6,6]),A(X)&&A(E))for(;H(x(b.$sum_of_dice(c.$last()),b.critical_value));)c.$push(_.$roll_barabara(2,6));return $e=b.$sum_of_dice(c),ue=R($e,b.modifier),ce=b.$result_status(ue,c.$length(),X,E),fe=U(["success","failure","super_success","critical","fumble"],{success:b.$translate("success"),failure:b.$translate("failure"),super_success:b.$translate("SwordWorld2_0.super_success"),critical:b.$translate("SwordWorld.critical"),fumble:b.$translate("SwordWorld.fumble")}).$freeze()["$[]"](ce),le=["("+b.expression+")",""+b.$dice_str(c,$e)+b.modifier_str,ue,fe].$compact(),F(s("Result").$new(),"tap",[],function(z){var J=t;return null==z&&(z=t),J=[le.$join(" \uff1e ")],F(z,"text=",L(J)),j(J.length,1),J=[ce["$=="]("fumble")],F(z,"fumble=",L(J)),j(J.length,1),J=[ce["$=="]("critical")],F(z,"critical=",L(J)),j(J.length,1),J=[["success","super_success","critical"]["$include?"](ce)],F(z,"success=",L(J)),j(J.length,1),J=[["failure","fumble"]["$include?"](ce)],F(z,"failure=",L(J)),J[j(J.length,1)]},1)},1),$.$private(),N($,"$node_expression",function(){var p,_=this;return p="2D6@"+_.critical_value+_.modifier_str,H(_.target)?""+p+_.cmp_op+_.target:p},0),N($,"$sum_of_dice",function(_){return _.$flatten().$sum()},1),N($,"$dice_str",function(_,p){return""+p+F(_,"map",[],function(c){return null==c&&(c=t),"["+c.$join(",")+"]"},1).$join()},2),N($,"$result_status",function(_,p,b,Z){var c=this;return H(c.target)?H(b)?"fumble":H(Z)?"critical":H(_.$send(c.cmp_op,c.target))?H(x(p,2))&&H(x(_,41))?"super_success":"success":"failure":"no_target"},4)},Opal.queue(function(r){var f,q,l,u,$,n,s,T,y,B,G=r.top,i=[],t=r.nil,e=r.$$$,k=r.module,N=r.klass,H=r.const_set,a=r.send2,U=r.find_super,A=r.def,x=r.eqeqeq,R=r.truthy,F=r.hash2,L=r.rb_gt,j=r.rb_plus,Q=r.eqeq,ie=r.rb_times,M=r.send,K=r.neqeq;return G.$require("bcdice/arithmetic_evaluator"),G.$require("bcdice/game_system/SwordWorld"),G.$require("bcdice/game_system/sword_world/transcendent_test"),f=i,q=B=[k(i[0],"BCDice")].concat(f),T=[k(B[0],"GameSystem")].concat(q),y=r.$r(T),l=T,$=[u=N(T[0],y("SwordWorld"),"SwordWorld2_0")].concat(l),n=r.$r($),(s=u.$$prototype).locale=s.randomizer=t,H($[0],"ID","SwordWorld2.0"),H($[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.0"),H($[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u30682.0"),H($[0],"HELP_MESSAGE",'\u81ea\u52d5\u7684\u6210\u529f\u3001\u6210\u529f\u3001\u5931\u6557\u3001\u81ea\u52d5\u7684\u5931\u6557\u306e\u81ea\u52d5\u5224\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx)\n\u3000"K\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc+\u30dc\u30fc\u30ca\u30b9"\u306e\u5f62\u3067\u8a18\u5165\u3057\u307e\u3059\u3002\n\u3000\u30dc\u30fc\u30ca\u30b9\u306e\u90e8\u5206\u306b\u300cK20+K30\u300d\u306e\u3088\u3046\u306b\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u53d6\u308b\u3053\u3068\u306f\u51fa\u6765\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001\u30dc\u30fc\u30ca\u30b9\u306f\u8907\u6570\u53d6\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3082\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3068\u540c\u69d8\u306b\u3001\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306b\u96a0\u308c\u3066\u30ed\u30fc\u30eb\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2\n\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u8a2d\u5b9a\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306f"[\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024]"\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u3000\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502410\u3068\u3057\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u51e6\u7406\u304c\u5fc5\u8981\u306a\u3044\u3068\u304d\u306f13\u306a\u3069\u3068\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u9632\u5fa1\u6642\u306a\u3069\u306e\u5bfe\u5fdc)\n\u3000\u307e\u305f\u30bf\u30a4\u30d7\u306e\u8efd\u6e1b\u5316\u306e\u305f\u3081\u306b\u672b\u5c3e\u306b\u300c@\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u300d\u3067\u3082\u51e6\u7406\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u3000\u4f8b\uff09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u534a\u6e1b (HKx, KxH+N)\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u5148\u982d\u307e\u305f\u306f\u672b\u5c3e\u306b"H"\u3092\u3064\u3051\u308b\u3068\u3001\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3092\u632f\u3063\u3066\u6700\u7d42\u7d50\u679c\u3092\u534a\u6e1b\u3055\u305b\u307e\u3059\u3002\n\u3000\u672b\u5c3e\u306b\u3064\u3051\u305f\u5834\u5408\u3001\u76f4\u5f8c\u306b\u4fee\u6b63\u3092\u3092\u3064\u3051\u308b\u3053\u3068\u3067\u3001\u534a\u6e1b\u5f8c\u306e\u52a0\u6e1b\u7b97\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3000\u3053\u306e\u969b\u3001\u8907\u6570\u306e\u9805\u306b\u3088\u308b\u4fee\u6b63\u306b\u306f\u30ab\u30c3\u30b3\u3067\u56f2\u3046\u3053\u3068\u304c\u5fc5\u8981\u3067\u3059\uff08\u30ab\u30c3\u30b3\u304c\u306a\u3044\u3068\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3059\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u306a\u3057\u3068\u6271\u308f\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H(1+1)\n\n\u30fb\u30c0\u30a4\u30b9\u76ee\u306e\u4fee\u6b63\uff08\u904b\u547d\u5909\u8ee2\u3084\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30ec\u30a4\u7528\uff09\n\u3000\u672b\u5c3e\u306b\u300c$\u4fee\u6b63\u5024\u300d\u3067\u30c0\u30a4\u30b9\u76ee\u306b\u4fee\u6b63\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\u3000$\uff0b\uff11\u3068\u4fee\u6b63\u8868\u8a18\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u306b\uff0b\u4fee\u6b63\u3001\uff04\uff19\u306e\u3088\u3046\u306b\u56fa\u5b9a\u5024\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u3092\u305d\u306e\u51fa\u76ee\u306b\u5dee\u3057\u66ff\u3048\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3057\u305f\u5834\u5408\u3067\u3082\u56fa\u5b9a\u5024\u3084\u4fee\u6b63\u5024\u306e\u9069\u7528\u306f\u6700\u521d\u306e\u4e00\u56de\u3060\u3051\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9\n\n\u30fb\u9996\u5207\u308a\u5200\u7528\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u4e0a\u6607 r10\n\u3000\u4f8b\uff09K20r10\u3000K30+24@8R10\u3000K40+24@8$12r10\n\n\u30fb\u30b0\u30ec\u30a4\u30c6\u30b9\u30c8\u30d5\u30a9\u30fc\u30c1\u30e5\u30f3\u306f\u672b\u5c3e\u306b gf\n\u3000\u4f8b\uff09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r10gf\n\n\u30fb\u5a01\u529b\u8868\u30921d+sf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u3082\u7d99\u7d9a sf4\n\u3000\u4f8b\uff09k10sf4\u3000k0+5SF4@13\u3000k70+26sf3@9\n\n\u30fb\u5a01\u529b\u8868\u30921d+tf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u306f2d\u3067\u53c2\u7167 tf3\n\u3000\u4f8b\uff09k10tf3\u3000k0+5TF4@13\u3000k70+26tf3@9\n\n\u30fb\u8d85\u8d8a\u5224\u5b9a\u7528\u306b2d6\u30ed\u30fc\u30eb\u306b 2D6@10 \u66f8\u5f0f\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u4ed8\u4e0e\u304c\u53ef\u80fd\u306b\u3002\n\u3000\u4f8b\uff092D6@10\u30002D6@10+11>=30\n\n\u30fb\u6210\u9577\u3000(Gr)\n\u3000\u672b\u5c3e\u306b\u6570\u5b57\u3092\u4ed8\u52a0\u3059\u308b\u3053\u3068\u3067\u3001\u8907\u6570\u56de\u306e\u6210\u9577\u3092\u307e\u3068\u3081\u3066\u884c\u3048\u307e\u3059\u3002\n\u3000\u4f8b\uff09Gr3\n\n\u30fb\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000(FT)\n\u3000\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u7d61\u307f\u52b9\u679c\u8868\u3000(TT)\n\u3000\u7d61\u307f\u52b9\u679c\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n'),u.$register_prefix("H?K","Gr","2D6?@\\d+","FT","TT"),A(u,"$initialize",function d(g){var p=this;return delete d.$$p,a(p,U(p,"initialize",d,!1,!0),"initialize",[g],null),p.rating_table=2},1),A(u,"$eval_game_system_specific_command",function d(g){var b,p=this,c=t;return delete d.$$p,x(/^Gr(\d+)?/i,b=g)?R(g["$=~"](/^Gr(\d+)/i))?p.$growth(n("Regexp").$last_match(1).$to_i()):p.$growth():x(/^2D6?@\d+/i,b)?(c=e(n("Command"),"Parser").$new(/2D6?/i,F(["round_type"],{round_type:e(e(n("BCDice"),"RoundType"),"CEIL")})).$enable_critical().$restrict_cmp_op_to(t,">=",">").$parse(g),R(c)?n("TranscendentTest").$new(c.$critical(),c.$modify_number(),c.$cmp_op(),c.$target_number(),p.locale).$execute(p.randomizer):t):x("FT",b)?p.$get_fumble_table():x("TT",b)?p.$get_tangle_table():a(p,U(p,"eval_game_system_specific_command",d,!1,!0),"eval_game_system_specific_command",[g],null)},1),A(u,"$rating_parser",function(){return n("RatingParser").$new(F(["version"],{version:"v2_0"}))},0),A(u,"$rollDice",function d(g,_){var b=this,Z=t;return delete d.$$p,R(L(g.$semi_fixed_val(),0))?(Z=b.randomizer.$roll_once(6),[j(Z,g.$semi_fixed_val()),Z+","+g.$semi_fixed_val()]):Q(_,0)&&R(L(g.$tmp_fixed_val(),0))?(Z=b.randomizer.$roll_once(6),[j(Z,g.$tmp_fixed_val()),Z+","+g.$tmp_fixed_val()]):R(g.$greatest_fortune())?(Z=b.randomizer.$roll_once(6),[ie(Z,2),Z+","+Z]):a(b,U(b,"rollDice",d,!1,!0),"rollDice",[g,_],null)},2),A(u,"$growth",function(g){return null==g&&(g=1),M(r.Range.$new(1,g,!1),"map",[],function p(){return(null==p.$$s?this:p.$$s).$growth_step()},{$$arity:0,$$s:this}).$join(" | ")},-1),A(u,"$growth_step",function(){var g=this,_=t,p=t,b=t;return p=(_=e(n("DiceTable"),"Table").$from_i18n("SwordWorld2_0.GrowthTable",g.locale)).$roll(g.randomizer),b=_.$roll(g.randomizer),K(p.$value(),b.$value())?"["+p.$value()+","+b.$value()+"]->("+p.$body()+" or "+b.$body()+")":"["+p.$value()+","+b.$value()+"]->("+p.$body()+")"},0),A(u,"$get_fumble_table",function(){return e(n("DiceTable"),"Table").$from_i18n("SwordWorld2_0.FumbleTable",this.locale).$roll(this.randomizer)},0),A(u,"$get_tangle_table",function(){return e(n("DiceTable"),"Table").$from_i18n("SwordWorld2_0.TangleTable",this.locale).$roll(this.randomizer)},0)})}}]);