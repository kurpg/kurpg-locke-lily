(self.webpackChunkudonarium_lily=self.webpackChunkudonarium_lily||[]).push([[2137],{2137:function(V,X,U){var e,v,h,S,k,_,D,x,s,W,C,l,P;U(4656),Opal.modules["bcdice/normalize"]=function(e){var s,w,x,y,P,v,f=[],W=e.nil,C=e.module;return P=f,s=v=[C(f[0],"BCDice")].concat(P),[y=C(v[0],"Normalize")].concat(s),y.$module_function(),e.def(y,"$comparison_operator",w=function(N){var _;return/<=|=</["$==="](_=N)?"<=":/>=|=>/["$==="](_)?">=":/<>|!=|=!/["$==="](_)?"!=":/</["$==="](_)?"<":/>/["$==="](_)?">":/=/["$==="](_)?"==":W},w.$$arity=1),void e.def(y,"$target_number",x=function(N){return N["$=="]("?")?N:N.$to_i()},x.$$arity=1)},Opal.modules["bcdice/format"]=function(e){var v,h,R,N,w,x,s,W=[],E=e.nil,C=e.$$,l=e.module,P=e.truthy;return v=W,h=s=[l(W[0],"BCDice")].concat(v),w=l(s[0],"Format"),x=[w].concat(h),w.$module_function(),e.def(w,"$comparison_operator",R=function(_){var k;return"=="["$==="](k=_)?"=":"!="["$==="](k)?"<>":C(x,"Symbol")["$==="](k)?_.$to_s():E},R.$$arity=1),void e.def(w,"$modifier",N=function(_){return P(_["$nil?"]())?E:_["$=="](0)?"":P("number"==typeof(p=_)?p>0:p["$>"](0))?"+"+_:_.$to_s();var p},N.$$arity=1)},Opal.modules["bcdice/game_system/NightWizard"]=function(e){function g(y,h){return"number"==typeof y&&"number"==typeof h?y+h:y["$+"](h)}function f(y,h){return"number"==typeof y&&"number"==typeof h?y-h:y["$-"](h)}var h,N,D,k,M,q,T,G,I,K,Y,H,L,z,a,$,o,i,n,r,u,d,b,_,x,W=e.top,E=[],t=e.nil,l=e.$$,P=e.module,p=e.klass,v=e.send2,m=e.truthy,s=e.send;return W.$require("bcdice/normalize"),W.$require("bcdice/format"),h=E,N=x=[P(E[0],"BCDice")].concat(h),D=(_=[P(x[0],"GameSystem")].concat(N))[0],k=l(_,"Base"),M=_,d=p(D,k,"NightWizard"),b=[d].concat(M),d.$$prototype.nw_command=d.$$prototype.randomizer=d.$$prototype.total=d.$$prototype.interim_expr=d.$$prototype.status=d.$$prototype.fumble_numbers=d.$$prototype.critical_numbers=t,e.const_set(b[0],"ID","NightWizard"),e.const_set(b[0],"NAME","\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 2nd Edition"),e.const_set(b[0],"SORT_KEY","\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30682"),e.const_set(b[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\u7528\u30b3\u30de\u30f3\u30c9\u3000(aNW+b@x#y$z+c)\n\u3000\u3000a : \u57fa\u672c\u5024\n\u3000\u3000b : \u5e38\u6642\u306b\u6e96\u3058\u308b\u7279\u6280\u306b\u3088\u308b\u88dc\u6b63\n\u3000\u3000c : \u5e38\u6642\u4ee5\u5916\u306e\u7279\u6280\u3001\u304a\u3088\u3073\u652f\u63f4\u52b9\u679c\u306b\u3088\u308b\u88dc\u6b63\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u3000x : \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 10\uff09\n\u3000\u3000y : \u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 5\uff09\n\u3000\u3000z : \u30d7\u30e9\u30fc\u30ca\u306b\u3088\u308b\u9054\u6210\u5024\u88dc\u6b63\u306e\u30d7\u30e9\u30fc\u30ca\u6d88\u8cbb\u6570\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u304c\u7121\u3044\u5834\u5408\u306f1\u308413\u306a\u3069\u306e\u3042\u308a\u5f97\u306a\u3044\u6570\u5024\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u4f8b\uff0912NW-5@7#2$3 1NW 50nw+5@7,10#2,5 50nw-5+10@7,10#2,5+15+25\n"),d.$register_prefix("([-+]?\\d+)?NW","2R6"),e.def(d,"$initialize",q=function(a){var u=this;return q.$$p&&(q.$$p=null),v(u,e.find_super_dispatcher(u,"initialize",q,!1,!0),"initialize",[a],null),u.nw_command="NW"},q.$$arity=1),e.def(d,"$eval_game_system_specific_command",T=function(a){var $,r,i,u=this,o=t,n=t,j=t,c=t,A=t;return o=m(i=u.$parse_nw(a))?i:u.$parse_2r6(a),m(o)?(r=u.$roll_nw(o),n=null==($=e.to_ary(r))[0]?t:$[0],j=null==$[1]?t:$[1],c=null==$[2]?t:$[2],A=m(o.$cmp_op())?m(n.$send(o.$cmp_op(),o.$target_number()))?"\u6210\u529f":"\u5931\u6557":t,["("+o+")",j,c,n.$to_s(),A].$compact().$join(" \uff1e ")):t},T.$$arity=1),d.$private(),function(z,a,$){var r=p(z,null,"Parsed");[r].concat($),r.$attr_accessor("critical_numbers"),r.$attr_accessor("fumble_numbers"),r.$attr_accessor("prana"),r.$attr_accessor("active_modify_number"),r.$attr_accessor("cmp_op"),r.$attr_accessor("target_number")}(b[0],0,b),z=b[0],a=l(b,"Parsed"),$=b,r=p(z,a,"ParsedNW"),u=[r].concat($),r.$$prototype.base=r.$$prototype.modify_number=r.$$prototype.active_modify_number=r.$$prototype.prana=r.$$prototype.command=r.$$prototype.critical_numbers=r.$$prototype.fumble_numbers=r.$$prototype.cmp_op=r.$$prototype.target_number=t,r.$attr_accessor("base"),r.$attr_accessor("modify_number"),e.def(r,"$initialize",o=function(c){var B=this;return o.$$p&&(o.$$p=null),v(B,e.find_super_dispatcher(B,"initialize",o,!1,!0),"initialize",[],null),B.command=c},o.$$arity=1),e.def(r,"$passive_modify_number",i=function(){return g(this.base,this.modify_number)},i.$$arity=0),e.def(r,"$to_s",n=function(){var A,F,B,J,Q,c=this;return A=m(c.base["$zero?"]())?t:c.base,F=l(u,"Format").$modifier(c.modify_number),B=l(u,"Format").$modifier(c.active_modify_number),J=m(Q=c.prana)?"$"+c.prana:Q,""+A+c.command+F+"@"+c.critical_numbers.$join(",")+"#"+c.fumble_numbers.$join(",")+J+B+c.cmp_op+c.target_number},n.$$arity=0),function(z,a,$){var o,r=p(z,a,"Parsed2R6");[r].concat($),r.$$prototype.passive_modify_number=r.$$prototype.active_modify_number=r.$$prototype.critical_numbers=r.$$prototype.fumble_numbers=r.$$prototype.cmp_op=r.$$prototype.target_number=t,r.$attr_accessor("passive_modify_number"),e.def(r,"$to_s",o=function(){var n=this;return"2R6M["+n.passive_modify_number+","+n.active_modify_number+"]C["+n.critical_numbers.$join(",")+"]F["+n.fumble_numbers.$join(",")+"]"+n.cmp_op+n.target_number},o.$$arity=0)}(b[0],l(b,"Parsed"),b),e.def(d,"$parse_nw",G=function(a){var $,r,o=t,i=t,n=t;return o=e.regexp(["^([-+]?\\d+)?",this.nw_command,"((?:[-+]\\d+)+)?(?:@(\\d+(?:,\\d+)*))?(?:#(\\d+(?:,\\d+)*))?(?:\\$(\\d+(?:,\\d+)*))?((?:[-+]\\d+)+)?(?:([>=]+)(\\d+))?$"]).$match(a),m(o)?(i=l(b,"ParsedNW").$new(this.nw_command),n=[o["$[]"](1).$to_i()],s(i,"base=",e.to_a(n)),f(n.length,1),n=[l(b,"ArithmeticEvaluator").$eval(o["$[]"](2))],s(i,"modify_number=",e.to_a(n)),f(n.length,1),n=[m(o["$[]"](3))?s(o["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]],s(i,"critical_numbers=",e.to_a(n)),f(n.length,1),n=[m(o["$[]"](4))?s(o["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]],s(i,"fumble_numbers=",e.to_a(n)),f(n.length,1),n=[($=o["$[]"](5),$===t||null==$?t:s($,"to_i",[]))],s(i,"prana=",e.to_a(n)),f(n.length,1),n=[l(b,"ArithmeticEvaluator").$eval(o["$[]"](6))],s(i,"active_modify_number=",e.to_a(n)),f(n.length,1),n=[l(b,"Normalize").$comparison_operator(o["$[]"](7))],s(i,"cmp_op=",e.to_a(n)),f(n.length,1),n=[(r=o["$[]"](8),r===t||null==r?t:s(r,"to_i",[]))],s(i,"target_number=",e.to_a(n)),f(n.length,1),i):t},G.$$arity=1),e.def(d,"$parse_2r6",I=function(a){var $,u=t,o=t,i=t;return u=/^2R6m\[([-+]?\d+(?:[-+]\d+)*)(?:,([-+]?\d+(?:[-+]\d+)*))?\](?:c\[(\d+(?:,\d+)*)\])?(?:f\[(\d+(?:,\d+)*)\])?(?:([>=]+)(\d+))?/i.$match(a),m(u)?(o=l(b,"Parsed2R6").$new(),i=[l(b,"ArithmeticEvaluator").$eval(u["$[]"](1))],s(o,"passive_modify_number=",e.to_a(i)),f(i.length,1),i=[l(b,"ArithmeticEvaluator").$eval(u["$[]"](2))],s(o,"active_modify_number=",e.to_a(i)),f(i.length,1),i=[m(u["$[]"](3))?s(u["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]],s(o,"critical_numbers=",e.to_a(i)),f(i.length,1),i=[m(u["$[]"](4))?s(u["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]],s(o,"fumble_numbers=",e.to_a(i)),f(i.length,1),i=[l(b,"Normalize").$comparison_operator(u["$[]"](5))],s(o,"cmp_op=",e.to_a(i)),f(i.length,1),i=[($=u["$[]"](6),$===t||null==$?t:s($,"to_i",[]))],s(o,"target_number=",e.to_a(i)),f(i.length,1),o):t},I.$$arity=1),e.def(d,"$roll_nw",K=function(a){var o,r=this,u=t,i=t,n=t,j=t,c=t;for(r.critical_numbers=a.$critical_numbers(),r.fumble_numbers=a.$fumble_numbers(),r.total=0,r.interim_expr="",r.status=t,u=r.$roll_once_first();u["$=="]("critical");)u=r.$roll_once();return m(m(o=u["$!="]("fumble"))?a.$prana():o)&&(n=(i=r.randomizer.$roll_barabara(a.$prana(),6)).$sum(),j=i.$join(","),r.total=g(r.total,n),r.interim_expr=g(r.interim_expr,"+"+n+"["+j+"]")),c=u["$=="]("fumble")?r.$fumble_base_number(a):g(a.$passive_modify_number(),a.$active_modify_number()),r.total=g(r.total,c),r.interim_expr=g(c.$to_s(),r.interim_expr),[r.total,r.interim_expr,r.status]},K.$$arity=1),e.def(d,"$roll_once",Y=function(a){var u,o,i,$=this,r=t;return null==a&&(a=!1),u=(r=$.randomizer.$roll_barabara(2,6)).$sum(),o=r.$join(","),m(m(i=a)?$.fumble_numbers["$include?"](u):i)?($.total=f($.total,10),$.interim_expr=g($.interim_expr,"-10["+o+"]"),$.status="\u30d5\u30a1\u30f3\u30d6\u30eb","fumble"):m($.critical_numbers["$include?"](u))?($.total=g($.total,10),$.interim_expr=g($.interim_expr,"+10["+o+"]"),$.status="\u30af\u30ea\u30c6\u30a3\u30ab\u30eb","critical"):($.total=g($.total,u),$.interim_expr=g($.interim_expr,"+"+u+"["+o+"]"),t)},Y.$$arity=-1),e.def(d,"$roll_once_first",H=function(){return this.$roll_once(!0)},H.$$arity=0),void e.def(d,"$fumble_base_number",L=function(a){return a.$passive_modify_number()},L.$$arity=1)},W=[],C=(e=Opal).$$,l=e.module,P=e.klass,e.top.$require("bcdice/game_system/NightWizard"),v=W,h=s=[l(W[0],"BCDice")].concat(v),S=x=[l(s[0],"GameSystem")].concat(h),D=[_=P(x[0],C(x,"NightWizard"),"NightWizard3rd")].concat(S),e.const_set(D[0],"NAME","\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 3rd Edition"),e.const_set(D[0],"SORT_KEY","\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30683"),e.const_set(D[0],"ID","NightWizard3rd"),_.$register_prefix("([-+]?\\d+)?NW","2R6"),e.def(_,"$fumble_base_number",k=function(d){return function(p,v){return"number"==typeof p&&"number"==typeof v?p+v:p["$+"](v)}(d.$passive_modify_number(),d.$active_modify_number())},k.$$arity=1)}}]);