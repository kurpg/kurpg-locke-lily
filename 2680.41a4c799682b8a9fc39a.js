(self.webpackChunkudonarium_lily=self.webpackChunkudonarium_lily||[]).push([[2680],{2680:function(Ze,Xe,Je){var e,B,A,U,R,H,l,z,Z,r,g,$,V,u;Je(4656),Opal.modules["i18n/backend/fallbacks"]=function(e){function W(z,i){return"number"==typeof z&&"number"==typeof i?z-i:z["$-"](i)}var i,l,U,R,G,A,K,w=[],r=e.nil,g=e.$$$,$=e.$$,V=e.module,u=e.truthy,q=e.send,B=e.send2,t=e.hash2;return i=w,K=[A=V(w[0],"I18n")].concat(i),e.class_variable_set(K[0],"@@fallbacks",r),l=e.get_singleton_class(A),G=[l].concat(K),e.def(l,"$fallbacks",U=function(){var L,n,f;return e.class_variable_set(G[1],"@@fallbacks",u(f=null==(L=G[1].$$cvars["@@fallbacks"])?r:L)?f:g(g($(G,"I18n"),"Locale"),"Fallbacks").$new()),u(n=$(G,"Thread").$current()["$[]"]("i18n_fallbacks"))?n:null==(L=G[1].$$cvars["@@fallbacks"])?r:L},U.$$arity=0),e.def(l,"$fallbacks=",R=function(L){var E,n;return e.class_variable_set(G[1],"@@fallbacks",u(L["$is_a?"]($(G,"Array")))?g(g($(G,"I18n"),"Locale"),"Fallbacks").$new(L):L),n=["i18n_fallbacks",null==(E=G[1].$$cvars["@@fallbacks"])?r:E],q($(G,"Thread").$current(),"[]=",e.to_a(n)),n[W(n.length,1)]},R.$$arity=1),void function(l,T){var U=[V(l,"Backend")].concat(T);!function(R,H){var f,n,m,c,L=V(R,"Fallbacks"),E=[L].concat(H);e.def(L,"$translate",f=function(k,b,p){try{var y,C=f.$$p,v=this,_=r,o=r,h=r,D=r,I=r,a=r;for(C&&(f.$$p=null),I=0,a=arguments.length,D=new Array(a);I<a;I++)D[I]=arguments[I];return null==p&&(p=$(E,"EMPTY_HASH")),!u(p.$fetch("fallback",!0))||u(p["$[]"]("fallback_in_progress"))?B(v,e.find_super_dispatcher(v,"translate",f,!1,!0),"translate",D,C):(u(p["$[]"]("default"))&&(_=v["$extract_non_symbol_default!"](p)),o=p.$merge(t(["fallback_in_progress"],{fallback_in_progress:!0})),q($(E,"I18n").$fallbacks()["$[]"](k),"each",[],((y=function(Q){var $e,te=null==y.$$s?this:y.$$s;null==Q&&(Q=r);try{return q(te,"catch",["exception"],(($e=function(){var ge=null==$e.$$s?this:$e.$$s,Te=r;if(Te=B(ge,e.find_iter_super_dispatcher(ge,"translate",$e.$$def||y.$$def||f,!1,!1),"translate",[Q,b,o],null),u(Te["$nil?"]()))return r;u(k.$to_s()["$!="](Q.$to_s()))&&ge.$on_fallback(k,Q,b,p),e.ret(Te)}).$$s=te,$e.$$arity=0,$e))}catch(ye){if(!e.rescue(ye,[g($(E,"I18n"),"InvalidLocale")]))throw ye;try{return r}finally{e.pop_exception()}}}).$$s=v,y.$$arity=1,y)),u(u(h=p["$key?"]("default"))?p["$[]"]("default")["$nil?"]():h)?r:u(_)?B(v,e.find_super_dispatcher(v,"translate",f,!1,!0),"translate",[k,r,p.$merge(t(["default"],{default:_}))],null):v.$throw("exception",g($(E,"I18n"),"MissingTranslation").$new(k,b,p)))}catch(S){if(S===e.returner)return S.$v;throw S}},f.$$arity=-3),e.def(L,"$extract_non_symbol_default!",n=function(k){var b,C,y=r,Y=r;return y=[k["$[]"]("default")].$flatten(),C=q(y,"detect",[],((b=function(_){return null==_&&(_=r),_["$is_a?"]($(E,"Symbol"))["$!"]()}).$$s=this,b.$$arity=1,b)),u(C)&&(Y=["default",y["$[]"](0,y.$index(C))],q(k,"[]=",e.to_a(Y)),W(Y.length,1)),C},n.$$arity=1),e.def(L,"$exists?",m=function(k,b,p){try{var y,C=m.$$p,v=this,_=r,o=r,h=r;for(C&&(m.$$p=null),o=0,h=arguments.length,_=new Array(h);o<h;o++)_[o]=arguments[o];return null==p&&(p=$(E,"EMPTY_HASH")),u(p.$fetch("fallback",!0))?(q($(E,"I18n").$fallbacks()["$[]"](k),"each",[],((y=function(I){var a=null==y.$$s?this:y.$$s;null==I&&(I=r);try{if(!u(B(a,e.find_iter_super_dispatcher(a,"exists?",y.$$def||m,!1,!1),"exists?",[I,b],null)))return r;e.ret(!0)}catch(S){if(!e.rescue(S,[g($(E,"I18n"),"InvalidLocale")]))throw S;try{return r}finally{e.pop_exception()}}}).$$s=v,y.$$arity=1,y)),!1):B(v,e.find_super_dispatcher(v,"exists?",m,!1,!0),"exists?",_,C)}catch(D){if(D===e.returner)return D.$v;throw D}},m.$$arity=-3),L.$private(),e.def(L,"$on_fallback",c=function(k,b,p,y){return r},c.$$arity=4)}(U[0],U)}(K[0],K)},Opal.modules["bcdice/randomizer"]=function(e){function W(l,T){return"number"==typeof l&&"number"==typeof T?l>T:l["$>"](T)}function Z(l,T){return"number"==typeof l&&"number"==typeof T?l+T:l["$+"](T)}function w(l,T){return"number"==typeof l&&"number"==typeof T?l<=T:l["$<="](T)}function r(l,T){return"number"==typeof l&&"number"==typeof T?l-T:l["$-"](T)}function g(l,T){return"number"==typeof l&&"number"==typeof T?l*T:l["$*"](T)}var T,L,n,m,c,d,k,b,p,y,C,Y,v,E,f,U,u=[],q=e.nil,B=e.$$$,t=e.$$,i=e.klass,A=e.truthy,K=e.send;return T=u,L=U=[(0,e.module)(u[0],"BCDice")].concat(T),E=i(U[0],null,"Randomizer"),f=[E].concat(L),E.$$prototype.rand_results=E.$$prototype.detailed_rand_results=q,e.const_set(f[0],"UPPER_LIMIT_DICE_TIMES",200),e.const_set(f[0],"UPPER_LIMIT_DICE_SIDES",1e3),e.const_set(f[0],"UPPER_LIMIT_RANDS",1e4),e.def(E,"$initialize",n=function(){return this.rand_results=[],this.detailed_rand_results=[]},n.$$arity=0),E.$attr_reader("rand_results"),E.$attr_reader("detailed_rand_results"),e.const_set(f[0],"DetailedRandResult",t(f,"Struct").$new("kind","sides","value")),e.def(E,"$roll_barabara",m=function(o,h){var D,a,I=this;return A(W(Z(I.rand_results.$size(),o),t(f,"UPPER_LIMIT_RANDS")))&&I.$raise(t(f,"TooManyRandsError")),A(A(a=w(o,0))?a:W(o,t(f,"UPPER_LIMIT_DICE_TIMES")))?[]:K(t(f,"Array"),"new",[o],((D=function(){return(null==D.$$s?this:D.$$s).$roll_once(h)}).$$s=I,D.$$arity=0,D))},m.$$arity=2),e.def(E,"$roll_sum",c=function(o,h){return this.$roll_barabara(o,h).$sum()},c.$$arity=2),e.def(E,"$roll_once",d=function(o){var D,I=q;return A(A(D=w(o,0))?D:W(o,t(f,"UPPER_LIMIT_DICE_SIDES")))?0:(I=this.$rand_inner(o),this.$push_to_detail("normal",o,I),I)},d.$$arity=1),e.def(E,"$roll_index",k=function(o){return r(this.$roll_once(o),1)},k.$$arity=1),e.def(E,"$roll_tens_d10",b=function(){var D,h=q;return(h=this.$rand_inner(10))["$=="](10)&&(h=0),D=g(h,10),this.$push_to_detail("tens_d10",10,D),D},b.$$arity=0),e.def(E,"$roll_d9",p=function(){var h;return h=r(this.$rand_inner(10),1),this.$push_to_detail("d9",10,h),h},p.$$arity=0),e.def(E,"$roll_d66",y=function(o){var h,a,I=q;return I=K(t(f,"Array"),"new",[2],((h=function(){return(null==h.$$s?this:h.$$s).$roll_once(6)}).$$s=this,h.$$arity=0,h)),a=o,B(t(f,"D66SortType"),"ASC")["$==="](a)?I["$sort!"]():B(t(f,"D66SortType"),"DESC")["$==="](a)&&I["$sort!"]()["$reverse!"](),Z(g(I["$[]"](0),10),I["$[]"](1))},y.$$arity=1),E.$private(),e.def(E,"$rand_inner",C=function(o){var D,h=this;return A(function(l,T){return"number"==typeof l&&"number"==typeof T?l>=T:l["$>="](T)}(h.rand_results.$size(),t(f,"UPPER_LIMIT_RANDS")))&&h.$raise(t(f,"TooManyRandsError")),D=h.$random(o),h.rand_results["$<<"]([D,o]),D},C.$$arity=1),e.def(E,"$random",Y=function(o){return Z(t(f,"Kernel").$rand(o),1)},Y.$$arity=1),e.def(E,"$push_to_detail",v=function(o,h,D){var a;return a=t(f,"DetailedRandResult").$new(o,h,D),this.detailed_rand_results.$push(a)},v.$$arity=3),void function(R,H,L){[i(R,H,"TooManyRandsError")].concat(L)}(U[0],t(U,"StandardError"),U)},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var B,A,U,L,E,f,n,R,H,l,z,Z=[],w=e.nil,g=e.$$,$=e.module,V=e.klass,u=e.truthy;return B=Z,A=z=[$(Z[0],"BCDice")].concat(B),U=l=[$(z[0],"DiceTable")].concat(A),R=V(l[0],null,"RollResult"),H=[R].concat(U),R.$$prototype.table_name=R.$$prototype.value=R.$$prototype.body=w,e.def(R,"$initialize",L=function(c,d,k){var b=this;return b.table_name=c,b.value=d,b.body=k},L.$$arity=3),R.$attr_reader("table_name"),R.$attr_reader("value"),R.$attr_reader("body"),e.def(R,"$to_s",E=function(){var c=this;return c.table_name+"("+c.value+") \uff1e "+c.body},E.$$arity=0),e.def(R,"$last_body",f=function(){var c=this;return u(c.body["$is_a?"](g(H,"RollResult")))?c.body.$last_body():c.body},f.$$arity=0),void e.def(R,"$empty?",n=function(){return!1},n.$$arity=0)},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var t,K,R,E,f,H,L,T,i,w=[],r=e.nil,$=e.$$,V=e.module,u=e.klass,q=e.truthy;return t=w,K=i=[V(w[0],"BCDice")].concat(t),R=T=[V(i[0],"DiceTable")].concat(K),H=u(T[0],null,"ChainTable"),L=[H].concat(R),H.$$prototype.times=H.$$prototype.sides=H.$$prototype.items=H.$$prototype.name=r,e.def(H,"$initialize",E=function(m,c,d){var k=this,b=r;return k.name=m,k.items=d.$freeze(),b=/(\d+)D(\d+)/i.$match(c),q(b)||k.$raise($(L,"ArgumentError"),"Unexpected table type: "+c),k.times=b["$[]"](1).$to_i(),k.sides=b["$[]"](2).$to_i()},E.$$arity=3),void e.def(H,"$roll",f=function(m){var d,k,c=this,b=r;return k=function(B,t){return"number"==typeof B&&"number"==typeof t?B-t:B["$-"](t)}(d=m.$roll_sum(c.times,c.sides),c.times),b=c.items["$[]"](k),q(b["$respond_to?"]("roll"))&&(b=b.$roll(m)),$(L,"RollResult").$new(c.name,d,b)},f.$$arity=1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){function w(z,i){return"number"==typeof z&&"number"==typeof i?z-i:z["$-"](i)}var i,T,L,n,m,c,E,f,U,K,g=[],$=e.nil,u=e.$$,q=e.module,B=e.klass,t=e.hash2;return i=g,T=K=[q(g[0],"BCDice")].concat(i),L=U=[q(K[0],"DiceTable")].concat(T),E=B(U[0],null,"D66GridTable"),f=[E].concat(L),E.$$prototype.name=E.$$prototype.items=$,e.defs(E,"$from_i18n",n=function(k,b){var y=$;return y=u(f,"I18n").$t(k,t(["locale","raise"],{locale:b,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items"))},n.$$arity=2),e.def(E,"$initialize",m=function(k,b){return this.name=k,this.items=b.$freeze()},m.$$arity=2),void e.def(E,"$roll",c=function(k){var p,y,C,Y,v;return p=k.$roll_once(6),y=k.$roll_once(6),C=function(z,i){return"number"==typeof z&&"number"==typeof i?z+i:z["$+"](i)}(function(z,i){return"number"==typeof z?10*z:z["$*"](10)}(p),y),Y=w(p,1),v=w(y,1),u(f,"RollResult").$new(this.name,C,this.items["$[]"](Y)["$[]"](v))},c.$$arity=1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var B,A,U,L,E,R,H,l,z,Z=[],w=e.nil,g=e.$$,$=e.module,V=e.klass,u=e.hash2;return e.top.$require("bcdice/dice_table/d66_grid_table"),B=Z,A=z=[$(Z[0],"BCDice")].concat(B),U=l=[$(z[0],"DiceTable")].concat(A),R=V(l[0],g(l,"D66GridTable"),"D66HalfGridTable"),H=[R].concat(U),e.defs(R,"$from_i18n",L=function(n,m){var d=w;return d=g(H,"I18n").$t(n,u(["locale","raise"],{locale:m,raise:!0})),this.$new(d["$[]"]("name"),d["$[]"]("items_1_2_3"),d["$[]"]("items_4_5_6"))},L.$$arity=2),void e.def(R,"$initialize",E=function(n,m,c){return this.name=n,this.items=[m,m,m,c,c,c].$freeze()},E.$$arity=3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var B,A,U,L,E,R,H,l,z,Z=[],w=e.nil,g=e.$$,$=e.module,V=e.klass,u=e.hash2;return e.top.$require("bcdice/dice_table/d66_grid_table"),B=Z,A=z=[$(Z[0],"BCDice")].concat(B),U=l=[$(z[0],"DiceTable")].concat(A),R=V(l[0],g(l,"D66GridTable"),"D66OneThirdTable"),H=[R].concat(U),e.defs(R,"$from_i18n",L=function(n,m){var d=w;return d=g(H,"I18n").$t(n,u(["locale","raise"],{locale:m,raise:!0})),this.$new(d["$[]"]("name"),d["$[]"]("items_1_2"),d["$[]"]("items_3_4"),d["$[]"]("items_5_6"))},L.$$arity=2),void e.def(R,"$initialize",E=function(n,m,c,d){return this.name=n,this.items=[m,m,c,c,d,d].$freeze()},E.$$arity=4)},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var i,T,L,n,m,c,d,E,f,U,K,r=[],g=e.nil,$=e.$$$,V=e.$$,u=e.module,q=e.klass,B=e.hash2,t=e.truthy;return i=r,T=K=[u(r[0],"BCDice")].concat(i),L=U=[u(K[0],"DiceTable")].concat(T),E=q(U[0],null,"D66Table"),f=[E].concat(L),E.$$prototype.sort_type=E.$$prototype.items=E.$$prototype.name=g,e.defs(E,"$from_i18n",n=function(b,p){var Y,C=g;return C=V(f,"I18n").$t(b,B(["locale"],{locale:p})),Y=V(f,"D66SortType").$const_get(C["$[]"]("d66_sort_type")),this.$new(C["$[]"]("name"),Y,C["$[]"]("items"))},n.$$arity=2),e.def(E,"$initialize",m=function(b,p,y){var C=this;return C.name=b,C.sort_type=p,C.items=y.$freeze()},m.$$arity=3),e.def(E,"$roll",c=function(b){var C,_,p=this,y=g,Y=g,v=g;return y=b.$roll_barabara(2,6),C=p.sort_type,$(V(f,"D66SortType"),"ASC")["$==="](C)?y["$sort!"]():$(V(f,"D66SortType"),"DESC")["$==="](C)&&y["$sort!"]()["$reverse!"](),Y=function(z,i){return"number"==typeof z&&"number"==typeof i?z+i:z["$+"](i)}(function(z,i){return"number"==typeof z?10*z:z["$*"](10)}(y["$[]"](0)),y["$[]"](1)),v=t(_=p.items["$[]"](Y))?_:p.items["$[]"](Y.$to_s()),t(v["$respond_to?"]("roll"))&&(v=v.$roll(b)),V(f,"RollResult").$new(p.name,Y,v)},c.$$arity=1),void e.def(E,"$choice",d=function(b){return V(f,"RollResult").$new(this.name,b,this.items["$[]"](b))},d.$$arity=1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){function W(A,K){return"number"==typeof A&&"number"==typeof K?A+K:A["$+"](K)}var K,f,c,n,U,H,T,g=[],$=e.nil,u=e.$$,q=e.module,B=e.klass,t=e.hash2,z=e.send,i=e.send2;return e.top.$require("bcdice/dice_table/d66_table"),K=g,U=T=[q(g[0],"BCDice")].concat(K),f=H=[q(T[0],"DiceTable")].concat(U),[n=B(H[0],u(H,"D66Table"),"D66LeftRangeTable")].concat(f),void e.def(n,"$initialize",c=function(k,b,p){var y,_,v=this;return c.$$p&&(c.$$p=null),_=t([],{}),z(p,"each",[],((y=function(o){function h(D){return o.apply(this,arguments)}return h.toString=function(){return o.toString()},h}(function(o){var D,a,Q,h=null==y.$$s?this:y.$$s;return null==o&&(o=$),D=e.to_ary(o),Q=null==D[1]?$:D[1],z(null==D[0]?$:D[0],"each",[],((a=function($e){var ge;return null==$e&&($e=$),z(Q,"each_with_index",[],((ge=function(Be,ze){var Ae,fe;return null==Be&&(Be=$),null==ze&&(ze=$),Ae=W(function(A,K){return"number"==typeof A?10*A:A["$*"](10)}($e),W(ze,1)),z(_,"[]=",e.to_a(fe=[Ae,Be])),fe[function(A,K){return"number"==typeof A?A-1:A["$-"](1)}(fe.length)]}).$$s=null==a.$$s?this:a.$$s,ge.$$arity=2,ge))}).$$s=h,a.$$arity=1,a))})).$$s=v,y.$$arity=1,y)),i(v,e.find_super_dispatcher(v,"initialize",c,!1,!0),"initialize",[k,b,_],null)},c.$$arity=3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var i,T,L,n,m,E,f,U,K,g=[],$=e.nil,u=e.$$,q=e.module,B=e.klass,t=e.truthy;return i=g,T=K=[q(g[0],"BCDice")].concat(i),L=U=[q(K[0],"DiceTable")].concat(T),E=B(U[0],null,"D66ParityTable"),f=[E].concat(L),E.$$prototype.odd=E.$$prototype.even=E.$$prototype.name=$,e.def(E,"$initialize",n=function(d,k,b){var p=this;return p.name=d,p.odd=k.$freeze(),p.even=b.$freeze()},n.$$arity=3),void e.def(E,"$roll",m=function(d){var p,C,Y,k=this,b=$;return b=d.$roll_once(6),p=d.$roll_once(6),C=(t(b["$odd?"]())?k.odd:k.even)["$[]"](function(z,i){return"number"==typeof z?z-1:z["$-"](1)}(p)),Y=function(z,i){return"number"==typeof z&&"number"==typeof i?z+i:z["$+"](i)}(function(z,i){return"number"==typeof z?10*z:z["$*"](10)}(b),p),u(f,"RollResult").$new(k.name,Y,C)},m.$$arity=1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var z,l,H,f,n,L,E,G,A,r=[],g=e.nil,V=e.$$,u=e.module,q=e.klass,B=e.send;return z=r,l=A=[u(r[0],"BCDice")].concat(z),H=G=[u(A[0],"DiceTable")].concat(l),L=q(G[0],null,"D66RangeTable"),E=[L].concat(H),L.$$prototype.items=L.$$prototype.name=g,e.def(L,"$initialize",f=function(c,d){return this.name=c,this.items=d.$freeze()},f.$$arity=2),void e.def(L,"$roll",n=function(c){var d,b,p,y,t,k=this,C=g;return b=c.$roll_once(6),p=c.$roll_once(6),y=function(t,z){return"number"==typeof t&&"number"==typeof z?t+z:t["$+"](z)}("number"==typeof(t=b)?10*t:t["$*"](10),p),C=B(k.items,"find",[],((d=function(v){return null==v&&(v=g),v["$[]"](0)["$include?"](y)}).$$s=k,d.$$arity=1,d)),V(E,"RollResult").$new(k.name,y,C["$[]"](1))},n.$$arity=1)},Opal.modules["bcdice/dice_table/range_table"]=function(e){var A,G,E,m,c,d,k,b,p,y,C,Y,f,n,R,l,g=[],$=e.nil,u=e.$$,q=e.module,B=e.klass,t=e.send,z=e.truthy;return A=g,G=l=[q(g[0],"BCDice")].concat(A),E=R=[q(l[0],"DiceTable")].concat(G),f=B(R[0],null,"RangeTable"),n=[f].concat(E),f.$$prototype.name=f.$$prototype.items=f.$$prototype.num_of_dice=f.$$prototype.num_of_sides=f.$$prototype.formatter=$,e.const_set(n[0],"RollResult",t(u(n,"Struct"),"new",["sum","values","content","formatted"],((m=function(){return(null==m.$$s?this:m.$$s).$alias_method("to_s","formatted")}).$$s=f,m.$$arity=0,m))),e.const_set(n[0],"Item",u(n,"Struct").$new("range","content")),e.const_set(n[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),e.const_set(n[0],"DEFAULT_FORMATTER",t(f,"lambda",[],($$2=function(v){function _(o,h){return v.apply(this,arguments)}return _.toString=function(){return v.toString()},_}(function(v,_){return null==$$2.$$s||$$2,null==v&&(v=$),null==_&&(_=$),v.$name()+"("+_.$sum()+") \uff1e "+_.$content()}),$$2.$$s=f,$$2.$$arity=2,$$2))),f.$attr_reader("name"),f.$attr_reader("num_of_dice"),f.$attr_reader("num_of_sides"),e.def(f,"$initialize",c=function(_,o,h){var S,D=c.$$p,I=D||$,a=this,Q=$;return D&&(c.$$p=null),D&&(c.$$p=null),a.name=_.$freeze(),a.formatter=z(S=I)?S:u(n,"DEFAULT_FORMATTER"),Q=u(n,"DICE_ROLL_METHOD_RE").$match(o),z(Q)||a.$raise(u(n,"ArgumentError"),a.name+": invalid dice roll method: "+o),a.num_of_dice=Q["$[]"](1).$to_i(),a.num_of_sides=Q["$[]"](2).$to_i(),a.$store(h)},c.$$arity=3),e.def(f,"$fetch",d=function(_){var o,D,h=this;return D=t(h.items,"find",[],((o=function(a){return null==a&&(a=$),a.$range()["$include?"](_)}).$$s=h,o.$$arity=1,o)),z(D)||h.$raise(u(n,"RangeError"),h.name+": value is out of range: "+_),D},d.$$arity=1),e.def(f,"$roll",k=function(_){var D,I,a,i,o=this,h=$;return D=(h=_.$roll_barabara(o.num_of_dice,o.num_of_sides)).$sum(),I=u(n,"RollResult").$new(D,h,o.$fetch(D).$content()),a=[o.formatter["$[]"](o,I)],t(I,"formatted=",e.to_a(a)),"number"==typeof(i=a.length)||i["$-"](1),I},k.$$arity=1),f.$private(),e.def(f,"$store",b=function(_){var o,h,D,a,S,I=this;return a=t(_,"map",[],((o=function(te,$e){return null==te&&(te=$),null==$e&&($e=$),[(null==o.$$s?this:o.$$s).$coerce_to_int_range(te),$e]}).$$s=I,o.$$arity=2,o)),S=t(a,"sort_by",[],((h=function(te,$e){return null==te&&(te=$),null==$e&&($e=$),te.$min()}).$$s=I,h.$$arity=2,h)),I.$assert_min_sum_is_covered(S),I.$assert_max_sum_is_covered(S),I.$assert_no_gap_or_overlap_in_ranges(S),I.items=t(S,"map",[],(D=function(te,$e){return null==te&&(te=$),null==$e&&($e=$),u(n,"Item").$new(te,$e.$freeze()).$freeze()},D.$$s=I,D.$$arity=2,D)).$freeze(),I},b.$$arity=1),e.def(f,"$coerce_to_int_range",p=function(_){var h,D=$;return h=_,u(n,"Integer")["$==="](h)?u(n,"Range").$new(_,_):u(n,"Range")["$==="](h)&&z(z(D=_.$begin()["$is_a?"](u(n,"Integer")))?_.$end()["$is_a?"](u(n,"Integer")):D)?_:this.$raise(u(n,"TypeError"),this.name+": "+_+" ("+_.$class()+") must be an Integer or a Range with Integers ")},p.$$arity=1),e.def(f,"$assert_min_sum_is_covered",y=function(_){var h,o=this,D=$;return h=o.num_of_dice,D=_.$first()["$[]"](0),z(D["$include?"](h))||o.$raise(u(n,"RangeError"),o.name+": min value ("+h+") is not covered: "+D),o},y.$$arity=1),e.def(f,"$assert_max_sum_is_covered",C=function(_){var h,o=this,D=$;return h=function(i,A){return"number"==typeof i&&"number"==typeof A?i*A:i["$*"](A)}(o.num_of_dice,o.num_of_sides),D=_.$last()["$[]"](0),z(D["$include?"](h))||o.$raise(u(n,"RangeError"),o.name+": max value ("+h+") is not covered: "+D),o},C.$$arity=1),void e.def(f,"$assert_no_gap_or_overlap_in_ranges",Y=function(_){var o;return t(_,"each_cons",[2],((o=function(I,a){var $e,ye,i,S=null==o.$$s?this:o.$$s,Q=$,te=$;return null==S.name&&(S.name=$),null==I&&(I=$),null==a&&(a=$),Q=I["$[]"](0),te=a["$[]"](0),ye="number"==typeof(i=$e=Q.$max())?i+1:i["$+"](1),z(te["$include?"]($e))&&S.$raise(u(n,"RangeError"),S.name+": Range overlap: "+Q+" and "+te),z(te["$include?"](ye))?$:S.$raise(u(n,"RangeError"),S.name+": Range gap: "+Q+" and "+te)}).$$s=this,o.$$arity=2,o)),this},Y.$$arity=1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var t,K,R,n,d,k,b,m,c,L,T,i,w=[],r=e.nil,g=e.$$$,$=e.$$,V=e.module,u=e.klass,q=e.send;return t=w,K=i=[V(w[0],"BCDice")].concat(t),R=T=[V(i[0],"DiceTable")].concat(K),n=L=[u(T[0],null,"SaiFicSkillTable")].concat(R),m=u(L[0],null,"Category"),c=[m].concat(n),m.$$prototype.name=r,e.def(m,"$initialize",d=function(y,C,Y,v){var _,o=this;return o.name=y,o.skills=q(C.$map(),"with_index",[2],((_=function(h){function D(I,a){return h.apply(this,arguments)}return D.toString=function(){return h.toString()},D}(function(h,D){return null==h&&(h=r),null==D&&(D=r),g($(c,"SaiFicSkillTable"),"Skill").$new(y,h,Y,D,v)})).$$s=o,_.$$arity=2,_)),o.dice=Y},d.$$arity=4),e.def(m,"$roll",k=function(y){return this.$skills()["$[]"](function(B,t){return"number"==typeof B?B-2:B["$-"](2)}(y.$roll_sum(2,6)))},k.$$arity=1),e.def(m,"$to_s",b=function(){return this.name},b.$$arity=0),void m.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var B,A,f,c,d,n,U,H,l,z,Z=[],w=e.nil,$=e.module,V=e.klass,u=e.hash2;return B=Z,A=z=[$(Z[0],"BCDice")].concat(B),U=l=[$(z[0],"DiceTable")].concat(A),f=H=[V(l[0],null,"SaiFicSkillTable")].concat(U),[n=V(H[0],null,"Skill")].concat(f),n.$$prototype.s_format=n.$$prototype.category_dice=n.$$prototype.row_dice=n.$$prototype.category_name=n.$$prototype.name=w,e.def(n,"$initialize",c=function(b,p,y,C,Y){var v=this;return v.category_name=b,v.name=p,v.category_dice=y,v.row_dice=C,v.s_format=Y},c.$$arity=5),e.def(n,"$to_s",d=function(){var b=this;return b.$format(b.s_format,u(["category_dice","row_dice","category_name","skill_name"],{category_dice:b.category_dice,row_dice:b.row_dice,category_name:b.category_name,skill_name:b.name}))},d.$$arity=0),void n.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var K,U,f,c,d,k,b,p,y,C,n,m,H,T,w=e.top,r=[],g=e.nil,$=e.$$$,V=e.$$,u=e.module,q=e.klass,B=e.hash2,t=e.send,i=e.truthy;return w.$require("bcdice/dice_table/sai_fic_skill_table/category"),w.$require("bcdice/dice_table/sai_fic_skill_table/skill"),K=r,U=T=[u(r[0],"BCDice")].concat(K),f=H=[u(T[0],"DiceTable")].concat(U),n=q(H[0],null,"SaiFicSkillTable"),m=[n].concat(f),n.$$prototype.rtt=n.$$prototype.rtt_format=n.$$prototype.rct=n.$$prototype.rct_format=n.$$prototype.rttn=n.$$prototype.rttn_format=n.$$prototype.categories=g,e.defs(n,"$from_i18n",c=function(v,_,o){var h,D,I,a,$e,te=g;if(null==o)o=B([],{});else if(!o.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(h=o.$$smap.rtt)&&(h=g),null==(D=o.$$smap.rct)&&(D=g),null==(I=o.$$smap.rttn)&&(I=g),$e=(te=V(m,"I18n").$t("RTT",B(["locale","raise","default"],{locale:_,raise:!1,default:B([],{})})).$merge(V(m,"I18n").$t(v,B(["locale","raise"],{locale:_,raise:!0}))))["$[]"]("items"),te=t(te,"select",[],((a=function(ye){function ge(Te,Be){return ye.apply(this,arguments)}return ge.toString=function(){return ye.toString()},ge}(function(ye,ge){return null==ye&&(ye=g),null==ge&&(ge=g),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](ye)})).$$s=this,a.$$arity=2,a)),this.$new($e,e.to_hash(te).$merge(B(["rtt","rct","rttn"],{rtt:h,rct:D,rttn:I})))},c.$$arity=-3),e.const_set(m[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),e.const_set(m[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),e.const_set(m[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),e.const_set(m[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),e.def(n,"$initialize",d=function(v,_){var o,h,D,I,a,S,Q,te,$e=this;if(null==_)_=B([],{});else if(!_.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(o=_.$$smap.rtt)&&(o=g),null==(h=_.$$smap.rct)&&(h=g),null==(D=_.$$smap.rttn)&&(D=g),null==(I=_.$$smap.rtt_format)&&(I=V(m,"DEFAULT_RTT")),null==(a=_.$$smap.rct_format)&&(a=V(m,"DEFAULT_RCT")),null==(S=_.$$smap.rttn_format)&&(S=V(m,"DEFAULT_RTTN")),null==(Q=_.$$smap.s_format)&&(Q=V(m,"DEFAULT_S")),$e.categories=t(v.$map(),"with_index",[1],((te=function(ge,Te){var ze,Ae,fe;return null==ge&&(ge=g),null==Te&&(Te=g),Ae=null==(ze=e.to_ary(ge))[0]?g:ze[0],fe=null==ze[1]?g:ze[1],$(V(m,"SaiFicSkillTable"),"Category").$new(Ae,fe,Te,Q)}).$$s=$e,te.$$arity=2,te.$$has_top_level_mlhs_arg=!0,te)),$e.rtt=o,$e.rct=h,$e.rttn=D.$to_a(),$e.rtt_format=I,$e.rct_format=a,$e.rttn_format=S},d.$$arity=-2),e.const_set(m[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),n.$attr_reader("categories"),e.def(n,"$roll_command",k=function(v,_){var h,o=this,D=g,I=g,a=g;return i(["RTT",o.rtt]["$include?"](h=_))?o.$format_skill(o.rtt_format,o.$roll_skill(v)):i(["RCT",o.rct]["$include?"](h))?(D=o.$roll_category(v),o.$format(o.rct_format,B(["category_dice","category_name"],{category_dice:D.$dice(),category_name:D.$name()}))):i(i(I=a=V(m,"RTTN").$index(h))?I:a=o.rttn.$index(h))?o.$format_skill(o.rttn_format,o.categories["$[]"](a).$roll(v)):g},k.$$arity=2),e.def(n,"$roll_category",b=function(v){return this.categories["$[]"](function(A,K){return"number"==typeof A?A-1:A["$-"](1)}(v.$roll_once(6)))},b.$$arity=1),e.def(n,"$roll_skill",p=function(v){return this.$roll_category(v).$roll(v)},p.$$arity=1),e.def(n,"$prefixes",y=function(){var v=this;return function(A,K){return"number"==typeof A&&"number"==typeof K?A+K:A["$+"](K)}(["RTT[1-6]?","RCT",v.rtt,v.rct],v.rttn).$compact()},y.$$arity=0),n.$private(),void e.def(n,"$format_skill",C=function(v,_){return this.$format(v,B(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:_.$category_dice(),row_dice:_.$row_dice(),category_name:_.$category_name(),skill_name:_.$name(),text:_.$to_s()}))},C.$$arity=2)},Opal.modules["bcdice/dice_table/table"]=function(e){var z,l,H,f,n,m,c,L,E,G,A,w=[],r=e.nil,$=e.$$,V=e.module,u=e.klass,q=e.hash2,B=e.truthy;return z=w,l=A=[V(w[0],"BCDice")].concat(z),H=G=[V(A[0],"DiceTable")].concat(l),L=u(G[0],null,"Table"),E=[L].concat(H),L.$$prototype.times=L.$$prototype.sides=L.$$prototype.name=L.$$prototype.items=r,e.defs(L,"$from_i18n",f=function(k,b){var y=r;return y=$(E,"I18n").$t(k,q(["locale"],{locale:b})),this.$new(y["$[]"]("name"),y["$[]"]("type"),y["$[]"]("items"))},f.$$arity=2),e.def(L,"$initialize",n=function(k,b,p){var y=this,C=r;return y.name=k,y.items=p.$freeze(),C=/(\d+)D(\d+)/i.$match(b),B(C)||y.$raise($(E,"ArgumentError"),"Unexpected table type: "+b),y.times=C["$[]"](1).$to_i(),y.sides=C["$[]"](2).$to_i()},n.$$arity=3),e.def(L,"$roll",m=function(k){var p,b=this;return p=k.$roll_sum(b.times,b.sides),b.$choice(p)},m.$$arity=1),void e.def(L,"$choice",c=function(k){var p,b=this;return p=function(t,z){return"number"==typeof t&&"number"==typeof z?t-z:t["$-"](z)}(k,b.times),$(E,"RollResult").$new(b.name,k,b.items["$[]"](p))},c.$$arity=1)},Opal.modules["bcdice/dice_table"]=function(e){var W=e.top;return W.$require("bcdice/dice_table/roll_result"),W.$require("bcdice/dice_table/chain_table"),W.$require("bcdice/dice_table/d66_grid_table"),W.$require("bcdice/dice_table/d66_half_grid_table"),W.$require("bcdice/dice_table/d66_one_third_table"),W.$require("bcdice/dice_table/d66_left_range_table"),W.$require("bcdice/dice_table/d66_parity_table"),W.$require("bcdice/dice_table/d66_range_table"),W.$require("bcdice/dice_table/d66_table"),W.$require("bcdice/dice_table/range_table"),W.$require("bcdice/dice_table/sai_fic_skill_table"),W.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var u,z,A,B,Z=[],$=e.module;return u=Z,z=B=[$(Z[0],"BCDice")].concat(u),A=[$(B[0],"D66SortType")].concat(z),e.const_set(A[0],"NO_SORT","no_sort"),e.const_set(A[0],"ASC","asc"),e.const_set(A[0],"DESC","desc"),void function(t,z){var A=[$(t,"RoundType")].concat(z);e.const_set(A[0],"CEIL","ceil"),e.const_set(A[0],"FLOOR","floor"),e.const_set(A[0],"ROUND","round")}(B[0],B)},Opal.modules["bcdice/translate"]=function(e){var B,A,T,K,l,z,Z=[],w=e.nil,g=e.$$,$=e.module,V=e.hash2;return B=Z,A=z=[$(Z[0],"BCDice")].concat(B),K=$(z[0],"Translate"),l=[K].concat(A),void e.def(K,"$translate",T=function(U,R){var H,L=this;if(null==L.locale&&(L.locale=w),null==R)R=V([],{});else if(!R.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return H=e.kwrestargs(R,{}),g(l,"I18n").$translate(U,V(["locale","raise"],{locale:L.locale,raise:!0}).$merge(e.to_hash(H)))},T.$$arity=-2)},Opal.modules["bcdice/result"]=function(e){function W(B,t){return"number"==typeof B&&"number"==typeof t?B-t:B["$-"](t)}var t,m,k,b,p,y,C,l,U,R,H,L,E,f,n,T,G,i,w=[],r=e.nil,u=e.klass,q=e.send;return t=w,l=i=[(0,e.module)(w[0],"BCDice")].concat(t),G=[T=u(i[0],null,"Result")].concat(l),T.$$prototype.secret=T.$$prototype.success=T.$$prototype.failure=T.$$prototype.critical=T.$$prototype.fumble=r,[m=e.get_singleton_class(T)].concat(G),e.def(m,"$success",k=function(v){var _;return q(this.$new(),"tap",[],((_=function(h){function D(I){return h.apply(this,arguments)}return D.toString=function(){return h.toString()},D}(function(h){var I=r;return null==h&&(h=r),q(h,"text=",e.to_a(I=[v])),W(I.length,1),q(h,"success=",e.to_a(I=[!0])),I[W(I.length,1)]})).$$s=this,_.$$arity=1,_))},k.$$arity=1),e.def(m,"$failure",b=function(v){var _;return q(this.$new(),"tap",[],((_=function(D){var a=r;return null==D&&(D=r),q(D,"text=",e.to_a(a=[v])),W(a.length,1),q(D,"failure=",e.to_a(a=[!0])),a[W(a.length,1)]}).$$s=this,_.$$arity=1,_))},b.$$arity=1),e.def(m,"$critical",p=function(v){var _;return q(this.$new(),"tap",[],((_=function(D){var a=r;return null==D&&(D=r),q(D,"text=",e.to_a(a=[v])),W(a.length,1),q(D,"critical=",e.to_a(a=[!0])),W(a.length,1),q(D,"success=",e.to_a(a=[!0])),a[W(a.length,1)]}).$$s=this,_.$$arity=1,_))},p.$$arity=1),e.def(m,"$fumble",y=function(v){var _;return q(this.$new(),"tap",[],((_=function(D){var a=r;return null==D&&(D=r),q(D,"text=",e.to_a(a=[v])),W(a.length,1),q(D,"fumble=",e.to_a(a=[!0])),W(a.length,1),q(D,"failure=",e.to_a(a=[!0])),a[W(a.length,1)]}).$$s=this,_.$$arity=1,_))},y.$$arity=1),e.def(m,"$nothing",C=function(){return"nothing"},C.$$arity=0),e.def(T,"$initialize",U=function(c){var d=this;return null==c&&(c=r),d.text=c,d.rands=r,d.detailed_rands=r,d.secret=!1,d.success=!1,d.failure=!1,d.critical=!1,d.fumble=!1},U.$$arity=-1),T.$attr_accessor("text","rands","detailed_rands"),T.$attr_writer("secret","success","failure","critical","fumble"),e.def(T,"$secret?",R=function(){return this.secret},R.$$arity=0),e.def(T,"$success?",H=function(){return this.success},H.$$arity=0),e.def(T,"$failure?",L=function(){return this.failure},L.$$arity=0),e.def(T,"$critical?",E=function(){return this.critical},E.$$arity=0),e.def(T,"$fumble?",f=function(){return this.fumble},f.$$arity=0),void e.def(T,"$condition=",n=function(c){return this.success=c,this.failure=c["$!"]()},n.$$arity=1)},Opal.modules["racc/parser"]=function(e){function W(U,R){return"number"==typeof U&&"number"==typeof R?U<R:U["$<"](R)}function Z(U,R){return"number"==typeof U&&"number"==typeof R?U-R:U["$-"](R)}function w(U,R){return"number"==typeof U&&"number"==typeof R?U+R:U["$+"](R)}function r(U,R){return"number"==typeof U&&"number"==typeof R?U>=R:U["$>="](R)}function g(U,R){return"number"==typeof U&&"number"==typeof R?U>R:U["$>"](R)}function $(U,R){return"number"==typeof U&&"number"==typeof R?U<=R:U["$<="](R)}var E,f,n,R,L,B=[],t=e.nil,z=e.$$$,i=e.$$,A=e.module,K=e.klass,l=e.truthy,T=e.gvars,G=e.send;return R=B,E=(L=[A(B[0],"Racc")].concat(R))[0],f=i(L,"StandardError"),n=L,[K(E,f,"ParseError")].concat(n),l(z("::","ParseError","skip_raise")?"constant":t)||e.const_set(B[0],"ParseError",z(i(B,"Racc"),"ParseError")),function(U,R){var m,k,b,p,y,C,Y,v,_,o,h,D,I,a,S,Q,te,$e,ye,ge,Te,Be,ze,qe,Ae,c,d,L=[A(U,"Racc")].concat(R);l(i(L,"Racc_No_Extensions","skip_raise")?"constant":t)||e.const_set(L[0],"Racc_No_Extensions",!1),m=L,c=K(L[0],null,"Parser"),d=[c].concat(m),c.$$prototype.yydebug=c.$$prototype.racc_debug_out=c.$$prototype.racc_error_status=c.$$prototype.racc_t=c.$$prototype.racc_vstack=c.$$prototype.racc_val=c.$$prototype.racc_state=c.$$prototype.racc_tstack=t,e.const_set(d[0],"Racc_Runtime_Version","1.4.6"),e.const_set(d[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),e.const_set(d[0],"Racc_Runtime_Core_Version_R","1.4.6"),e.const_set(d[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),e.const_set(d[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),e.const_set(d[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),e.const_set(d[0],"Racc_Runtime_Core_Version",i(d,"Racc_Runtime_Core_Version_R")),e.const_set(d[0],"Racc_Runtime_Core_Revision",i(d,"Racc_Runtime_Core_Revision_R")),e.const_set(d[0],"Racc_Runtime_Type","ruby"),e.defs(i(d,"Parser"),"$racc_runtime_type",k=function(){return i(d,"Racc_Runtime_Type")},k.$$arity=0),e.def(c,"$_racc_setup",b=function(){var O,X,s=this,N=t,P=t,x=t;return null==T.stderr&&(T.stderr=t),l(z(s.$class(),"Racc_debug_parser"))||(s.yydebug=!1),l(null!=(O=s.yydebug)&&O!==t?"instance-variable":t)||(s.yydebug=!1),l(s.yydebug)&&(l(null!=(X=s.racc_debug_out)&&X!==t?"instance-variable":t)||(s.racc_debug_out=T.stderr),s.racc_debug_out=l(N=s.racc_debug_out)?N:T.stderr),P=z(s.$class(),"Racc_arg"),l(W(P.$size(),14))&&(G(P,"[]=",e.to_a(x=[13,!0])),Z(x.length,1)),P},b.$$arity=0),e.def(c,"$_racc_init_sysvars",p=function(){var O=this;return O.racc_state=[0],O.racc_tstack=[],O.racc_vstack=[],O.racc_t=t,O.racc_val=t,O.racc_read_next=!0,O.racc_user_yyerror=!1,O.racc_error_status=0},p.$$arity=0),e.def(c,"$do_parse",y=function(){return this.$__send__(i(d,"Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},y.$$arity=0),e.def(c,"$next_token",C=function(){return this.$raise(i(d,"NotImplementedError"),this.$class()+"#next_token is not defined")},C.$$arity=0),e.def(c,"$_racc_do_parse_rb",Y=function(O,X){var s,P,x=this,J=t,ee=t,ne=t,de=t,ie=t,me=t,ve=t,le=t;return s=e.to_ary(O),J=null==s[0]?t:s[0],ee=null==s[1]?t:s[1],ne=null==s[2]?t:s[2],de=null==s[3]?t:s[3],ie=null==s[10]?t:s[10],x.$_racc_init_sysvars(),me=ve=le=t,G(x,"catch",["racc_end_parse"],((P=function(){var Ee,Ne,ae=null==P.$$s?this:P.$$s,De=t,Ie=t,Ce=t;for(null==ae.racc_state&&(ae.racc_state=t),null==ae.racc_read_next&&(ae.racc_read_next=t),null==ae.racc_t&&(ae.racc_t=t),null==ae.yydebug&&(ae.yydebug=t),null==ae.racc_val&&(ae.racc_val=t);l(!0);)for(l(le=de["$[]"](ae.racc_state["$[]"](-1)))?(l(ae.racc_read_next)&&l(ae.racc_t["$!="](0))&&(Ne=ae.$next_token(),Ee=e.to_ary(Ne),me=null==Ee[0]?t:Ee[0],ae.racc_val=null==Ee[1]?t:Ee[1],ae.racc_t=l(me)?l(De=ie["$[]"](me))?De:1:0,l(ae.yydebug)&&ae.$racc_read_token(ae.racc_t,me,ae.racc_val),ae.racc_read_next=!1),le=w(le,ae.racc_t),l(l(Ie=l(Ce=r(le,0))?ve=J["$[]"](le):Ce)?ee["$[]"](le)["$=="](ae.racc_state["$[]"](-1)):Ie)||(ve=ne["$[]"](ae.racc_state["$[]"](-1)))):ve=ne["$[]"](ae.racc_state["$[]"](-1));l(ve=ae.$_racc_evalact(ve,O)););}).$$s=x,P.$$arity=0,P))},Y.$$arity=2),e.def(c,"$yyparse",v=function(O,X){return this.$__send__(i(d,"Racc_YY_Parse_Method"),O,X,this.$_racc_setup(),!0)},v.$$arity=2),e.def(c,"$_racc_yyparse_rb",_=function(O,X,s,N){var P,J,ne=t,de=t,re=t,ie=t,ve=t,le=t,he=t;return P=e.to_ary(s),ne=null==P[0]?t:P[0],de=null==P[1]?t:P[1],re=null==P[2]?t:P[2],ie=null==P[3]?t:P[3],ve=null==P[10]?t:P[10],this.$_racc_init_sysvars(),le=t,he=t,G(this,"catch",["racc_end_parse"],((J=function(){var De,Re=null==J.$$s?this:J.$$s;for(null==Re.racc_state&&(Re.racc_state=t);!l(he=ie["$[]"](Re.racc_state["$[]"](-1)));)for(;l(le=Re.$_racc_evalact(re["$[]"](Re.racc_state["$[]"](-1)),s)););return G(O,"__send__",[X],((De=function(Ce,Se){var Ue,Ge,ke=null==De.$$s?this:De.$$s,Le=t,He=t,je=t,We=t,ue=t,M=t,_e=t;for(null==ke.racc_t&&(ke.racc_t=t),null==ke.racc_state&&(ke.racc_state=t),null==ke.racc_read_next&&(ke.racc_read_next=t),null==Ce&&(Ce=t),null==Se&&(Se=t),ke.racc_t=l(Ce)?l(Le=ve["$[]"](Ce))?Le:1:0,ke.racc_val=Se,ke.racc_read_next=!1,he=w(he,ke.racc_t),l(l(Ue=l(Ge=r(he,0))?le=ne["$[]"](he):Ge)?de["$[]"](he)["$=="](ke.racc_state["$[]"](-1)):Ue)||(le=re["$[]"](ke.racc_state["$[]"](-1)));l(le=ke.$_racc_evalact(le,s)););for(;l(l(He=l(je=(he=ie["$[]"](ke.racc_state["$[]"](-1)))["$!"]())?je:ke.racc_read_next["$!"]())?He:ke.racc_t["$=="](0));)for(l(l(We=l(ue=l(M=l(_e=he)?he=w(he,ke.racc_t):_e)?r(he,0):M)?le=ne["$[]"](he):ue)?de["$[]"](he)["$=="](ke.racc_state["$[]"](-1)):We)||(le=re["$[]"](ke.racc_state["$[]"](-1)));l(le=ke.$_racc_evalact(le,s)););}).$$s=Re,De.$$arity=2,De))}).$$s=this,J.$$arity=0,J))},_.$$arity=4),e.def(c,"$_racc_evalact",o=function(O,X){var s,P,re,me,x=this,J=t,ee=t,de=t,ie=t,ve=t,le=t,he=t,ae=t,Re=t,Ee=t;if(J=null==(s=e.to_ary(X))[0]?t:s[0],ee=null==s[1]?t:s[1],de=null==s[3]?t:s[3],re=null==s[11]?t:s[11],ie=null==s[12]?t:s[12],l(l(me=g(O,0))?W(O,re):me))l(g(x.racc_error_status,0))&&(x.racc_t["$=="](1)||(x.racc_error_status=Z(x.racc_error_status,1))),x.racc_vstack.$push(x.racc_val),x.racc_state.$push(O),x.racc_read_next=!0,l(x.yydebug)&&(x.racc_tstack.$push(x.racc_t),x.$racc_shift(x.racc_t,x.racc_tstack,x.racc_vstack));else if(l(l(ve=W(O,0))?g(O,ie["$-@"]()):ve)){if(le=G(x,"catch",["racc_jump"],((P=function(){var De=null==P.$$s?this:P.$$s;return null==De.racc_state&&(De.racc_state=t),De.racc_state.$push(De.$_racc_do_reduce(X,O)),!1}).$$s=x,P.$$arity=0,P)),l(le)){if(1["$==="](he=le))return x.racc_user_yyerror=!0,ie["$-@"]();if(2["$==="](he))return re;x.$raise("[Racc Bug] unknown jump code")}}else if(O["$=="](re))l(x.yydebug)&&x.$racc_accept(),x.$throw("racc_end_parse",x.racc_vstack["$[]"](0));else{if(O["$=="](ie["$-@"]())){for((0)["$==="](he=x.racc_error_status)?l(X["$[]"](21))||x.$on_error(x.racc_t,x.racc_val,x.racc_vstack):3["$==="](he)&&(x.racc_t["$=="](0)&&x.$throw("racc_end_parse",t),x.racc_read_next=!0),x.racc_user_yyerror=!1,x.racc_error_status=3;l(!0)&&(!l(ae=de["$[]"](x.racc_state["$[]"](-1)))||(ae=w(ae,1),!l(l(Re=l(Ee=r(ae,0))?O=J["$[]"](ae):Ee)?ee["$[]"](ae)["$=="](x.racc_state["$[]"](-1)):Re)));)l($(x.racc_state.$size(),1))&&x.$throw("racc_end_parse",t),x.racc_state.$pop(),x.racc_vstack.$pop(),l(x.yydebug)&&(x.racc_tstack.$pop(),x.$racc_e_pop(x.racc_state,x.racc_tstack,x.racc_vstack));return O}x.$raise("[Racc Bug] unknown action "+O.$inspect())}return l(x.yydebug)&&x.$racc_next_state(x.racc_state["$[]"](-1),x.racc_state),t},o.$$arity=2),e.def(c,"$_racc_do_reduce",h=function(O,X){var s,re,me,Ee,Ne,De,ke,P=this,J=t,ee=t,ne=t,de=t,ie=t,ve=t,le=t,he=t,ae=t,Re=t,Ie=t,Ce=t,Se=t,Fe=t,Me=t,Le=t;return J=null==(s=e.to_ary(O))[4]?t:s[4],ee=null==s[5]?t:s[5],ne=null==s[6]?t:s[6],de=null==s[7]?t:s[7],re=null==s[8]?t:s[8],ie=null==s[9]?t:s[9],me=null==s[13]?t:s[13],ve=P.racc_state,le=P.racc_vstack,he=P.racc_tstack,ae=function(U,R){return"number"==typeof U?-3*U:U["$*"](-3)}(X),Re=ie["$[]"](ae),Ee=ie["$[]"](w(ae,1)),Ne=ie["$[]"](w(ae,2)),De=[],l(P.yydebug)&&(Ie=he["$[]"](Re["$-@"](),Re)),Ce=le["$[]"](Re["$-@"](),Re),l(P.yydebug)&&(Se=[Re["$-@"](),Re,De],G(he,"[]=",e.to_a(Se)),Z(Se.length,1)),Se=[Re["$-@"](),Re,De],G(le,"[]=",e.to_a(Se)),Z(Se.length,1),Se=[Re["$-@"](),Re,De],G(ve,"[]=",e.to_a(Se)),Z(Se.length,1),l(me)?le.$push(P.$__send__(Ne,Ce,le,Ce["$[]"](0))):le.$push(P.$__send__(Ne,Ce,le)),he.$push(Ee),l(P.yydebug)&&P.$racc_reduce(Ie,Ee,he,le),ke=Z(Ee,re),l(ae=de["$[]"](ke))&&(ae=w(ae,ve["$[]"](-1)),l(l(Fe=l(Me=r(ae,0))?Le=J["$[]"](ae):Me)?ee["$[]"](ae)["$=="](ke):Fe))?Le:ne["$[]"](ke)},h.$$arity=2),e.def(c,"$on_error",D=function(O,X,s){var P,N=this;return N.$raise(i(d,"ParseError"),N.$sprintf("\nparse error on value %s (%s)",X.$inspect(),l(P=N.$token_to_str(O))?P:"?"))},D.$$arity=3),e.def(c,"$yyerror",I=function(){return this.$throw("racc_jump",1)},I.$$arity=0),e.def(c,"$yyaccept",a=function(){return this.$throw("racc_jump",2)},a.$$arity=0),e.def(c,"$yyerrok",S=function(){return this.racc_error_status=0},S.$$arity=0),e.def(c,"$racc_read_token",Q=function(O,X,s){var N=this;return N.racc_debug_out.$print("read    "),N.racc_debug_out.$print(X.$inspect(),"(",N.$racc_token2str(O),") "),N.racc_debug_out.$puts(s.$inspect()),N.racc_debug_out.$puts()},Q.$$arity=3),e.def(c,"$racc_shift",te=function(O,X,s){var N=this;return N.racc_debug_out.$puts("shift   "+N.$racc_token2str(O)),N.$racc_print_stacks(X,s),N.racc_debug_out.$puts()},te.$$arity=3),e.def(c,"$racc_reduce",$e=function(O,X,s,N){var P,x=this,J=t;return(J=x.racc_debug_out).$print("reduce "),l(O["$empty?"]())?J.$print(" <none>"):G(O,"each",[],((P=function(ne){return null==ne&&(ne=t),J.$print(" ",(null==P.$$s?this:P.$$s).$racc_token2str(ne))}).$$s=x,P.$$arity=1,P)),J.$puts(" --\x3e "+x.$racc_token2str(X)),x.$racc_print_stacks(s,N),x.racc_debug_out.$puts()},$e.$$arity=4),e.def(c,"$racc_accept",ye=function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},ye.$$arity=0),e.def(c,"$racc_e_pop",ge=function(O,X,s){var N=this;return N.racc_debug_out.$puts("error recovering mode: pop token"),N.$racc_print_states(O),N.$racc_print_stacks(X,s),N.racc_debug_out.$puts()},ge.$$arity=3),e.def(c,"$racc_next_state",Te=function(O,X){var s=this;return s.racc_debug_out.$puts("goto    "+O),s.$racc_print_states(X),s.racc_debug_out.$puts()},Te.$$arity=2),e.def(c,"$racc_print_stacks",Be=function(O,X){var s,P=t;return(P=this.racc_debug_out).$print("        ["),G(O,"each_index",[],((s=function(J){return null==J&&(J=t),P.$print(" (",(null==s.$$s?this:s.$$s).$racc_token2str(O["$[]"](J))," ",X["$[]"](J).$inspect(),")")}).$$s=this,s.$$arity=1,s)),P.$puts(" ]")},Be.$$arity=2),e.def(c,"$racc_print_states",ze=function(O){var X,N=t;return(N=this.racc_debug_out).$print("        ["),G(O,"each",[],((X=function(x){return null==x&&(x=t),N.$print(" ",x)}).$$s=this,X.$$arity=1,X)),N.$puts(" ]")},ze.$$arity=1),e.def(c,"$racc_token2str",qe=function(O){var s;return l(s=z(this.$class(),"Racc_token_to_s_table")["$[]"](O))?s:this.$raise("[Racc Bug] can't convert token "+O+" to string")},qe.$$arity=1),e.def(c,"$token_to_str",Ae=function(O){return z(this.$class(),"Racc_token_to_s_table")["$[]"](O)},Ae.$$arity=1)}(B[0],B)},Opal.modules["bcdice/arithmetic/node"]=function(e){function W(B,t){return"number"==typeof B&&"number"==typeof t?B/t:B["$/"](t)}var t,K,U,L,E,f,c,d,k,b,p,y,n,m,H,T,i,w=[],r=e.nil,g=e.$$$,$=e.$$,V=e.module,u=e.klass,q=e.send2;return t=w,K=i=[V(w[0],"BCDice")].concat(t),U=T=[V(i[0],"Arithmetic")].concat(K),function(L,E,f){var c,d,k,b,p,n=u(L,null,"BinaryOp");[n].concat(f),n.$$prototype.lhs=n.$$prototype.rhs=n.$$prototype.op=r,e.def(n,"$initialize",c=function(C,Y,v){var _=this;return _.lhs=C,_.op=Y,_.rhs=v},c.$$arity=3),e.def(n,"$eval",d=function(C){var _,Y=this,v=r;return v=Y.lhs.$eval(C),_=Y.rhs.$eval(C),v.$send(Y.op,_)},d.$$arity=1),e.def(n,"$output",k=function(){var C=this;return""+C.lhs.$output()+C.op+C.rhs.$output()},k.$$arity=0),e.def(n,"$s_exp",b=function(){var C=this;return"("+C.$op_for_s_exp()+" "+C.lhs.$s_exp()+" "+C.rhs.$s_exp()+")"},b.$$arity=0),e.def(n,"$op_for_s_exp",p=function(){return this.op},p.$$arity=0)}((H=[V(T[0],"Node")].concat(U))[0],0,H),L=H[0],E=$(H,"BinaryOp"),f=H,n=u(L,E,"DivideBase"),m=[n].concat(f),n.$$prototype.lhs=n.$$prototype.rhs=n.$$prototype.op=r,e.def(n,"$initialize",c=function(Y,v){return c.$$p&&(c.$$p=null),q(this,e.find_super_dispatcher(this,"initialize",c,!1,!0),"initialize",[Y,"/",v],null)},c.$$arity=2),e.def(n,"$eval",d=function(Y){var _,v=this,o=r;return _=v.lhs.$eval(Y),(o=v.rhs.$eval(Y))["$=="](0)&&v.$raise($(m,"ZeroDivisionError")),v.$divide_and_round(_,o,Y)},d.$$arity=1),e.def(n,"$output",k=function(){var Y=k.$$p,_=this,o=r,h=r,D=r;for(Y&&(k.$$p=null),h=0,D=arguments.length,o=new Array(D);h<D;h++)o[h]=arguments[h];return""+q(_,e.find_super_dispatcher(_,"output",k,!1,!0),"output",o,Y)+_.$rounding_method()},k.$$arity=0),n.$private(),e.def(n,"$rounding_method",b=function(){return g(this.$class(),"ROUNDING_METHOD")},b.$$arity=0),e.def(n,"$op_for_s_exp",p=function(){return""+this.op+this.$rounding_method()},p.$$arity=0),e.def(n,"$divide_and_round",y=function(Y,v,_){return this.$raise($(m,"NotImplementedError"))},y.$$arity=3),function(L,E,f){var c,n=u(L,E,"DivideWithGameSystemDefault"),m=[n].concat(f);e.const_set(m[0],"ROUNDING_METHOD",""),n.$private(),e.def(n,"$divide_and_round",c=function(k,b,p){var C;return C=p,g($(m,"RoundType"),"CEIL")["$==="](C)?W(k.$to_f(),b).$ceil():g($(m,"RoundType"),"ROUND")["$==="](C)?W(k.$to_f(),b).$round():W(k,b).$to_i()},c.$$arity=3)}(H[0],$(H,"DivideBase"),H),function(L,E,f){var c,n=u(L,E,"DivideWithCeil"),m=[n].concat(f);e.const_set(m[0],"ROUNDING_METHOD","C"),n.$private(),e.def(n,"$divide_and_round",c=function(k,b,p){return W(k.$to_f(),b).$ceil()},c.$$arity=3)}(H[0],$(H,"DivideBase"),H),function(L,E,f){var c,n=u(L,E,"DivideWithRound"),m=[n].concat(f);e.const_set(m[0],"ROUNDING_METHOD","R"),n.$private(),e.def(n,"$divide_and_round",c=function(k,b,p){return W(k.$to_f(),b).$round()},c.$$arity=3)}(H[0],$(H,"DivideBase"),H),function(L,E,f){var c,n=u(L,E,"DivideWithFloor"),m=[n].concat(f);e.const_set(m[0],"ROUNDING_METHOD","F"),n.$private(),e.def(n,"$divide_and_round",c=function(k,b,p){return W(k,b).$to_i()},c.$$arity=3)}(H[0],$(H,"DivideBase"),H),function(L,E,f){var c,d,k,b,n=u(L,null,"Negative");[n].concat(f),n.$$prototype.body=r,e.def(n,"$initialize",c=function(y){return this.body=y},c.$$arity=1),e.def(n,"$eval",d=function(y){return this.body.$eval(y)["$-@"]()},d.$$arity=1),e.def(n,"$output",k=function(){return"-"+this.body.$output()},k.$$arity=0),e.def(n,"$s_exp",b=function(){return"(- "+this.body.$s_exp()+")"},b.$$arity=0)}(H[0],0,H),function(L,E,f){var c,d,k,b,n=u(L,null,"Parenthesis");[n].concat(f),n.$$prototype.expr=r,e.def(n,"$initialize",c=function(y){return this.expr=y},c.$$arity=1),e.def(n,"$eval",d=function(y){return this.expr.$eval(y)},d.$$arity=1),e.def(n,"$output",k=function(){return"("+this.expr.$output()+")"},k.$$arity=0),e.def(n,"$s_exp",b=function(){return"(Parenthesis "+this.expr.$s_exp()+")"},b.$$arity=0)}(H[0],0,H),void function(L,E,f){var c,d,k,n=u(L,null,"Number");[n].concat(f),n.$$prototype.value=r,e.def(n,"$initialize",c=function(p){return this.value=p},c.$$arity=1),e.def(n,"$eval",d=function(p){return this.value},d.$$arity=1),e.def(n,"$output",k=function(){return this.value.$to_s()},k.$$arity=0),e.alias(n,"s_exp","output")}(H[0],0,H)},Opal.modules.strscan=function(e){var z,K,l,T,G,U,R,H,L,E,f,n,m,c,d,k,b,p,y,C,Y,v,_,o,h,D,i,A,w=[],r=e.nil,$=e.$$,u=e.truthy,q=e.send;return z=w,i=(0,e.klass)(w[0],null,"StringScanner"),A=[i].concat(z),i.$$prototype.pos=i.$$prototype.string=i.$$prototype.working=i.$$prototype.matched=i.$$prototype.prev_pos=i.$$prototype.match=r,i.$attr_reader("pos"),i.$attr_reader("matched"),e.def(i,"$initialize",K=function(a){var S=this;return S.string=a,S.pos=0,S.matched=r,S.working=a,S.match=[]},K.$$arity=1),i.$attr_reader("string"),e.def(i,"$beginning_of_line?",l=function(){var a=this;return 0===a.pos||"\n"===a.string.charAt(a.pos-1)},l.$$arity=0),e.alias(i,"bol?","beginning_of_line?"),e.def(i,"$scan",T=function(a){var S=this,Q=(a=S.$anchor(a)).exec(S.working);return null==Q?S.matched=r:"object"==typeof Q?(S.prev_pos=S.pos,S.pos+=Q[0].length,S.working=S.working.substring(Q[0].length),S.matched=Q[0],S.match=Q,Q[0]):"string"==typeof Q?(S.pos+=Q.length,S.working=S.working.substring(Q.length),Q):r},T.$$arity=1),e.def(i,"$scan_until",G=function(a){var S=this;a=S.$anchor(a);for(var $e,Q=S.pos,te=S.working;;){if($e=a.exec(te),Q+=1,te=te.substr(1),null!=$e)return S.matched=S.string.substr(S.pos,Q-S.pos-1+$e[0].length),S.match=$e,S.prev_pos=Q-1,S.pos=Q,S.working=te.substr($e[0].length),S.matched;if(0===te.length)return S.match=[],S.matched=r}},G.$$arity=1),e.def(i,"$[]",U=function(a){var Q;if(u(this.match["$empty?"]()))return r;Q=a,$(A,"Symbol")["$==="](Q)?a=a.$to_s():$(A,"String")["$==="](Q)||(a=$(A,"Opal")["$coerce_to!"](a,$(A,"Integer"),"to_int"));var te=this.match;return a<0&&(a+=te.length),a<0||a>=te.length||null==te[a]?r:te[a]},U.$$arity=1),e.def(i,"$check",R=function(a){var S=this,Q=(a=S.$anchor(a)).exec(S.working);return S.matched=null==Q?r:Q[0]},R.$$arity=1),e.def(i,"$check_until",H=function(a){var S=this,Q=S.prev_pos,te=S.pos,$e=S.$scan_until(a);return $e!==r&&(S.matched=$e.substr(-1),S.working=S.string.substr(te)),S.prev_pos=Q,S.pos=te,$e},H.$$arity=1),e.def(i,"$peek",L=function(a){return this.working.substring(0,a)},L.$$arity=1),e.def(i,"$eos?",E=function(){return 0===this.working.length},E.$$arity=0),e.def(i,"$exist?",f=function(a){var Q=a.exec(this.working);return null==Q?r:0==Q.index?0:Q.index+1},f.$$arity=1),e.def(i,"$skip",n=function(a){var S=this,Q=(a=S.$anchor(a)).exec(S.working);if(null==Q)return S.match=[],S.matched=r;var te=Q[0],$e=te.length;return S.matched=te,S.match=Q,S.prev_pos=S.pos,S.pos+=$e,S.working=S.working.substring($e),$e},n.$$arity=1),e.def(i,"$skip_until",m=function(a){var Q=this.$scan_until(a);return Q===r?r:(this.matched=Q.substr(-1),Q.length)},m.$$arity=1),e.def(i,"$get_byte",c=function(){var a=this,S=r;return a.pos<a.string.length?(a.prev_pos=a.pos,a.pos+=1,S=a.matched=a.working.substring(0,1),a.working=a.working.substring(1)):a.matched=r,S},c.$$arity=0),e.alias(i,"getch","get_byte"),e.def(i,"$match?",d=function(a){var S=this,Q=(a=S.$anchor(a)).exec(S.working);return null==Q?r:(S.prev_pos=S.pos,Q[0].length)},d.$$arity=1),e.def(i,"$pos=",k=function(a){var S=this;return a<0&&(a+=S.string.$length()),S.pos=a,S.working=S.string.slice(a)},k.$$arity=1),e.def(i,"$matched_size",b=function(){return this.matched===r?r:this.matched.length},b.$$arity=0),e.def(i,"$post_match",p=function(){var a=this;return a.matched===r?r:a.string.substr(a.pos)},p.$$arity=0),e.def(i,"$pre_match",y=function(){var a=this;return a.matched===r?r:a.string.substr(0,a.prev_pos)},y.$$arity=0),e.def(i,"$reset",C=function(){var a=this;return a.working=a.string,a.matched=r,a.pos=0},C.$$arity=0),e.def(i,"$rest",Y=function(){return this.working},Y.$$arity=0),e.def(i,"$rest?",v=function(){return 0!==this.working.length},v.$$arity=0),e.def(i,"$rest_size",_=function(){return this.$rest().$size()},_.$$arity=0),e.def(i,"$terminate",o=function(){var S,a=this;return a.match=r,S=[a.string.$length()],q(a,"pos=",e.to_a(S)),S[function(B,t){return"number"==typeof B?B-1:B["$-"](1)}(S.length)]},o.$$arity=0),e.def(i,"$unscan",h=function(){var a=this;return a.pos=a.prev_pos,a.prev_pos=r,a.match=r,a},h.$$arity=0),i.$private(),e.def(i,"$anchor",D=function(a){var Q=a.toString().match(/\/([^\/]+)$/);return Q=Q?Q[1]:void 0,new RegExp("^(?:"+a.source+")",Q)},D.$$arity=1),r&&"anchor"},Opal.modules["bcdice/normalize"]=function(e){var z,K,l,i,u,B,Z=[],w=e.nil,$=e.module;return u=Z,z=B=[$(Z[0],"BCDice")].concat(u),[i=$(B[0],"Normalize")].concat(z),i.$module_function(),e.def(i,"$comparison_operator",K=function(G){var R;return/<=|=</["$==="](R=G)?"<=":/>=|=>/["$==="](R)?">=":/<>|!=|=!/["$==="](R)?"!=":/</["$==="](R)?"<":/>/["$==="](R)?">":/=/["$==="](R)?"==":w},K.$$arity=1),void e.def(i,"$target_number",l=function(G){return G["$=="]("?")?G:G.$to_i()},l.$$arity=1)},Opal.modules["bcdice/command/lexer"]=function(e){var z,l,H,f,n,m,L,E,G,A,W=e.top,Z=[],w=e.nil,g=e.$$,$=e.module,V=e.klass,u=e.hash2,q=e.truthy,B=e.send;return W.$require("strscan"),W.$require("bcdice/normalize"),z=Z,l=A=[$(Z[0],"BCDice")].concat(z),H=G=[$(A[0],"Command")].concat(l),L=V(G[0],null,"Lexer"),E=[L].concat(H),L.$$prototype.scanner=L.$$prototype.notations=w,e.const_set(E[0],"SYMBOLS",u(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),e.def(L,"$initialize",f=function(d,k){var b,p,y,Y,C=this;return d=q(Y=(p=(b=d)===w||null==b?w:B(b,"split",[" ",2]))===w||null==p?w:B(p,"first",[]))?Y:"",C.scanner=g(E,"StringScanner").$new(d),C.notations=B(k,"map",[],((y=function(v){function _(o){return v.apply(this,arguments)}return _.toString=function(){return v.toString()},_}(function(v){return null==v&&(v=w),q(v["$is_a?"](g(E,"String")))?g(E,"Regexp").$new(v):v})).$$s=C,y.$$arity=1,y))},f.$$arity=2),e.def(L,"$next_token",n=function(){try{var d,k=this,b=w,p=w,C=w,Y=w;return q(k.scanner["$eos?"]())?[!1,"$"]:(B(k.notations,"each",[],((d=function(_){var h,o=null==d.$$s?this:d.$$s;if(null==o.scanner&&(o.scanner=w),null==_&&(_=w),h=o.scanner.$scan(_),!q(h))return w;e.ret(["NOTATION",h])}).$$s=k,d.$$arity=1,d)),q(b=k.scanner.$scan(/\d+/))?["NUMBER",b.$to_i()]:q(p=k.scanner.$scan(/[<>!=]+/))?(p=g(E,"Normalize").$comparison_operator(p),[q(p)?"CMP_OP":"ILLEGAL",p]):(C=k.scanner.$getch().$upcase(),[q(Y=g(E,"SYMBOLS")["$[]"](C))?Y:C.$to_sym(),C]))}catch(v){if(v===e.returner)return v.$v;throw v}},n.$$arity=0),void e.def(L,"$source",m=function(){return this.scanner.$string()},m.$$arity=0)},Opal.modules["bcdice/command/parsed"]=function(e){var B,A,U,L,E,f,R,H,l,z,Z=[],w=e.nil,g=e.$$,$=e.module,V=e.klass,u=e.truthy;return B=Z,A=z=[$(Z[0],"BCDice")].concat(B),U=l=[$(z[0],"Command")].concat(A),R=V(l[0],null,"Parsed"),H=[R].concat(U),R.$$prototype.question_target=R.$$prototype.critical=R.$$prototype.fumble=R.$$prototype.dollar=R.$$prototype.modify_number=R.$$prototype.target_number=R.$$prototype.prefix_number=R.$$prototype.command=R.$$prototype.suffix_number=R.$$prototype.cmp_op=w,R.$attr_accessor("command"),R.$attr_accessor("prefix_number"),R.$attr_accessor("suffix_number"),R.$attr_accessor("critical"),R.$attr_accessor("fumble"),R.$attr_accessor("dollar"),R.$attr_accessor("modify_number"),R.$attr_accessor("cmp_op"),R.$attr_accessor("target_number"),R.$attr_writer("question_target"),e.def(R,"$initialize",L=function(){var m=this;return m.prefix_number=w,m.suffix_number=w,m.critical=w,m.fumble=w,m.dollar=w,m.cmp_op=w,m.target_number=w,m.question_target=!1},L.$$arity=0),e.def(R,"$question_target?",E=function(){return this.question_target},E.$$arity=0),void e.def(R,"$to_s",f=function(m){var C,c=this,d=w,k=w,b=w,p=w,y=w;return null==m&&(m="after_command"),d=u(c.critical)?"@"+c.critical:w,k=u(c.fumble)?"#"+c.fumble:w,b=u(c.dollar)?"$"+c.dollar:w,p=g(H,"Format").$modifier(c.modify_number),y=u(c.question_target)?"?":c.target_number,"after_command"["$==="](C=m)?[c.prefix_number,c.command,c.suffix_number,d,k,b,p,c.cmp_op,y].$join():"after_modify_number"["$==="](C)?[c.prefix_number,c.command,c.suffix_number,p,d,k,b,c.cmp_op,y].$join():"after_target_number"["$==="](C)?[c.prefix_number,c.command,c.suffix_number,p,c.cmp_op,y,d,k,b].$join():w},f.$$arity=-1)},Opal.modules["bcdice/command/parser"]=function(e){function W(A,K){return"number"==typeof A&&"number"==typeof K?A-K:A["$-"](K)}var K,U,L,E,f,c,d,k,b,p,y,C,Y,v,_,o,h,D,I,a,S,Q,te,$e,ye,ge,Te,Be,ze,qe,Ae,fe,O,X,s,N,P,x,J,ee,ne,de,re,ie,me,ve,le,he,ae,Re,Ee,Ne,De,Ie,Ce,Se,ke,Fe,Me,Le,He,n,m,H,T,Z=e.top,w=[],r=e.nil,g=e.$$$,$=e.$$,V=e.klass,u=e.module,q=e.hash2,B=e.send2,t=e.send,z=e.hash,i=e.truthy;return Z.$require("racc/parser.rb"),Z.$require("bcdice/arithmetic/node"),Z.$require("bcdice/command/lexer"),Z.$require("bcdice/command/parsed"),function(A,K,l){[V(A,K,"Parser")].concat(l)}(g($(w,"BCDice"),"Command"),g($(w,"Racc"),"Parser"),w),K=w,U=T=[u(w[0],"BCDice")].concat(K),L=(H=[u(T[0],"Command")].concat(U))[0],E=g($(H,"Racc"),"Parser"),f=H,n=V(L,E,"Parser"),m=[n].concat(f),n.$$prototype.notations=n.$$prototype.lexer=n.$$prototype.modifier=n.$$prototype.prefix_number=n.$$prototype.suffix_number=n.$$prototype.need_suffix_number=n.$$prototype.need_prefix_number=n.$$prototype.critical=n.$$prototype.fumble=n.$$prototype.dollar=n.$$prototype.allowed_cmp_op=n.$$prototype.question_target=r,e.def(n,"$initialize",c=function(M,_e){var j,F,se,xe,pe=c.$$p,oe=this;if(pe&&(c.$$p=null),j=e.slice.call(arguments,0,arguments.length),null==(F=e.extract_kwargs(j)))F=q([],{});else if(!F.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(se=j,!e.hasOwnProperty.call(F.$$smap,"round_type"))throw e.ArgumentError.$new("missing keyword: round_type");return xe=F.$$smap.round_type,B(oe,e.find_super_dispatcher(oe,"initialize",c,!1,!0),"initialize",[],null),oe.notations=se,oe.round_type=xe,oe.prefix_number=!1,oe.suffix_number=!1,oe.need_prefix_number=!1,oe.need_suffix_number=!1,oe.modifier=!0,oe.critical=!1,oe.fumble=!1,oe.dollar=!1,oe.allowed_cmp_op=[r,">=",">","<=","<","==","!="],oe.question_target=!1},c.$$arity=-2),e.def(n,"$disable_modifier",d=function(){return this.modifier=!1,this},d.$$arity=0),e.def(n,"$enable_prefix_number",k=function(){return this.prefix_number=!0,this},k.$$arity=0),e.def(n,"$enable_suffix_number",b=function(){return this.suffix_number=!0,this},b.$$arity=0),e.def(n,"$has_prefix_number",p=function(){var M=this;return M.prefix_number=!0,M.need_prefix_number=!0,M},p.$$arity=0),e.def(n,"$has_suffix_number",y=function(){var M=this;return M.suffix_number=!0,M.need_suffix_number=!0,M},y.$$arity=0),e.def(n,"$enable_critical",C=function(){return this.critical=!0,this},C.$$arity=0),e.def(n,"$enable_fumble",Y=function(){return this.fumble=!0,this},Y.$$arity=0),e.def(n,"$enable_dollar",v=function(){return this.dollar=!0,this},v.$$arity=0),e.def(n,"$restrict_cmp_op_to",_=function(M){var _e,F=this;return _e=e.slice.call(arguments,0,arguments.length),F.allowed_cmp_op=_e,F},_.$$arity=-1),e.def(n,"$enable_question_target",o=function(){return this.question_target=!0,this},o.$$arity=0),e.def(n,"$parse",h=function(M){try{return this.lexer=$(m,"Lexer").$new(M,this.notations),this.$do_parse()}catch(j){if(!e.rescue(j,[$(m,"ParseError"),$(m,"ZeroDivisionError")]))throw j;try{return r}finally{e.pop_exception()}}},h.$$arity=1),n.$private(),e.def(n,"$parsed",D=function(M,_e,j,F){var se;return t($(m,"Parsed").$new(),"tap",[],((se=function(be){var we,Pe,Ye,Ke,Ve,Qe,oe=null==se.$$s?this:se.$$s,ce=r;return null==oe.round_type&&(oe.round_type=r),null==be&&(be=r),ce=[M["$[]"]("command")],t(be,"command=",e.to_a(ce)),W(ce.length,1),ce=[(we=M["$[]"]("prefix"),we===r||null==we?r:t(we,"eval",[oe.round_type]))],t(be,"prefix_number=",e.to_a(ce)),W(ce.length,1),ce=[(Pe=M["$[]"]("suffix"),Pe===r||null==Pe?r:t(Pe,"eval",[oe.round_type]))],t(be,"suffix_number=",e.to_a(ce)),W(ce.length,1),ce=[(Ye=_e["$[]"]("critical"),Ye===r||null==Ye?r:t(Ye,"eval",[oe.round_type]))],t(be,"critical=",e.to_a(ce)),W(ce.length,1),ce=[(Ke=_e["$[]"]("fumble"),Ke===r||null==Ke?r:t(Ke,"eval",[oe.round_type]))],t(be,"fumble=",e.to_a(ce)),W(ce.length,1),ce=[(Ve=_e["$[]"]("dollar"),Ve===r||null==Ve?r:t(Ve,"eval",[oe.round_type]))],t(be,"dollar=",e.to_a(ce)),W(ce.length,1),ce=[j.$eval(oe.round_type)],t(be,"modify_number=",e.to_a(ce)),W(ce.length,1),ce=[F["$[]"]("cmp_op")],t(be,"cmp_op=",e.to_a(ce)),W(ce.length,1),F["$[]"]("target")["$=="]("?")?(t(be,"question_target=",e.to_a(ce=[!0])),W(ce.length,1),t(be,"target_number=",e.to_a(ce=[0])),ce[W(ce.length,1)]):(t(be,"question_target=",e.to_a(ce=[!1])),W(ce.length,1),ce=[(Qe=F["$[]"]("target"),Qe===r||null==Qe?r:t(Qe,"eval",[oe.round_type]))],t(be,"target_number=",e.to_a(ce)),ce[W(ce.length,1)])}).$$s=this,se.$$arity=1,se))},D.$$arity=4),e.def(n,"$next_token",I=function(){return this.lexer.$next_token()},I.$$arity=0),Ne=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,33,34,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,r,r,17,18,6,r,5,r,r,17,18,r,r,5,23,24,25,26,56,54,55,57],De=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,r,17,15,15,18,18,23,r,18,30,30,23,23,24,r,23,31,31,24,24,25,r,24,44,44,25,25,28,r,25,47,47,28,28,29,r,28,48,48,29,29,33,r,29,49,49,33,33,34,r,33,50,50,34,34,36,r,34,r,r,36,36,37,r,36,r,r,37,37,r,r,37,27,27,27,27,52,52,52,52],Ie=[-2,4,16,-3,-1,11,r,33,13,35,23,30,1,r,28,40,r,37,44,r,r,-2,r,51,58,65,0,106,72,79,47,54,r,86,93,r,100,107,r,r,r,r,r,r,63,r,r,68,75,82,89,r,120,r,r,r,r,r],Ce=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],Se=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,r,r,21,47,48,40,51,52,49,50,44,46,3,r,r,r,13,r,r,r,r,r,r,r,32],ke=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,r,r,4,8,8,5,7,7,8,8,9,5,6,r,r,r,6,r,r,r,r,r,r,r,6],Fe=[r,6,13,3,9,-1,27,-15,-10,-1,-38],Me=[r,r,r,r,r,r,19,16,15,r,r],Le=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],He=z(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),e.const_set(m[0],"Racc_arg",[Ne,De,Ce,Ie,Se,ke,Me,Fe,19,Le,He,58,35,!0]),e.const_set(m[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),e.const_set(m[0],"Racc_debug_parser",!1),e.def(n,"$_reduce_1",a=function(M,_e,j){var F;return i(this.modifier)||this.$raise($(m,"ParseError")),F=e.to_ary(M),this.$parsed(null==F[0]?r:F[0],null==F[1]?r:F[1],null==F[2]?r:F[2],null==F[3]?r:F[3])},a.$$arity=3),e.def(n,"$_reduce_2",S=function(M,_e,j){var F;return i(this.modifier)||this.$raise($(m,"ParseError")),F=e.to_ary(M),this.$parsed(null==F[0]?r:F[0],null==F[2]?r:F[2],null==F[1]?r:F[1],null==F[3]?r:F[3])},S.$$arity=3),e.def(n,"$_reduce_3",Q=function(M,_e,j){var F,oe;return oe=null==(F=e.to_ary(M))[2]?r:F[2],this.$parsed(null==F[0]?r:F[0],null==F[1]?r:F[1],g(g($(m,"Arithmetic"),"Node"),"Number").$new(0),oe)},Q.$$arity=3),e.def(n,"$_reduce_4",te=function(M,_e,j){var se,F=this;return i(i(se=F.prefix_number)?F.suffix_number:se)||F.$raise($(m,"ParseError")),q(["command","prefix","suffix"],{command:M["$[]"](1),prefix:M["$[]"](0),suffix:M["$[]"](2)})},te.$$arity=3),e.def(n,"$_reduce_5",$e=function(M,_e,j){var F=this;return i(F.prefix_number)||F.$raise($(m,"ParseError")),i(F.need_suffix_number)&&F.$raise($(m,"ParseError")),q(["command","prefix"],{command:M["$[]"](1),prefix:M["$[]"](0)})},$e.$$arity=3),e.def(n,"$_reduce_6",ye=function(M,_e,j){var F=this;return i(F.suffix_number)||F.$raise($(m,"ParseError")),i(F.need_prefix_number)&&F.$raise($(m,"ParseError")),q(["command","suffix"],{command:M["$[]"](0),suffix:M["$[]"](1)})},ye.$$arity=3),e.def(n,"$_reduce_7",ge=function(M,_e,j){var se,F=this;return i(i(se=F.need_prefix_number)?se:F.need_suffix_number)&&F.$raise($(m,"ParseError")),q(["command"],{command:M["$[]"](0)})},ge.$$arity=3),e.def(n,"$_reduce_8",Te=function(M,_e,j){return q([],{})},Te.$$arity=3),e.def(n,"$_reduce_9",Be=function(M,_e,j){var F,oe,Pe,we,pe=r;return pe=null==(F=e.to_ary(M))[0]?r:F[0],oe=null==F[2]?r:F[2],i(i(we=this.critical)?pe["$[]"]("critical")["$nil?"]():we)||this.$raise($(m,"ParseError")),t(pe,"[]=",e.to_a(Pe=["critical",oe])),W(Pe.length,1),pe},Be.$$arity=3),e.def(n,"$_reduce_10",ze=function(M,_e,j){var F,oe,Pe,we,pe=r;return pe=null==(F=e.to_ary(M))[0]?r:F[0],oe=null==F[2]?r:F[2],i(i(we=this.fumble)?pe["$[]"]("fumble")["$nil?"]():we)||this.$raise($(m,"ParseError")),t(pe,"[]=",e.to_a(Pe=["fumble",oe])),W(Pe.length,1),pe},ze.$$arity=3),e.def(n,"$_reduce_11",qe=function(M,_e,j){var F,oe,Pe,we,pe=r;return pe=null==(F=e.to_ary(M))[0]?r:F[0],oe=null==F[2]?r:F[2],i(i(we=this.dollar)?pe["$[]"]("dollar")["$nil?"]():we)||this.$raise($(m,"ParseError")),t(pe,"[]=",e.to_a(Pe=["dollar",oe])),W(Pe.length,1),pe},qe.$$arity=3),e.def(n,"$_reduce_12",Ae=function(M,_e,j){return M["$[]"](1)},Ae.$$arity=3),e.def(n,"$_reduce_13",fe=function(M,_e,j){return g(g($(m,"Arithmetic"),"Node"),"Negative").$new(M["$[]"](1))},fe.$$arity=3),e.def(n,"$_reduce_14",O=function(M,_e,j){return g(g($(m,"Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"+",M["$[]"](2))},O.$$arity=3),e.def(n,"$_reduce_15",X=function(M,_e,j){return g(g($(m,"Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"-",M["$[]"](2))},X.$$arity=3),e.def(n,"$_reduce_16",s=function(M,_e,j){return i(this.allowed_cmp_op["$include?"](r))||this.$raise($(m,"ParseError")),q([],{})},s.$$arity=3),e.def(n,"$_reduce_17",N=function(M,_e,j){var F,pe,be;return be=null==(F=e.to_ary(M))[1]?r:F[1],i(this.allowed_cmp_op["$include?"](pe=null==F[0]?r:F[0]))||this.$raise($(m,"ParseError")),q(["cmp_op","target"],{cmp_op:pe,target:be})},N.$$arity=3),e.def(n,"$_reduce_18",P=function(M,_e,j){var se,F=this;return se=M["$[]"](0),i(F.question_target)||F.$raise($(m,"ParseError")),i(F.allowed_cmp_op["$include?"](se))||F.$raise($(m,"ParseError")),q(["cmp_op","target"],{cmp_op:se,target:"?"})},P.$$arity=3),e.def(n,"$_reduce_19",x=function(M,_e,j){return g(g($(m,"Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"+",M["$[]"](2))},x.$$arity=3),e.def(n,"$_reduce_20",J=function(M,_e,j){return g(g($(m,"Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"-",M["$[]"](2))},J.$$arity=3),e.def(n,"$_reduce_22",ee=function(M,_e,j){return g(g($(m,"Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"*",M["$[]"](2))},ee.$$arity=3),e.def(n,"$_reduce_23",ne=function(M,_e,j){return M["$[]"](3).$new(M["$[]"](0),M["$[]"](2))},ne.$$arity=3),e.def(n,"$_reduce_25",de=function(M,_e,j){return g(g($(m,"Arithmetic"),"Node"),"DivideWithGameSystemDefault")},de.$$arity=3),e.def(n,"$_reduce_26",re=function(M,_e,j){return g(g($(m,"Arithmetic"),"Node"),"DivideWithCeil")},re.$$arity=3),e.def(n,"$_reduce_27",ie=function(M,_e,j){return g(g($(m,"Arithmetic"),"Node"),"DivideWithCeil")},ie.$$arity=3),e.def(n,"$_reduce_28",me=function(M,_e,j){return g(g($(m,"Arithmetic"),"Node"),"DivideWithRound")},me.$$arity=3),e.def(n,"$_reduce_29",ve=function(M,_e,j){return g(g($(m,"Arithmetic"),"Node"),"DivideWithFloor")},ve.$$arity=3),e.def(n,"$_reduce_30",le=function(M,_e,j){return M["$[]"](1)},le.$$arity=3),e.def(n,"$_reduce_31",he=function(M,_e,j){return g(g($(m,"Arithmetic"),"Node"),"Negative").$new(M["$[]"](1))},he.$$arity=3),e.def(n,"$_reduce_33",ae=function(M,_e,j){return M["$[]"](1)},ae.$$arity=3),e.def(n,"$_reduce_34",Re=function(M,_e,j){return g(g($(m,"Arithmetic"),"Node"),"Number").$new(M["$[]"](0))},Re.$$arity=3),void e.def(n,"$_reduce_none",Ee=function(M,_e,j){return M["$[]"](0)},Ee.$$arity=3)},Opal.modules["bcdice/deprecated/checker"]=function(e){var B,A,G,H,L,E,f,n,m,U,R,l,z,Z=[],w=e.nil,g=e.$$,$=e.module,V=e.send,u=e.truthy;return B=Z,A=z=[$(Z[0],"BCDice")].concat(B),G=l=[$(z[0],"Deprecated")].concat(A),U=$(l[0],"Checker"),R=[U].concat(G),U.$private(),e.def(U,"$check_result_legacy",H=function(d,k,b,p){var v,h,y=this,C=w,Y=w,_=w,o=w,D=w;return C=V(k,"map",[],"sides".$to_proc()),v=(Y=V(k,"map",[],"value".$to_proc())).$sum(),_=[100]["$==="](o=C)?y.$check_1D100(d,v,b,p):[20]["$==="](o)?y.$check_1D20(d,v,b,p):[6,6]["$==="](o)?y.$check_2D6(d,v,Y,b,p):w,u(u(h=_["$nil?"]())?h:_["$empty?"]())&&(o=C.$uniq(),_=[10]["$==="](o)?y.$check_nD10(d,v,Y,b,p):[6]["$==="](o)?y.$check_nD6(d,v,Y,b,p):w,u(u(D=_["$nil?"]())?D:_["$empty?"]()))?w:g(R,"Result").$new(_.$delete_prefix(" \uff1e "))},H.$$arity=4),e.def(U,"$check_1D100",L=function(d,k,b,p){return w},L.$$arity=4),e.def(U,"$check_1D20",E=function(d,k,b,p){return w},E.$$arity=4),e.def(U,"$check_nD10",f=function(d,k,b,p,y){return w},f.$$arity=5),e.def(U,"$check_2D6",n=function(d,k,b,p,y){return w},n.$$arity=5),void e.def(U,"$check_nD6",m=function(d,k,b,p,y){return w},m.$$arity=5)},Opal.modules["bcdice/base"]=function(e){function W(T,G){return"number"==typeof T&&"number"==typeof G?T+G:T["$+"](G)}function Z(T,G){return"number"==typeof T&&"number"==typeof G?T-G:T["$-"](G)}var G,E,m,c,d,k,b,p,y,C,Y,v,_,o,h,D,I,a,S,Q,te,$e,ye,ge,Te,Be,ze,qe,Ae,fe,O,X,P,x,J,ee,ne,N,f,n,R,$=e.top,V=[],u=e.nil,q=e.$$$,B=e.$$,t=e.module,z=e.klass,i=e.truthy,A=e.send,K=e.range,l=u;return $.$require("i18n"),$.$require("i18n/backend/fallbacks"),$.$require("bcdice/randomizer"),$.$require("bcdice/dice_table"),$.$require("bcdice/enum"),$.$require("bcdice/translate"),$.$require("bcdice/result"),$.$require("bcdice/command/parser"),$.$require("bcdice/deprecated/checker"),G=V,E=R=[t(V[0],"BCDice")].concat(G),f=z(R[0],null,"Base"),n=[f].concat(E),f.$$prototype.sort_add_dice=f.$$prototype.sort_barabara_dice=f.$$prototype.enabled_d9=f.$$prototype.raw_input=f.$$prototype.randomizer=f.$$prototype.enabled_upcase_input=f.$$prototype.debug=u,X=e.get_singleton_class(f),N=[X].concat(n),X.$attr_reader("prefixes"),e.def(X,"$register_prefix",P=function(re){var me,ve=this,le=u;return null==ve.prefixes&&(ve.prefixes=u),me=e.slice.call(arguments,0,arguments.length),ve.prefixes=i(le=ve.prefixes)?le:[],ve.prefixes.$concat(me.$flatten())},P.$$arity=-1),e.def(X,"$register_prefix_from_super_class",x=function(){return this.$register_prefix(this.$superclass().$prefixes())},x.$$arity=0),e.def(X,"$prefixes_pattern",J=function(){var ie,re=this,me=u;return null==re.prefixes_pattern&&(re.prefixes_pattern=u),null==re.prefixes&&(re.prefixes=u),re.prefixes_pattern=i(ie=re.prefixes_pattern)?ie:u,i(re.prefixes_pattern)?re.prefixes_pattern:(re.prefixes=i(me=re.prefixes)?me:[],re.prefixes.$freeze(),re.prefixes_pattern=(i(re.prefixes["$empty?"]())?/(?!)/:e.regexp(["^(S)?(",re.prefixes.$join("|"),")"],"i")).$freeze())},J.$$arity=0),e.def(X,"$command_pattern",ee=function(){var re,me,ie=this,ve=u,le=u;return null==ie.command_pattern&&(ie.command_pattern=u),null==ie.prefixes&&(ie.prefixes=u),ie.command_pattern=i(me=ie.command_pattern)?me:u,i(ie.command_pattern)?ie.command_pattern:(ie.prefixes=i(ve=ie.prefixes)?ve:[],ie.prefixes.$freeze(),le=W(A(q(B(N,"CommonCommand"),"COMMANDS"),"map",[],((re=function(ae){return null==ae&&(ae=u),q(ae,"PREFIX_PATTERN").$source()}).$$s=ie,re.$$arity=1,re)),ie.prefixes),ie.command_pattern=e.regexp(["^S?(",le.$join("|"),")"],"i").$freeze())},ee.$$arity=0),e.def(X,"$eval",ne=function(re){return this.$new(re).$eval()},ne.$$arity=1),f.$include(B(n,"Translate")),f.$include(q(B(n,"Deprecated"),"Checker")),e.def(f,"$initialize",m=function(s){var N=this;return N.raw_input=s,N.sort_add_dice=!1,N.sort_barabara_dice=!1,N.d66_sort_type=q(B(n,"D66SortType"),"NO_SORT"),N.enabled_d9=!1,N.round_type=q(B(n,"RoundType"),"FLOOR"),N.sides_implicit_d=6,N.upper_dice_reroll_threshold=u,N.reroll_dice_reroll_threshold=u,N.default_cmp_op=u,N.default_target_number=u,N.enabled_upcase_input=!0,N.locale="ja_jp",N.randomizer=q(B(n,"BCDice"),"Randomizer").$new(),N.debug=!1},m.$$arity=1),f.$attr_accessor("randomizer"),f.$attr_reader("d66_sort_type"),f.$attr_reader("round_type"),f.$attr_reader("sides_implicit_d"),f.$attr_reader("upper_dice_reroll_threshold"),f.$attr_reader("reroll_dice_reroll_threshold"),f.$attr_reader("default_cmp_op"),f.$attr_reader("default_target_number"),e.def(f,"$sort_add_dice?",c=function(){return this.sort_add_dice},c.$$arity=0),e.def(f,"$sort_barabara_dice?",d=function(){return this.sort_barabara_dice},d.$$arity=0),e.def(f,"$enabled_d9?",k=function(){return this.enabled_d9},k.$$arity=0),e.def(f,"$enable_debug",b=function(){return this.debug=!0},b.$$arity=0),e.def(f,"$eval",p=function(){var N,P,x,s=this,J=u;return N=q(B(n,"BCDice"),"Preprocessor").$process(s.raw_input,s),P=i(x=s.$dice_command(N))?x:s.$eval_common_command(s.raw_input),i(P)?(J=[s.randomizer.$rand_results()],A(P,"rands=",e.to_a(J)),Z(J.length,1),J=[s.randomizer.$detailed_rand_results()],A(P,"detailed_rands=",e.to_a(J)),Z(J.length,1),P):u},p.$$arity=0),e.def(f,"$change_text",y=function(s){return s},y.$$arity=1),e.def(f,"$check_result",C=function(s,N,P,x){var J=this,ee=u,ne=u,de=u,re=u,ie=u;return ee=J.$check_result_legacy(s,N,P,x),i(ee)?ee:(ne=A(N,"map",[],"sides".$to_proc()),re=(de=A(N,"map",[],"value".$to_proc())).$sum(),(ee=[100]["$==="](ie=ne)?J.$result_1d100(s,re,P,x):[20]["$==="](ie)?J.$result_1d20(s,re,P,x):[6,6]["$==="](ie)?J.$result_2d6(s,re,de,P,x):u)["$=="](B(n,"Result").$nothing())?u:i(ee)?ee:(ie=ne.$uniq(),(ee=[10]["$==="](ie)?J.$result_nd10(s,re,de,P,x):[6]["$==="](ie)?J.$result_nd6(s,re,de,P,x):u)["$=="](B(n,"Result").$nothing())?u:i(ee)?ee:J.$result_ndx(s,P,x)))},C.$$arity=4),e.def(f,"$grich_text",Y=function(s,N,P){return u},Y.$$arity=3),f.$private(),e.def(f,"$eval_common_command",v=function(s){try{var N;return s=this.$change_text(s),A(q(B(n,"CommonCommand"),"COMMANDS"),"each",[],((N=function(J){var ne,ee=null==N.$$s?this:N.$$s;if(null==ee.randomizer&&(ee.randomizer=u),null==J&&(J=u),ne=J.$eval(s,ee,ee.randomizer),!i(ne))return u;e.ret(ne)}).$$s=this,N.$$arity=1,N)),u}catch(x){if(x===e.returner)return x.$v;throw x}},v.$$arity=1),e.def(f,"$dice_command",_=function(s){var N,P=this,x=u,J=u,ee=u,ne=u,de=u,re=u,ie=u;return i(P.enabled_upcase_input)&&(s=s.$upcase()),x=P.$class().$prefixes_pattern().$match(s),i(x)?(J=x["$[]"](1)["$nil?"]()["$!"](),i(J)&&(s=s["$[]"](K(1,-1,!1))),ee=P.$eval_game_system_specific_command(s),i(ee["$is_a?"](B(n,"Result")))?(ne=[i(de=ee["$secret?"]())?de:J],A(ee,"secret=",e.to_a(ne)),Z(ne.length,1),ee):i(i(re=i(ie=ee["$nil?"]())?ie:ee["$empty?"]())?re:ee["$=="]("1"))?u:A(B(n,"Result").$new(),"tap",[],((N=function(ve){return null==ve&&(ve=u),ne=[ee.$to_s()],A(ve,"text=",e.to_a(ne)),Z(ne.length,1),A(ve,"secret=",e.to_a(ne=[J])),ne[Z(ne.length,1)]}).$$s=P,N.$$arity=1,N))):u},_.$$arity=1),e.def(f,"$eval_game_system_specific_command",o=function(s){return u},o.$$arity=1),e.def(f,"$result_ndx",h=function(s,N,P){return i(P["$is_a?"](B(n,"String")))?u:i(s.$send(N,P))?B(n,"Result").$success(this.$translate("success")):B(n,"Result").$failure(this.$translate("failure"))},h.$$arity=3),e.def(f,"$result_1d100",D=function(s,N,P,x){return u},D.$$arity=4),e.def(f,"$result_1d20",I=function(s,N,P,x){return u},I.$$arity=4),e.def(f,"$result_nd10",a=function(s,N,P,x,J){return u},a.$$arity=5),e.def(f,"$result_2d6",S=function(s,N,P,x,J){return u},S.$$arity=5),e.def(f,"$result_nd6",Q=function(s,N,P,x,J){return u},Q.$$arity=5),e.def(f,"$get_table_by_2d6",te=function(s){return this.$get_table_by_nD6(s,2)},te.$$arity=1),e.def(f,"$get_table_by_1d6",$e=function(s){return this.$get_table_by_nD6(s,1)},$e.$$arity=1),e.def(f,"$get_table_by_nD6",ye=function(s,N){return this.$get_table_by_nDx(s,N,6)},ye.$$arity=2),e.def(f,"$get_table_by_nDx",ge=function(s,N,P){var J,ee=u;return J=this.randomizer.$roll_sum(N,P),ee=this.$get_table_value(s["$[]"](Z(J,N))),i(ee["$nil?"]())?["1",0]:[ee,J]},ge.$$arity=3),e.def(f,"$get_table_by_1d3",Te=function(s){var x,J,N=this,ee=u;return N.$debug("get_table_by_1d3"),x=N.randomizer.$roll_sum(1,6),N.$debug("num",x),J=function(T,G){return"number"==typeof T?T/2:T["$/"](2)}(Z(x,1)).$to_i(),N.$debug("index",J),ee=s["$[]"](J),i(ee["$nil?"]())?["1",0]:[ee,x]},Te.$$arity=1),e.def(f,"$get_table_by_d66_swap",Be=function(s){var P;return P=this.randomizer.$roll_d66(q(B(n,"D66SortType"),"ASC")),[this.$get_table_by_number(P,s),P]},Be.$$arity=1),e.def(f,"$get_table_by_d66",ze=function(s){var P,x,J,ne,ee=u;return P=this.randomizer.$roll_once(6),x=this.randomizer.$roll_once(6),J=W(function(T,G){return"number"==typeof T?6*T:T["$*"](6)}(Z(P,1)),Z(x,1)),ee=s["$[]"](J),ne=""+P+x,i(ee["$nil?"]())?["1",ne]:[ee,ne]},ze.$$arity=1),e.def(f,"$get_table_by_number",qe=function(s,N,P){try{var x;return null==P&&(P="1"),A(N,"each",[],((x=function(ne){var re,de=null==x.$$s?this:x.$$s;if(null==ne&&(ne=u),re=ne["$[]"](0),!i(function(T,G){return"number"==typeof T&&"number"==typeof G?T>=G:T["$>="](G)}(re,s)))return u;e.ret(de.$get_table_value(ne["$[]"](1)))}).$$s=this,x.$$arity=1,x)),this.$get_table_value(P)}catch(ee){if(ee===e.returner)return ee.$v;throw ee}},qe.$$arity=-3),e.def(f,"$get_table_value",Ae=function(s){return i(s["$is_a?"](B(n,"Proc")))?s.$call():s},Ae.$$arity=1),e.def(f,"$roll_tables",fe=function(s,N){var x=u;return x=N["$[]"](s),i(x)?x.$roll(this.randomizer).$to_s():u},fe.$$arity=2),e.def(f,"$debug",O=function(s,N){var x,J,ee=this,ne=u,de=u;return x=e.slice.call(arguments,1,arguments.length),i(ee.debug)?(ne=i(s["$is_a?"](B(n,"String")))?s:s.$inspect(),i(x["$empty?"]())?ee.$warn(ne):(de=A(x,"map",[],((J=function(ie){return null==ie&&(ie=u),i(ie["$is_a?"](B(n,"String")))?'"'+ie+'"':ie.$inspect()}).$$s=ee,J.$$arity=1,J)),ee.$warn(ne+": "+de.$join(", ")))):u},O.$$arity=-2),q(q(B(V,"I18n"),"Backend"),"Simple").$include(q(q(B(V,"I18n"),"Backend"),"Fallbacks")),B(V,"I18n").$load_path()["$<<"](B(V,"Dir")["$[]"](B(V,"File").$join($.$__dir__(),"../../i18n/**/*.yml"))),l=["ja_jp"],A(B(V,"I18n"),"default_locale=",e.to_a(l)),Z(l.length,1),l=[["ja_jp"]],A(B(V,"I18n").$fallbacks(),"defaults=",e.to_a(l)),l[Z(l.length,1)]},Opal.modules["bcdice/game_system/DesperateRun"]=function(e){function W(l,T){return"number"==typeof l&&"number"==typeof T?l+T:l["$+"](T)}function w(l,T){return"number"==typeof l&&"number"==typeof T?l-T:l["$-"](T)}var T,H,m,k,b,p,y,c,d,E,U,g=[],$=e.nil,V=e.$$$,u=e.$$,q=e.module,B=e.klass,t=e.hash2,z=e.send2,i=e.truthy,A=e.range,K=e.send;return e.top.$require("bcdice/base"),T=g,H=U=[q(g[0],"BCDice")].concat(T),m=E=[q(U[0],"GameSystem")].concat(H),c=B(E[0],u(E,"Base"),"DesperateRun"),d=[c].concat(m),c.$$prototype.randomizer=$,e.const_set(d[0],"ID","DesperateRun"),e.const_set(d[0],"NAME","Desperate Run TRPG"),e.const_set(d[0],"SORT_KEY","\u3066\u3059\u3078\u308c\u3044\u3068\u3089\u3093TRPG"),e.const_set(d[0],"HELP_MESSAGE","\u30fb\u96e3\u6613\u5ea6\u7b97\u51fa\u30b3\u30de\u30f3\u30c9\u3000DDC\n\u30fb\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\u3000RCx\u3000or\u3000RCx+y\u3000or\u3000RCx-y\uff08x\uff1d\u96e3\u6613\u5ea6\u3001y=\u4fee\u6b63\u5024\uff08\u7701\u7565\u53ef\u80fd\uff09\uff09\n\u30fb\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u8868\u3000ACT\n\u30fb\u521d\u671f\u30a2\u30a4\u30c6\u30e0\u8868\u3000ITEMT\n\u30fb\u52d5\u6a5f\u8868\u3000DOUKIT\n\u30fb\u6b7b\u4ea1\u30d5\u30e9\u30b0\u53f0\u8a5e\u8868\u3000FLAGT\n\u30fb\u9014\u4e2d\u53c2\u52a0\u52d5\u6a5f\u8868\u3000ENTRYT\n\u30fb\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868\u3000ROADT\n"),e.const_set(d[0],"TABLES",t(["ACT","ITEMT","DOUKIT","FLAGT","ENTRYT","ROADT"],{ACT:V(u(d,"DiceTable"),"Table").$new("\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u8868","1D6",["PC\u5168\u54e1\u3001\u968a\u5217\u30921D6\u3067\u6c7a\u3081\u308b\uff0812\uff1a\u524d\u5217\u300134\uff1a\u4e2d\u5217\u300156\uff1a\u5f8c\u5217\uff09","1\u30bf\u30fc\u30f3\u3001\u30e2\u30f3\u30b9\u30bf\u30fc\u5074\u306e\u307f\u884c\u52d5\u3059\u308b\u3002","\u3053\u306e\u6226\u95d8\u306e\u884c\u52d5\u9806\u304c\u3001PC\u2192\u30e2\u30f3\u30b9\u30bf\u30fc\u3001\u304b\u3089\u3001\u30e2\u30f3\u30b9\u30bf\u30fc\u2192PC\u306b\u5909\u308f\u308b\u3002","PC\u5168\u54e1\u3001\u30a2\u30a4\u30c6\u30e01\u3064\u3092\u9078\u3093\u3067\u5931\u3046\u3002","PC\u5168\u54e11D6\u3092\u632f\u308b\u3002\u3053\u306e\u6226\u95d8\u4e2d\u3001\u305d\u306e\u51fa\u76ee\u306f\u30ce\u30fc\u30d7\u30e9\u30f3\u306b\u306a\u308b\u3002","PC\u5168\u54e1\u3001Flag\u304c1\u5897\u52a0\u3059\u308b\u3002"]),ITEMT:V(u(d,"DiceTable"),"Table").$new("\u521d\u671f\u30a2\u30a4\u30c6\u30e0\u8868","2D6",["\u30ed\u30b1\u30c3\u30c8\u30e9\u30f3\u30c1\u30e3\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30de\u30ab\u30d6\u30ebLv+3\u3000\u56de\u6570\uff1a\u653b\u64831\u56de","\u30ad\u30fc\u30d4\u30c3\u30af\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30e0\u30fc\u30d6\u30b7\u30fc\u30f3\u3067\u4f7f\u7528\u53ef\u3002\u5224\u5b9a\u306e\u51fa\u76ee\u306e\u5408\u8a08+1\u3000\u56de\u6570\uff1a2\u56de","\u30ec\u30fc\u30c0\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30ce\u30fc\u30d7\u30e9\u30f3\u3000\u88c5\u5099\u6642\u3001\u300c\u5371\u967a\u300d\u30921\u6e1b\u3089\u3059\u3053\u3068\u304c\u51fa\u6765\u308b\u3000\u56de\u6570\uff1a\u5371\u967a\u6e1b\u5c112\u56de","\u98df\u6599\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30e0\u30fc\u30d6\u30b7\u30fc\u30f3\u3067\u4f7f\u7528\u53ef\u3002Life3\u56de\u5fa9\u3000\u56de\u6570\uff1a1\u56de","\u5fdc\u6025\u30ad\u30c3\u30c8\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30e1\u30c7\u30a3\u30ab\u30ebLv+1\u3000\u56de\u6570\uff1a\u56de\u5fa93\u56de","\u5203\u7269\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30a2\u30bf\u30c3\u30afLv+1\u3000\u56de\u6570\uff1a\u653b\u64836\u56de","\u9283\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30b7\u30e5\u30fc\u30c8Lv+1\u3000\u56de\u6570\uff1a\u653b\u64836\u56de","\u30c9\u30e9\u30c3\u30b0\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u3044\u3064\u3067\u3082\u4f7f\u7528\u53ef\u3002Brave1\u56de\u5fa9\u3000\u56de\u6570\uff1a1\u56de","\u91d1\u5238\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30a2\u30d5\u30bf\u30fc\u30d7\u30ec\u30a4\u3067\u4f7f\u7528\u53ef\u3002\u7d4c\u9a13\u70b9+2\u3000\u56de\u6570\uff1a1\u56de","\u30d7\u30ed\u30c6\u30af\u30bf\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30ac\u30fc\u30c9Lv+1\u3000\u56de\u6570\uff1a\u9632\u5fa15\u56de","\u30c8\u30df\u30fc\u30ac\u30f3\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30c1\u30a7\u30fc\u30f3Lv+5\u3000\u56de\u6570\uff1a\u653b\u64831\u56de"]),DOUKIT:V(u(d,"DiceTable"),"Table").$new("\u52d5\u6a5f\u8868","1D6",["\u96b7\u5c5e\u3002\u4f55\u304b\u5f31\u307f\u306b\u4ed8\u3051\u8fbc\u307e\u308c\u3001\u5acc\u3005\u306a\u304c\u3089\u3082\u53c2\u52a0\u3059\u308b\u3053\u3068\u3068\u306a\u308b\u3002\u5f8c\u308d\u3081\u305f\u3044\u4e8b\u3001\u501f\u91d1\u3001\u306a\u3069\u3002","\u732e\u8eab\u3002\u3053\u306e\u756a\u7d44\u306f\u8ab0\u304b\u306e\u305f\u3081\u306b\u51fa\u3066\u3044\u308b\u3002\u75c5\u6c17\u306e\u5bb6\u65cf\u3092\u6551\u3046\u305f\u3081\u3001\u53c2\u52a0\u8005\u306e\u4e00\u4eba\u304c\u604b\u4eba\u3067\u3042\u308b\u3001\u306a\u3069\u3002","\u6210\u884c\u3002\u671b\u3093\u3067\u3044\u306a\u3044\u306e\u306b\u53c2\u52a0\u3059\u308b\u3053\u3068\u3068\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u3002\u8ab0\u304b\u304c\u52dd\u624b\u306b\u7533\u3057\u8fbc\u3093\u3060\u3001\u7d1b\u308c\u8fbc\u3093\u3067\u3057\u307e\u3063\u305f\u3001\u306a\u3069\u3002","\u6e07\u671b\u3002\u3068\u306b\u304b\u304f\u4f55\u304b\u3092\u6b32\u3057\u3066\u53c2\u52a0\u3057\u3066\u3044\u308b\u3002\u91d1\u3001\u30b9\u30ea\u30eb\u3001\u91d1\u3067\u624b\u306b\u5165\u308b\u3082\u306e\u3001\u306a\u3069\u3002","\u5947\u4eba\u3002\u597d\u304d\u597d\u3093\u3067\u3053\u306e\u756a\u7d44\u306b\u51fa\u3066\u3044\u308b\u3002\u6bba\u4eba\u7656\u3001\u30ca\u30eb\u30b7\u30b9\u30c8\u3001\u81ea\u6bba\u9858\u671b\u3001\u5316\u3051\u7269\u30de\u30cb\u30a2\u3001\u306a\u3069\u3002","\u4ed5\u4e8b\u3002\u3053\u306e\u756a\u7d44\u306b\u51fa\u308b\u306e\u306f\u4ed5\u4e8b\u3060\u304b\u3089\u3060\u3002\u8cde\u91d1\u7a3c\u304e\u3001\u82b8\u80fd\u4eba\u3001\u8a18\u8005\u3001\u756a\u7d44\u30b9\u30bf\u30c3\u30d5\u3001\u306a\u3069\u3002"]),FLAGT:V(u(d,"DiceTable"),"Table").$new("\u6b7b\u4ea1\u30d5\u30e9\u30b0\u53f0\u8a5e\u8868","1D6",["\u5e0c\u671b\u3002\u300c\u3053\u308c\u304c\u7d42\u308f\u3063\u305f\u3089\u3001\u4e00\u7dd2\u306b\u9152\u3067\u3082\u98f2\u3082\u3046\u3084\u300d\u300c\u3082\u3046\u4f55\u3082\u6016\u304f\u306a\u3044\u300d\u306a\u3069\u3002","\u671b\u90f7\u3002\u300c\u304f\u305d\u3063\u3001\u3001\u3001\u4ffa\u306b\u306f\u3001\u5e30\u308a\u3092\u5f85\u3064\u4eba\u304c\u3001\u3001\u3001\u3063\uff01\u300d\u300c\u3042\u3042\u3001\u6545\u90f7\u306e\u30de\u30eb\u30b2\u30ea\u30fc\u30bf\u3092\u3082\u3046\u4e00\u5ea6\u98df\u3079\u305f\u304b\u3063\u305f\u3001\u3001\u3001\u300d\u306a\u3069\u3002","\u72c2\u4e71\u3002\u300c\u304a\u524d\u3092\u3001\u6bba\u305b\u3070\u3001\u4ffa\u306f\u3001\u5104\u4e07\u9577\u8005\u306a\u3093\u3060\u3088\u3049\u3049\u3049\u304a\uff01\uff01\u300d\u300c\u30d2\u30cf\u30c3\u3001\u6b7b\u306d\u6b7b\u306d\u6b7b\u306d\u6b7b\u306d\u3047\u3047\u3047\u3047\u300d\u306a\u3069\u3002","\u7d76\u671b\u3002\u300c\u3082\u3046\u3060\u3081\u3060\u3041\u3001\u3001\u3001\u304a\u3057\u307e\u3044\u3060\u3041\u3001\u3001\u3001\u300d\u300c\u304f\u3001\u304f\u308b\u306a\u3063\u3001\u304f\u308b\u306a\u3041\u3041\u3041\u3041\uff01\uff01\u300d\u306a\u3069\u3002","\u6162\u5fc3\u3002\u300c\u306a\u3093\u3060\u3001\u3053\u3093\u306a\u3084\u3064\u3001\u4ffa\u3060\u3051\u3067\u5341\u5206\u3060\u300d\u300c\u5927\u4e08\u592b\u3060\u3001\u554f\u984c\u306a\u3044\u300d\u306a\u3069\u3002","\u72a0\u7272\u3002\u300c\u3075\u3075\u3001\u4ffa\u306a\u3089\u5927\u4e08\u592b\u3060\u3001\u3001\u3001\u6c17\u306b\u3059\u308b\u306a\u300d\u300c\u304a\u524d\u3089\u4e0b\u304c\u308c\u3063\uff01\u3053\u3053\u306f\u4ffa\u306b\u4efb\u305b\u308d\uff01\u300d\u306a\u3069\u3002"]),ENTRYT:V(u(d,"DiceTable"),"Table").$new("\u9014\u4e2d\u53c2\u52a0\u52d5\u6a5f\u8868","1D6",["\u9045\u523b\u3002\u3082\u3068\u3082\u3068\u53c2\u52a0\u3059\u308b\u4e88\u5b9a\u3060\u3063\u305f\u306e\u3060\u304c\u9045\u308c\u3066\u3057\u307e\u3063\u305f\u3002\u4eca\u304b\u3089\u3067\u3082\u8d70\u308c\u3068\u7121\u7406\u77e2\u7406\u53c2\u52a0\u3002","\u73fe\u4f4f\u3002\u3082\u3068\u3082\u3068\u3053\u3053\u306b\u4f4f\u3093\u3067\u3044\u305f\u3002\u4f55\uff1f\u756a\u7d44\uff1f\u3048\uff1f\u3042\u3001\u304a\u91d1\u3082\u3089\u3048\u3093\u306e\uff1f\u30a4\u30a4\u30cd\uff01","\u7a81\u767a\u3002\u3082\u3068\u3082\u3068\u8996\u8074\u8005\u3068\u3057\u3066\u30b9\u30bf\u30b8\u30aa\u306b\u5c45\u305f\u3093\u3060\u3051\u3069\u3001\u53f8\u4f1a\u306b\u3046\u307e\u304f\u4e57\u305b\u3089\u308c\u3066\u30fb\u30fb\u30fb","\u4e71\u5165\u3002\u4f55\u304b\u76ee\u7684\u304c\u3042\u3063\u3066\u4e71\u5165\u3057\u305f\u3002\u4eca\u56de\u306e\u30b9\u30c6\u30fc\u30b8\u304c\u7c21\u5358\u306b\u898b\u3048\u305f\u308a\u3001\u53c2\u52a0\u8005\u306b\u5927\u4e8b\u306a\u4eba\u304c\u3044\u305f\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002","\u795e\u96a0\u3002\u4eca\u56de\u3088\u308a\u524d\u306e\u756a\u7d44\u306b\u53c2\u52a0\u3057\u3066\u3044\u305f\u304c\u884c\u65b9\u4e0d\u660e\u30fb\u6b7b\u3093\u3060\u3068\u601d\u308f\u308c\u3066\u3044\u305f\u3002\u304c\u3002\u541b\u306f\u307e\u3060\u3053\u3053\u306b\u3044\u308b\u3002","\u8077\u54e1\u3002\u3042\u308c\u3001\u9003\u3052\u9045\u308c\u307e\u3057\u305f\uff1f\u3042\u3089\u3042\u3089\u3001\u5927\u5909\u3067\u3059\u306d\u3001\u3057\u3087\u3046\u304c\u306a\u3044\u304b\u3089\u53c2\u52a0\u8005\u3055\u3093\u3068\u4e00\u7dd2\u306b\u8d70\u3063\u3066\u304f\u3060\u3055\u3044\u3002"]),ROADT:V(u(d,"DiceTable"),"Table").$new("\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868","1D6",["\u6b7b\u7dda\u3002\u6b7b\u306c\u304b\u3068\u601d\u3063\u305f\u3002Flag+1","\u602a\u6211\u3002\u75db\u3044\u3002Life-1","\u5931\u610f\u3002\u3069\u3046\u3057\u3066\u3053\u3046\u306a\u3063\u305f\u3002Brave-1\u3002\u6e1b\u3089\u305b\u306a\u3044\u5834\u5408\u3001Flag+1","\u7d1b\u5931\u3002\u3069\u3063\u304b\u3044\u3063\u305f\u3002Item\u3092\u3069\u308c\u304b1\u3064\u6368\u3066\u308b\u3002\u6368\u3066\u308c\u306a\u3044\u5834\u5408\u3001Flag+1","\u8ffd\u5c3e\u3002\u5f8c\u308d\uff01\u5f8c\u308d\u30fc\u3063\uff01\u53c2\u52a0\u958b\u59cb\u90e8\u5c4b\u306e\u5371\u967a+1","\u8ff7\u5b50\u3002\u3042\u308c\u3001\u3053\u3053\u3069\u3053\u3060\uff1f\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868\u3092\u632f\u308b\u56de\u6570+2"])}).$freeze()),c.$register_prefix("RC","DDC",u(d,"TABLES").$keys()),e.def(c,"$initialize",k=function(Y){var o=this;return k.$$p&&(k.$$p=null),z(o,e.find_super_dispatcher(o,"initialize",k,!1,!0),"initialize",[Y],null),o.sort_add_dice=!0,o.d66_sort_type=V(u(d,"D66SortType"),"ASC")},k.$$arity=1),c.$private(),e.def(c,"$eval_game_system_specific_command",b=function(Y){var _,o,v=this;return i(_=i(o=v.$check_roll(Y))?o:v.$ddc_table(Y))?_:v.$roll_tables(Y,V(v.$class(),"TABLES"))},b.$$arity=1),e.def(c,"$check_roll",p=function(Y){var v,_,D=$,I=$,a=$,S=$,Q=$,te=$,$e=$,ye=$,Te=$;return D=V(u(d,"Command"),"Parser").$new(/RC\d+/,t(["round_type"],{round_type:this.$round_type()})).$restrict_cmp_op_to($).$parse(Y),i(D)?(_=this.randomizer.$roll_barabara(2,6),S=W(I=null==(v=e.to_ary(_))[0]?$:v[0],a=null==v[1]?$:v[1]),Q=W(W(I,a),D.$modify_number()),te=D.$command()["$[]"](A(2,-1,!1)).$to_i(),i(D.$modify_number()["$!="](0))&&($e="\u3000\u4fee\u6b63\u5024\uff1a"+D.$modify_number()),ye=I["$=="](a)?u(d,"Result").$critical("\u30be\u30ed\u76ee\uff01\u3010Critical\u3011"):S["$=="](7)?u(d,"Result").$fumble("\u30c0\u30a4\u30b9\u306e\u51fa\u76ee\u304c\u8868\u88cf\uff01\u3010Fumble\u3011"):i(function(l,T){return"number"==typeof l&&"number"==typeof T?l>=T:l["$>="](T)}(Q,te))?u(d,"Result").$success(Q+"\u3001\u96e3\u6613\u5ea6\u4ee5\u4e0a\uff01\u3010Success\u3011"):u(d,"Result").$failure(Q+"\u3001\u96e3\u6613\u5ea6\u672a\u6e80\uff01\u3010Miss\u3011"),Te=[["\u5224\u5b9a\u3000\u96e3\u6613\u5ea6\uff1a"+te+$e,"\u51fa\u76ee\uff1a"+I+"\u3001"+a,ye.$text()].$join(" \uff1e ")],K(ye,"text=",e.to_a(Te)),w(Te.length,1),ye):$},p.$$arity=1),void e.def(c,"$ddc_table",y=function(Y){var v,_,h=$,D=$,I=$,a=$,S=$;return i(Y["$!="]("DDC"))?$:(_=this.randomizer.$roll_barabara(2,6),_=[h=null==(v=e.to_ary(_))[0]?$:v[0],D=null==v[1]?$:v[1]].$sort(),"\u96e3\u6613\u5ea6\u6c7a\u5b9a \uff1e \u51fa\u76ee\uff1a"+h+"\u3001"+D+" \uff1e "+(a=null==(v=e.to_ary(_))[1]?$:v[1])+"-"+(I=null==v[0]?$:v[0])+"="+(S=w(a,I))+" \uff1e \u96e3\u6613\u5ea6"+W(5,S))},y.$$arity=1)},Z=[],r=(e=Opal).$$$,g=e.$$,$=e.module,V=e.klass,u=e.hash2,e.top.$require("bcdice/game_system/DesperateRun"),B=Z,A=z=[$(Z[0],"BCDice")].concat(B),U=l=[$(z[0],"GameSystem")].concat(A),H=[R=V(l[0],g(l,"DesperateRun"),"JekyllAndHyde")].concat(U),e.const_set(H[0],"ID","JekyllAndHyde"),e.const_set(H[0],"NAME","\u30b8\u30ad\u30eb\u3068\u30cf\u30a4\u30c9\u3068\u30b0\u30ea\u30c8\u30b0\u30e9"),e.const_set(H[0],"SORT_KEY","\u3057\u304d\u308b\u3068\u306f\u3044\u3068\u3068\u304f\u308a\u3068\u304f\u3089"),e.const_set(H[0],"HELP_MESSAGE","\u30fb\u96e3\u6613\u5ea6\u7b97\u51fa\u30b3\u30de\u30f3\u30c9\u3000DDC\n\u30fb\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\u3000RCx\u3000or\u3000RCx+y\u3000or\u3000RCx-y\uff08x\uff1d\u96e3\u6613\u5ea6\u3001y=\u4fee\u6b63\u5024\uff08\u7701\u7565\u53ef\u80fd\uff09\uff09\n\u30fb\u76ee\u6a19\u6c7a\u5b9a\u8868\u3000GOALT\n"),e.const_set(H[0],"TABLES",u(["GOALT"],{GOALT:r(g(H,"DiceTable"),"Table").$new("\u76ee\u6a19\u6c7a\u5b9a\u8868","1D6",["\u300c\u4e3b\u4eba\u683c\u306e\u76ee\u7684\u9054\u6210\u300d","\u300c\u4e3b\u4eba\u683c\u306e\u76ee\u7684\u963b\u5bb3\u300d","\u300c\u4e3b\u4eba\u683c\u306e\u30cf\u30c3\u30d4\u30fc\u30a8\u30f3\u30c9\uff08\u76ee\u7684\u9054\u6210\u3057\u306a\u304f\u3066\u3082\u3088\u3044\uff09\u300d","\u300c\u4e3b\u4eba\u683c\u306e\u30d0\u30c3\u30c9\u30a8\u30f3\u30c9\uff08\u76ee\u7684\u9054\u6210\u3057\u3066\u3044\u3066\u3082\u3088\u3044\uff09\u300d","\u300c\u81ea\u5206\u306e\u4eba\u683c\u304c\u76ee\u7684\u3092\u6c7a\u5b9a\u3067\u304d\u308b\u300d","\u300c\u4e3b\u4eba\u683c\u306e\u76ee\u7684\u9054\u6210\u300d\u300c\u4e3b\u4eba\u683c\u306e\u76ee\u7684\u963b\u5bb3\u300d\u300c\u4e3b\u4eba\u683c\u306e\u30cf\u30c3\u30d4\u30fc\u30a8\u30f3\u30c9\uff08\u76ee\u7684\u9054\u6210\u3057\u306a\u304f\u3066\u3082\u3088\u3044\uff09\u300d\u300c\u4e3b\u4eba\u683c\u306e\u30d0\u30c3\u30c9\u30a8\u30f3\u30c9\uff08\u76ee\u7684\u9054\u6210\u3057\u3066\u3044\u3066\u3082\u3088\u3044\uff09\u300d\u300c\u81ea\u5206\u306e\u4eba\u683c\u304c\u76ee\u7684\u3092\u6c7a\u5b9a\u3067\u304d\u308b\u300d\u306e\u3069\u308c\u304b\u3092\u81ea\u7531\u306b\u9078\u3079\u308b"])}).$freeze()),R.$register_prefix("RC","DDC",g(H,"TABLES").$keys())}}]);