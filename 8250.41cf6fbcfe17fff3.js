(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[8250],{8250:(pe,ye,ge)=>{ge(9993),Opal.modules["i18n/backend/fallbacks"]=function(r){var M,l,B,G,j,_,Y=[],i=r.nil,t=r.$$$,e=r.module,p=r.class_variable_set,C=r.truthy,V=r.class_variable_get,s=r.def,F=r.send,I=r.to_a,y=r.rb_minus,w=r.send2,H=r.find_super,L=r.hash2,K=r.find_block_super,Q=r.neqeq;return M=Y,_=[j=e(Y[0],"I18n")].concat(M),p(_[0],"@@fallbacks",i),l=r.get_singleton_class(j),B=[l].concat(_),G=r.$r(B),s(l,"$fallbacks",function(){var q=i;return p(B[1],"@@fallbacks",C(null!=B[1].$$cvars["@@fallbacks"]?"class variable":i)&&C(q=V(B[1],"@@fallbacks",!1))?q:t(t(G("I18n"),"Locale"),"Fallbacks").$new()),C(q=G("Thread").$current()["$[]"]("i18n_fallbacks"))?q:V(B[1],"@@fallbacks",!1)},0),s(l,"$fallbacks=",function(m){var q;return p(B[1],"@@fallbacks",C(m["$is_a?"](G("Array")))?t(t(G("I18n"),"Locale"),"Fallbacks").$new(m):m),q=["i18n_fallbacks",V(B[1],"@@fallbacks",!1)],F(G("Thread").$current(),"[]=",I(q)),q[y(q.length,1)]},1),function(l,P){var m,q,b,v,G=[e(l,"Backend")].concat(P);return m=G,b=[q=e(G[0],"Fallbacks")].concat(m),v=r.$r(b),s(q,"$translate",function f(u,c,$){try{var n=f.$$p||i,a=this,h=i,E=i;return delete f.$$p,null==$&&($=v("EMPTY_HASH")),C($.$fetch("fallback",!0))?C($["$[]"]("fallback_in_progress"))?w(a,H(a,"translate",f,!1,!0),"translate",[u,c,$],n):(C($["$[]"]("default"))&&(h=a["$extract_non_symbol_default!"]($)),E=$.$merge(L(["fallback_in_progress"],{fallback_in_progress:!0})),F(v("I18n").$fallbacks()["$[]"](u),"each",[],function d(N){var A=null==d.$$s?this:d.$$s;null==N&&(N=i);try{return F(A,"catch",["exception"],function ee(){var o=null==ee.$$s?this:ee.$$s,J=i;if(J=w(o,K(o,"translate",ee.$$def||d.$$def||f,!1,!1),"translate",[N,c,E],null),C(J["$nil?"]()))return i;Q(u.$to_s(),N.$to_s())&&o.$on_fallback(u,N,c,$),r.ret(J)},{$$arity:0,$$s:A})}catch(ee){if(!r.rescue(ee,[t(v("I18n"),"InvalidLocale")]))throw ee;try{return i}finally{r.pop_exception()}}},{$$arity:1,$$s:a}),C($["$key?"]("default"))&&C($["$[]"]("default")["$nil?"]())?i:C(h)?w(a,H(a,"translate",f,!1,!0),"translate",[u,i,$.$merge(L(["default"],{default:h}))],null):a.$throw("exception",t(v("I18n"),"MissingTranslation").$new(u,c,$))):w(a,H(a,"translate",f,!1,!0),"translate",[u,c,$],n)}catch(d){if(d===r.returner)return d.$v;throw d}},-3),s(q,"$extract_non_symbol_default!",function(u){var $,c=i,n=i;return c=[u["$[]"]("default")].$flatten(),$=F(c,"detect",[],function(h){return null==h&&(h=i),h["$is_a?"](v("Symbol"))["$!"]()},1),C($)&&(n=["default",c["$[]"](0,c.$index($))],F(u,"[]=",I(n)),y(n.length,1)),$},1),s(q,"$exists?",function f(u,c,$){try{var n=f.$$p||i,a=this;return delete f.$$p,null==$&&($=v("EMPTY_HASH")),C($.$fetch("fallback",!0))?(F(v("I18n").$fallbacks()["$[]"](u),"each",[],function h(E){var d=null==h.$$s?this:h.$$s;null==E&&(E=i);try{if(!C(w(d,K(d,"exists?",h.$$def||f,!1,!1),"exists?",[E,c],null)))return i;r.ret(!0)}catch(N){if(!r.rescue(N,[t(v("I18n"),"InvalidLocale")]))throw N;try{return i}finally{r.pop_exception()}}},{$$arity:1,$$s:a}),!1):w(a,H(a,"exists?",f,!1,!0),"exists?",[u,c,$],n)}catch(h){if(h===r.returner)return h.$v;throw h}},-3),q.$private(),s(q,"$on_fallback",function(u,c,$,n){return i},4)}(_[0],_)},Opal.modules["bcdice/randomizer"]=function(r){var j,x,m,q,b,v,l,P,Y=[],i=r.nil,t=r.$$$,p=r.klass,C=r.const_set,V=r.def,s=r.truthy,F=r.rb_gt,I=r.rb_plus,y=r.rb_le,w=r.send,H=r.rb_minus,L=r.eqeq,K=r.rb_times,Q=r.eqeqeq,ie=r.rb_ge;return j=Y,l=[(0,r.module)(Y[0],"BCDice")].concat(j),P=r.$r(l),x=l,q=[m=p(l[0],null,"Randomizer")].concat(x),b=r.$r(q),(v=m.$$prototype).rand_results=v.detailed_rand_results=i,C(q[0],"UPPER_LIMIT_DICE_TIMES",200),C(q[0],"UPPER_LIMIT_DICE_SIDES",1e4),C(q[0],"UPPER_LIMIT_RANDS",1e4),V(m,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]},0),m.$attr_reader("rand_results"),m.$attr_reader("detailed_rand_results"),C(q[0],"DetailedRandResult",b("Struct").$new("kind","sides","value")),V(m,"$roll_barabara",function(u,c){var $=this;return s(F(I($.rand_results.$size(),u),b("UPPER_LIMIT_RANDS")))&&$.$raise(b("TooManyRandsError")),s(y(u,0))||s(F(u,b("UPPER_LIMIT_DICE_TIMES")))?[]:w(b("Array"),"new",[u],function n(){return(null==n.$$s?this:n.$$s).$roll_once(c)},{$$arity:0,$$s:$})},2),V(m,"$roll_sum",function(u,c){return this.$roll_barabara(u,c).$sum()},2),V(m,"$roll_once",function(u){var $=i;return s(y(u,0))||s(F(u,b("UPPER_LIMIT_DICE_SIDES")))?0:($=this.$rand_inner(u),this.$push_to_detail("normal",u,$),$)},1),V(m,"$roll_index",function(u){return H(this.$roll_once(u),1)},1),V(m,"$roll_tens_d10",function(){var $,c=i;return c=this.$rand_inner(10),L(c,10)&&(c=0),$=K(c,10),this.$push_to_detail("tens_d10",10,$),$},0),V(m,"$roll_d9",function(){var c;return c=H(this.$rand_inner(10),1),this.$push_to_detail("d9",10,c),c},0),V(m,"$roll_d66",function(u){var n,$=i;return $=w(b("Array"),"new",[2],function a(){return(null==a.$$s?this:a.$$s).$roll_once(6)},{$$arity:0,$$s:this}),Q(t(b("D66SortType"),"ASC"),n=u)?$["$sort!"]():Q(t(b("D66SortType"),"DESC"),n)&&$["$sort!"]()["$reverse!"](),I(K($["$[]"](0),10),$["$[]"](1))},1),m.$private(),V(m,"$rand_inner",function(u){var $,c=this;return s(ie(c.rand_results.$size(),b("UPPER_LIMIT_RANDS")))&&c.$raise(b("TooManyRandsError")),$=c.$random(u),c.rand_results["$<<"]([$,u]),$},1),V(m,"$random",function(u){return I(b("Kernel").$rand(u),1)},1),V(m,"$push_to_detail",function(u,c,$){var a;return a=b("DetailedRandResult").$new(u,c,$),this.detailed_rand_results.$push(a)},3),p(l[0],P("StandardError"),"TooManyRandsError"),i},Opal.modules["bcdice/dice_table/roll_result"]=function(r){var s,w,ie,M,j,_,l,L,I,Y=[],i=r.nil,t=r.module,e=r.klass,p=r.def,C=r.truthy;return s=Y,w=I=[t(Y[0],"BCDice")].concat(s),ie=L=[t(I[0],"DiceTable")].concat(w),j=[M=e(L[0],null,"RollResult")].concat(ie),_=r.$r(j),(l=M.$$prototype).table_name=l.value=l.body=i,p(M,"$initialize",function(B,G,x){var m=this;return m.table_name=B,m.value=G,m.body=x},3),M.$attr_reader("table_name"),M.$attr_reader("value"),M.$attr_reader("body"),p(M,"$to_s",function(){var B=this;return B.table_name+"("+B.value+") \uff1e "+B.body},0),p(M,"$last_body",function(){var B=this;return C(B.body["$is_a?"](_("RollResult")))?B.body.$last_body():B.body},0),p(M,"$empty?",function(){return!1},0)},Opal.modules["bcdice/dice_table/chain_table"]=function(r){var F,H,M,j,_,l,P,K,y,Y=[],i=r.nil,t=r.module,e=r.klass,p=r.truthy,C=r.def,V=r.rb_minus;return F=Y,H=y=[t(Y[0],"BCDice")].concat(F),M=K=[t(y[0],"DiceTable")].concat(H),_=[j=e(K[0],null,"ChainTable")].concat(M),l=r.$r(_),(P=j.$$prototype).times=P.sides=P.items=P.name=i,C(j,"$initialize",function(G,x,m){var q=this,b=i;return q.name=G,q.items=m.$freeze(),b=/(\d+)D(\d+)/i.$match(x),p(b)||q.$raise(l("ArgumentError"),"Unexpected table type: "+x),q.times=b["$[]"](1).$to_i(),q.sides=b["$[]"](2).$to_i()},3),C(j,"$roll",function(G){var m,q,x=this,b=i;return m=G.$roll_sum(x.times,x.sides),q=V(m,x.times),b=x.items["$[]"](q),p(b["$respond_to?"]("roll"))&&(b=b.$roll(G)),l("RollResult").$new(x.name,m,b)},1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(r){var w,Q,l,P,B,G,x,M,L,Y=[],i=r.nil,t=r.module,e=r.klass,p=r.hash2,C=r.defs,V=r.def,s=r.rb_plus,F=r.rb_times,I=r.rb_minus;return w=Y,Q=L=[t(Y[0],"BCDice")].concat(w),l=M=[t(L[0],"DiceTable")].concat(Q),B=[P=e(M[0],null,"D66GridTable")].concat(l),G=r.$r(B),(x=P.$$prototype).name=x.items=i,C(P,"$from_i18n",function(q,b){var f=i;return f=G("I18n").$t(q,p(["locale","raise"],{locale:b,raise:!0})),this.$new(f["$[]"]("name"),f["$[]"]("items"))},2),V(P,"$initialize",function(q,b){return this.name=q,this.items=b.$freeze()},2),V(P,"$roll",function(q){var v,f,u,c,$;return v=q.$roll_once(6),f=q.$roll_once(6),u=s(F(v,10),f),c=I(v,1),$=I(f,1),G("RollResult").$new(this.name,u,this.items["$[]"](c)["$[]"]($))},1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(r){var I,L,_,l,P,B,Q,ie,w,i=[],t=r.nil,e=r.module,p=r.klass,C=r.hash2,V=r.defs,s=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),I=i,L=w=[e(i[0],"BCDice")].concat(I),Q=[e(w[0],"DiceTable")].concat(L),ie=r.$r(Q),_=Q,P=[l=p(Q[0],ie("D66GridTable"),"D66HalfGridTable")].concat(_),B=r.$r(P),V(l,"$from_i18n",function(x,m){var b=t;return b=B("I18n").$t(x,C(["locale","raise"],{locale:m,raise:!0})),this.$new(b["$[]"]("name"),b["$[]"]("items_1_2_3"),b["$[]"]("items_4_5_6"))},2),s(l,"$initialize",function(x,m,q){return this.name=x,this.items=[m,m,m,q,q,q].$freeze()},3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(r){var I,L,_,l,P,B,Q,ie,w,i=[],t=r.nil,e=r.module,p=r.klass,C=r.hash2,V=r.defs,s=r.def;return r.top.$require("bcdice/dice_table/d66_grid_table"),I=i,L=w=[e(i[0],"BCDice")].concat(I),Q=[e(w[0],"DiceTable")].concat(L),ie=r.$r(Q),_=Q,P=[l=p(Q[0],ie("D66GridTable"),"D66OneThirdTable")].concat(_),B=r.$r(P),V(l,"$from_i18n",function(x,m){var b=t;return b=B("I18n").$t(x,C(["locale","raise"],{locale:m,raise:!0})),this.$new(b["$[]"]("name"),b["$[]"]("items_1_2"),b["$[]"]("items_3_4"),b["$[]"]("items_5_6"))},2),s(l,"$initialize",function(x,m,q,b){return this.name=x,this.items=[m,m,q,q,b,b].$freeze()},4)},Opal.modules["bcdice/dice_table/d66_table"]=function(r){var L,M,B,G,x,m,q,_,Q,Y=[],i=r.nil,t=r.$$$,e=r.module,p=r.klass,C=r.hash2,V=r.defs,s=r.def,F=r.eqeqeq,I=r.rb_plus,y=r.rb_times,w=r.truthy;return L=Y,M=Q=[e(Y[0],"BCDice")].concat(L),B=_=[e(Q[0],"DiceTable")].concat(M),x=[G=p(_[0],null,"D66Table")].concat(B),m=r.$r(x),(q=G.$$prototype).sort_type=q.items=q.name=i,V(G,"$from_i18n",function(v,f){var $,c=i;return c=m("I18n").$t(v,C(["locale"],{locale:f})),$=m("D66SortType").$const_get(c["$[]"]("d66_sort_type")),this.$new(c["$[]"]("name"),$,c["$[]"]("items"))},2),s(G,"$initialize",function(v,f,u){var c=this;return c.name=v,c.sort_type=f,c.items=u.$freeze()},3),s(G,"$roll",function(v){var f=this,u=i,c=i,$=i,n=i;return u=v.$roll_barabara(2,6),F(t(m("D66SortType"),"ASC"),c=f.sort_type)?u["$sort!"]():F(t(m("D66SortType"),"DESC"),c)&&u["$sort!"]()["$reverse!"](),$=I(y(u["$[]"](0),10),u["$[]"](1)),n=w(c=f.items["$[]"]($))?c:f.items["$[]"]($.$to_s()),w(n["$respond_to?"]("roll"))&&(n=n.$roll(v)),m("RollResult").$new(f.name,$,n)},1),s(G,"$choice",function(v){return m("RollResult").$new(this.name,v,this.items["$[]"](v))},1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(r){var ie,l,B,G,j,i=[],t=r.nil,e=r.module,p=r.klass,C=r.hash2,V=r.send,s=r.to_ary,F=r.rb_plus,I=r.rb_times,y=r.to_a,w=r.rb_minus,H=r.send2,L=r.find_super,K=r.def;return r.top.$require("bcdice/dice_table/d66_table"),ie=i,l=j=[e(i[0],"BCDice")].concat(ie),B=[e(j[0],"DiceTable")].concat(l),G=r.$r(B),K(p(B[0],G("D66Table"),"D66LeftRangeTable"),"$initialize",function b(v,f,u){var n;return delete b.$$p,n=C([],{}),V(u,"each",[],function(h){var E,A;return null==h&&(h=t),E=s(h),A=null==E[1]?t:E[1],V(null==E[0]?t:E[0],"each",[],function(o){return null==o&&(o=t),V(A,"each_with_index",[],function(T,$e){var ue,le;return null==T&&(T=t),null==$e&&($e=t),ue=F(I(o,10),F($e,1)),V(n,"[]=",y(le=[ue,T])),le[w(le.length,1)]},2)},1)},1),H(this,L(this,"initialize",b,!1,!0),"initialize",[v,f,n],null)},3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(r){var H,ie,P,B,G,x,m,j,K,Y=[],i=r.nil,t=r.module,e=r.klass,p=r.hash2,C=r.defs,V=r.def,s=r.truthy,F=r.rb_minus,I=r.rb_plus,y=r.rb_times;return H=Y,ie=K=[t(Y[0],"BCDice")].concat(H),P=j=[t(K[0],"DiceTable")].concat(ie),G=[B=e(j[0],null,"D66ParityTable")].concat(P),x=r.$r(G),(m=B.$$prototype).odd=m.even=m.name=i,C(B,"$from_i18n",function(b,v){var u=i;return u=x("I18n").$t(b,p(["locale","raise"],{locale:v,raise:!0})),this.$new(u["$[]"]("name"),u["$[]"]("odd"),u["$[]"]("even"))},2),V(B,"$initialize",function(b,v,f){var u=this;return u.name=b,u.odd=v.$freeze(),u.even=f.$freeze()},3),V(B,"$roll",function(b){var u,$,n,v=this,f=i;return f=b.$roll_once(6),u=b.$roll_once(6),$=(s(f["$odd?"]())?v.odd:v.even)["$[]"](F(u,1)),n=I(y(f,10),u),x("RollResult").$new(v.name,n,$)},1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(r){var I,L,j,_,l,P,B,Q,w,Y=[],i=r.nil,t=r.module,e=r.klass,p=r.def,C=r.rb_plus,V=r.rb_times,s=r.send;return I=Y,L=w=[t(Y[0],"BCDice")].concat(I),j=Q=[t(w[0],"DiceTable")].concat(L),l=[_=e(Q[0],null,"D66RangeTable")].concat(j),P=r.$r(l),(B=_.$$prototype).items=B.name=i,p(_,"$initialize",function(x,m){return this.name=x,this.items=m.$freeze()},2),p(_,"$roll",function(x){var q,b,v,f=i;return q=x.$roll_once(6),b=x.$roll_once(6),v=C(V(q,10),b),f=s(this.items,"find",[],function(c){return null==c&&(c=i),c["$[]"](0)["$include?"](v)},1),P("RollResult").$new(this.name,v,f["$[]"](1))},1)},Opal.modules["bcdice/dice_table/range_table"]=function(r){var K,j,G,x,m,q,b,l,ie,Y=[],i=r.nil,t=r.module,e=r.klass,p=r.const_set,C=r.send,V=r.truthy,s=r.def,F=r.to_a,I=r.rb_minus,y=r.eqeqeq,w=r.rb_times,H=r.rb_plus;return K=Y,j=ie=[t(Y[0],"BCDice")].concat(K),G=l=[t(ie[0],"DiceTable")].concat(j),m=[x=e(l[0],null,"RangeTable")].concat(G),q=r.$r(m),(b=x.$$prototype).name=b.items=b.num_of_dice=b.num_of_sides=b.formatter=i,p(m[0],"RollResult",C(q("Struct"),"new",["sum","values","content","formatted"],function v(){return(null==v.$$s?this:v.$$s).$alias_method("to_s","formatted")},{$$arity:0,$$s:x})),p(m[0],"Item",q("Struct").$new("range","content")),p(m[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),p(m[0],"DEFAULT_FORMATTER",C(x,"lambda",[],function(f,u){return null==f&&(f=i),null==u&&(u=i),f.$name()+"("+u.$sum()+") \uff1e "+u.$content()},2)),x.$attr_reader("name"),x.$attr_reader("num_of_dice"),x.$attr_reader("num_of_sides"),s(x,"$initialize",function v(f,u,c){var a,$=v.$$p||i,n=this,h=i;return delete v.$$p,n.name=f.$freeze(),n.formatter=V(a=$)?a:q("DEFAULT_FORMATTER"),h=q("DICE_ROLL_METHOD_RE").$match(u),V(h)||n.$raise(q("ArgumentError"),n.name+": invalid dice roll method: "+u),n.num_of_dice=h["$[]"](1).$to_i(),n.num_of_sides=h["$[]"](2).$to_i(),n.$store(c)},3),s(x,"$fetch",function(f){var c,u=this;return c=C(u.items,"find",[],function(n){return null==n&&(n=i),n.$range()["$include?"](f)},1),V(c)||u.$raise(q("RangeError"),u.name+": value is out of range: "+f),c},1),s(x,"$roll",function(f){var $,n,a,u=this,c=i;return $=(c=f.$roll_barabara(u.num_of_dice,u.num_of_sides)).$sum(),n=q("RollResult").$new($,c,u.$fetch($).$content()),a=[u.formatter["$[]"](u,n)],C(n,"formatted=",F(a)),I(a.length,1),n},1),x.$private(),s(x,"$store",function(f){var c,$,u=this;return c=C(f,"map",[],function n(a,h){return null==a&&(a=i),null==h&&(h=i),[(null==n.$$s?this:n.$$s).$coerce_to_int_range(a),h]},{$$arity:2,$$s:u}),$=C(c,"sort_by",[],function(a,h){return null==a&&(a=i),null==h&&(h=i),a.$min()},2),u.$assert_min_sum_is_covered($),u.$assert_max_sum_is_covered($),u.$assert_no_gap_or_overlap_in_ranges($),u.items=C($,"map",[],function(a,h){return null==a&&(a=i),null==h&&(h=i),q("Item").$new(a,h.$freeze()).$freeze()},2).$freeze(),u},1),s(x,"$coerce_to_int_range",function(f){var c;return y(q("Integer"),c=f)?q("Range").$new(f,f):y(q("Range"),c)&&V(f.$begin()["$is_a?"](q("Integer")))&&V(f.$end()["$is_a?"](q("Integer")))?f:this.$raise(q("TypeError"),this.name+": "+f+" ("+f.$class()+") must be an Integer or a Range with Integers ")},1),s(x,"$assert_min_sum_is_covered",function(f){var c,u=this,$=i;return c=u.num_of_dice,$=f.$first()["$[]"](0),V($["$include?"](c))||u.$raise(q("RangeError"),u.name+": min value ("+c+") is not covered: "+$),u},1),s(x,"$assert_max_sum_is_covered",function(f){var c,u=this,$=i;return c=w(u.num_of_dice,u.num_of_sides),$=f.$last()["$[]"](0),V($["$include?"](c))||u.$raise(q("RangeError"),u.name+": max value ("+c+") is not covered: "+$),u},1),s(x,"$assert_no_gap_or_overlap_in_ranges",function(f){return C(f,"each_cons",[2],function c($,n){var d,N,a=null==c.$$s?this:c.$$s,h=i,E=i;return null==a.name&&(a.name=i),null==$&&($=i),null==n&&(n=i),h=$["$[]"](0),E=n["$[]"](0),d=h.$max(),N=H(d,1),V(E["$include?"](d))&&a.$raise(q("RangeError"),a.name+": Range overlap: "+h+" and "+E),V(E["$include?"](N))?i:a.$raise(q("RangeError"),a.name+": Range gap: "+h+" and "+E)},{$$arity:2,$$s:this}),this},1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(r){var I,L,j,G,x,m,q,l,Q,w,Y=[],i=r.nil,t=r.$$$,e=r.module,p=r.klass,C=r.send,V=r.def,s=r.rb_minus;return I=Y,L=w=[e(Y[0],"BCDice")].concat(I),j=Q=[e(w[0],"DiceTable")].concat(L),G=l=[p(Q[0],null,"SaiFicSkillTable")].concat(j),m=[x=p(l[0],null,"Category")].concat(G),q=r.$r(m),x.$$prototype.name=i,V(x,"$initialize",function(f,u,c,$){var n=this;return n.name=f,n.skills=C(u.$map(),"with_index",[2],function(h,E){return null==h&&(h=i),null==E&&(E=i),t(q("SaiFicSkillTable"),"Skill").$new(f,h,c,E,$)},2),n.dice=c},4),V(x,"$roll",function(f){return this.$skills()["$[]"](s(f.$roll_sum(2,6),2))},1),V(x,"$to_s",function(){return this.name},0),x.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(r){var s,w,ie,P,B,j,L,I,Y=[],i=r.nil,t=r.module,e=r.klass,p=r.def,C=r.hash2;return s=Y,w=I=[t(Y[0],"BCDice")].concat(s),ie=L=[t(I[0],"DiceTable")].concat(w),j=[e(L[0],null,"SaiFicSkillTable")].concat(ie),(B=(P=e(j[0],null,"Skill")).$$prototype).s_format=B.category_dice=B.row_dice=B.category_name=B.name=i,p(P,"$initialize",function(x,m,q,b,v){var f=this;return f.category_name=x,f.name=m,f.category_dice=q,f.row_dice=b,f.s_format=v},5),p(P,"$to_s",function(){var x=this;return x.$format(x.s_format,C(["category_dice","row_dice","category_name","skill_name"],{category_dice:x.category_dice,row_dice:x.row_dice,category_name:x.category_name,skill_name:x.name}))},0),P.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(r){var M,P,q,b,v,f,u,G,_,Y=r.top,i=[],t=r.nil,e=r.$$$,p=r.module,C=r.klass,V=r.hash2,s=r.send,I=r.defs,y=r.const_set,w=r.to_ary,H=r.def,L=r.truthy,K=r.rb_minus,Q=r.rb_plus;return Y.$require("bcdice/dice_table/sai_fic_skill_table/category"),Y.$require("bcdice/dice_table/sai_fic_skill_table/skill"),M=i,P=_=[p(i[0],"BCDice")].concat(M),q=G=[p(_[0],"DiceTable")].concat(P),v=[b=C(G[0],null,"SaiFicSkillTable")].concat(q),f=r.$r(v),(u=b.$$prototype).rtt=u.rtt_format=u.rct=u.rct_format=u.rttn=u.rttn_format=u.categories=t,I(b,"$from_i18n",function($,n,a){var h,E,d,o,ee=t;if(null==a)a=V([],{});else if(!a.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(h=a.$$smap.rtt)&&(h=t),null==(E=a.$$smap.rct)&&(E=t),null==(d=a.$$smap.rttn)&&(d=t),o=(ee=f("I18n").$t("RTT",V(["locale","raise","default"],{locale:n,raise:!1,default:V([],{})})).$merge(f("I18n").$t($,V(["locale","raise"],{locale:n,raise:!0}))))["$[]"]("items"),ee=s(ee,"select",[],function(T,$e){return null==T&&(T=t),null==$e&&($e=t),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](T)},2),this.$new(o,r.to_hash(ee).$merge(V(["rtt","rct","rttn"],{rtt:h,rct:E,rttn:d})))},-3),y(v[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),y(v[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),y(v[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),y(v[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),H(b,"$initialize",function($,n){var a,h,E,d,N,A,ee,o=this;if(null==n)n=V([],{});else if(!n.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(a=n.$$smap.rtt)&&(a=t),null==(h=n.$$smap.rct)&&(h=t),null==(E=n.$$smap.rttn)&&(E=t),null==(d=n.$$smap.rtt_format)&&(d=f("DEFAULT_RTT")),null==(N=n.$$smap.rct_format)&&(N=f("DEFAULT_RCT")),null==(A=n.$$smap.rttn_format)&&(A=f("DEFAULT_RTTN")),null==(ee=n.$$smap.s_format)&&(ee=f("DEFAULT_S")),o.categories=s($.$map(),"with_index",[1],function(T,$e){var ue,fe,_e;return null==T&&(T=t),null==$e&&($e=t),fe=null==(ue=w(T))[0]?t:ue[0],_e=null==ue[1]?t:ue[1],e(f("SaiFicSkillTable"),"Category").$new(fe,_e,$e,ee)},{$$arity:2,$$has_top_level_mlhs_arg:!0}),o.rtt=a,o.rct=h,o.rttn=E.$to_a(),o.rtt_format=d,o.rct_format=N,o.rttn_format=A},-2),y(v[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),b.$attr_reader("categories"),H(b,"$roll_command",function($,n){var h,a=this,E=t,d=t;return L(["RTT",a.rtt]["$include?"](h=n))?a.$format_skill(a.rtt_format,a.$roll_skill($)):L(["RCT",a.rct]["$include?"](h))?(E=a.$roll_category($),a.$format(a.rct_format,V(["category_dice","category_name"],{category_dice:E.$dice(),category_name:E.$name()}))):L(d=f("RTTN").$index(h))||L(d=a.rttn.$index(h))?a.$format_skill(a.rttn_format,a.categories["$[]"](d).$roll($)):t},2),H(b,"$roll_category",function($){return this.categories["$[]"](K($.$roll_once(6),1))},1),H(b,"$roll_skill",function($){return this.$roll_category($).$roll($)},1),H(b,"$prefixes",function(){var $=this;return Q(["RTT[1-6]?","RCT",$.rtt,$.rct],$.rttn).$compact()},0),b.$private(),H(b,"$format_skill",function($,n){return this.$format($,V(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:n.$category_dice(),row_dice:n.$row_dice(),category_name:n.$category_name(),skill_name:n.$name(),text:n.$to_s()}))},2)},Opal.modules["bcdice/dice_table/table"]=function(r){var y,K,_,l,P,B,G,ie,H,Y=[],i=r.nil,t=r.module,e=r.klass,p=r.hash2,C=r.defs,V=r.truthy,s=r.def,F=r.rb_minus;return y=Y,K=H=[t(Y[0],"BCDice")].concat(y),_=ie=[t(H[0],"DiceTable")].concat(K),P=[l=e(ie[0],null,"Table")].concat(_),B=r.$r(P),(G=l.$$prototype).times=G.sides=G.name=G.items=i,C(l,"$from_i18n",function(m,q){var v=i;return v=B("I18n").$t(m,p(["locale"],{locale:q})),this.$new(v["$[]"]("name"),v["$[]"]("type"),v["$[]"]("items"))},2),s(l,"$initialize",function(m,q,b){var v=this,f=i;return v.name=m,v.items=b.$freeze(),f=/(\d+)D(\d+)/i.$match(q),V(f)||v.$raise(B("ArgumentError"),"Unexpected table type: "+q),v.times=f["$[]"](1).$to_i(),v.sides=f["$[]"](2).$to_i()},3),s(l,"$roll",function(m){var b,q=this;return b=m.$roll_sum(q.times,q.sides),q.$choice(b)},1),s(l,"$choice",function(m){var b,q=this;return b=F(m,q.times),B("RollResult").$new(q.name,m,q.items["$[]"](b))},1)},Opal.modules["bcdice/dice_table"]=function(r){var Y=r.top;return Y.$require("bcdice/dice_table/roll_result"),Y.$require("bcdice/dice_table/chain_table"),Y.$require("bcdice/dice_table/d66_grid_table"),Y.$require("bcdice/dice_table/d66_half_grid_table"),Y.$require("bcdice/dice_table/d66_one_third_table"),Y.$require("bcdice/dice_table/d66_left_range_table"),Y.$require("bcdice/dice_table/d66_parity_table"),Y.$require("bcdice/dice_table/d66_range_table"),Y.$require("bcdice/dice_table/d66_table"),Y.$require("bcdice/dice_table/range_table"),Y.$require("bcdice/dice_table/sai_fic_skill_table"),Y.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(r){var C,I,w,s,Y=[],t=r.module,e=r.const_set;return C=Y,I=s=[t(Y[0],"BCDice")].concat(C),w=[t(s[0],"D66SortType")].concat(I),e(w[0],"NO_SORT","no_sort"),e(w[0],"ASC","asc"),e(w[0],"DESC","desc"),function(F,I){var w=[t(F,"RoundType")].concat(I);return e(w[0],"CEIL","ceil"),e(w[0],"FLOOR","floor"),e(w[0],"ROUND","round")}(s[0],s)},Opal.modules["bcdice/translate"]=function(r){var s,w,H,L,K,I,Y=[],i=r.nil,t=r.module,e=r.hash2,C=r.def;return s=Y,w=I=[t(Y[0],"BCDice")].concat(s),L=[H=t(I[0],"Translate")].concat(w),K=r.$r(L),C(H,"$translate",function(ie,M){var j,_=this;if(null==_.locale&&(_.locale=i),null==M)M=e([],{});else if(!M.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return j=r.kwrestargs(M,{}),K("I18n").$translate(ie,e(["locale","raise"],{locale:_.locale,raise:!0}).$merge(r.to_hash(j)))},-2)},Opal.modules["bcdice/result"]=function(r){var I,K,j,Q,M,w,Y=[],i=r.nil,e=r.klass,p=r.send,C=r.to_a,V=r.rb_minus,s=r.def;return I=Y,K=w=[(0,r.module)(Y[0],"BCDice")].concat(I),[Q=e(w[0],null,"Result")].concat(K),(M=Q.$$prototype).secret=M.success=M.failure=M.critical=M.fumble=i,s(j=r.get_singleton_class(Q),"$success",function(P){return p(this.$new(),"tap",[],function(x){var m=i;return null==x&&(x=i),p(x,"text=",C(m=[P])),V(m.length,1),p(x,"success=",C(m=[!0])),m[V(m.length,1)]},1)},1),s(j,"$failure",function(P){return p(this.$new(),"tap",[],function(x){var m=i;return null==x&&(x=i),p(x,"text=",C(m=[P])),V(m.length,1),p(x,"failure=",C(m=[!0])),m[V(m.length,1)]},1)},1),s(j,"$critical",function(P){return p(this.$new(),"tap",[],function(x){var m=i;return null==x&&(x=i),p(x,"text=",C(m=[P])),V(m.length,1),p(x,"critical=",C(m=[!0])),V(m.length,1),p(x,"success=",C(m=[!0])),m[V(m.length,1)]},1)},1),s(j,"$fumble",function(P){return p(this.$new(),"tap",[],function(x){var m=i;return null==x&&(x=i),p(x,"text=",C(m=[P])),V(m.length,1),p(x,"fumble=",C(m=[!0])),V(m.length,1),p(x,"failure=",C(m=[!0])),m[V(m.length,1)]},1)},1),s(j,"$nothing",function(){return"nothing"},0),s(Q,"$initialize",function(_){var l=this;return null==_&&(_=i),l.text=_,l.rands=i,l.detailed_rands=i,l.secret=!1,l.success=!1,l.failure=!1,l.critical=!1,l.fumble=!1},-1),Q.$attr_accessor("text","rands","detailed_rands"),Q.$attr_writer("secret","success","failure","critical","fumble"),s(Q,"$secret?",function(){return this.secret},0),s(Q,"$success?",function(){return this.success},0),s(Q,"$failure?",function(){return this.failure},0),s(Q,"$critical?",function(){return this.critical},0),s(Q,"$fumble?",function(){return this.fumble},0),s(Q,"$condition=",function(_){return this.success=_,this.failure=_["$!"]()},1)},Opal.modules["racc/parser"]=function(r){var q,v,f,i=[],t=r.$r(i),e=r.nil,p=r.$$$,C=r.module,V=r.klass,s=r.truthy,F=r.const_set,I=r.defs,y=r.gvars,w=r.rb_lt,H=r.send,L=r.to_a,K=r.rb_minus,Q=r.def,ie=r.to_ary,M=r.neqeq,j=r.rb_plus,_=r.eqeq,l=r.rb_ge,P=r.rb_gt,B=r.eqeqeq,G=r.rb_le,x=r.rb_times;return q=i,v=[C(i[0],"Racc")].concat(q),f=r.$r(v),V(v[0],f("StandardError"),"ParseError"),s(p("::","ParseError","skip_raise")?"constant":e)||F(i[0],"ParseError",p(t("Racc"),"ParseError")),function(m,q){var n,a,h,E,d,f=[C(m,"Racc")].concat(q),u=r.$r(f);return s(u("Racc_No_Extensions","skip_raise")?"constant":e)||F(f[0],"Racc_No_Extensions",!1),n=f,h=[a=V(f[0],null,"Parser")].concat(n),E=r.$r(h),(d=a.$$prototype).yydebug=d.racc_debug_out=d.racc_error_status=d.racc_t=d.racc_vstack=d.racc_val=d.racc_state=d.racc_tstack=e,F(h[0],"Racc_Runtime_Version","1.4.6"),F(h[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),F(h[0],"Racc_Runtime_Core_Version_R","1.4.6"),F(h[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),F(h[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),F(h[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),F(h[0],"Racc_Runtime_Core_Version",E("Racc_Runtime_Core_Version_R")),F(h[0],"Racc_Runtime_Core_Revision",E("Racc_Runtime_Core_Revision_R")),F(h[0],"Racc_Runtime_Type","ruby"),I(E("Parser"),"$racc_runtime_type",function(){return E("Racc_Runtime_Type")},0),Q(a,"$_racc_setup",function(){var A,ee,o=this,J=e,T=e,$e=e;return null==y.stderr&&(y.stderr=e),s(p(o.$class(),"Racc_debug_parser"))||(o.yydebug=!1),s(null!=(A=o.yydebug)&&A!==e?"instance-variable":e)||(o.yydebug=!1),s(o.yydebug)&&(s(null!=(ee=o.racc_debug_out)&&ee!==e?"instance-variable":e)||(o.racc_debug_out=y.stderr),o.racc_debug_out=s(J=o.racc_debug_out)?J:y.stderr),T=p(o.$class(),"Racc_arg"),s(w(T.$size(),14))&&(H(T,"[]=",L($e=[13,!0])),K($e.length,1)),T},0),Q(a,"$_racc_init_sysvars",function(){var A=this;return A.racc_state=[0],A.racc_tstack=[],A.racc_vstack=[],A.racc_t=e,A.racc_val=e,A.racc_read_next=!0,A.racc_user_yyerror=!1,A.racc_error_status=0},0),Q(a,"$do_parse",function(){return this.$__send__(E("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),Q(a,"$next_token",function(){return this.$raise(E("NotImplementedError"),this.$class()+"#next_token is not defined")},0),Q(a,"$_racc_do_parse_rb",function(A,ee){var o,T=this,$e=e,ue=e,le=e,fe=e,re=e,z=e,ne=e,D=e;return o=ie(A),$e=null==o[0]?e:o[0],ue=null==o[1]?e:o[1],le=null==o[2]?e:o[2],fe=null==o[3]?e:o[3],re=null==o[10]?e:o[10],T.$_racc_init_sysvars(),z=ne=D=e,H(T,"catch",["racc_end_parse"],function R(){var O,S,W=null==R.$$s?this:R.$$s,k=e;for(null==W.racc_state&&(W.racc_state=e),null==W.racc_read_next&&(W.racc_read_next=e),null==W.racc_t&&(W.racc_t=e),null==W.yydebug&&(W.yydebug=e),null==W.racc_val&&(W.racc_val=e);s(!0);)for(s(D=fe["$[]"](W.racc_state["$[]"](-1)))?(s(W.racc_read_next)&&M(W.racc_t,0)&&(S=W.$next_token(),O=ie(S),z=null==O[0]?e:O[0],W.racc_val=null==O[1]?e:O[1],W.racc_t=s(z)?s(k=re["$[]"](z))?k:1:0,s(W.yydebug)&&W.$racc_read_token(W.racc_t,z,W.racc_val),W.racc_read_next=!1),D=j(D,W.racc_t),s(l(D,0))&&s(ne=$e["$[]"](D))&&_(ue["$[]"](D),W.racc_state["$[]"](-1))||(ne=le["$[]"](W.racc_state["$[]"](-1)))):ne=le["$[]"](W.racc_state["$[]"](-1));s(ne=W.$_racc_evalact(ne,A)););},{$$arity:0,$$s:T})},2),Q(a,"$yyparse",function(A,ee){return this.$__send__(E("Racc_YY_Parse_Method"),A,ee,this.$_racc_setup(),!0)},2),Q(a,"$_racc_yyparse_rb",function(A,ee,o,J){var T,le=e,fe=e,_e=e,re=e,ne=e,D=e,R=e;return T=ie(o),le=null==T[0]?e:T[0],fe=null==T[1]?e:T[1],_e=null==T[2]?e:T[2],re=null==T[3]?e:T[3],ne=null==T[10]?e:T[10],this.$_racc_init_sysvars(),D=e,R=e,H(this,"catch",["racc_end_parse"],function ae(){var W=null==ae.$$s?this:ae.$$s;for(null==W.racc_state&&(W.racc_state=e);!s(R=re["$[]"](W.racc_state["$[]"](-1)));)for(;s(D=W.$_racc_evalact(_e["$[]"](W.racc_state["$[]"](-1)),o)););return H(A,"__send__",[ee],function k(g,te){var X=null==k.$$s?this:k.$$s,U=e,se=e;for(null==X.racc_t&&(X.racc_t=e),null==X.racc_state&&(X.racc_state=e),null==X.racc_read_next&&(X.racc_read_next=e),null==g&&(g=e),null==te&&(te=e),X.racc_t=s(g)?s(U=ne["$[]"](g))?U:1:0,X.racc_val=te,X.racc_read_next=!1,R=j(R,X.racc_t),s(l(R,0))&&s(D=le["$[]"](R))&&_(fe["$[]"](R),X.racc_state["$[]"](-1))||(D=_e["$[]"](X.racc_state["$[]"](-1)));s(D=X.$_racc_evalact(D,o)););for(;s(s(U=s(se=(R=re["$[]"](X.racc_state["$[]"](-1)))["$!"]())?se:X.racc_read_next["$!"]())?U:X.racc_t["$=="](0));)for(s(R)&&s(R=j(R,X.racc_t))&&s(l(R,0))&&s(D=le["$[]"](R))&&_(fe["$[]"](R),X.racc_state["$[]"](-1))||(D=_e["$[]"](X.racc_state["$[]"](-1)));s(D=X.$_racc_evalact(D,o)););},{$$arity:2,$$s:W})},{$$arity:0,$$s:this})},4),Q(a,"$_racc_evalact",function(A,ee){var o,_e,T=this,$e=e,ue=e,fe=e,re=e,z=e,ne=e,D=e;if($e=null==(o=ie(ee))[0]?e:o[0],ue=null==o[1]?e:o[1],fe=null==o[3]?e:o[3],_e=null==o[11]?e:o[11],re=null==o[12]?e:o[12],s(P(A,0))&&s(w(A,_e)))s(P(T.racc_error_status,0))&&(_(T.racc_t,1)||(T.racc_error_status=K(T.racc_error_status,1))),T.racc_vstack.$push(T.racc_val),T.racc_state.$push(A),T.racc_read_next=!0,s(T.yydebug)&&(T.racc_tstack.$push(T.racc_t),T.$racc_shift(T.racc_t,T.racc_tstack,T.racc_vstack));else if(s(w(A,0))&&s(P(A,re["$-@"]()))){if(z=H(T,"catch",["racc_jump"],function R(){var ae=null==R.$$s?this:R.$$s;return null==ae.racc_state&&(ae.racc_state=e),ae.racc_state.$push(ae.$_racc_do_reduce(ee,A)),!1},{$$arity:0,$$s:T}),s(z)){if(B(1,ne=z))return T.racc_user_yyerror=!0,re["$-@"]();if(B(2,ne))return _e;T.$raise("[Racc Bug] unknown jump code")}}else if(_(A,_e))s(T.yydebug)&&T.$racc_accept(),T.$throw("racc_end_parse",T.racc_vstack["$[]"](0));else{if(_(A,re["$-@"]())){for(B(0,ne=T.racc_error_status)?s(ee["$[]"](21))||T.$on_error(T.racc_t,T.racc_val,T.racc_vstack):B(3,ne)&&(_(T.racc_t,0)&&T.$throw("racc_end_parse",e),T.racc_read_next=!0),T.racc_user_yyerror=!1,T.racc_error_status=3;s(!0)&&!(s(D=fe["$[]"](T.racc_state["$[]"](-1)))&&(D=j(D,1),s(l(D,0))&&s(A=$e["$[]"](D))&&_(ue["$[]"](D),T.racc_state["$[]"](-1))));)s(G(T.racc_state.$size(),1))&&T.$throw("racc_end_parse",e),T.racc_state.$pop(),T.racc_vstack.$pop(),s(T.yydebug)&&(T.racc_tstack.$pop(),T.$racc_e_pop(T.racc_state,T.racc_tstack,T.racc_vstack));return A}T.$raise("[Racc Bug] unknown action "+A.$inspect())}return s(T.yydebug)&&T.$racc_next_state(T.racc_state["$[]"](-1),T.racc_state),e},2),Q(a,"$_racc_do_reduce",function(A,ee){var o,re,ne,W,k,g,X,T=this,ue=e,le=e,fe=e,_e=e,z=e,D=e,R=e,ae=e,O=e,S=e,te=e,ce=e,Z=e,U=e;return ue=null==(o=ie(A))[4]?e:o[4],le=null==o[5]?e:o[5],fe=null==o[6]?e:o[6],_e=null==o[7]?e:o[7],re=null==o[8]?e:o[8],z=null==o[9]?e:o[9],ne=null==o[13]?e:o[13],D=T.racc_state,R=T.racc_vstack,ae=T.racc_tstack,O=x(ee,-3),S=z["$[]"](O),W=z["$[]"](j(O,1)),k=z["$[]"](j(O,2)),g=[],s(T.yydebug)&&(te=ae["$[]"](S["$-@"](),S)),ce=R["$[]"](S["$-@"](),S),s(T.yydebug)&&(Z=[S["$-@"](),S,g],H(ae,"[]=",L(Z)),K(Z.length,1)),Z=[S["$-@"](),S,g],H(R,"[]=",L(Z)),K(Z.length,1),Z=[S["$-@"](),S,g],H(D,"[]=",L(Z)),K(Z.length,1),s(ne)?R.$push(T.$__send__(k,ce,R,ce["$[]"](0))):R.$push(T.$__send__(k,ce,R)),ae.$push(W),s(T.yydebug)&&T.$racc_reduce(te,W,ae,R),X=K(W,re),s(O=_e["$[]"](X))&&(O=j(O,D["$[]"](-1)),s(l(O,0))&&s(U=ue["$[]"](O))&&_(le["$[]"](O),X))?U:fe["$[]"](X)},2),Q(a,"$on_error",function(A,ee,o){var T,J=this;return J.$raise(E("ParseError"),J.$sprintf("\nparse error on value %s (%s)",ee.$inspect(),s(T=J.$token_to_str(A))?T:"?"))},3),Q(a,"$yyerror",function(){return this.$throw("racc_jump",1)},0),Q(a,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),Q(a,"$yyerrok",function(){return this.racc_error_status=0},0),Q(a,"$racc_read_token",function(A,ee,o){var J=this;return J.racc_debug_out.$print("read    "),J.racc_debug_out.$print(ee.$inspect(),"(",J.$racc_token2str(A),") "),J.racc_debug_out.$puts(o.$inspect()),J.racc_debug_out.$puts()},3),Q(a,"$racc_shift",function(A,ee,o){var J=this;return J.racc_debug_out.$puts("shift   "+J.$racc_token2str(A)),J.$racc_print_stacks(ee,o),J.racc_debug_out.$puts()},3),Q(a,"$racc_reduce",function(A,ee,o,J){var T=this,$e=e;return($e=T.racc_debug_out).$print("reduce "),s(A["$empty?"]())?$e.$print(" <none>"):H(A,"each",[],function ue(le){return null==le&&(le=e),$e.$print(" ",(null==ue.$$s?this:ue.$$s).$racc_token2str(le))},{$$arity:1,$$s:T}),$e.$puts(" --\x3e "+T.$racc_token2str(ee)),T.$racc_print_stacks(o,J),T.racc_debug_out.$puts()},4),Q(a,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),Q(a,"$racc_e_pop",function(A,ee,o){var J=this;return J.racc_debug_out.$puts("error recovering mode: pop token"),J.$racc_print_states(A),J.$racc_print_stacks(ee,o),J.racc_debug_out.$puts()},3),Q(a,"$racc_next_state",function(A,ee){var o=this;return o.racc_debug_out.$puts("goto    "+A),o.$racc_print_states(ee),o.racc_debug_out.$puts()},2),Q(a,"$racc_print_stacks",function(A,ee){var J=e;return(J=this.racc_debug_out).$print("        ["),H(A,"each_index",[],function T($e){return null==$e&&($e=e),J.$print(" (",(null==T.$$s?this:T.$$s).$racc_token2str(A["$[]"]($e))," ",ee["$[]"]($e).$inspect(),")")},{$$arity:1,$$s:this}),J.$puts(" ]")},2),Q(a,"$racc_print_states",function(A){var o=e;return(o=this.racc_debug_out).$print("        ["),H(A,"each",[],function(T){return null==T&&(T=e),o.$print(" ",T)},1),o.$puts(" ]")},1),Q(a,"$racc_token2str",function(A){var o;return s(o=p(this.$class(),"Racc_token_to_s_table")["$[]"](A))?o:this.$raise("[Racc Bug] can't convert token "+A+" to string")},1),Q(a,"$token_to_str",function(A){return p(this.$class(),"Racc_token_to_s_table")["$[]"](A)},1)}(i[0],i)},Opal.modules["bcdice/arithmetic/node"]=function(r){var Q,_,G,f,u,m,q,P,M,Y=[],i=r.nil,t=r.$$$,e=r.module,p=r.klass,C=r.def,V=r.send2,s=r.find_super,F=r.eqeq,I=r.const_set,y=r.eqeqeq,w=r.rb_divide,H=r.truthy,L=r.alias;return Q=Y,_=M=[e(Y[0],"BCDice")].concat(Q),G=P=[e(M[0],"Arithmetic")].concat(_),m=[e(P[0],"Node")].concat(G),q=r.$r(m),(u=(f=p(m[0],null,"BinaryOp")).$$prototype).lhs=u.rhs=u.op=i,C(f,"$initialize",function($,n,a){var h=this;return h.lhs=$,h.op=n,h.rhs=a},3),C(f,"$eval",function($){var h,n=this,a=i;return a=n.lhs.$eval($),h=n.rhs.$eval($),a.$send(n.op,h)},1),C(f,"$output",function(){var $=this;return""+$.lhs.$output()+$.op+$.rhs.$output()},0),C(f,"$s_exp",function(){var $=this;return"("+$.$op_for_s_exp()+" "+$.lhs.$s_exp()+" "+$.rhs.$s_exp()+")"},0),C(f,"$op_for_s_exp",function(){return this.op},0),function(b,v,f){var u=p(b,v,"DivideBase"),c=[u].concat(f),$=r.$r(c),n=u.$$prototype;n.lhs=n.rhs=n.op=i,C(u,"$initialize",function a(h,E){return delete a.$$p,V(this,s(this,"initialize",a,!1,!0),"initialize",[h,"/",E],null)},2),C(u,"$eval",function(h){var d,N,E=this;return d=E.lhs.$eval(h),N=E.rhs.$eval(h),F(N,0)&&E.$raise($("ZeroDivisionError")),E.$divide_and_round(d,N,h)},1),C(u,"$output",function a(){var h=a.$$p||i,E=this;return delete a.$$p,""+V(E,s(E,"output",a,!1,!0),"output",[],h)+E.$rounding_method()},0),u.$private(),C(u,"$rounding_method",function(){return t(this.$class(),"ROUNDING_METHOD")},0),C(u,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),C(u,"$divide_and_round",function(h,E,d){return this.$raise($("NotImplementedError"))},3)}(m[0],q("BinaryOp"),m),function(b,v,f){var u=p(b,v,"DivideWithGameSystemDefault"),c=[u].concat(f),$=r.$r(c);I(c[0],"ROUNDING_METHOD",""),u.$private(),C(u,"$divide_and_round",function(a,h,E){var d,N=i;return y(t($("RoundType"),"CEIL"),d=E)?w(a.$to_f(),h).$ceil():y(t($("RoundType"),"ROUND"),d)?(N=w(a.$to_f(),h),H(N["$negative?"]())?N.$abs().$round()["$-@"]():N.$round()):w(a,h).$floor()},3)}(m[0],q("DivideBase"),m),function(b,v,f){var u=p(b,v,"DivideWithCeil"),c=[u].concat(f);I(c[0],"ROUNDING_METHOD","C"),u.$private(),C(u,"$divide_and_round",function(n,a,h){return w(n.$to_f(),a).$ceil()},3)}(m[0],q("DivideBase"),m),function(b,v,f){var u=p(b,v,"DivideWithRound"),c=[u].concat(f);I(c[0],"ROUNDING_METHOD","R"),u.$private(),C(u,"$divide_and_round",function(n,a,h){var E=i;return E=w(n.$to_f(),a),H(E["$negative?"]())?E.$abs().$round()["$-@"]():E.$round()},3)}(m[0],q("DivideBase"),m),function(b,v,f){var u=p(b,v,"DivideWithFloor"),c=[u].concat(f);I(c[0],"ROUNDING_METHOD","F"),u.$private(),C(u,"$divide_and_round",function(n,a,h){return w(n,a).$floor()},3)}(m[0],q("DivideBase"),m),function(b,v){var f=p(b,null,"Negative");f.$$prototype.body=i,C(f,"$initialize",function($){return this.body=$},1),C(f,"$eval",function($){return this.body.$eval($)["$-@"]()},1),C(f,"$output",function(){return"-"+this.body.$output()},0),C(f,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(m[0]),function(b,v){var f=p(b,null,"Parenthesis");f.$$prototype.expr=i,C(f,"$initialize",function($){return this.expr=$},1),C(f,"$eval",function($){return this.expr.$eval($)},1),C(f,"$output",function(){return"("+this.expr.$output()+")"},0),C(f,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(m[0]),function(b,v){var f=p(b,null,"Number");return f.$$prototype.value=i,C(f,"$initialize",function($){return this.value=$},1),C(f,"$eval",function($){return this.value},1),C(f,"$output",function(){return this.value.$to_s()},0),L(f,"s_exp","output")}(m[0])},Opal.modules.strscan=function(r){var L,K,Q,ie,M,Y=[],i=r.nil,e=r.def,p=r.truthy,C=r.eqeqeq,V=r.Opal,s=r.send,F=r.to_a,I=r.rb_minus,y=r.alias;return L=Y,Q=[K=(0,r.klass)(Y[0],null,"StringScanner")].concat(L),ie=r.$r(Q),(M=K.$$prototype).pos=M.string=M.working=M.matched=M.prev_pos=M.match=i,K.$attr_reader("pos","matched"),e(K,"$initialize",function(_){var l=this;return l.string=_,l.pos=0,l.matched=i,l.working=_,l.match=[]},1),K.$attr_reader("string"),e(K,"$beginning_of_line?",function(){var _=this;return 0===_.pos||"\n"===_.string.charAt(_.pos-1)},0),e(K,"$scan",function(_){var l=this,P=(_=l.$anchor(_)).exec(l.working);return null==P?l.matched=i:"object"==typeof P?(l.prev_pos=l.pos,l.pos+=P[0].length,l.working=l.working.substring(P[0].length),l.matched=P[0],l.match=P,P[0]):"string"==typeof P?(l.pos+=P.length,l.working=l.working.substring(P.length),P):i},1),e(K,"$scan_until",function(_){var l=this;_=l.$anchor(_);for(var G,P=l.pos,B=l.working;;){if(G=_.exec(B),P+=1,B=B.substr(1),null!=G)return l.matched=l.string.substr(l.pos,P-l.pos-1+G[0].length),l.match=G,l.prev_pos=P-1,l.pos=P,l.working=B.substr(G[0].length),l.matched;if(0===B.length)return l.match=[],l.matched=i}},1),e(K,"$[]",function(_){var P;if(p(this.match["$empty?"]()))return i;C(ie("Symbol"),P=_)?_=_.$to_s():C(ie("String"),P)||(_=V["$coerce_to!"](_,ie("Integer"),"to_int"));var B=this.match;return _<0&&(_+=B.length),_<0||_>=B.length||null==B[_]?i:B[_]},1),e(K,"$check",function(_){var l=this,P=(_=l.$anchor(_)).exec(l.working);return l.matched=null==P?i:P[0]},1),e(K,"$check_until",function(_){var l=this,P=l.prev_pos,B=l.pos,G=l.$scan_until(_);return G!==i&&(l.matched=G.substr(-1),l.working=l.string.substr(B)),l.prev_pos=P,l.pos=B,G},1),e(K,"$peek",function(_){return this.working.substring(0,_)},1),e(K,"$eos?",function(){return 0===this.working.length},0),e(K,"$exist?",function(_){var P=_.exec(this.working);return null==P?i:0==P.index?0:P.index+1},1),e(K,"$skip",function(_){var l=this,P=(_=l.$anchor(_)).exec(l.working);if(null==P)return l.match=[],l.matched=i;var B=P[0],G=B.length;return l.matched=B,l.match=P,l.prev_pos=l.pos,l.pos+=G,l.working=l.working.substring(G),G},1),e(K,"$skip_until",function(_){var P=this.$scan_until(_);return P===i?i:(this.matched=P.substr(-1),P.length)},1),e(K,"$get_byte",function(){var _=this,l=i;return _.pos<_.string.length?(_.prev_pos=_.pos,_.pos+=1,l=_.matched=_.working.substring(0,1),_.working=_.working.substring(1)):_.matched=i,l},0),e(K,"$match?",function(_){var l=this,P=(_=l.$anchor(_)).exec(l.working);return null==P?i:(l.prev_pos=l.pos,P[0].length)},1),e(K,"$pos=",function(_){var l=this;return _<0&&(_+=l.string.$length()),l.pos=_,l.working=l.string.slice(_)},1),e(K,"$matched_size",function(){return this.matched===i?i:this.matched.length},0),e(K,"$post_match",function(){var _=this;return _.matched===i?i:_.string.substr(_.pos)},0),e(K,"$pre_match",function(){var _=this;return _.matched===i?i:_.string.substr(0,_.prev_pos)},0),e(K,"$reset",function(){var _=this;return _.working=_.string,_.matched=i,_.pos=0},0),e(K,"$rest",function(){return this.working},0),e(K,"$rest?",function(){return 0!==this.working.length},0),e(K,"$rest_size",function(){return this.$rest().$size()},0),e(K,"$terminate",function(){var l,_=this;return _.match=i,l=[_.string.$length()],s(_,"pos=",F(l)),l[I(l.length,1)]},0),e(K,"$unscan",function(){var _=this;return _.pos=_.prev_pos,_.prev_pos=i,_.match=i,_},0),y(K,"bol?","beginning_of_line?"),y(K,"getch","get_byte"),K.$private(),e(K,"$anchor",function(_){var l=_.toString().match(/\/([^\/]+)$/);return l=l?l[1]:void 0,new RegExp("^(?:"+_.source+")",l)},1)},Opal.modules["bcdice/normalize"]=function(r){var s,w,I,Y=[],i=r.nil,t=r.module,e=r.eqeqeq,p=r.def,C=r.eqeq;return s=Y,I=[t(Y[0],"BCDice")].concat(s),(w=t(I[0],"Normalize")).$module_function(),p(w,"$comparison_operator",function(L){var K;return e(/<=|=</,K=L)?"<=":e(/>=|=>/,K)?">=":e(/<>|!=|=!/,K)?"!=":e(/</,K)?"<":e(/>/,K)?">":e(/=/,K)?"==":i},1),p(w,"$target_number",function(L){return C(L,"?")?L:L.$to_i()},1)},Opal.modules["bcdice/command/lexer"]=function(r){var w,Q,l,P,B,G,x,M,L,Y=r.top,i=[],t=r.nil,e=r.module,p=r.klass,C=r.const_set,V=r.hash2,s=r.truthy,F=r.send,I=r.def;return Y.$require("strscan"),Y.$require("bcdice/normalize"),w=i,Q=L=[e(i[0],"BCDice")].concat(w),l=M=[e(L[0],"Command")].concat(Q),B=[P=p(M[0],null,"Lexer")].concat(l),G=r.$r(B),(x=P.$$prototype).scanner=x.notations=t,C(B[0],"SYMBOLS",V(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),I(P,"$initialize",function(q,b){var v,f,c;return q=s(c=(f=(v=q)===t||null==v?t:F(v,"split",[" ",2]))===t||null==f?t:F(f,"first",[]))?c:"",this.scanner=G("StringScanner").$new(q),this.notations=F(b,"map",[],function(n){return null==n&&(n=t),s(n["$is_a?"](G("String")))?G("Regexp").$new(n):n},1)},2),I(P,"$next_token",function(){try{var q=this,b=t,v=t,u=t,c=t;return s(q.scanner["$eos?"]())?[!1,"$"]:(F(q.notations,"each",[],function $(n){var h,a=null==$.$$s?this:$.$$s;if(null==a.scanner&&(a.scanner=t),null==n&&(n=t),h=a.scanner.$scan(n),!s(h))return t;r.ret(["NOTATION",h])},{$$arity:1,$$s:q}),s(b=q.scanner.$scan(/\d+/))?["NUMBER",b.$to_i()]:s(v=q.scanner.$scan(/[<>!=]+/))?(v=G("Normalize").$comparison_operator(v),[s(v)?"CMP_OP":"ILLEGAL",v]):(u=q.scanner.$getch().$upcase(),[s(c=G("SYMBOLS")["$[]"](u))?c:u.$to_sym(),u]))}catch($){if($===r.returner)return $.$v;throw $}},0),I(P,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/command/parsed"]=function(r){var F,H,M,j,_,l,P,K,y,Y=[],i=r.nil,t=r.module,e=r.klass,p=r.def,C=r.truthy,V=r.eqeqeq;return F=Y,H=y=[t(Y[0],"BCDice")].concat(F),M=K=[t(y[0],"Command")].concat(H),_=[j=e(K[0],null,"Parsed")].concat(M),l=r.$r(_),(P=j.$$prototype).question_target=P.critical=P.fumble=P.dollar=P.modify_number=P.target_number=P.prefix_number=P.command=P.suffix_number=P.cmp_op=i,j.$attr_accessor("command"),j.$attr_accessor("prefix_number"),j.$attr_accessor("suffix_number"),j.$attr_accessor("critical"),j.$attr_accessor("fumble"),j.$attr_accessor("dollar"),j.$attr_accessor("modify_number"),j.$attr_accessor("cmp_op"),j.$attr_accessor("target_number"),j.$attr_writer("question_target"),p(j,"$initialize",function(){var G=this;return G.prefix_number=i,G.suffix_number=i,G.critical=i,G.fumble=i,G.dollar=i,G.cmp_op=i,G.target_number=i,G.question_target=!1},0),p(j,"$question_target?",function(){return this.question_target},0),p(j,"$to_s",function(G){var u,x=this,m=i,q=i,b=i,v=i,f=i;return null==G&&(G="after_command"),m=C(x.critical)?"@"+x.critical:i,q=C(x.fumble)?"#"+x.fumble:i,b=C(x.dollar)?"$"+x.dollar:i,v=l("Format").$modifier(x.modify_number),f=C(x.question_target)?"?":x.target_number,V("after_command",u=G)?[x.prefix_number,x.command,x.suffix_number,m,q,b,v,x.cmp_op,f].$join():V("after_modify_number",u)?[x.prefix_number,x.command,x.suffix_number,v,m,q,b,x.cmp_op,f].$join():V("after_target_number",u)?[x.prefix_number,x.command,x.suffix_number,v,x.cmp_op,f,m,q,b].$join():i},-1)},Opal.modules["bcdice/command/parser"]=function(r){var l,x,u,a,h,E,d,N,A,ee,o,J,ue,c,$,n,_e,q,b,B,Y=r.top,i=[],t=r.$r(i),e=r.nil,p=r.$$$,C=r.klass,V=r.module,s=r.hash2,F=r.send2,I=r.find_super,y=r.def,w=r.send,H=r.to_a,L=r.rb_minus,K=r.eqeq,Q=r.hash,ie=r.const_set,M=r.truthy,j=r.to_ary;return Y.$require("racc/parser.rb"),Y.$require("bcdice/arithmetic/node"),Y.$require("bcdice/command/lexer"),Y.$require("bcdice/command/parsed"),C(p(t("BCDice"),"Command"),p(t("Racc"),"Parser"),"Parser"),l=i,x=B=[V(i[0],"BCDice")].concat(l),q=[V(B[0],"Command")].concat(x),b=r.$r(q),u=q,$=[c=C(q[0],p(b("Racc"),"Parser"),"Parser")].concat(u),n=r.$r($),(_e=c.$$prototype).notations=_e.lexer=_e.modifier=_e.suffix_number=_e.prefix_number=_e.need_suffix_number=_e.need_prefix_number=_e.critical=_e.fumble=_e.dollar=_e.allowed_cmp_op=_e.question_target=e,y(c,"$initialize",function re(z,ne){var D,R,ae,O,W=this;if(delete re.$$p,D=r.slice.call(arguments),null==(R=r.extract_kwargs(D)))R=s([],{});else if(!R.$$is_hash)throw r.ArgumentError.$new("expected kwargs");if(ae=D,!r.hasOwnProperty.call(R.$$smap,"round_type"))throw r.ArgumentError.$new("missing keyword: round_type");return O=R.$$smap.round_type,F(W,I(W,"initialize",re,!1,!0),"initialize",[],null),W.notations=ae,W.round_type=O,W.prefix_number=!1,W.suffix_number=!1,W.need_prefix_number=!1,W.need_suffix_number=!1,W.modifier=!0,W.critical=!1,W.fumble=!1,W.dollar=!1,W.allowed_cmp_op=[e,">=",">","<=","<","==","!="],W.question_target=!1},-2),y(c,"$disable_modifier",function(){return this.modifier=!1,this},0),y(c,"$enable_prefix_number",function(){return this.prefix_number=!0,this},0),y(c,"$enable_suffix_number",function(){return this.suffix_number=!0,this},0),y(c,"$has_prefix_number",function(){var z=this;return z.prefix_number=!0,z.need_prefix_number=!0,z},0),y(c,"$has_suffix_number",function(){var z=this;return z.suffix_number=!0,z.need_suffix_number=!0,z},0),y(c,"$enable_critical",function(){return this.critical=!0,this},0),y(c,"$enable_fumble",function(){return this.fumble=!0,this},0),y(c,"$enable_dollar",function(){return this.dollar=!0,this},0),y(c,"$restrict_cmp_op_to",function(z){var ne,R=this;return ne=r.slice.call(arguments),R.allowed_cmp_op=ne,R},-1),y(c,"$enable_question_target",function(){return this.question_target=!0,this},0),y(c,"$parse",function(z){try{return this.lexer=n("Lexer").$new(z,this.notations),this.$do_parse()}catch(D){if(!r.rescue(D,[n("ParseError"),n("ZeroDivisionError")]))throw D;try{return e}finally{r.pop_exception()}}},1),c.$private(),y(c,"$parsed",function(z,ne,D,R){return w(n("Parsed").$new(),"tap",[],function O(S){var W,k,g,te,ce,Z,X=null==O.$$s?this:O.$$s,U=e;return null==X.round_type&&(X.round_type=e),null==S&&(S=e),U=[z["$[]"]("command")],w(S,"command=",H(U)),L(U.length,1),U=[(W=z["$[]"]("prefix"),W===e||null==W?e:w(W,"eval",[X.round_type]))],w(S,"prefix_number=",H(U)),L(U.length,1),U=[(k=z["$[]"]("suffix"),k===e||null==k?e:w(k,"eval",[X.round_type]))],w(S,"suffix_number=",H(U)),L(U.length,1),U=[(g=ne["$[]"]("critical"),g===e||null==g?e:w(g,"eval",[X.round_type]))],w(S,"critical=",H(U)),L(U.length,1),U=[(te=ne["$[]"]("fumble"),te===e||null==te?e:w(te,"eval",[X.round_type]))],w(S,"fumble=",H(U)),L(U.length,1),U=[(ce=ne["$[]"]("dollar"),ce===e||null==ce?e:w(ce,"eval",[X.round_type]))],w(S,"dollar=",H(U)),L(U.length,1),U=[D.$eval(X.round_type)],w(S,"modify_number=",H(U)),L(U.length,1),U=[R["$[]"]("cmp_op")],w(S,"cmp_op=",H(U)),L(U.length,1),K(R["$[]"]("target"),"?")?(w(S,"question_target=",H(U=[!0])),L(U.length,1),w(S,"target_number=",H(U=[0])),U[L(U.length,1)]):(w(S,"question_target=",H(U=[!1])),L(U.length,1),U=[(Z=R["$[]"]("target"),Z===e||null==Z?e:w(Z,"eval",[X.round_type]))],w(S,"target_number=",H(U)),U[L(U.length,1)])},{$$arity:1,$$s:this})},4),y(c,"$next_token",function(){return this.lexer.$next_token()},0),a=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,33,34,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,36,37,17,18,6,e,5,e,e,17,18,6,e,5,e,e,17,18,e,e,5,23,24,25,26,56,54,55,57],h=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,e,17,15,15,18,18,23,e,18,30,30,23,23,24,e,23,31,31,24,24,25,e,24,44,44,25,25,28,e,25,47,47,28,28,29,e,28,48,48,29,29,33,e,29,49,49,33,33,34,e,33,50,50,34,34,36,e,34,e,e,36,36,37,e,36,e,e,37,37,e,e,37,27,27,27,27,52,52,52,52],E=[-2,4,16,-3,-1,11,e,33,13,35,23,30,1,e,28,40,e,37,44,e,e,-2,e,51,58,65,0,106,72,79,47,54,e,86,93,e,100,107,e,e,e,e,e,e,63,e,e,68,75,82,89,e,120,e,e,e,e,e],d=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],N=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,e,e,21,47,48,40,51,52,49,50,44,46,3,e,e,e,13,e,e,e,e,e,e,e,32],A=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,e,e,4,8,8,5,7,7,8,8,9,5,6,e,e,e,6,e,e,e,e,e,e,e,6],ee=[e,6,13,3,9,-1,27,-15,-10,-1,-38],o=[e,e,e,e,e,e,19,16,15,e,e],J=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],ue=Q(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),ie($[0],"Racc_arg",[a,h,d,E,N,A,o,ee,19,J,ue,58,35,!0]),ie($[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),ie($[0],"Racc_debug_parser",!1),y(c,"$_reduce_1",function(z,ne,D){var R,O=this;return M(O.modifier)||O.$raise(n("ParseError")),R=j(z),O.$parsed(null==R[0]?e:R[0],null==R[1]?e:R[1],null==R[2]?e:R[2],null==R[3]?e:R[3])},3),y(c,"$_reduce_2",function(z,ne,D){var R,O=this;return M(O.modifier)||O.$raise(n("ParseError")),R=j(z),O.$parsed(null==R[0]?e:R[0],null==R[2]?e:R[2],null==R[1]?e:R[1],null==R[3]?e:R[3])},3),y(c,"$_reduce_3",function(z,ne,D){var R,k;return k=null==(R=j(z))[2]?e:R[2],this.$parsed(null==R[0]?e:R[0],null==R[1]?e:R[1],p(p(n("Arithmetic"),"Node"),"Number").$new(0),k)},3),y(c,"$_reduce_4",function(z,ne,D){var R=this;return M(R.prefix_number)&&M(R.suffix_number)||R.$raise(n("ParseError")),s(["command","prefix","suffix"],{command:z["$[]"](1),prefix:z["$[]"](0),suffix:z["$[]"](2)})},3),y(c,"$_reduce_5",function(z,ne,D){var R=this;return M(R.prefix_number)||R.$raise(n("ParseError")),M(R.need_suffix_number)&&R.$raise(n("ParseError")),s(["command","prefix"],{command:z["$[]"](1),prefix:z["$[]"](0)})},3),y(c,"$_reduce_6",function(z,ne,D){var R=this;return M(R.suffix_number)||R.$raise(n("ParseError")),M(R.need_prefix_number)&&R.$raise(n("ParseError")),s(["command","suffix"],{command:z["$[]"](0),suffix:z["$[]"](1)})},3),y(c,"$_reduce_7",function(z,ne,D){var R=this;return(M(R.need_prefix_number)||M(R.need_suffix_number))&&R.$raise(n("ParseError")),s(["command"],{command:z["$[]"](0)})},3),y(c,"$_reduce_8",function(z,ne,D){return s([],{})},3),y(c,"$_reduce_9",function(z,ne,D){var R,k,g,S=e;return S=null==(R=j(z))[0]?e:R[0],k=null==R[2]?e:R[2],M(this.critical)&&M(S["$[]"]("critical")["$nil?"]())||this.$raise(n("ParseError")),w(S,"[]=",H(g=["critical",k])),L(g.length,1),S},3),y(c,"$_reduce_10",function(z,ne,D){var R,k,g,S=e;return S=null==(R=j(z))[0]?e:R[0],k=null==R[2]?e:R[2],M(this.fumble)&&M(S["$[]"]("fumble")["$nil?"]())||this.$raise(n("ParseError")),w(S,"[]=",H(g=["fumble",k])),L(g.length,1),S},3),y(c,"$_reduce_11",function(z,ne,D){var R,k,g,S=e;return S=null==(R=j(z))[0]?e:R[0],k=null==R[2]?e:R[2],M(this.dollar)&&M(S["$[]"]("dollar")["$nil?"]())||this.$raise(n("ParseError")),w(S,"[]=",H(g=["dollar",k])),L(g.length,1),S},3),y(c,"$_reduce_12",function(z,ne,D){return z["$[]"](1)},3),y(c,"$_reduce_13",function(z,ne,D){return p(p(n("Arithmetic"),"Node"),"Negative").$new(z["$[]"](1))},3),y(c,"$_reduce_14",function(z,ne,D){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"+",z["$[]"](2))},3),y(c,"$_reduce_15",function(z,ne,D){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"-",z["$[]"](2))},3),y(c,"$_reduce_16",function(z,ne,D){return M(this.allowed_cmp_op["$include?"](e))||this.$raise(n("ParseError")),s([],{})},3),y(c,"$_reduce_17",function(z,ne,D){var R,S,W;return W=null==(R=j(z))[1]?e:R[1],M(this.allowed_cmp_op["$include?"](S=null==R[0]?e:R[0]))||this.$raise(n("ParseError")),s(["cmp_op","target"],{cmp_op:S,target:W})},3),y(c,"$_reduce_18",function(z,ne,D){var ae,R=this;return ae=z["$[]"](0),M(R.question_target)||R.$raise(n("ParseError")),M(R.allowed_cmp_op["$include?"](ae))||R.$raise(n("ParseError")),s(["cmp_op","target"],{cmp_op:ae,target:"?"})},3),y(c,"$_reduce_19",function(z,ne,D){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"+",z["$[]"](2))},3),y(c,"$_reduce_20",function(z,ne,D){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"-",z["$[]"](2))},3),y(c,"$_reduce_22",function(z,ne,D){return p(p(n("Arithmetic"),"Node"),"BinaryOp").$new(z["$[]"](0),"*",z["$[]"](2))},3),y(c,"$_reduce_23",function(z,ne,D){return z["$[]"](3).$new(z["$[]"](0),z["$[]"](2))},3),y(c,"$_reduce_25",function(z,ne,D){return p(p(n("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),y(c,"$_reduce_26",function(z,ne,D){return p(p(n("Arithmetic"),"Node"),"DivideWithCeil")},3),y(c,"$_reduce_27",function(z,ne,D){return p(p(n("Arithmetic"),"Node"),"DivideWithCeil")},3),y(c,"$_reduce_28",function(z,ne,D){return p(p(n("Arithmetic"),"Node"),"DivideWithRound")},3),y(c,"$_reduce_29",function(z,ne,D){return p(p(n("Arithmetic"),"Node"),"DivideWithFloor")},3),y(c,"$_reduce_30",function(z,ne,D){return z["$[]"](1)},3),y(c,"$_reduce_31",function(z,ne,D){return p(p(n("Arithmetic"),"Node"),"Negative").$new(z["$[]"](1))},3),y(c,"$_reduce_33",function(z,ne,D){return z["$[]"](1)},3),y(c,"$_reduce_34",function(z,ne,D){return p(p(n("Arithmetic"),"Node"),"Number").$new(z["$[]"](0))},3),y(c,"$_reduce_none",function(z,ne,D){return z["$[]"](0)},3)},Opal.modules["bcdice/deprecated/checker"]=function(r){var F,H,ie,M,j,_,K,y,Y=[],i=r.nil,t=r.module,e=r.send,p=r.eqeqeq,C=r.truthy,V=r.def;return F=Y,H=y=[t(Y[0],"BCDice")].concat(F),ie=K=[t(y[0],"Deprecated")].concat(H),j=[M=t(K[0],"Checker")].concat(ie),_=r.$r(j),M.$private(),V(M,"$check_result_legacy",function(P,B,G,x){var v,m=this,q=i,b=i,f=i,u=i;return q=e(B,"map",[],"sides".$to_proc()),v=(b=e(B,"map",[],"value".$to_proc())).$sum(),f=p([100],u=q)?m.$check_1D100(P,v,G,x):p([20],u)?m.$check_1D20(P,v,G,x):p([6,6],u)?m.$check_2D6(P,v,b,G,x):i,(C(f["$nil?"]())||C(f["$empty?"]()))&&(f=p([10],u=q.$uniq())?m.$check_nD10(P,v,b,G,x):p([6],u)?m.$check_nD6(P,v,b,G,x):i,C(f["$nil?"]())||C(f["$empty?"]()))?i:_("Result").$new(f.$delete_prefix(" \uff1e "))},4),V(M,"$check_1D100",function(P,B,G,x){return i},4),V(M,"$check_1D20",function(P,B,G,x){return i},4),V(M,"$check_nD10",function(P,B,G,x,m){return i},5),V(M,"$check_2D6",function(P,B,G,x,m){return i},5),V(M,"$check_nD6",function(P,B,G,x,m){return i},5)},Opal.modules["bcdice/base"]=function(r){var B,b,$,a,h,v,f,u,c,x,Y=r.top,i=[],t=r.$r(i),e=r.nil,p=r.$$$,C=r.module,V=r.klass,s=r.truthy,F=r.def,I=r.regexp,y=r.rb_plus,w=r.send,H=r.to_a,L=r.rb_minus,K=r.eqeqeq,Q=r.eqeq,ie=r.range,M=r.rb_divide,j=r.rb_times,_=r.rb_ge,l=e;return Y.$require("i18n"),Y.$require("i18n/backend/fallbacks"),Y.$require("bcdice/randomizer"),Y.$require("bcdice/dice_table"),Y.$require("bcdice/enum"),Y.$require("bcdice/translate"),Y.$require("bcdice/result"),Y.$require("bcdice/command/parser"),Y.$require("bcdice/deprecated/checker"),B=i,b=x=[C(i[0],"BCDice")].concat(B),f=[v=V(x[0],null,"Base")].concat(b),u=r.$r(f),(c=v.$$prototype).sort_add_dice=c.sort_barabara_dice=c.enabled_d9=c.raw_input=c.randomizer=c.enabled_upcase_input=c.debug=e,a=[$=r.get_singleton_class(v)].concat(f),h=r.$r(a),$.$attr_reader("prefixes"),F($,"$register_prefix",function(d){var A,ee=this,o=e;return null==ee.prefixes&&(ee.prefixes=e),A=r.slice.call(arguments),ee.prefixes=s(o=ee.prefixes)?o:[],ee.prefixes.$concat(A.$flatten())},-1),F($,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())},0),F($,"$prefixes_pattern",function(){var d=this,N=e;return null==d.prefixes_pattern&&(d.prefixes_pattern=e),null==d.prefixes&&(d.prefixes=e),d.prefixes_pattern=s(N=d.prefixes_pattern)?N:e,s(d.prefixes_pattern)?d.prefixes_pattern:(d.prefixes=s(N=d.prefixes)?N:[],d.prefixes.$freeze(),d.prefixes_pattern=(s(d.prefixes["$empty?"]())?/(?!)/:I(["^(S)?(",d.prefixes.$join("|"),")"],"i")).$freeze())},0),F($,"$command_pattern",function(){var d=this,N=e,A=e;return null==d.command_pattern&&(d.command_pattern=e),null==d.prefixes&&(d.prefixes=e),d.command_pattern=s(N=d.command_pattern)?N:e,s(d.command_pattern)?d.command_pattern:(d.prefixes=s(N=d.prefixes)?N:[],d.prefixes.$freeze(),A=y(w(p(h("CommonCommand"),"COMMANDS"),"map",[],function(o){return null==o&&(o=e),p(o,"PREFIX_PATTERN").$source()},1),d.prefixes),d.command_pattern=I(["^S?(",A.$join("|"),")"],"i").$freeze())},0),F($,"$eval",function(d){return this.$new(d).$eval()},1),v.$include(u("Translate")),v.$include(p(u("Deprecated"),"Checker")),F(v,"$initialize",function(n){var a=this;return a.raw_input=n,a.sort_add_dice=!1,a.sort_barabara_dice=!1,a.d66_sort_type=p(u("D66SortType"),"NO_SORT"),a.enabled_d9=!1,a.round_type=p(u("RoundType"),"FLOOR"),a.sides_implicit_d=6,a.upper_dice_reroll_threshold=e,a.reroll_dice_reroll_threshold=e,a.default_cmp_op=e,a.default_target_number=e,a.enabled_upcase_input=!0,a.locale="ja_jp",a.randomizer=p(u("BCDice"),"Randomizer").$new(),a.debug=!1},1),v.$attr_accessor("randomizer"),v.$attr_reader("d66_sort_type"),v.$attr_reader("round_type"),v.$attr_reader("sides_implicit_d"),v.$attr_reader("upper_dice_reroll_threshold"),v.$attr_reader("reroll_dice_reroll_threshold"),v.$attr_reader("default_cmp_op"),v.$attr_reader("default_target_number"),F(v,"$sort_add_dice?",function(){return this.sort_add_dice},0),F(v,"$sort_barabara_dice?",function(){return this.sort_barabara_dice},0),F(v,"$enabled_d9?",function(){return this.enabled_d9},0),F(v,"$enable_debug",function(){return this.debug=!0},0),F(v,"$eval",function(){var a,h,E,n=this,d=e;return a=p(u("BCDice"),"Preprocessor").$process(n.raw_input,n),h=s(E=n.$dice_command(a))?E:n.$eval_common_command(n.raw_input),s(h)?(d=[n.randomizer.$rand_results()],w(h,"rands=",H(d)),L(d.length,1),d=[n.randomizer.$detailed_rand_results()],w(h,"detailed_rands=",H(d)),L(d.length,1),h):e},0),F(v,"$change_text",function(n){return n},1),F(v,"$check_result",function(n,a,h,E){var d=this,N=e,A=e,ee=e,o=e,J=e;return N=d.$check_result_legacy(n,a,h,E),s(N)?N:(A=w(a,"map",[],"sides".$to_proc()),o=(ee=w(a,"map",[],"value".$to_proc())).$sum(),N=K([100],J=A)?d.$result_1d100(n,o,h,E):K([20],J)?d.$result_1d20(n,o,h,E):K([6,6],J)?d.$result_2d6(n,o,ee,h,E):e,Q(N,u("Result").$nothing())?e:s(N)?N:(N=K([10],J=A.$uniq())?d.$result_nd10(n,o,ee,h,E):K([6],J)?d.$result_nd6(n,o,ee,h,E):e,Q(N,u("Result").$nothing())?e:s(N)?N:d.$result_ndx(n,h,E)))},4),F(v,"$grich_text",function(n,a,h){return e},3),v.$private(),F(v,"$eval_common_command",function(n){try{return n=this.$change_text(n),w(p(u("CommonCommand"),"COMMANDS"),"each",[],function h(E){var N,d=null==h.$$s?this:h.$$s;if(null==d.randomizer&&(d.randomizer=e),null==E&&(E=e),N=E.$eval(n,d,d.randomizer),!s(N))return e;r.ret(N)},{$$arity:1,$$s:this}),e}catch(h){if(h===r.returner)return h.$v;throw h}},1),F(v,"$dice_command",function(n){var a=this,h=e,E=e,d=e,N=e,A=e;return s(a.enabled_upcase_input)&&(n=n.$upcase()),h=a.$class().$prefixes_pattern().$match(n),s(h)?(E=h["$[]"](1)["$nil?"]()["$!"](),s(E)&&(n=n["$[]"](ie(1,-1,!1))),d=a.$eval_game_system_specific_command(n),s(d["$is_a?"](u("Result")))?(N=[s(A=d["$secret?"]())?A:E],w(d,"secret=",H(N)),L(N.length,1),d):s(d["$nil?"]())||s(d["$empty?"]())||Q(d,"1")?e:w(u("Result").$new(),"tap",[],function(o){return null==o&&(o=e),N=[d.$to_s()],w(o,"text=",H(N)),L(N.length,1),w(o,"secret=",H(N=[E])),N[L(N.length,1)]},1)):e},1),F(v,"$eval_game_system_specific_command",function(n){return e},1),F(v,"$result_ndx",function(n,a,h){return s(h["$is_a?"](u("String")))?e:s(n.$send(a,h))?u("Result").$success(this.$translate("success")):u("Result").$failure(this.$translate("failure"))},3),F(v,"$result_1d100",function(n,a,h,E){return e},4),F(v,"$result_1d20",function(n,a,h,E){return e},4),F(v,"$result_nd10",function(n,a,h,E,d){return e},5),F(v,"$result_2d6",function(n,a,h,E,d){return e},5),F(v,"$result_nd6",function(n,a,h,E,d){return e},5),F(v,"$get_table_by_2d6",function(n){return this.$get_table_by_nD6(n,2)},1),F(v,"$get_table_by_1d6",function(n){return this.$get_table_by_nD6(n,1)},1),F(v,"$get_table_by_nD6",function(n,a){return this.$get_table_by_nDx(n,a,6)},2),F(v,"$get_table_by_nDx",function(n,a,h){var d,N=e;return d=this.randomizer.$roll_sum(a,h),N=this.$get_table_value(n["$[]"](L(d,a))),s(N["$nil?"]())?["1",0]:[N,d]},3),F(v,"$get_table_by_1d3",function(n){var E,d,a=this,N=e;return a.$debug("get_table_by_1d3"),E=a.randomizer.$roll_sum(1,6),a.$debug("num",E),d=M(L(E,1),2).$to_i(),a.$debug("index",d),N=n["$[]"](d),s(N["$nil?"]())?["1",0]:[N,E]},1),F(v,"$get_table_by_d66_swap",function(n){var h;return h=this.randomizer.$roll_d66(p(u("D66SortType"),"ASC")),[this.$get_table_by_number(h,n),h]},1),F(v,"$get_table_by_d66",function(n){var h,E,d,A,N=e;return h=this.randomizer.$roll_once(6),E=this.randomizer.$roll_once(6),d=y(j(L(h,1),6),L(E,1)),N=n["$[]"](d),A=""+h+E,s(N["$nil?"]())?["1",A]:[N,A]},1),F(v,"$get_table_by_number",function(n,a,h){try{return null==h&&(h="1"),w(a,"each",[],function d(N){var ee,A=null==d.$$s?this:d.$$s;if(null==N&&(N=e),ee=N["$[]"](0),!s(_(ee,n)))return e;r.ret(A.$get_table_value(N["$[]"](1)))},{$$arity:1,$$s:this}),this.$get_table_value(h)}catch(d){if(d===r.returner)return d.$v;throw d}},-3),F(v,"$get_table_value",function(n){return s(n["$is_a?"](u("Proc")))?n.$call():n},1),F(v,"$roll_tables",function(n,a){var E=e;return E=a["$[]"](n),s(E)?E.$roll(this.randomizer).$to_s():e},2),F(v,"$debug",function(n,a){var E,d=this,N=e,A=e;return E=r.slice.call(arguments,1),s(d.debug)?(N=s(n["$is_a?"](u("String")))?n:n.$inspect(),s(E["$empty?"]())?d.$warn(N):(A=w(E,"map",[],function(o){return null==o&&(o=e),s(o["$is_a?"](u("String")))?'"'+o+'"':o.$inspect()},1),d.$warn(N+": "+A.$join(", ")))):e},-2),p(p(t("I18n"),"Backend"),"Simple").$include(p(p(t("I18n"),"Backend"),"Fallbacks")),t("I18n").$load_path()["$<<"](t("Dir")["$[]"](t("File").$join("bcdice","../../i18n/**/*.yml"))),l=["ja_jp"],w(t("I18n"),"default_locale=",H(l)),L(l.length,1),l=[["ja_jp"]],w(t("I18n").$fallbacks(),"defaults=",H(l)),l[L(l.length,1)]},Opal.modules["bcdice/game_system/sword_world/rating_lexer"]=function(r){var w,Q,P,q,b,v,f,G,M,j,L,i=[],t=r.nil,e=r.module,p=r.klass,C=r.const_set,V=r.hash2,s=r.truthy,F=r.send,I=r.def;return r.top.$require("strscan"),w=i,Q=L=[e(i[0],"BCDice")].concat(w),M=[e(L[0],"GameSystem")].concat(Q),j=r.$r(M),P=M,q=G=[p(M[0],j("Base"),"SwordWorld")].concat(P),v=[b=p(G[0],null,"RatingLexer")].concat(q),f=r.$r(v),b.$$prototype.scanner=t,C(v[0],"SYMBOLS",V(["+","-","*","/","(",")","[","]","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),I(b,"$initialize",function($){var n,a,E;return $=s(E=(a=(n=$)===t||null==n?t:F(n,"split",[" ",2]))===t||null==a?t:F(a,"first",[]))?E:"",this.scanner=f("StringScanner").$new($)},1),I(b,"$next_token",function(){var $=this,n=t,a=t,E=t;return s($.scanner["$eos?"]())?[!1,"$"]:s(n=$.scanner.$scan(/\d+/))?["NUMBER",n.$to_i()]:(a=$.scanner.$getch().$upcase(),[s(E=f("SYMBOLS")["$[]"](a))?E:a.$to_sym(),a])},0),I(b,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/game_system/sword_world/rating_parsed"]=function(r){var w,Q,P,q,b,v,f,u,G,M,j,L,Y=[],i=r.nil,t=r.module,e=r.klass,p=r.def,C=r.truthy,V=r.rb_le,s=r.rb_plus,F=r.rb_lt,I=r.neqeq;return w=Y,Q=L=[t(Y[0],"BCDice")].concat(w),M=[t(L[0],"GameSystem")].concat(Q),j=r.$r(M),P=M,q=G=[e(M[0],j("Base"),"SwordWorld")].concat(P),v=[b=e(G[0],null,"RatingParsed")].concat(q),f=r.$r(v),(u=b.$$prototype).modifier_after_half=u.semi_fixed_val=u.kept_modify=u.rate=u.greatest_fortune=u.modifier=i,b.$attr_accessor("rate"),b.$attr_accessor("critical"),b.$attr_accessor("kept_modify"),b.$attr_accessor("first_to"),b.$attr_accessor("first_modify"),b.$attr_accessor("rateup"),b.$attr_accessor("greatest_fortune"),b.$attr_accessor("semi_fixed_val"),b.$attr_accessor("tmp_fixed_val"),b.$attr_accessor("modifier"),b.$attr_accessor("modifier_after_half"),p(b,"$initialize",function($,n){var a=this;return a.rate=$,a.modifier=n,a.critical=13,a.kept_modify=0,a.first_to=0,a.first_modify=0,a.greatest_fortune=!1,a.rateup=0,a.semi_fixed_val=0,a.tmp_fixed_val=0,a.modifier_after_half=i},2),p(b,"$half",function(){return this.modifier_after_half["$nil?"]()["$!"]()},0),p(b,"$min_critical",function(){var $=this;return C(V($.semi_fixed_val,1))?3:s(s($.semi_fixed_val,$.kept_modify),2).$clamp(3,13)},0),p(b,"$infinite_roll?",function(){return F(this.$critical(),this.$min_critical())},0),p(b,"$to_s",function(){var $=this,n=i;return n="KeyNo."+$.rate,C(F($.$critical(),13))&&(n=s(n,"c["+$.$critical()+"]")),I($.$first_modify(),0)&&(n=s(n,"m["+f("Format").$modifier($.$first_modify())+"]")),I($.$first_to(),0)&&(n=s(n,"m["+$.$first_to()+"]")),I($.$rateup(),0)&&(n=s(n,"r["+$.$rateup()+"]")),C($.greatest_fortune)&&(n=s(n,"gf")),I($.$semi_fixed_val(),0)&&(n=s(n,"sf["+$.$semi_fixed_val()+"]")),I($.$tmp_fixed_val(),0)&&(n=s(n,"tf["+$.$tmp_fixed_val()+"]")),I($.$kept_modify(),0)&&(n=s(n,"a["+f("Format").$modifier($.$kept_modify())+"]")),I($.modifier,0)&&(n=s(n,f("Format").$modifier($.modifier))),n},0)},Opal.modules["bcdice/game_system/sword_world/rating_options"]=function(r){var s,w,M,B,_,L,K,I,Y=[],t=r.module,e=r.klass,p=r.truthy,C=r.def;return s=Y,w=I=[t(Y[0],"BCDice")].concat(s),L=[t(I[0],"GameSystem")].concat(w),K=r.$r(L),M=L,_=[e(L[0],K("Base"),"SwordWorld")].concat(M),(B=e(_[0],null,"RatingOptions")).$attr_accessor("critical"),B.$attr_accessor("kept_modify"),B.$attr_accessor("first_to"),B.$attr_accessor("first_modify"),B.$attr_accessor("rateup"),B.$attr_accessor("greatest_fortune"),B.$attr_accessor("semi_fixed_val"),B.$attr_accessor("tmp_fixed_val"),B.$attr_accessor("modifier"),B.$attr_accessor("modifier_after_half"),C(B,"$settable_first_roll_adjust_option?",function(){var m;return p(m=this.$first_modify()["$nil?"]())?this.$first_to()["$nil?"]():m},0),C(B,"$settable_non_2d_roll_option?",function(){var m,q,x=this;return p(m=p(q=x.$greatest_fortune()["$nil?"]())?x.$semi_fixed_val()["$nil?"]():q)?x.$tmp_fixed_val()["$nil?"]():m},0)},Opal.modules["bcdice/game_system/sword_world/rating_parser"]=function(r){var l,x,u,E,ee,o,J,T,$e,ue,le,fe,_e,ne,d,N,A,ae,$,n,q,b,B,Y=r.top,i=[],t=r.nil,e=r.$$$,p=r.module,C=r.klass,V=r.hash2,s=r.send2,F=r.find_super,I=r.def,y=r.send,w=r.truthy,H=r.to_a,L=r.rb_minus,K=r.not,Q=r.hash,ie=r.const_set,M=r.to_ary,j=r.eqeq;return Y.$require("racc/parser.rb"),Y.$require("bcdice/arithmetic/node"),Y.$require("bcdice/enum"),Y.$require("bcdice/game_system/sword_world/rating_lexer"),Y.$require("bcdice/game_system/sword_world/rating_parsed"),Y.$require("bcdice/game_system/sword_world/rating_options"),l=i,x=B=[p(i[0],"BCDice")].concat(l),q=[p(B[0],"GameSystem")].concat(x),b=r.$r(q),u=q,$=[C(q[0],b("Base"),"SwordWorld")].concat(u),n=r.$r($),E=$,N=[d=C($[0],e(n("Racc"),"Parser"),"RatingParser")].concat(E),A=r.$r(N),(ae=d.$$prototype).lexer=ae.round_type=ae.version=t,I(d,"$initialize",function O(S){var W,k;if(delete O.$$p,null==S)S=V([],{});else if(!S.$$is_hash)throw r.ArgumentError.$new("expected kwargs");return null==(W=S.$$smap.version)&&(W="v1_0"),null==(k=S.$$smap.round_type)&&(k=e(A("RoundType"),"CEIL")),s(this,F(this,"initialize",O,!1,!0),"initialize",[],null),this.version=W,this.round_type=k},-1),I(d,"$set_debug",function(){return this.yydebug=!0,this},0),I(d,"$parse",function(S){try{return this.lexer=A("RatingLexer").$new(S),this.$do_parse()}catch(k){if(!r.rescue(k,[A("ParseError"),A("ZeroDivisionError")]))throw k;try{return t}finally{r.pop_exception()}}},1),d.$private(),I(d,"$parsed",function(S,W,k){return y(A("RatingParsed").$new(S,W),"tap",[],function te(ce){var Z,X,U,se,me,ve,be,he=null==te.$$s?this:te.$$s,oe=t,de=t;return null==he.round_type&&(he.round_type=t),null==ce&&(ce=t),oe=[w((Z=k.$kept_modify(),de=Z===t||null==Z?t:y(Z,"eval",[he.round_type])))?de:0],y(ce,"kept_modify=",H(oe)),L(oe.length,1),oe=[w(de=k.$first_to())?de:0],y(ce,"first_to=",H(oe)),L(oe.length,1),oe=[w(de=k.$first_modify())?de:0],y(ce,"first_modify=",H(oe)),L(oe.length,1),oe=[w((X=k.$rateup(),de=X===t||null==X?t:y(X,"eval",[he.round_type])))?de:0],y(ce,"rateup=",H(oe)),L(oe.length,1),K(k.$greatest_fortune()["$nil?"]())&&(oe=[k.$greatest_fortune()],y(ce,"greatest_fortune=",H(oe)),L(oe.length,1)),oe=[w((U=k.$semi_fixed_val(),de=U===t||null==U?t:y(U,"clamp",[1,6])))?de:0],y(ce,"semi_fixed_val=",H(oe)),L(oe.length,1),oe=[w((se=k.$tmp_fixed_val(),de=se===t||null==se?t:y(se,"clamp",[1,6])))?de:0],y(ce,"tmp_fixed_val=",H(oe)),L(oe.length,1),oe=[(me=k.$modifier_after_half(),me===t||null==me?t:y(me,"eval",[he.round_type]))],y(ce,"modifier_after_half=",H(oe)),L(oe.length,1),oe=[w((ve=k.$critical(),be=ve===t||null==ve?t:y(ve,"eval",[he.round_type]),de=be===t||null==be?t:y(be,"clamp",[0,13])))?de:w(ce.$half())?13:10],y(ce,"critical=",H(oe)),oe[L(oe.length,1)]},{$$arity:1,$$s:this})},3),I(d,"$next_token",function(){return this.lexer.$next_token()},0),ee=[15,14,16,5,17,18,20,21,57,58,23,24,11,59,12,19,13,15,14,16,4,17,18,20,21,4,30,3,30,11,8,12,19,13,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,9,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,37,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,38,39,32,26,27,26,27,29,46,29,33,34,51,52,53,54],o=[6,6,6,1,6,6,6,6,49,49,10,10,6,49,6,6,6,22,22,22,3,22,22,22,22,0,11,0,12,22,4,22,22,22,11,11,12,12,11,14,12,15,41,41,43,43,19,14,14,15,15,14,20,15,19,19,5,21,19,23,20,20,44,44,20,21,21,23,23,21,24,23,26,45,45,50,50,27,24,24,26,26,24,29,26,27,27,16,55,27,56,29,29,62,62,29,55,55,56,56,55,57,56,58,63,63,17,18,13,57,57,58,58,57,25,58,13,13,33,34,38,39],J=[22,3,t,17,28,56,-4,t,t,t,0,24,26,106,37,39,80,99,100,44,50,55,13,57,68,97,70,75,t,81,t,t,t,116,117,t,t,t,118,119,t,30,t,32,50,61,t,t,t,-2,63,t,t,t,t,86,88,99,101,t,t,t,81,92],T=[-33,-33,-4,-33,-33,-33,-1,-4,-3,64,-5,-33,-33,-33,-11,-33,-33,-33,-33,-33,-33,-33,-2,-33,-33,-33,-33,-33,-30,-33,-32,-7,-8,-33,-33,-12,-13,-14,-33,-33,-17,-18,-27,-19,-20,-21,-6,-28,-29,-33,-24,-9,-10,-15,-16,-33,-33,-33,-33,-31,-25,-26,-22,-23],$e=[25,31,6,35,36,1,49,22,40,41,43,2,44,45,7,47,48,t,50,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,60,61,62,63],ue=[5,5,3,5,5,1,7,3,5,6,6,2,6,6,2,5,5,t,6,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,5,5,6,6],le=[t,5,11,0,t,-11,-11,-23,t],fe=[t,t,t,t,10,42,t,t,28],_e=[0,0,"racc_error",2,22,"_reduce_1",3,22,"_reduce_2",2,23,"_reduce_3",0,24,"_reduce_4",2,24,"_reduce_5",4,24,"_reduce_6",3,24,"_reduce_7",3,24,"_reduce_8",4,24,"_reduce_9",4,24,"_reduce_10",2,24,"_reduce_11",3,24,"_reduce_12",3,24,"_reduce_13",3,24,"_reduce_14",4,24,"_reduce_15",4,24,"_reduce_16",3,24,"_reduce_17",2,25,"_reduce_18",2,25,"_reduce_19",3,25,"_reduce_20",3,25,"_reduce_21",3,28,"_reduce_22",3,28,"_reduce_23",1,28,"_reduce_none",3,27,"_reduce_25",3,27,"_reduce_26",1,27,"_reduce_none",2,26,"_reduce_28",2,26,"_reduce_29",1,26,"_reduce_none",3,29,"_reduce_31",1,29,"_reduce_32"],ne=Q(!1,0,"error",1,"NUMBER",2,"K",3,"R",4,"H",5,"G",6,"F",7,"S",8,"T",9,"PLUS",10,"MINUS",11,"ASTERISK",12,"SLASH",13,"PARENL",14,"PARENR",15,"BRACKETL",16,"BRACKETR",17,"AT",18,"SHARP",19,"DOLLAR",20),ie(N[0],"Racc_arg",[ee,o,T,J,$e,ue,fe,le,21,_e,ne,64,33,!0]),ie(N[0],"Racc_token_to_s_table",["$end","error","NUMBER","K","R","H","G","F","S","T","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","AT","SHARP","DOLLAR","$start","expr","rate","option","modifier","unary","mul","add","term"]),ie(N[0],"Racc_debug_parser",!1),I(d,"$_reduce_1",function(S,W,k){var g,Z,se,X=t,U=t;return Z=null==(g=M(S))[0]?t:g[0],U=w(se=(X=null==g[1]?t:g[1]).$modifier())?se:e(e(A("Arithmetic"),"Node"),"Number").$new(0),this.$parsed(Z,U.$eval(this.round_type),X)},3),I(d,"$_reduce_2",function(S,W,k){var g,X,se,U=t,me=t,ve=t;return X=null==(g=M(S))[1]?t:g[1],w((U=null==g[2]?t:g[2]).$modifier_after_half())||(me=[e(e(A("Arithmetic"),"Node"),"Number").$new(0)],y(U,"modifier_after_half=",H(me)),L(me.length,1)),ve=w(se=U.$modifier())?se:e(e(A("Arithmetic"),"Node"),"Number").$new(0),this.$parsed(X,ve.$eval(this.round_type),U)},3),I(d,"$_reduce_3",function(S,W,k){return S["$[]"](1).$to_i()},3),I(d,"$_reduce_4",function(S,W,k){return A("RatingOptions").$new()},3),I(d,"$_reduce_5",function(S,W,k){var g,X,U,Z=t;return X=null==(g=M(S))[1]?t:g[1],w((Z=null==g[0]?t:g[0]).$modifier()["$nil?"]())||this.$raise(A("ParseError")),y(Z,"modifier=",H(U=[X])),L(U.length,1),Z},3),I(d,"$_reduce_6",function(S,W,k){var g,U,se,Z=t;return U=null==(g=M(S))[2]?t:g[2],w((Z=null==g[0]?t:g[0]).$critical()["$nil?"]())||this.$raise(A("ParseError")),y(Z,"critical=",H(se=[U])),L(se.length,1),Z},3),I(d,"$_reduce_7",function(S,W,k){var g,U,se,Z=t;return U=null==(g=M(S))[2]?t:g[2],w((Z=null==g[0]?t:g[0]).$critical()["$nil?"]())||this.$raise(A("ParseError")),y(Z,"critical=",H(se=[U])),L(se.length,1),Z},3),I(d,"$_reduce_8",function(S,W,k){var g,se,Z=t,U=t;return U=null==(g=M(S))[2]?t:g[2],w((Z=null==g[0]?t:g[0])["$settable_first_roll_adjust_option?"]())||this.$raise(A("ParseError")),se=[U.$to_i()],y(Z,"first_to=",H(se)),L(se.length,1),Z},3),I(d,"$_reduce_9",function(S,W,k){var g,se,Z=t,U=t;return U=null==(g=M(S))[3]?t:g[3],w((Z=null==g[0]?t:g[0])["$settable_first_roll_adjust_option?"]())||this.$raise(A("ParseError")),se=[U.$to_i()],y(Z,"first_modify=",H(se)),L(se.length,1),Z},3),I(d,"$_reduce_10",function(S,W,k){var g,se,Z=t,U=t;return U=null==(g=M(S))[3]?t:g[3],w((Z=null==g[0]?t:g[0])["$settable_first_roll_adjust_option?"]())||this.$raise(A("ParseError")),se=[U.$to_i()["$-@"]()],y(Z,"first_modify=",H(se)),L(se.length,1),Z},3),I(d,"$_reduce_11",function(S,W,k){var g,U,Z=t;return g=M(S),w((Z=null==g[0]?t:g[0]).$modifier_after_half()["$nil?"]())||this.$raise(A("ParseError")),U=[e(e(A("Arithmetic"),"Node"),"Number").$new(0)],y(Z,"modifier_after_half=",H(U)),L(U.length,1),Z},3),I(d,"$_reduce_12",function(S,W,k){var g,U,se,Z=t;return U=null==(g=M(S))[2]?t:g[2],w((Z=null==g[0]?t:g[0]).$modifier_after_half()["$nil?"]())||this.$raise(A("ParseError")),y(Z,"modifier_after_half=",H(se=[U])),L(se.length,1),Z},3),I(d,"$_reduce_13",function(S,W,k){var g,U,se,Z=t;return Z=null==(g=M(S))[0]?t:g[0],U=null==g[2]?t:g[2],w(["v2_5","v2_0"]["$include?"](this.version))&&w(Z.$rateup()["$nil?"]())||this.$raise(A("ParseError")),y(Z,"rateup=",H(se=[U])),L(se.length,1),Z},3),I(d,"$_reduce_14",function(S,W,k){var g,U,Z=t;return Z=null==(g=M(S))[0]?t:g[0],w(["v2_5","v2_0"]["$include?"](this.version))&&w(Z["$settable_non_2d_roll_option?"]())||this.$raise(A("ParseError")),y(Z,"greatest_fortune=",H(U=[!0])),L(U.length,1),Z},3),I(d,"$_reduce_15",function(S,W,k){var g,se,Z=t,U=t;return Z=null==(g=M(S))[0]?t:g[0],U=null==g[3]?t:g[3],w(["v2_5","v2_0"]["$include?"](this.version))&&w(Z["$settable_non_2d_roll_option?"]())||this.$raise(A("ParseError")),se=[U.$to_i()],y(Z,"semi_fixed_val=",H(se)),L(se.length,1),Z},3),I(d,"$_reduce_16",function(S,W,k){var g,se,Z=t,U=t;return Z=null==(g=M(S))[0]?t:g[0],U=null==g[3]?t:g[3],w(["v2_5","v2_0"]["$include?"](this.version))&&w(Z["$settable_non_2d_roll_option?"]())||this.$raise(A("ParseError")),se=[U.$to_i()],y(Z,"tmp_fixed_val=",H(se)),L(se.length,1),Z},3),I(d,"$_reduce_17",function(S,W,k){var g,U,se,Z=t;return Z=null==(g=M(S))[0]?t:g[0],U=null==g[2]?t:g[2],j(this.version,"v2_5")&&w(Z.$kept_modify()["$nil?"]())||this.$raise(A("ParseError")),y(Z,"kept_modify=",H(se=[U])),L(se.length,1),Z},3),I(d,"$_reduce_18",function(S,W,k){return S["$[]"](1)},3),I(d,"$_reduce_19",function(S,W,k){return e(e(A("Arithmetic"),"Node"),"Negative").$new(S["$[]"](1))},3),I(d,"$_reduce_20",function(S,W,k){return e(e(A("Arithmetic"),"Node"),"BinaryOp").$new(S["$[]"](0),"+",S["$[]"](2))},3),I(d,"$_reduce_21",function(S,W,k){return e(e(A("Arithmetic"),"Node"),"BinaryOp").$new(S["$[]"](0),"-",S["$[]"](2))},3),I(d,"$_reduce_22",function(S,W,k){return e(e(A("Arithmetic"),"Node"),"BinaryOp").$new(S["$[]"](0),"+",S["$[]"](2))},3),I(d,"$_reduce_23",function(S,W,k){return e(e(A("Arithmetic"),"Node"),"BinaryOp").$new(S["$[]"](0),"-",S["$[]"](2))},3),I(d,"$_reduce_25",function(S,W,k){return e(e(A("Arithmetic"),"Node"),"BinaryOp").$new(S["$[]"](0),"*",S["$[]"](2))},3),I(d,"$_reduce_26",function(S,W,k){return e(e(A("Arithmetic"),"Node"),"DivideWithGameSystemDefault").$new(S["$[]"](0),S["$[]"](2))},3),I(d,"$_reduce_28",function(S,W,k){return S["$[]"](1)},3),I(d,"$_reduce_29",function(S,W,k){return e(e(A("Arithmetic"),"Node"),"Negative").$new(S["$[]"](1))},3),I(d,"$_reduce_31",function(S,W,k){return S["$[]"](1)},3),I(d,"$_reduce_32",function(S,W,k){return e(e(A("Arithmetic"),"Node"),"Number").$new(S["$[]"](0))},3),I(d,"$_reduce_none",function(S,W,k){return S["$[]"](0)},3)},Opal.queue(function(r){var m,f,h,E,d,N,A,c,$,b,Y=r.top,i=[],t=r.nil,e=r.module,p=r.klass,C=r.const_set,V=r.send2,s=r.find_super,F=r.def,I=r.truthy,y=r.rb_ge,w=r.rb_le,H=r.eqeq,L=r.neqeq,K=r.rb_minus,Q=r.rb_gt,ie=r.hash2,M=r.send,j=r.to_ary,_=r.rb_plus,l=r.rb_lt,P=r.rb_times,B=r.to_a,G=r.rb_divide;return Y.$require("bcdice/base"),Y.$require("bcdice/game_system/sword_world/rating_parser"),m=i,f=b=[e(i[0],"BCDice")].concat(m),c=[e(b[0],"GameSystem")].concat(f),$=r.$r(c),h=c,d=[E=p(c[0],$("Base"),"SwordWorld")].concat(h),N=r.$r(d),(A=E.$$prototype).rating_table=A.randomizer=t,C(d[0],"ID","SwordWorld"),C(d[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG"),C(d[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u3068"),C(d[0],"HELP_MESSAGE","\u30fbSW\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx[c]+m$f) (x:\u30ad\u30fc, c:\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024, m:\u30dc\u30fc\u30ca\u30b9, f:\u51fa\u76ee\u4fee\u6b63)\n"),E.$register_prefix("H?K"),F(E,"$initialize",function ee(o){var T=this;return delete ee.$$p,V(T,s(T,"initialize",ee,!1,!0),"initialize",[o],null),T.rating_table=0},1),F(E,"$result_2d6",function(o,J,T,$e,ue){return I(y(J,12))?N("Result").$critical(this.$translate("SwordWorld.critical")):I(w(J,2))?N("Result").$fumble(this.$translate("SwordWorld.fumble")):L($e,">=")||H(ue,"?")?t:I(y(o,ue))?N("Result").$success(this.$translate("success")):N("Result").$failure(this.$translate("failure"))},5),F(E,"$eval_game_system_specific_command",function(o){return this.$rating(o)},1),E.$private(),F(E,"$rating_parser",function(){return N("RatingParser").$new()},0),F(E,"$rating",function(o){var J,T,$e=this,ue=t,le=t,fe=t,_e=t,re=t,z=t,ne=t,D=t,R=t,ae=t,O=t,S=t,W=t,k=t,te=t,ce=t;return $e.$debug("rating string",o),ue=$e.$rating_parser().$parse(o),I(ue)?(le=$e.$getSW2_0_RatingTable(),fe=K(le.$length(),1),$e.$debug("keyMax",fe),I(Q(ue.$rate(),fe))?N("Result").$new($e.$translate("SwordWorld.keynumber_exceeds",ie(["keyMax"],{keyMax:fe}))):I(ue["$infinite_roll?"]())?N("Result").$new($e.$translate("SwordWorld.infinite_critical",ie(["min_critical"],{min_critical:ue.$min_critical()}))):(_e=$e.$getNewRates(le),re=ue+" \uff1e ",z=[],ne=[],D=[],R=0,ae=0,O=0,S=0,W=ue.$first_to(),k=ue.$first_modify(),function(){var Z=r.new_brk();try{M($e,"loop",[],function X(){var U,se,he,oe,me=null==X.$$s?this:X.$$s,ve=t,be=t;if(se=me.$rollDice(ue,S),be=null==(U=j(se))[1]?t:U[1],R=ve=null==U[0]?t:U[0],L(W,0)?(R=ve=W,W=0):L(k,0)&&(R=_(R,k),k=0),I(w(ve,2))&&(z["$<<"](ve.$to_s()),ne["$<<"](be.$to_s()),D["$<<"]("**"),S=_(S,1),r.brk(t,Z)),L(ue.$kept_modify(),0)&&L(R,2)&&(R=_(R,ue.$kept_modify())),I(l(R,2))&&(R=2),I(Q(R,12))&&(R=12),he=[_(ue.$rate(),P(S,ue.$rateup())),fe].$min(),me.$debug("currentKey",he),oe=_e["$[]"](R)["$[]"](he),me.$debug("rateValue",oe),O=_(O,oe),ae=_(ae,R),z["$<<"](R.$to_s()),ne["$<<"](be.$to_s()),D["$<<"](I(Q(R,2))?oe:"**"),S=_(S,1),I(y(R,ue.$critical())))return t;r.brk(t,Z)},{$$arity:0,$$s:$e,$$brk:Z})}catch(X){if(X===Z)return X.$v;throw X}}(),T=$e.$getResultText(O,ue,ne,z,D,ae,S),J=j(T),te=null==J[1]?t:J[1],ce=null==J[2]?t:J[2],re=_(re,null==J[0]?t:J[0]),M(N("Result").$new(),"tap",[],function(X){var U=t;return null==X&&(X=t),M(X,"text=",B(U=[re])),K(U.length,1),M(X,"critical=",B(U=[te])),K(U.length,1),M(X,"fumble=",B(U=[ce])),U[K(U.length,1)]},1))):($e.$debug("not matched"),"1")},1),F(E,"$getSW2_0_RatingTable",function(){return["*,0,0,0,1,2,2,3,3,4,4","*,0,0,0,1,2,3,3,3,4,4","*,0,0,0,1,2,3,4,4,4,4","*,0,0,1,1,2,3,4,4,4,5","*,0,0,1,2,2,3,4,4,5,5","*,0,1,1,2,2,3,4,5,5,5","*,0,1,1,2,3,3,4,5,5,5","*,0,1,1,2,3,4,4,5,5,6","*,0,1,2,2,3,4,4,5,6,6","*,0,1,2,3,3,4,4,5,6,7","*,1,1,2,3,3,4,5,5,6,7","*,1,2,2,3,3,4,5,6,6,7","*,1,2,2,3,4,4,5,6,6,7","*,1,2,3,3,4,4,5,6,7,7","*,1,2,3,4,4,4,5,6,7,8","*,1,2,3,4,4,5,5,6,7,8","*,1,2,3,4,4,5,6,7,7,8","*,1,2,3,4,5,5,6,7,7,8","*,1,2,3,4,5,6,6,7,7,8","*,1,2,3,4,5,6,7,7,8,9","*,1,2,3,4,5,6,7,8,9,10","*,1,2,3,4,6,6,7,8,9,10","*,1,2,3,5,6,6,7,8,9,10","*,2,2,3,5,6,7,7,8,9,10","*,2,3,4,5,6,7,7,8,9,10","*,2,3,4,5,6,7,8,8,9,10","*,2,3,4,5,6,8,8,9,9,10","*,2,3,4,6,6,8,8,9,9,10","*,2,3,4,6,6,8,9,9,10,10","*,2,3,4,6,7,8,9,9,10,10","*,2,4,4,6,7,8,9,10,10,10","*,2,4,5,6,7,8,9,10,10,11","*,3,4,5,6,7,8,10,10,10,11","*,3,4,5,6,8,8,10,10,10,11","*,3,4,5,6,8,9,10,10,11,11","*,3,4,5,7,8,9,10,10,11,12","*,3,5,5,7,8,9,10,11,11,12","*,3,5,6,7,8,9,10,11,12,12","*,3,5,6,7,8,10,10,11,12,13","*,4,5,6,7,8,10,11,11,12,13","*,4,5,6,7,9,10,11,11,12,13","*,4,6,6,7,9,10,11,12,12,13","*,4,6,7,7,9,10,11,12,13,13","*,4,6,7,8,9,10,11,12,13,14","*,4,6,7,8,10,10,11,12,13,14","*,4,6,7,9,10,10,11,12,13,14","*,4,6,7,9,10,10,12,13,13,14","*,4,6,7,9,10,11,12,13,13,15","*,4,6,7,9,10,12,12,13,13,15","*,4,6,7,10,10,12,12,13,14,15","*,4,6,8,10,10,12,12,13,15,15","*,5,7,8,10,10,12,12,13,15,15","*,5,7,8,10,11,12,12,13,15,15","*,5,7,9,10,11,12,12,14,15,15","*,5,7,9,10,11,12,13,14,15,16","*,5,7,10,10,11,12,13,14,16,16","*,5,8,10,10,11,12,13,15,16,16","*,5,8,10,11,11,12,13,15,16,17","*,5,8,10,11,12,12,13,15,16,17","*,5,9,10,11,12,12,14,15,16,17","*,5,9,10,11,12,13,14,15,16,18","*,5,9,10,11,12,13,14,16,17,18","*,5,9,10,11,13,13,14,16,17,18","*,5,9,10,11,13,13,15,17,17,18","*,5,9,10,11,13,14,15,17,17,18","*,5,9,10,12,13,14,15,17,18,18","*,5,9,10,12,13,15,15,17,18,19","*,5,9,10,12,13,15,16,17,19,19","*,5,9,10,12,14,15,16,17,19,19","*,5,9,10,12,14,16,16,17,19,19","*,5,9,10,12,14,16,17,18,19,19","*,5,9,10,13,14,16,17,18,19,20","*,5,9,10,13,15,16,17,18,19,20","*,5,9,10,13,15,16,17,19,20,21","*,6,9,10,13,15,16,18,19,20,21","*,6,9,10,13,16,16,18,19,20,21","*,6,9,10,13,16,17,18,19,20,21","*,6,9,10,13,16,17,18,20,21,22","*,6,9,10,13,16,17,19,20,22,23","*,6,9,10,13,16,18,19,20,22,23","*,6,9,10,13,16,18,20,21,22,23","*,6,9,10,13,17,18,20,21,22,23","*,6,9,10,14,17,18,20,21,22,24","*,6,9,11,14,17,18,20,21,23,24","*,6,9,11,14,17,19,20,21,23,24","*,6,9,11,14,17,19,21,22,23,24","*,7,10,11,14,17,19,21,22,23,25","*,7,10,12,14,17,19,21,22,24,25","*,7,10,12,14,18,19,21,22,24,25","*,7,10,12,15,18,19,21,22,24,26","*,7,10,12,15,18,19,21,23,25,26","*,7,11,13,15,18,19,21,23,25,26","*,7,11,13,15,18,20,21,23,25,27","*,8,11,13,15,18,20,22,23,25,27","*,8,11,13,16,18,20,22,23,25,28","*,8,11,14,16,18,20,22,23,26,28","*,8,11,14,16,19,20,22,23,26,28","*,8,12,14,16,19,20,22,24,26,28","*,8,12,15,16,19,20,22,24,27,28","*,8,12,15,17,19,20,22,24,27,29","*,8,12,15,18,19,20,22,24,27,30"]},0),F(E,"$getNewRates",function(o){var T=t,$e=t,ue=t,le=t,fe=t,_e=t,re=t,z=t,ne=t,D=t,R=t,ae=t;return T=[],$e=[],ue=[],le=[],fe=[],_e=[],re=[],z=[],ne=[],D=[],R=[],M(o,"each",[],function(W){var k=t;return null==W&&(W=t),k=W.$split(/,/),R.$push(0),T.$push(k["$[]"](1).$to_i()),$e.$push(k["$[]"](2).$to_i()),ue.$push(k["$[]"](3).$to_i()),le.$push(k["$[]"](4).$to_i()),fe.$push(k["$[]"](5).$to_i()),_e.$push(k["$[]"](6).$to_i()),re.$push(k["$[]"](7).$to_i()),z.$push(k["$[]"](8).$to_i()),ne.$push(k["$[]"](9).$to_i()),D.$push(k["$[]"](10).$to_i())},1),H(this.rating_table,1)&&(ae=[31,(ae=[32,(ae=[33,10],M(D,"[]=",B(ae)),ae[K(ae.length,1)])],M(D,"[]=",B(ae)),ae[K(ae.length,1)])],M(D,"[]=",B(ae)),K(ae.length,1)),[R,R,R,T,$e,ue,le,fe,_e,re,z,ne,D]},1),F(E,"$rollDice",function(o,J){var $e=t;return[($e=this.randomizer.$roll_barabara(2,6)).$sum(),$e.$join(",")]},2),F(E,"$getResultText",function(o,J,T,$e,ue,le,fe){var _e=t,re=t,z=t,ne=t,D=t;return(_e=[]).$push("2D:["+T.$join(" ")+"]="+$e.$join(",")),I(w(le,2))?(_e.$push(ue.$join(",")),_e.$push("\u81ea\u52d5\u7684\u5931\u6557"),[_e.$join(" \uff1e "),!1,!0]):(I(Q(ue.$size(),1))||L(J.$modifier(),0)?(re=_(ue.$join(","),N("Format").$modifier(J.$modifier())),I(J.$half())&&(re="("+re+")/2",L(J.$modifier_after_half(),0)&&(re=_(re,N("Format").$modifier(J.$modifier_after_half())))),_e.$push(re)):I(J.$half())&&(re=ue.$first()+"/2",L(J.$modifier_after_half(),0)&&(re=_(re,N("Format").$modifier(J.$modifier_after_half()))),_e.$push(re)),I(Q(fe,1))&&(z=K(fe,1)+"\u56de\u8ee2",_e.$push(z)),ne=_(o,J.$modifier()),I(J.$half())&&(ne=G(ne,2).$ceil(),L(J.$modifier_after_half(),0)&&(ne=_(ne,J.$modifier_after_half()))),D=ne.$to_s(),_e.$push(D),[_e.$join(" \uff1e "),Q(fe,1),!1])},7)})}}]);