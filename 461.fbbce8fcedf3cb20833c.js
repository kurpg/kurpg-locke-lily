(self.webpackChunkudonarium_lily=self.webpackChunkudonarium_lily||[]).push([[461],{461:function(Xe,Je,Ze){Ze(4656),Opal.modules["i18n/backend/fallbacks"]=function(e){function H(B,$){return"number"==typeof B&&"number"==typeof $?B-$:B["$-"]($)}var $,p,N,g,V,F,O,x=[],r=e.nil,d=e.$$$,n=e.$$,ae=e.module,c=e.truthy,j=e.send,W=e.send2,t=e.hash2;return $=x,O=[F=ae(x[0],"I18n")].concat($),e.class_variable_set(O[0],"@@fallbacks",r),p=e.get_singleton_class(F),V=[p].concat(O),e.def(p,"$fallbacks",N=function(){var K,i,y;return e.class_variable_set(V[1],"@@fallbacks",c(y=null==(K=V[1].$$cvars["@@fallbacks"])?r:K)?y:d(d(n(V,"I18n"),"Locale"),"Fallbacks").$new()),c(i=n(V,"Thread").$current()["$[]"]("i18n_fallbacks"))?i:null==(K=V[1].$$cvars["@@fallbacks"])?r:K},N.$$arity=0),e.def(p,"$fallbacks=",g=function(K){var U,i;return e.class_variable_set(V[1],"@@fallbacks",c(K["$is_a?"](n(V,"Array")))?d(d(n(V,"I18n"),"Locale"),"Fallbacks").$new(K):K),i=["i18n_fallbacks",null==(U=V[1].$$cvars["@@fallbacks"])?r:U],j(n(V,"Thread").$current(),"[]=",e.to_a(i)),i[H(i.length,1)]},g.$$arity=1),void function(p,P){var N=[ae(p,"Backend")].concat(P);!function(g,J){var y,i,b,s,K=ae(g,"Fallbacks"),U=[K].concat(J);e.def(K,"$translate",y=function(E,u,o){try{var h,A=y.$$p,D=this,v=r,m=r,z=r,M=r,Y=r,_=r;for(A&&(y.$$p=null),Y=0,_=arguments.length,M=new Array(_);Y<_;Y++)M[Y]=arguments[Y];return null==o&&(o=n(U,"EMPTY_HASH")),!c(o.$fetch("fallback",!0))||c(o["$[]"]("fallback_in_progress"))?W(D,e.find_super_dispatcher(D,"translate",y,!1,!0),"translate",M,A):(c(o["$[]"]("default"))&&(v=D["$extract_non_symbol_default!"](o)),m=o.$merge(t(["fallback_in_progress"],{fallback_in_progress:!0})),j(n(U,"I18n").$fallbacks()["$[]"](E),"each",[],((h=function(C){var I,L=null==h.$$s?this:h.$$s;null==C&&(C=r);try{return j(L,"catch",["exception"],((I=function(){var ve=null==I.$$s?this:I.$$s,ge=r;if(ge=W(ve,e.find_iter_super_dispatcher(ve,"translate",I.$$def||h.$$def||y,!1,!1),"translate",[C,u,m],null),c(ge["$nil?"]()))return r;c(E.$to_s()["$!="](C.$to_s()))&&ve.$on_fallback(E,C,u,o),e.ret(ge)}).$$s=L,I.$$arity=0,I))}catch(ye){if(!e.rescue(ye,[d(n(U,"I18n"),"InvalidLocale")]))throw ye;try{return r}finally{e.pop_exception()}}}).$$s=D,h.$$arity=1,h)),c(c(z=o["$key?"]("default"))?o["$[]"]("default")["$nil?"]():z)?r:c(v)?W(D,e.find_super_dispatcher(D,"translate",y,!1,!0),"translate",[E,r,o.$merge(t(["default"],{default:v}))],null):D.$throw("exception",d(n(U,"I18n"),"MissingTranslation").$new(E,u,o)))}catch(w){if(w===e.returner)return w.$v;throw w}},y.$$arity=-3),e.def(K,"$extract_non_symbol_default!",i=function(E){var u,A,h=r,X=r;return h=[E["$[]"]("default")].$flatten(),A=j(h,"detect",[],((u=function(v){return null==v&&(v=r),v["$is_a?"](n(U,"Symbol"))["$!"]()}).$$s=this,u.$$arity=1,u)),c(A)&&(X=["default",h["$[]"](0,h.$index(A))],j(E,"[]=",e.to_a(X)),H(X.length,1)),A},i.$$arity=1),e.def(K,"$exists?",b=function(E,u,o){try{var h,A=b.$$p,D=this,v=r,m=r,z=r;for(A&&(b.$$p=null),m=0,z=arguments.length,v=new Array(z);m<z;m++)v[m]=arguments[m];return null==o&&(o=n(U,"EMPTY_HASH")),c(o.$fetch("fallback",!0))?(j(n(U,"I18n").$fallbacks()["$[]"](E),"each",[],((h=function(Y){var _=null==h.$$s?this:h.$$s;null==Y&&(Y=r);try{if(!c(W(_,e.find_iter_super_dispatcher(_,"exists?",h.$$def||b,!1,!1),"exists?",[Y,u],null)))return r;e.ret(!0)}catch(w){if(!e.rescue(w,[d(n(U,"I18n"),"InvalidLocale")]))throw w;try{return r}finally{e.pop_exception()}}}).$$s=D,h.$$arity=1,h)),!1):W(D,e.find_super_dispatcher(D,"exists?",b,!1,!0),"exists?",v,A)}catch(M){if(M===e.returner)return M.$v;throw M}},b.$$arity=-3),K.$private(),e.def(K,"$on_fallback",s=function(E,u,o,h){return r},s.$$arity=4)}(N[0],N)}(O[0],O)},Opal.modules["bcdice/randomizer"]=function(e){function H(p,P){return"number"==typeof p&&"number"==typeof P?p>P:p["$>"](P)}function Z(p,P){return"number"==typeof p&&"number"==typeof P?p+P:p["$+"](P)}function x(p,P){return"number"==typeof p&&"number"==typeof P?p<=P:p["$<="](P)}function r(p,P){return"number"==typeof p&&"number"==typeof P?p-P:p["$-"](P)}function d(p,P){return"number"==typeof p&&"number"==typeof P?p*P:p["$*"](P)}var P,K,i,b,s,l,E,u,o,h,A,X,D,U,y,N,c=[],j=e.nil,W=e.$$$,t=e.$$,$=e.klass,F=e.truthy,O=e.send;return P=c,K=N=[(0,e.module)(c[0],"BCDice")].concat(P),U=$(N[0],null,"Randomizer"),y=[U].concat(K),U.$$prototype.rand_results=U.$$prototype.detailed_rand_results=j,e.const_set(y[0],"UPPER_LIMIT_DICE_TIMES",200),e.const_set(y[0],"UPPER_LIMIT_DICE_SIDES",1e3),e.const_set(y[0],"UPPER_LIMIT_RANDS",1e4),e.def(U,"$initialize",i=function(){return this.rand_results=[],this.detailed_rand_results=[]},i.$$arity=0),U.$attr_reader("rand_results"),U.$attr_reader("detailed_rand_results"),e.const_set(y[0],"DetailedRandResult",t(y,"Struct").$new("kind","sides","value")),e.def(U,"$roll_barabara",b=function(m,z){var M,_,Y=this;return F(H(Z(Y.rand_results.$size(),m),t(y,"UPPER_LIMIT_RANDS")))&&Y.$raise(t(y,"TooManyRandsError")),F(F(_=x(m,0))?_:H(m,t(y,"UPPER_LIMIT_DICE_TIMES")))?[]:O(t(y,"Array"),"new",[m],((M=function(){return(null==M.$$s?this:M.$$s).$roll_once(z)}).$$s=Y,M.$$arity=0,M))},b.$$arity=2),e.def(U,"$roll_sum",s=function(m,z){return this.$roll_barabara(m,z).$sum()},s.$$arity=2),e.def(U,"$roll_once",l=function(m){var M,Y=j;return F(F(M=x(m,0))?M:H(m,t(y,"UPPER_LIMIT_DICE_SIDES")))?0:(Y=this.$rand_inner(m),this.$push_to_detail("normal",m,Y),Y)},l.$$arity=1),e.def(U,"$roll_index",E=function(m){return r(this.$roll_once(m),1)},E.$$arity=1),e.def(U,"$roll_tens_d10",u=function(){var M,z=j;return(z=this.$rand_inner(10))["$=="](10)&&(z=0),M=d(z,10),this.$push_to_detail("tens_d10",10,M),M},u.$$arity=0),e.def(U,"$roll_d9",o=function(){var z;return z=r(this.$rand_inner(10),1),this.$push_to_detail("d9",10,z),z},o.$$arity=0),e.def(U,"$roll_d66",h=function(m){var z,_,Y=j;return Y=O(t(y,"Array"),"new",[2],((z=function(){return(null==z.$$s?this:z.$$s).$roll_once(6)}).$$s=this,z.$$arity=0,z)),_=m,W(t(y,"D66SortType"),"ASC")["$==="](_)?Y["$sort!"]():W(t(y,"D66SortType"),"DESC")["$==="](_)&&Y["$sort!"]()["$reverse!"](),Z(d(Y["$[]"](0),10),Y["$[]"](1))},h.$$arity=1),U.$private(),e.def(U,"$rand_inner",A=function(m){var M,z=this;return F(function(p,P){return"number"==typeof p&&"number"==typeof P?p>=P:p["$>="](P)}(z.rand_results.$size(),t(y,"UPPER_LIMIT_RANDS")))&&z.$raise(t(y,"TooManyRandsError")),M=z.$random(m),z.rand_results["$<<"]([M,m]),M},A.$$arity=1),e.def(U,"$random",X=function(m){return Z(t(y,"Kernel").$rand(m),1)},X.$$arity=1),e.def(U,"$push_to_detail",D=function(m,z,M){var _;return _=t(y,"DetailedRandResult").$new(m,z,M),this.detailed_rand_results.$push(_)},D.$$arity=3),void function(g,J,K){[$(g,J,"TooManyRandsError")].concat(K)}(N[0],t(N,"StandardError"),N)},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var W,F,N,K,U,y,i,g,J,p,B,Z=[],x=e.nil,d=e.$$,n=e.module,ae=e.klass,c=e.truthy;return W=Z,F=B=[n(Z[0],"BCDice")].concat(W),N=p=[n(B[0],"DiceTable")].concat(F),g=ae(p[0],null,"RollResult"),J=[g].concat(N),g.$$prototype.table_name=g.$$prototype.value=g.$$prototype.body=x,e.def(g,"$initialize",K=function(s,l,E){var u=this;return u.table_name=s,u.value=l,u.body=E},K.$$arity=3),g.$attr_reader("table_name"),g.$attr_reader("value"),g.$attr_reader("body"),e.def(g,"$to_s",U=function(){var s=this;return s.table_name+"("+s.value+") \uff1e "+s.body},U.$$arity=0),e.def(g,"$last_body",y=function(){var s=this;return c(s.body["$is_a?"](d(J,"RollResult")))?s.body.$last_body():s.body},y.$$arity=0),void e.def(g,"$empty?",i=function(){return!1},i.$$arity=0)},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var t,O,g,U,y,J,K,P,$,x=[],r=e.nil,n=e.$$,ae=e.module,c=e.klass,j=e.truthy;return t=x,O=$=[ae(x[0],"BCDice")].concat(t),g=P=[ae($[0],"DiceTable")].concat(O),J=c(P[0],null,"ChainTable"),K=[J].concat(g),J.$$prototype.times=J.$$prototype.sides=J.$$prototype.items=J.$$prototype.name=r,e.def(J,"$initialize",U=function(b,s,l){var E=this,u=r;return E.name=b,E.items=l.$freeze(),u=/(\d+)D(\d+)/i.$match(s),j(u)||E.$raise(n(K,"ArgumentError"),"Unexpected table type: "+s),E.times=u["$[]"](1).$to_i(),E.sides=u["$[]"](2).$to_i()},U.$$arity=3),void e.def(J,"$roll",y=function(b){var l,E,s=this,u=r;return E=function(W,t){return"number"==typeof W&&"number"==typeof t?W-t:W["$-"](t)}(l=b.$roll_sum(s.times,s.sides),s.times),u=s.items["$[]"](E),j(u["$respond_to?"]("roll"))&&(u=u.$roll(b)),n(K,"RollResult").$new(s.name,l,u)},y.$$arity=1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){function x(B,$){return"number"==typeof B&&"number"==typeof $?B-$:B["$-"]($)}var $,P,K,i,b,s,U,y,N,O,d=[],n=e.nil,c=e.$$,j=e.module,W=e.klass,t=e.hash2;return $=d,P=O=[j(d[0],"BCDice")].concat($),K=N=[j(O[0],"DiceTable")].concat(P),U=W(N[0],null,"D66GridTable"),y=[U].concat(K),U.$$prototype.name=U.$$prototype.items=n,e.defs(U,"$from_i18n",i=function(E,u){var h=n;return h=c(y,"I18n").$t(E,t(["locale","raise"],{locale:u,raise:!0})),this.$new(h["$[]"]("name"),h["$[]"]("items"))},i.$$arity=2),e.def(U,"$initialize",b=function(E,u){return this.name=E,this.items=u.$freeze()},b.$$arity=2),void e.def(U,"$roll",s=function(E){var o,h,A,X,D,B;return o=E.$roll_once(6),h=E.$roll_once(6),A=function(B,$){return"number"==typeof B&&"number"==typeof $?B+$:B["$+"]($)}("number"==typeof(B=o)?10*B:B["$*"](10),h),X=x(o,1),D=x(h,1),c(y,"RollResult").$new(this.name,A,this.items["$[]"](X)["$[]"](D))},s.$$arity=1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var W,F,N,K,U,g,J,p,B,Z=[],x=e.nil,d=e.$$,n=e.module,ae=e.klass,c=e.hash2;return e.top.$require("bcdice/dice_table/d66_grid_table"),W=Z,F=B=[n(Z[0],"BCDice")].concat(W),N=p=[n(B[0],"DiceTable")].concat(F),g=ae(p[0],d(p,"D66GridTable"),"D66HalfGridTable"),J=[g].concat(N),e.defs(g,"$from_i18n",K=function(i,b){var l=x;return l=d(J,"I18n").$t(i,c(["locale","raise"],{locale:b,raise:!0})),this.$new(l["$[]"]("name"),l["$[]"]("items_1_2_3"),l["$[]"]("items_4_5_6"))},K.$$arity=2),void e.def(g,"$initialize",U=function(i,b,s){return this.name=i,this.items=[b,b,b,s,s,s].$freeze()},U.$$arity=3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var W,F,N,K,U,g,J,p,B,Z=[],x=e.nil,d=e.$$,n=e.module,ae=e.klass,c=e.hash2;return e.top.$require("bcdice/dice_table/d66_grid_table"),W=Z,F=B=[n(Z[0],"BCDice")].concat(W),N=p=[n(B[0],"DiceTable")].concat(F),g=ae(p[0],d(p,"D66GridTable"),"D66OneThirdTable"),J=[g].concat(N),e.defs(g,"$from_i18n",K=function(i,b){var l=x;return l=d(J,"I18n").$t(i,c(["locale","raise"],{locale:b,raise:!0})),this.$new(l["$[]"]("name"),l["$[]"]("items_1_2"),l["$[]"]("items_3_4"),l["$[]"]("items_5_6"))},K.$$arity=2),void e.def(g,"$initialize",U=function(i,b,s,l){return this.name=i,this.items=[b,b,s,s,l,l].$freeze()},U.$$arity=4)},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var $,P,K,i,b,s,l,U,y,N,O,r=[],d=e.nil,n=e.$$$,ae=e.$$,c=e.module,j=e.klass,W=e.hash2,t=e.truthy;return $=r,P=O=[c(r[0],"BCDice")].concat($),K=N=[c(O[0],"DiceTable")].concat(P),U=j(N[0],null,"D66Table"),y=[U].concat(K),U.$$prototype.sort_type=U.$$prototype.items=U.$$prototype.name=d,e.defs(U,"$from_i18n",i=function(u,o){var X,A=d;return A=ae(y,"I18n").$t(u,W(["locale"],{locale:o})),X=ae(y,"D66SortType").$const_get(A["$[]"]("d66_sort_type")),this.$new(A["$[]"]("name"),X,A["$[]"]("items"))},i.$$arity=2),e.def(U,"$initialize",b=function(u,o,h){var A=this;return A.name=u,A.sort_type=o,A.items=h.$freeze()},b.$$arity=3),e.def(U,"$roll",s=function(u){var A,v,B,o=this,h=d,X=d,D=d;return h=u.$roll_barabara(2,6),A=o.sort_type,n(ae(y,"D66SortType"),"ASC")["$==="](A)?h["$sort!"]():n(ae(y,"D66SortType"),"DESC")["$==="](A)&&h["$sort!"]()["$reverse!"](),X=function(B,$){return"number"==typeof B&&"number"==typeof $?B+$:B["$+"]($)}("number"==typeof(B=h["$[]"](0))?10*B:B["$*"](10),h["$[]"](1)),D=t(v=o.items["$[]"](X))?v:o.items["$[]"](X.$to_s()),t(D["$respond_to?"]("roll"))&&(D=D.$roll(u)),ae(y,"RollResult").$new(o.name,X,D)},s.$$arity=1),void e.def(U,"$choice",l=function(u){return ae(y,"RollResult").$new(this.name,u,this.items["$[]"](u))},l.$$arity=1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){function H(F,O){return"number"==typeof F&&"number"==typeof O?F+O:F["$+"](O)}var O,y,s,i,N,J,P,d=[],n=e.nil,c=e.$$,j=e.module,W=e.klass,t=e.hash2,B=e.send,$=e.send2;return e.top.$require("bcdice/dice_table/d66_table"),O=d,N=P=[j(d[0],"BCDice")].concat(O),y=J=[j(P[0],"DiceTable")].concat(N),[i=W(J[0],c(J,"D66Table"),"D66LeftRangeTable")].concat(y),void e.def(i,"$initialize",s=function(E,u,o){var h,v,D=this;return s.$$p&&(s.$$p=null),v=t([],{}),B(o,"each",[],((h=function(m){function z(M){return m.apply(this,arguments)}return z.toString=function(){return m.toString()},z}(function(m){var M,_,C,z=null==h.$$s?this:h.$$s;return null==m&&(m=n),M=e.to_ary(m),C=null==M[1]?n:M[1],B(null==M[0]?n:M[0],"each",[],((_=function(I){var ve;return null==I&&(I=n),B(C,"each_with_index",[],((ve=function(Ce,ke){var De,be,F;return null==Ce&&(Ce=n),null==ke&&(ke=n),De=H("number"==typeof(F=I)?10*F:F["$*"](10),H(ke,1)),B(v,"[]=",e.to_a(be=[De,Ce])),be[function(F,O){return"number"==typeof F?F-1:F["$-"](1)}(be.length)]}).$$s=null==_.$$s?this:_.$$s,ve.$$arity=2,ve))}).$$s=z,_.$$arity=1,_))})).$$s=D,h.$$arity=1,h)),$(D,e.find_super_dispatcher(D,"initialize",s,!1,!0),"initialize",[E,u,v],null)},s.$$arity=3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var $,P,K,i,b,U,y,N,O,d=[],n=e.nil,c=e.$$,j=e.module,W=e.klass,t=e.truthy;return $=d,P=O=[j(d[0],"BCDice")].concat($),K=N=[j(O[0],"DiceTable")].concat(P),U=W(N[0],null,"D66ParityTable"),y=[U].concat(K),U.$$prototype.odd=U.$$prototype.even=U.$$prototype.name=n,e.def(U,"$initialize",i=function(l,E,u){var o=this;return o.name=l,o.odd=E.$freeze(),o.even=u.$freeze()},i.$$arity=3),void e.def(U,"$roll",b=function(l){var o,A,X,B,E=this,u=n;return u=l.$roll_once(6),o=l.$roll_once(6),A=(t(u["$odd?"]())?E.odd:E.even)["$[]"]("number"==typeof(B=o)?B-1:B["$-"](1)),X=function(B,$){return"number"==typeof B&&"number"==typeof $?B+$:B["$+"]($)}(function(B,$){return"number"==typeof B?10*B:B["$*"](10)}(u),o),c(y,"RollResult").$new(E.name,X,A)},b.$$arity=1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var B,p,J,y,i,K,U,V,F,r=[],d=e.nil,ae=e.$$,c=e.module,j=e.klass,W=e.send;return B=r,p=F=[c(r[0],"BCDice")].concat(B),J=V=[c(F[0],"DiceTable")].concat(p),K=j(V[0],null,"D66RangeTable"),U=[K].concat(J),K.$$prototype.items=K.$$prototype.name=d,e.def(K,"$initialize",y=function(s,l){return this.name=s,this.items=l.$freeze()},y.$$arity=2),void e.def(K,"$roll",i=function(s){var l,u,o,h,t,E=this,A=d;return u=s.$roll_once(6),o=s.$roll_once(6),h=function(t,B){return"number"==typeof t&&"number"==typeof B?t+B:t["$+"](B)}("number"==typeof(t=u)?10*t:t["$*"](10),o),A=W(E.items,"find",[],((l=function(D){return null==D&&(D=d),D["$[]"](0)["$include?"](h)}).$$s=E,l.$$arity=1,l)),ae(U,"RollResult").$new(E.name,h,A["$[]"](1))},i.$$arity=1)},Opal.modules["bcdice/dice_table/range_table"]=function(e){var F,V,U,b,s,l,E,u,o,h,A,X,y,i,g,p,d=[],n=e.nil,c=e.$$,j=e.module,W=e.klass,t=e.send,B=e.truthy;return F=d,V=p=[j(d[0],"BCDice")].concat(F),U=g=[j(p[0],"DiceTable")].concat(V),y=W(g[0],null,"RangeTable"),i=[y].concat(U),y.$$prototype.name=y.$$prototype.items=y.$$prototype.num_of_dice=y.$$prototype.num_of_sides=y.$$prototype.formatter=n,e.const_set(i[0],"RollResult",t(c(i,"Struct"),"new",["sum","values","content","formatted"],((b=function(){return(null==b.$$s?this:b.$$s).$alias_method("to_s","formatted")}).$$s=y,b.$$arity=0,b))),e.const_set(i[0],"Item",c(i,"Struct").$new("range","content")),e.const_set(i[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),e.const_set(i[0],"DEFAULT_FORMATTER",t(y,"lambda",[],($$2=function(D){function v(m,z){return D.apply(this,arguments)}return v.toString=function(){return D.toString()},v}(function(D,v){return null==$$2.$$s||$$2,null==D&&(D=n),null==v&&(v=n),D.$name()+"("+v.$sum()+") \uff1e "+v.$content()}),$$2.$$s=y,$$2.$$arity=2,$$2))),y.$attr_reader("name"),y.$attr_reader("num_of_dice"),y.$attr_reader("num_of_sides"),e.def(y,"$initialize",s=function(v,m,z){var w,M=s.$$p,Y=M||n,_=this,C=n;return M&&(s.$$p=null),M&&(s.$$p=null),_.name=v.$freeze(),_.formatter=B(w=Y)?w:c(i,"DEFAULT_FORMATTER"),C=c(i,"DICE_ROLL_METHOD_RE").$match(m),B(C)||_.$raise(c(i,"ArgumentError"),_.name+": invalid dice roll method: "+m),_.num_of_dice=C["$[]"](1).$to_i(),_.num_of_sides=C["$[]"](2).$to_i(),_.$store(z)},s.$$arity=3),e.def(y,"$fetch",l=function(v){var m,M,z=this;return M=t(z.items,"find",[],((m=function(_){return null==_&&(_=n),_.$range()["$include?"](v)}).$$s=z,m.$$arity=1,m)),B(M)||z.$raise(c(i,"RangeError"),z.name+": value is out of range: "+v),M},l.$$arity=1),e.def(y,"$roll",E=function(v){var M,Y,_,$,m=this,z=n;return M=(z=v.$roll_barabara(m.num_of_dice,m.num_of_sides)).$sum(),Y=c(i,"RollResult").$new(M,z,m.$fetch(M).$content()),_=[m.formatter["$[]"](m,Y)],t(Y,"formatted=",e.to_a(_)),"number"==typeof($=_.length)||$["$-"](1),Y},E.$$arity=1),y.$private(),e.def(y,"$store",u=function(v){var m,z,M,_,w,Y=this;return _=t(v,"map",[],((m=function(L,I){return null==L&&(L=n),null==I&&(I=n),[(null==m.$$s?this:m.$$s).$coerce_to_int_range(L),I]}).$$s=Y,m.$$arity=2,m)),w=t(_,"sort_by",[],((z=function(L,I){return null==L&&(L=n),null==I&&(I=n),L.$min()}).$$s=Y,z.$$arity=2,z)),Y.$assert_min_sum_is_covered(w),Y.$assert_max_sum_is_covered(w),Y.$assert_no_gap_or_overlap_in_ranges(w),Y.items=t(w,"map",[],(M=function(L,I){return null==L&&(L=n),null==I&&(I=n),c(i,"Item").$new(L,I.$freeze()).$freeze()},M.$$s=Y,M.$$arity=2,M)).$freeze(),Y},u.$$arity=1),e.def(y,"$coerce_to_int_range",o=function(v){var z,M=n;return z=v,c(i,"Integer")["$==="](z)?c(i,"Range").$new(v,v):c(i,"Range")["$==="](z)&&B(B(M=v.$begin()["$is_a?"](c(i,"Integer")))?v.$end()["$is_a?"](c(i,"Integer")):M)?v:this.$raise(c(i,"TypeError"),this.name+": "+v+" ("+v.$class()+") must be an Integer or a Range with Integers ")},o.$$arity=1),e.def(y,"$assert_min_sum_is_covered",h=function(v){var z,m=this,M=n;return z=m.num_of_dice,M=v.$first()["$[]"](0),B(M["$include?"](z))||m.$raise(c(i,"RangeError"),m.name+": min value ("+z+") is not covered: "+M),m},h.$$arity=1),e.def(y,"$assert_max_sum_is_covered",A=function(v){var z,m=this,M=n;return z=function($,F){return"number"==typeof $&&"number"==typeof F?$*F:$["$*"](F)}(m.num_of_dice,m.num_of_sides),M=v.$last()["$[]"](0),B(M["$include?"](z))||m.$raise(c(i,"RangeError"),m.name+": max value ("+z+") is not covered: "+M),m},A.$$arity=1),void e.def(y,"$assert_no_gap_or_overlap_in_ranges",X=function(v){var m;return t(v,"each_cons",[2],((m=function(Y,_){var I,ye,$,w=null==m.$$s?this:m.$$s,C=n,L=n;return null==w.name&&(w.name=n),null==Y&&(Y=n),null==_&&(_=n),C=Y["$[]"](0),L=_["$[]"](0),ye="number"==typeof($=I=C.$max())?$+1:$["$+"](1),B(L["$include?"](I))&&w.$raise(c(i,"RangeError"),w.name+": Range overlap: "+C+" and "+L),B(L["$include?"](ye))?n:w.$raise(c(i,"RangeError"),w.name+": Range gap: "+C+" and "+L)}).$$s=this,m.$$arity=2,m)),this},X.$$arity=1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var t,O,g,i,l,E,u,b,s,K,P,$,x=[],r=e.nil,d=e.$$$,n=e.$$,ae=e.module,c=e.klass,j=e.send;return t=x,O=$=[ae(x[0],"BCDice")].concat(t),g=P=[ae($[0],"DiceTable")].concat(O),i=K=[c(P[0],null,"SaiFicSkillTable")].concat(g),b=c(K[0],null,"Category"),s=[b].concat(i),b.$$prototype.name=r,e.def(b,"$initialize",l=function(h,A,X,D){var v,m=this;return m.name=h,m.skills=j(A.$map(),"with_index",[2],((v=function(z){function M(Y,_){return z.apply(this,arguments)}return M.toString=function(){return z.toString()},M}(function(z,M){return null==z&&(z=r),null==M&&(M=r),d(n(s,"SaiFicSkillTable"),"Skill").$new(h,z,X,M,D)})).$$s=m,v.$$arity=2,v)),m.dice=X},l.$$arity=4),e.def(b,"$roll",E=function(h){return this.$skills()["$[]"]("number"==typeof(W=h.$roll_sum(2,6))?W-2:W["$-"](2));var W},E.$$arity=1),e.def(b,"$to_s",u=function(){return this.name},u.$$arity=0),void b.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var W,F,y,s,l,i,N,J,p,B,Z=[],x=e.nil,n=e.module,ae=e.klass,c=e.hash2;return W=Z,F=B=[n(Z[0],"BCDice")].concat(W),N=p=[n(B[0],"DiceTable")].concat(F),y=J=[ae(p[0],null,"SaiFicSkillTable")].concat(N),[i=ae(J[0],null,"Skill")].concat(y),i.$$prototype.s_format=i.$$prototype.category_dice=i.$$prototype.row_dice=i.$$prototype.category_name=i.$$prototype.name=x,e.def(i,"$initialize",s=function(u,o,h,A,X){var D=this;return D.category_name=u,D.name=o,D.category_dice=h,D.row_dice=A,D.s_format=X},s.$$arity=5),e.def(i,"$to_s",l=function(){var u=this;return u.$format(u.s_format,c(["category_dice","row_dice","category_name","skill_name"],{category_dice:u.category_dice,row_dice:u.row_dice,category_name:u.category_name,skill_name:u.name}))},l.$$arity=0),void i.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var O,N,y,s,l,E,u,o,h,A,i,b,J,P,x=e.top,r=[],d=e.nil,n=e.$$$,ae=e.$$,c=e.module,j=e.klass,W=e.hash2,t=e.send,$=e.truthy;return x.$require("bcdice/dice_table/sai_fic_skill_table/category"),x.$require("bcdice/dice_table/sai_fic_skill_table/skill"),O=r,N=P=[c(r[0],"BCDice")].concat(O),y=J=[c(P[0],"DiceTable")].concat(N),i=j(J[0],null,"SaiFicSkillTable"),b=[i].concat(y),i.$$prototype.rtt=i.$$prototype.rtt_format=i.$$prototype.rct=i.$$prototype.rct_format=i.$$prototype.rttn=i.$$prototype.rttn_format=i.$$prototype.categories=d,e.defs(i,"$from_i18n",s=function(D,v,m){var z,M,Y,_,I,L=d;if(null==m)m=W([],{});else if(!m.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(z=m.$$smap.rtt)&&(z=d),null==(M=m.$$smap.rct)&&(M=d),null==(Y=m.$$smap.rttn)&&(Y=d),I=(L=ae(b,"I18n").$t("RTT",W(["locale","raise","default"],{locale:v,raise:!1,default:W([],{})})).$merge(ae(b,"I18n").$t(D,W(["locale","raise"],{locale:v,raise:!0}))))["$[]"]("items"),L=t(L,"select",[],((_=function(ye){function ve(ge,Ce){return ye.apply(this,arguments)}return ve.toString=function(){return ye.toString()},ve}(function(ye,ve){return null==ye&&(ye=d),null==ve&&(ve=d),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](ye)})).$$s=this,_.$$arity=2,_)),this.$new(I,e.to_hash(L).$merge(W(["rtt","rct","rttn"],{rtt:z,rct:M,rttn:Y})))},s.$$arity=-3),e.const_set(b[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),e.const_set(b[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),e.const_set(b[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),e.const_set(b[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),e.def(i,"$initialize",l=function(D,v){var m,z,M,Y,_,w,C,L,I=this;if(null==v)v=W([],{});else if(!v.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(m=v.$$smap.rtt)&&(m=d),null==(z=v.$$smap.rct)&&(z=d),null==(M=v.$$smap.rttn)&&(M=d),null==(Y=v.$$smap.rtt_format)&&(Y=ae(b,"DEFAULT_RTT")),null==(_=v.$$smap.rct_format)&&(_=ae(b,"DEFAULT_RCT")),null==(w=v.$$smap.rttn_format)&&(w=ae(b,"DEFAULT_RTTN")),null==(C=v.$$smap.s_format)&&(C=ae(b,"DEFAULT_S")),I.categories=t(D.$map(),"with_index",[1],((L=function(ve,ge){var ke,De,be;return null==ve&&(ve=d),null==ge&&(ge=d),De=null==(ke=e.to_ary(ve))[0]?d:ke[0],be=null==ke[1]?d:ke[1],n(ae(b,"SaiFicSkillTable"),"Category").$new(De,be,ge,C)}).$$s=I,L.$$arity=2,L.$$has_top_level_mlhs_arg=!0,L)),I.rtt=m,I.rct=z,I.rttn=M.$to_a(),I.rtt_format=Y,I.rct_format=_,I.rttn_format=w},l.$$arity=-2),e.const_set(b[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),i.$attr_reader("categories"),e.def(i,"$roll_command",E=function(D,v){var z,m=this,M=d,Y=d,_=d;return $(["RTT",m.rtt]["$include?"](z=v))?m.$format_skill(m.rtt_format,m.$roll_skill(D)):$(["RCT",m.rct]["$include?"](z))?(M=m.$roll_category(D),m.$format(m.rct_format,W(["category_dice","category_name"],{category_dice:M.$dice(),category_name:M.$name()}))):$($(Y=_=ae(b,"RTTN").$index(z))?Y:_=m.rttn.$index(z))?m.$format_skill(m.rttn_format,m.categories["$[]"](_).$roll(D)):d},E.$$arity=2),e.def(i,"$roll_category",u=function(D){return this.categories["$[]"]("number"==typeof(F=D.$roll_once(6))?F-1:F["$-"](1));var F},u.$$arity=1),e.def(i,"$roll_skill",o=function(D){return this.$roll_category(D).$roll(D)},o.$$arity=1),e.def(i,"$prefixes",h=function(){var D=this;return function(F,O){return"number"==typeof F&&"number"==typeof O?F+O:F["$+"](O)}(["RTT[1-6]?","RCT",D.rtt,D.rct],D.rttn).$compact()},h.$$arity=0),i.$private(),void e.def(i,"$format_skill",A=function(D,v){return this.$format(D,W(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:v.$category_dice(),row_dice:v.$row_dice(),category_name:v.$category_name(),skill_name:v.$name(),text:v.$to_s()}))},A.$$arity=2)},Opal.modules["bcdice/dice_table/table"]=function(e){var B,p,J,y,i,b,s,K,U,V,F,x=[],r=e.nil,n=e.$$,ae=e.module,c=e.klass,j=e.hash2,W=e.truthy;return B=x,p=F=[ae(x[0],"BCDice")].concat(B),J=V=[ae(F[0],"DiceTable")].concat(p),K=c(V[0],null,"Table"),U=[K].concat(J),K.$$prototype.times=K.$$prototype.sides=K.$$prototype.name=K.$$prototype.items=r,e.defs(K,"$from_i18n",y=function(E,u){var h=r;return h=n(U,"I18n").$t(E,j(["locale"],{locale:u})),this.$new(h["$[]"]("name"),h["$[]"]("type"),h["$[]"]("items"))},y.$$arity=2),e.def(K,"$initialize",i=function(E,u,o){var h=this,A=r;return h.name=E,h.items=o.$freeze(),A=/(\d+)D(\d+)/i.$match(u),W(A)||h.$raise(n(U,"ArgumentError"),"Unexpected table type: "+u),h.times=A["$[]"](1).$to_i(),h.sides=A["$[]"](2).$to_i()},i.$$arity=3),e.def(K,"$roll",b=function(E){var o,u=this;return o=E.$roll_sum(u.times,u.sides),u.$choice(o)},b.$$arity=1),void e.def(K,"$choice",s=function(E){var o,u=this;return o=function(t,B){return"number"==typeof t&&"number"==typeof B?t-B:t["$-"](B)}(E,u.times),n(U,"RollResult").$new(u.name,E,u.items["$[]"](o))},s.$$arity=1)},Opal.modules["bcdice/dice_table"]=function(e){var H=e.top;return H.$require("bcdice/dice_table/roll_result"),H.$require("bcdice/dice_table/chain_table"),H.$require("bcdice/dice_table/d66_grid_table"),H.$require("bcdice/dice_table/d66_half_grid_table"),H.$require("bcdice/dice_table/d66_one_third_table"),H.$require("bcdice/dice_table/d66_left_range_table"),H.$require("bcdice/dice_table/d66_parity_table"),H.$require("bcdice/dice_table/d66_range_table"),H.$require("bcdice/dice_table/d66_table"),H.$require("bcdice/dice_table/range_table"),H.$require("bcdice/dice_table/sai_fic_skill_table"),H.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var c,B,F,W,Z=[],n=e.module;return c=Z,B=W=[n(Z[0],"BCDice")].concat(c),F=[n(W[0],"D66SortType")].concat(B),e.const_set(F[0],"NO_SORT","no_sort"),e.const_set(F[0],"ASC","asc"),e.const_set(F[0],"DESC","desc"),void function(t,B){var F=[n(t,"RoundType")].concat(B);e.const_set(F[0],"CEIL","ceil"),e.const_set(F[0],"FLOOR","floor"),e.const_set(F[0],"ROUND","round")}(W[0],W)},Opal.modules["bcdice/translate"]=function(e){var W,F,P,O,p,B,Z=[],x=e.nil,d=e.$$,n=e.module,ae=e.hash2;return W=Z,F=B=[n(Z[0],"BCDice")].concat(W),O=n(B[0],"Translate"),p=[O].concat(F),void e.def(O,"$translate",P=function(N,g){var J,K=this;if(null==K.locale&&(K.locale=x),null==g)g=ae([],{});else if(!g.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return J=e.kwrestargs(g,{}),d(p,"I18n").$translate(N,ae(["locale","raise"],{locale:K.locale,raise:!0}).$merge(e.to_hash(J)))},P.$$arity=-2)},Opal.modules["bcdice/result"]=function(e){function H(W,t){return"number"==typeof W&&"number"==typeof t?W-t:W["$-"](t)}var t,b,E,u,o,h,A,p,N,g,J,K,U,y,i,P,V,$,x=[],r=e.nil,c=e.klass,j=e.send;return t=x,p=$=[(0,e.module)(x[0],"BCDice")].concat(t),V=[P=c($[0],null,"Result")].concat(p),P.$$prototype.secret=P.$$prototype.success=P.$$prototype.failure=P.$$prototype.critical=P.$$prototype.fumble=r,[b=e.get_singleton_class(P)].concat(V),e.def(b,"$success",E=function(D){var v;return j(this.$new(),"tap",[],((v=function(z){function M(Y){return z.apply(this,arguments)}return M.toString=function(){return z.toString()},M}(function(z){var Y=r;return null==z&&(z=r),j(z,"text=",e.to_a(Y=[D])),H(Y.length,1),j(z,"success=",e.to_a(Y=[!0])),Y[H(Y.length,1)]})).$$s=this,v.$$arity=1,v))},E.$$arity=1),e.def(b,"$failure",u=function(D){var v;return j(this.$new(),"tap",[],((v=function(M){var _=r;return null==M&&(M=r),j(M,"text=",e.to_a(_=[D])),H(_.length,1),j(M,"failure=",e.to_a(_=[!0])),_[H(_.length,1)]}).$$s=this,v.$$arity=1,v))},u.$$arity=1),e.def(b,"$critical",o=function(D){var v;return j(this.$new(),"tap",[],((v=function(M){var _=r;return null==M&&(M=r),j(M,"text=",e.to_a(_=[D])),H(_.length,1),j(M,"critical=",e.to_a(_=[!0])),H(_.length,1),j(M,"success=",e.to_a(_=[!0])),_[H(_.length,1)]}).$$s=this,v.$$arity=1,v))},o.$$arity=1),e.def(b,"$fumble",h=function(D){var v;return j(this.$new(),"tap",[],((v=function(M){var _=r;return null==M&&(M=r),j(M,"text=",e.to_a(_=[D])),H(_.length,1),j(M,"fumble=",e.to_a(_=[!0])),H(_.length,1),j(M,"failure=",e.to_a(_=[!0])),_[H(_.length,1)]}).$$s=this,v.$$arity=1,v))},h.$$arity=1),e.def(b,"$nothing",A=function(){return"nothing"},A.$$arity=0),e.def(P,"$initialize",N=function(s){var l=this;return null==s&&(s=r),l.text=s,l.rands=r,l.detailed_rands=r,l.secret=!1,l.success=!1,l.failure=!1,l.critical=!1,l.fumble=!1},N.$$arity=-1),P.$attr_accessor("text","rands","detailed_rands"),P.$attr_writer("secret","success","failure","critical","fumble"),e.def(P,"$secret?",g=function(){return this.secret},g.$$arity=0),e.def(P,"$success?",J=function(){return this.success},J.$$arity=0),e.def(P,"$failure?",K=function(){return this.failure},K.$$arity=0),e.def(P,"$critical?",U=function(){return this.critical},U.$$arity=0),e.def(P,"$fumble?",y=function(){return this.fumble},y.$$arity=0),void e.def(P,"$condition=",i=function(s){return this.success=s,this.failure=s["$!"]()},i.$$arity=1)},Opal.modules["racc/parser"]=function(e){function H(N,g){return"number"==typeof N&&"number"==typeof g?N<g:N["$<"](g)}function Z(N,g){return"number"==typeof N&&"number"==typeof g?N-g:N["$-"](g)}function x(N,g){return"number"==typeof N&&"number"==typeof g?N+g:N["$+"](g)}function r(N,g){return"number"==typeof N&&"number"==typeof g?N>=g:N["$>="](g)}function d(N,g){return"number"==typeof N&&"number"==typeof g?N>g:N["$>"](g)}function n(N,g){return"number"==typeof N&&"number"==typeof g?N<=g:N["$<="](g)}var U,y,i,g,K,W=[],t=e.nil,B=e.$$$,$=e.$$,F=e.module,O=e.klass,p=e.truthy,P=e.gvars,V=e.send;return g=W,U=(K=[F(W[0],"Racc")].concat(g))[0],y=$(K,"StandardError"),i=K,[O(U,y,"ParseError")].concat(i),p(B("::","ParseError","skip_raise")?"constant":t)||e.const_set(W[0],"ParseError",B($(W,"Racc"),"ParseError")),function(N,g){var b,E,u,o,h,A,X,D,v,m,z,M,Y,_,w,C,L,I,ye,ve,ge,Ce,ke,qe,De,s,l,K=[F(N,"Racc")].concat(g);p($(K,"Racc_No_Extensions","skip_raise")?"constant":t)||e.const_set(K[0],"Racc_No_Extensions",!1),b=K,s=O(K[0],null,"Parser"),l=[s].concat(b),s.$$prototype.yydebug=s.$$prototype.racc_debug_out=s.$$prototype.racc_error_status=s.$$prototype.racc_t=s.$$prototype.racc_vstack=s.$$prototype.racc_val=s.$$prototype.racc_state=s.$$prototype.racc_tstack=t,e.const_set(l[0],"Racc_Runtime_Version","1.4.6"),e.const_set(l[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),e.const_set(l[0],"Racc_Runtime_Core_Version_R","1.4.6"),e.const_set(l[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),e.const_set(l[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),e.const_set(l[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),e.const_set(l[0],"Racc_Runtime_Core_Version",$(l,"Racc_Runtime_Core_Version_R")),e.const_set(l[0],"Racc_Runtime_Core_Revision",$(l,"Racc_Runtime_Core_Revision_R")),e.const_set(l[0],"Racc_Runtime_Type","ruby"),e.defs($(l,"Parser"),"$racc_runtime_type",E=function(){return $(l,"Racc_Runtime_Type")},E.$$arity=0),e.def(s,"$_racc_setup",u=function(){var ee,te,a=this,G=t,q=t,S=t;return null==P.stderr&&(P.stderr=t),p(B(a.$class(),"Racc_debug_parser"))||(a.yydebug=!1),p(null!=(ee=a.yydebug)&&ee!==t?"instance-variable":t)||(a.yydebug=!1),p(a.yydebug)&&(p(null!=(te=a.racc_debug_out)&&te!==t?"instance-variable":t)||(a.racc_debug_out=P.stderr),a.racc_debug_out=p(G=a.racc_debug_out)?G:P.stderr),q=B(a.$class(),"Racc_arg"),p(H(q.$size(),14))&&(V(q,"[]=",e.to_a(S=[13,!0])),Z(S.length,1)),q},u.$$arity=0),e.def(s,"$_racc_init_sysvars",o=function(){var ee=this;return ee.racc_state=[0],ee.racc_tstack=[],ee.racc_vstack=[],ee.racc_t=t,ee.racc_val=t,ee.racc_read_next=!0,ee.racc_user_yyerror=!1,ee.racc_error_status=0},o.$$arity=0),e.def(s,"$do_parse",h=function(){return this.$__send__($(l,"Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},h.$$arity=0),e.def(s,"$next_token",A=function(){return this.$raise($(l,"NotImplementedError"),this.$class()+"#next_token is not defined")},A.$$arity=0),e.def(s,"$_racc_do_parse_rb",X=function(ee,te){var a,q,S=this,ne=t,ie=t,ce=t,Pe=t,fe=t,he=t,we=t,de=t;return a=e.to_ary(ee),ne=null==a[0]?t:a[0],ie=null==a[1]?t:a[1],ce=null==a[2]?t:a[2],Pe=null==a[3]?t:a[3],fe=null==a[10]?t:a[10],S.$_racc_init_sysvars(),he=we=de=t,V(S,"catch",["racc_end_parse"],((q=function(){var Ie,Me,me=null==q.$$s?this:q.$$s,Ne=t,He=t,We=t;for(null==me.racc_state&&(me.racc_state=t),null==me.racc_read_next&&(me.racc_read_next=t),null==me.racc_t&&(me.racc_t=t),null==me.yydebug&&(me.yydebug=t),null==me.racc_val&&(me.racc_val=t);p(!0);)for(p(de=Pe["$[]"](me.racc_state["$[]"](-1)))?(p(me.racc_read_next)&&p(me.racc_t["$!="](0))&&(Me=me.$next_token(),Ie=e.to_ary(Me),he=null==Ie[0]?t:Ie[0],me.racc_val=null==Ie[1]?t:Ie[1],me.racc_t=p(he)?p(Ne=fe["$[]"](he))?Ne:1:0,p(me.yydebug)&&me.$racc_read_token(me.racc_t,he,me.racc_val),me.racc_read_next=!1),de=x(de,me.racc_t),p(p(He=p(We=r(de,0))?we=ne["$[]"](de):We)?ie["$[]"](de)["$=="](me.racc_state["$[]"](-1)):He)||(we=ce["$[]"](me.racc_state["$[]"](-1)))):we=ce["$[]"](me.racc_state["$[]"](-1));p(we=me.$_racc_evalact(we,ee)););}).$$s=S,q.$$arity=0,q))},X.$$arity=2),e.def(s,"$yyparse",D=function(ee,te){return this.$__send__($(l,"Racc_YY_Parse_Method"),ee,te,this.$_racc_setup(),!0)},D.$$arity=2),e.def(s,"$_racc_yyparse_rb",v=function(ee,te,a,G){var q,ne,ce=t,Pe=t,oe=t,fe=t,we=t,de=t,Te=t;return q=e.to_ary(a),ce=null==q[0]?t:q[0],Pe=null==q[1]?t:q[1],oe=null==q[2]?t:q[2],fe=null==q[3]?t:q[3],we=null==q[10]?t:q[10],this.$_racc_init_sysvars(),de=t,Te=t,V(this,"catch",["racc_end_parse"],((ne=function(){var Ne,ze=null==ne.$$s?this:ne.$$s;for(null==ze.racc_state&&(ze.racc_state=t);!p(Te=fe["$[]"](ze.racc_state["$[]"](-1)));)for(;p(de=ze.$_racc_evalact(oe["$[]"](ze.racc_state["$[]"](-1)),a)););return V(ee,"__send__",[te],((Ne=function(We,Le){var _e,Re,Be=null==Ne.$$s?this:Ne.$$s,xe=t,Q=t,T=t,le=t,re=t,f=t,$e=t;for(null==Be.racc_t&&(Be.racc_t=t),null==Be.racc_state&&(Be.racc_state=t),null==Be.racc_read_next&&(Be.racc_read_next=t),null==We&&(We=t),null==Le&&(Le=t),Be.racc_t=p(We)?p(xe=we["$[]"](We))?xe:1:0,Be.racc_val=Le,Be.racc_read_next=!1,Te=x(Te,Be.racc_t),p(p(_e=p(Re=r(Te,0))?de=ce["$[]"](Te):Re)?Pe["$[]"](Te)["$=="](Be.racc_state["$[]"](-1)):_e)||(de=oe["$[]"](Be.racc_state["$[]"](-1)));p(de=Be.$_racc_evalact(de,a)););for(;p(p(Q=p(T=(Te=fe["$[]"](Be.racc_state["$[]"](-1)))["$!"]())?T:Be.racc_read_next["$!"]())?Q:Be.racc_t["$=="](0));)for(p(p(le=p(re=p(f=p($e=Te)?Te=x(Te,Be.racc_t):$e)?r(Te,0):f)?de=ce["$[]"](Te):re)?Pe["$[]"](Te)["$=="](Be.racc_state["$[]"](-1)):le)||(de=oe["$[]"](Be.racc_state["$[]"](-1)));p(de=Be.$_racc_evalact(de,a)););}).$$s=ze,Ne.$$arity=2,Ne))}).$$s=this,ne.$$arity=0,ne))},v.$$arity=4),e.def(s,"$_racc_evalact",m=function(ee,te){var a,q,oe,he,S=this,ne=t,ie=t,Pe=t,fe=t,we=t,de=t,Te=t,me=t,ze=t,Ie=t;if(ne=null==(a=e.to_ary(te))[0]?t:a[0],ie=null==a[1]?t:a[1],Pe=null==a[3]?t:a[3],oe=null==a[11]?t:a[11],fe=null==a[12]?t:a[12],p(p(he=d(ee,0))?H(ee,oe):he))p(d(S.racc_error_status,0))&&(S.racc_t["$=="](1)||(S.racc_error_status=Z(S.racc_error_status,1))),S.racc_vstack.$push(S.racc_val),S.racc_state.$push(ee),S.racc_read_next=!0,p(S.yydebug)&&(S.racc_tstack.$push(S.racc_t),S.$racc_shift(S.racc_t,S.racc_tstack,S.racc_vstack));else if(p(p(we=H(ee,0))?d(ee,fe["$-@"]()):we)){if(de=V(S,"catch",["racc_jump"],((q=function(){var Ne=null==q.$$s?this:q.$$s;return null==Ne.racc_state&&(Ne.racc_state=t),Ne.racc_state.$push(Ne.$_racc_do_reduce(te,ee)),!1}).$$s=S,q.$$arity=0,q)),p(de)){if(1["$==="](Te=de))return S.racc_user_yyerror=!0,fe["$-@"]();if(2["$==="](Te))return oe;S.$raise("[Racc Bug] unknown jump code")}}else if(ee["$=="](oe))p(S.yydebug)&&S.$racc_accept(),S.$throw("racc_end_parse",S.racc_vstack["$[]"](0));else{if(ee["$=="](fe["$-@"]())){for((0)["$==="](Te=S.racc_error_status)?p(te["$[]"](21))||S.$on_error(S.racc_t,S.racc_val,S.racc_vstack):3["$==="](Te)&&(S.racc_t["$=="](0)&&S.$throw("racc_end_parse",t),S.racc_read_next=!0),S.racc_user_yyerror=!1,S.racc_error_status=3;p(!0)&&(!p(me=Pe["$[]"](S.racc_state["$[]"](-1)))||(me=x(me,1),!p(p(ze=p(Ie=r(me,0))?ee=ne["$[]"](me):Ie)?ie["$[]"](me)["$=="](S.racc_state["$[]"](-1)):ze)));)p(n(S.racc_state.$size(),1))&&S.$throw("racc_end_parse",t),S.racc_state.$pop(),S.racc_vstack.$pop(),p(S.yydebug)&&(S.racc_tstack.$pop(),S.$racc_e_pop(S.racc_state,S.racc_tstack,S.racc_vstack));return ee}S.$raise("[Racc Bug] unknown action "+ee.$inspect())}return p(S.yydebug)&&S.$racc_next_state(S.racc_state["$[]"](-1),S.racc_state),t},m.$$arity=2),e.def(s,"$_racc_do_reduce",z=function(ee,te){var a,oe,he,Ie,Me,Ne,Be,q=this,ne=t,ie=t,ce=t,Pe=t,fe=t,we=t,de=t,Te=t,me=t,ze=t,He=t,We=t,Le=t,Ge=t,je=t,xe=t;return ne=null==(a=e.to_ary(ee))[4]?t:a[4],ie=null==a[5]?t:a[5],ce=null==a[6]?t:a[6],Pe=null==a[7]?t:a[7],oe=null==a[8]?t:a[8],fe=null==a[9]?t:a[9],he=null==a[13]?t:a[13],we=q.racc_state,de=q.racc_vstack,Te=q.racc_tstack,me=function(N,g){return"number"==typeof N?-3*N:N["$*"](-3)}(te),ze=fe["$[]"](me),Ie=fe["$[]"](x(me,1)),Me=fe["$[]"](x(me,2)),Ne=[],p(q.yydebug)&&(He=Te["$[]"](ze["$-@"](),ze)),We=de["$[]"](ze["$-@"](),ze),p(q.yydebug)&&(Le=[ze["$-@"](),ze,Ne],V(Te,"[]=",e.to_a(Le)),Z(Le.length,1)),Le=[ze["$-@"](),ze,Ne],V(de,"[]=",e.to_a(Le)),Z(Le.length,1),Le=[ze["$-@"](),ze,Ne],V(we,"[]=",e.to_a(Le)),Z(Le.length,1),p(he)?de.$push(q.$__send__(Me,We,de,We["$[]"](0))):de.$push(q.$__send__(Me,We,de)),Te.$push(Ie),p(q.yydebug)&&q.$racc_reduce(He,Ie,Te,de),Be=Z(Ie,oe),p(me=Pe["$[]"](Be))&&(me=x(me,we["$[]"](-1)),p(p(Ge=p(je=r(me,0))?xe=ne["$[]"](me):je)?ie["$[]"](me)["$=="](Be):Ge))?xe:ce["$[]"](Be)},z.$$arity=2),e.def(s,"$on_error",M=function(ee,te,a){var q,G=this;return G.$raise($(l,"ParseError"),G.$sprintf("\nparse error on value %s (%s)",te.$inspect(),p(q=G.$token_to_str(ee))?q:"?"))},M.$$arity=3),e.def(s,"$yyerror",Y=function(){return this.$throw("racc_jump",1)},Y.$$arity=0),e.def(s,"$yyaccept",_=function(){return this.$throw("racc_jump",2)},_.$$arity=0),e.def(s,"$yyerrok",w=function(){return this.racc_error_status=0},w.$$arity=0),e.def(s,"$racc_read_token",C=function(ee,te,a){var G=this;return G.racc_debug_out.$print("read    "),G.racc_debug_out.$print(te.$inspect(),"(",G.$racc_token2str(ee),") "),G.racc_debug_out.$puts(a.$inspect()),G.racc_debug_out.$puts()},C.$$arity=3),e.def(s,"$racc_shift",L=function(ee,te,a){var G=this;return G.racc_debug_out.$puts("shift   "+G.$racc_token2str(ee)),G.$racc_print_stacks(te,a),G.racc_debug_out.$puts()},L.$$arity=3),e.def(s,"$racc_reduce",I=function(ee,te,a,G){var q,S=this,ne=t;return(ne=S.racc_debug_out).$print("reduce "),p(ee["$empty?"]())?ne.$print(" <none>"):V(ee,"each",[],((q=function(ce){return null==ce&&(ce=t),ne.$print(" ",(null==q.$$s?this:q.$$s).$racc_token2str(ce))}).$$s=S,q.$$arity=1,q)),ne.$puts(" --\x3e "+S.$racc_token2str(te)),S.$racc_print_stacks(a,G),S.racc_debug_out.$puts()},I.$$arity=4),e.def(s,"$racc_accept",ye=function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},ye.$$arity=0),e.def(s,"$racc_e_pop",ve=function(ee,te,a){var G=this;return G.racc_debug_out.$puts("error recovering mode: pop token"),G.$racc_print_states(ee),G.$racc_print_stacks(te,a),G.racc_debug_out.$puts()},ve.$$arity=3),e.def(s,"$racc_next_state",ge=function(ee,te){var a=this;return a.racc_debug_out.$puts("goto    "+ee),a.$racc_print_states(te),a.racc_debug_out.$puts()},ge.$$arity=2),e.def(s,"$racc_print_stacks",Ce=function(ee,te){var a,q=t;return(q=this.racc_debug_out).$print("        ["),V(ee,"each_index",[],((a=function(ne){return null==ne&&(ne=t),q.$print(" (",(null==a.$$s?this:a.$$s).$racc_token2str(ee["$[]"](ne))," ",te["$[]"](ne).$inspect(),")")}).$$s=this,a.$$arity=1,a)),q.$puts(" ]")},Ce.$$arity=2),e.def(s,"$racc_print_states",ke=function(ee){var te,G=t;return(G=this.racc_debug_out).$print("        ["),V(ee,"each",[],((te=function(S){return null==S&&(S=t),G.$print(" ",S)}).$$s=this,te.$$arity=1,te)),G.$puts(" ]")},ke.$$arity=1),e.def(s,"$racc_token2str",qe=function(ee){var a;return p(a=B(this.$class(),"Racc_token_to_s_table")["$[]"](ee))?a:this.$raise("[Racc Bug] can't convert token "+ee+" to string")},qe.$$arity=1),e.def(s,"$token_to_str",De=function(ee){return B(this.$class(),"Racc_token_to_s_table")["$[]"](ee)},De.$$arity=1)}(W[0],W)},Opal.modules["bcdice/arithmetic/node"]=function(e){function H(W,t){return"number"==typeof W&&"number"==typeof t?W/t:W["$/"](t)}var t,O,N,K,U,y,s,l,E,u,o,h,i,b,J,P,$,x=[],r=e.nil,d=e.$$$,n=e.$$,ae=e.module,c=e.klass,j=e.send2;return t=x,O=$=[ae(x[0],"BCDice")].concat(t),N=P=[ae($[0],"Arithmetic")].concat(O),function(K,U,y){var s,l,E,u,o,i=c(K,null,"BinaryOp");[i].concat(y),i.$$prototype.lhs=i.$$prototype.rhs=i.$$prototype.op=r,e.def(i,"$initialize",s=function(A,X,D){var v=this;return v.lhs=A,v.op=X,v.rhs=D},s.$$arity=3),e.def(i,"$eval",l=function(A){var v,X=this,D=r;return D=X.lhs.$eval(A),v=X.rhs.$eval(A),D.$send(X.op,v)},l.$$arity=1),e.def(i,"$output",E=function(){var A=this;return""+A.lhs.$output()+A.op+A.rhs.$output()},E.$$arity=0),e.def(i,"$s_exp",u=function(){var A=this;return"("+A.$op_for_s_exp()+" "+A.lhs.$s_exp()+" "+A.rhs.$s_exp()+")"},u.$$arity=0),e.def(i,"$op_for_s_exp",o=function(){return this.op},o.$$arity=0)}((J=[ae(P[0],"Node")].concat(N))[0],0,J),K=J[0],U=n(J,"BinaryOp"),y=J,i=c(K,U,"DivideBase"),b=[i].concat(y),i.$$prototype.lhs=i.$$prototype.rhs=i.$$prototype.op=r,e.def(i,"$initialize",s=function(X,D){return s.$$p&&(s.$$p=null),j(this,e.find_super_dispatcher(this,"initialize",s,!1,!0),"initialize",[X,"/",D],null)},s.$$arity=2),e.def(i,"$eval",l=function(X){var v,D=this,m=r;return v=D.lhs.$eval(X),(m=D.rhs.$eval(X))["$=="](0)&&D.$raise(n(b,"ZeroDivisionError")),D.$divide_and_round(v,m,X)},l.$$arity=1),e.def(i,"$output",E=function(){var X=E.$$p,v=this,m=r,z=r,M=r;for(X&&(E.$$p=null),z=0,M=arguments.length,m=new Array(M);z<M;z++)m[z]=arguments[z];return""+j(v,e.find_super_dispatcher(v,"output",E,!1,!0),"output",m,X)+v.$rounding_method()},E.$$arity=0),i.$private(),e.def(i,"$rounding_method",u=function(){return d(this.$class(),"ROUNDING_METHOD")},u.$$arity=0),e.def(i,"$op_for_s_exp",o=function(){return""+this.op+this.$rounding_method()},o.$$arity=0),e.def(i,"$divide_and_round",h=function(X,D,v){return this.$raise(n(b,"NotImplementedError"))},h.$$arity=3),function(K,U,y){var s,i=c(K,U,"DivideWithGameSystemDefault"),b=[i].concat(y);e.const_set(b[0],"ROUNDING_METHOD",""),i.$private(),e.def(i,"$divide_and_round",s=function(E,u,o){var A;return A=o,d(n(b,"RoundType"),"CEIL")["$==="](A)?H(E.$to_f(),u).$ceil():d(n(b,"RoundType"),"ROUND")["$==="](A)?H(E.$to_f(),u).$round():H(E,u).$to_i()},s.$$arity=3)}(J[0],n(J,"DivideBase"),J),function(K,U,y){var s,i=c(K,U,"DivideWithCeil"),b=[i].concat(y);e.const_set(b[0],"ROUNDING_METHOD","C"),i.$private(),e.def(i,"$divide_and_round",s=function(E,u,o){return H(E.$to_f(),u).$ceil()},s.$$arity=3)}(J[0],n(J,"DivideBase"),J),function(K,U,y){var s,i=c(K,U,"DivideWithRound"),b=[i].concat(y);e.const_set(b[0],"ROUNDING_METHOD","R"),i.$private(),e.def(i,"$divide_and_round",s=function(E,u,o){return H(E.$to_f(),u).$round()},s.$$arity=3)}(J[0],n(J,"DivideBase"),J),function(K,U,y){var s,i=c(K,U,"DivideWithFloor"),b=[i].concat(y);e.const_set(b[0],"ROUNDING_METHOD","F"),i.$private(),e.def(i,"$divide_and_round",s=function(E,u,o){return H(E,u).$to_i()},s.$$arity=3)}(J[0],n(J,"DivideBase"),J),function(K,U,y){var s,l,E,u,i=c(K,null,"Negative");[i].concat(y),i.$$prototype.body=r,e.def(i,"$initialize",s=function(h){return this.body=h},s.$$arity=1),e.def(i,"$eval",l=function(h){return this.body.$eval(h)["$-@"]()},l.$$arity=1),e.def(i,"$output",E=function(){return"-"+this.body.$output()},E.$$arity=0),e.def(i,"$s_exp",u=function(){return"(- "+this.body.$s_exp()+")"},u.$$arity=0)}(J[0],0,J),function(K,U,y){var s,l,E,u,i=c(K,null,"Parenthesis");[i].concat(y),i.$$prototype.expr=r,e.def(i,"$initialize",s=function(h){return this.expr=h},s.$$arity=1),e.def(i,"$eval",l=function(h){return this.expr.$eval(h)},l.$$arity=1),e.def(i,"$output",E=function(){return"("+this.expr.$output()+")"},E.$$arity=0),e.def(i,"$s_exp",u=function(){return"(Parenthesis "+this.expr.$s_exp()+")"},u.$$arity=0)}(J[0],0,J),void function(K,U,y){var s,l,E,i=c(K,null,"Number");[i].concat(y),i.$$prototype.value=r,e.def(i,"$initialize",s=function(o){return this.value=o},s.$$arity=1),e.def(i,"$eval",l=function(o){return this.value},l.$$arity=1),e.def(i,"$output",E=function(){return this.value.$to_s()},E.$$arity=0),e.alias(i,"s_exp","output")}(J[0],0,J)},Opal.modules.strscan=function(e){var B,O,p,P,V,N,g,J,K,U,y,i,b,s,l,E,u,o,h,A,X,D,v,m,z,M,$,F,x=[],r=e.nil,n=e.$$,c=e.truthy,j=e.send;return B=x,$=(0,e.klass)(x[0],null,"StringScanner"),F=[$].concat(B),$.$$prototype.pos=$.$$prototype.string=$.$$prototype.working=$.$$prototype.matched=$.$$prototype.prev_pos=$.$$prototype.match=r,$.$attr_reader("pos"),$.$attr_reader("matched"),e.def($,"$initialize",O=function(_){var w=this;return w.string=_,w.pos=0,w.matched=r,w.working=_,w.match=[]},O.$$arity=1),$.$attr_reader("string"),e.def($,"$beginning_of_line?",p=function(){var _=this;return 0===_.pos||"\n"===_.string.charAt(_.pos-1)},p.$$arity=0),e.alias($,"bol?","beginning_of_line?"),e.def($,"$scan",P=function(_){var w=this,C=(_=w.$anchor(_)).exec(w.working);return null==C?w.matched=r:"object"==typeof C?(w.prev_pos=w.pos,w.pos+=C[0].length,w.working=w.working.substring(C[0].length),w.matched=C[0],w.match=C,C[0]):"string"==typeof C?(w.pos+=C.length,w.working=w.working.substring(C.length),C):r},P.$$arity=1),e.def($,"$scan_until",V=function(_){var w=this;_=w.$anchor(_);for(var I,C=w.pos,L=w.working;;){if(I=_.exec(L),C+=1,L=L.substr(1),null!=I)return w.matched=w.string.substr(w.pos,C-w.pos-1+I[0].length),w.match=I,w.prev_pos=C-1,w.pos=C,w.working=L.substr(I[0].length),w.matched;if(0===L.length)return w.match=[],w.matched=r}},V.$$arity=1),e.def($,"$[]",N=function(_){var C;if(c(this.match["$empty?"]()))return r;C=_,n(F,"Symbol")["$==="](C)?_=_.$to_s():n(F,"String")["$==="](C)||(_=n(F,"Opal")["$coerce_to!"](_,n(F,"Integer"),"to_int"));var L=this.match;return _<0&&(_+=L.length),_<0||_>=L.length||null==L[_]?r:L[_]},N.$$arity=1),e.def($,"$check",g=function(_){var w=this,C=(_=w.$anchor(_)).exec(w.working);return w.matched=null==C?r:C[0]},g.$$arity=1),e.def($,"$check_until",J=function(_){var w=this,C=w.prev_pos,L=w.pos,I=w.$scan_until(_);return I!==r&&(w.matched=I.substr(-1),w.working=w.string.substr(L)),w.prev_pos=C,w.pos=L,I},J.$$arity=1),e.def($,"$peek",K=function(_){return this.working.substring(0,_)},K.$$arity=1),e.def($,"$eos?",U=function(){return 0===this.working.length},U.$$arity=0),e.def($,"$exist?",y=function(_){var C=_.exec(this.working);return null==C?r:0==C.index?0:C.index+1},y.$$arity=1),e.def($,"$skip",i=function(_){var w=this,C=(_=w.$anchor(_)).exec(w.working);if(null==C)return w.match=[],w.matched=r;var L=C[0],I=L.length;return w.matched=L,w.match=C,w.prev_pos=w.pos,w.pos+=I,w.working=w.working.substring(I),I},i.$$arity=1),e.def($,"$skip_until",b=function(_){var C=this.$scan_until(_);return C===r?r:(this.matched=C.substr(-1),C.length)},b.$$arity=1),e.def($,"$get_byte",s=function(){var _=this,w=r;return _.pos<_.string.length?(_.prev_pos=_.pos,_.pos+=1,w=_.matched=_.working.substring(0,1),_.working=_.working.substring(1)):_.matched=r,w},s.$$arity=0),e.alias($,"getch","get_byte"),e.def($,"$match?",l=function(_){var w=this,C=(_=w.$anchor(_)).exec(w.working);return null==C?r:(w.prev_pos=w.pos,C[0].length)},l.$$arity=1),e.def($,"$pos=",E=function(_){var w=this;return _<0&&(_+=w.string.$length()),w.pos=_,w.working=w.string.slice(_)},E.$$arity=1),e.def($,"$matched_size",u=function(){return this.matched===r?r:this.matched.length},u.$$arity=0),e.def($,"$post_match",o=function(){var _=this;return _.matched===r?r:_.string.substr(_.pos)},o.$$arity=0),e.def($,"$pre_match",h=function(){var _=this;return _.matched===r?r:_.string.substr(0,_.prev_pos)},h.$$arity=0),e.def($,"$reset",A=function(){var _=this;return _.working=_.string,_.matched=r,_.pos=0},A.$$arity=0),e.def($,"$rest",X=function(){return this.working},X.$$arity=0),e.def($,"$rest?",D=function(){return 0!==this.working.length},D.$$arity=0),e.def($,"$rest_size",v=function(){return this.$rest().$size()},v.$$arity=0),e.def($,"$terminate",m=function(){var w,W,_=this;return _.match=r,w=[_.string.$length()],j(_,"pos=",e.to_a(w)),w[(W=w.length,"number"==typeof W?W-1:W["$-"](1))]},m.$$arity=0),e.def($,"$unscan",z=function(){var _=this;return _.pos=_.prev_pos,_.prev_pos=r,_.match=r,_},z.$$arity=0),$.$private(),e.def($,"$anchor",M=function(_){var C=_.toString().match(/\/([^\/]+)$/);return C=C?C[1]:void 0,new RegExp("^(?:"+_.source+")",C)},M.$$arity=1),r&&"anchor"},Opal.modules["bcdice/normalize"]=function(e){var B,O,p,$,c,W,Z=[],x=e.nil,n=e.module;return c=Z,B=W=[n(Z[0],"BCDice")].concat(c),[$=n(W[0],"Normalize")].concat(B),$.$module_function(),e.def($,"$comparison_operator",O=function(V){var g;return/<=|=</["$==="](g=V)?"<=":/>=|=>/["$==="](g)?">=":/<>|!=|=!/["$==="](g)?"!=":/</["$==="](g)?"<":/>/["$==="](g)?">":/=/["$==="](g)?"==":x},O.$$arity=1),void e.def($,"$target_number",p=function(V){return V["$=="]("?")?V:V.$to_i()},p.$$arity=1)},Opal.modules["bcdice/command/lexer"]=function(e){var B,p,J,y,i,b,K,U,V,F,H=e.top,Z=[],x=e.nil,d=e.$$,n=e.module,ae=e.klass,c=e.hash2,j=e.truthy,W=e.send;return H.$require("strscan"),H.$require("bcdice/normalize"),B=Z,p=F=[n(Z[0],"BCDice")].concat(B),J=V=[n(F[0],"Command")].concat(p),K=ae(V[0],null,"Lexer"),U=[K].concat(J),K.$$prototype.scanner=K.$$prototype.notations=x,e.const_set(U[0],"SYMBOLS",c(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),e.def(K,"$initialize",y=function(l,E){var u,o,h,X,A=this;return l=j(X=(o=(u=l)===x||null==u?x:W(u,"split",[" ",2]))===x||null==o?x:W(o,"first",[]))?X:"",A.scanner=d(U,"StringScanner").$new(l),A.notations=W(E,"map",[],((h=function(D){function v(m){return D.apply(this,arguments)}return v.toString=function(){return D.toString()},v}(function(D){return null==D&&(D=x),j(D["$is_a?"](d(U,"String")))?d(U,"Regexp").$new(D):D})).$$s=A,h.$$arity=1,h))},y.$$arity=2),e.def(K,"$next_token",i=function(){try{var l,E=this,u=x,o=x,A=x,X=x;return j(E.scanner["$eos?"]())?[!1,"$"]:(W(E.notations,"each",[],((l=function(v){var z,m=null==l.$$s?this:l.$$s;if(null==m.scanner&&(m.scanner=x),null==v&&(v=x),z=m.scanner.$scan(v),!j(z))return x;e.ret(["NOTATION",z])}).$$s=E,l.$$arity=1,l)),j(u=E.scanner.$scan(/\d+/))?["NUMBER",u.$to_i()]:j(o=E.scanner.$scan(/[<>!=]+/))?(o=d(U,"Normalize").$comparison_operator(o),[j(o)?"CMP_OP":"ILLEGAL",o]):(A=E.scanner.$getch().$upcase(),[j(X=d(U,"SYMBOLS")["$[]"](A))?X:A.$to_sym(),A]))}catch(D){if(D===e.returner)return D.$v;throw D}},i.$$arity=0),void e.def(K,"$source",b=function(){return this.scanner.$string()},b.$$arity=0)},Opal.modules["bcdice/command/parsed"]=function(e){var W,F,N,K,U,y,g,J,p,B,Z=[],x=e.nil,d=e.$$,n=e.module,ae=e.klass,c=e.truthy;return W=Z,F=B=[n(Z[0],"BCDice")].concat(W),N=p=[n(B[0],"Command")].concat(F),g=ae(p[0],null,"Parsed"),J=[g].concat(N),g.$$prototype.question_target=g.$$prototype.critical=g.$$prototype.fumble=g.$$prototype.dollar=g.$$prototype.modify_number=g.$$prototype.target_number=g.$$prototype.prefix_number=g.$$prototype.command=g.$$prototype.suffix_number=g.$$prototype.cmp_op=x,g.$attr_accessor("command"),g.$attr_accessor("prefix_number"),g.$attr_accessor("suffix_number"),g.$attr_accessor("critical"),g.$attr_accessor("fumble"),g.$attr_accessor("dollar"),g.$attr_accessor("modify_number"),g.$attr_accessor("cmp_op"),g.$attr_accessor("target_number"),g.$attr_writer("question_target"),e.def(g,"$initialize",K=function(){var b=this;return b.prefix_number=x,b.suffix_number=x,b.critical=x,b.fumble=x,b.dollar=x,b.cmp_op=x,b.target_number=x,b.question_target=!1},K.$$arity=0),e.def(g,"$question_target?",U=function(){return this.question_target},U.$$arity=0),void e.def(g,"$to_s",y=function(b){var A,s=this,l=x,E=x,u=x,o=x,h=x;return null==b&&(b="after_command"),l=c(s.critical)?"@"+s.critical:x,E=c(s.fumble)?"#"+s.fumble:x,u=c(s.dollar)?"$"+s.dollar:x,o=d(J,"Format").$modifier(s.modify_number),h=c(s.question_target)?"?":s.target_number,"after_command"["$==="](A=b)?[s.prefix_number,s.command,s.suffix_number,l,E,u,o,s.cmp_op,h].$join():"after_modify_number"["$==="](A)?[s.prefix_number,s.command,s.suffix_number,o,l,E,u,s.cmp_op,h].$join():"after_target_number"["$==="](A)?[s.prefix_number,s.command,s.suffix_number,o,s.cmp_op,h,l,E,u].$join():x},y.$$arity=-1)},Opal.modules["bcdice/command/parser"]=function(e){function H(F,O){return"number"==typeof F&&"number"==typeof O?F-O:F["$-"](O)}var O,N,K,U,y,s,l,E,u,o,h,A,X,D,v,m,z,M,Y,_,w,C,L,I,ye,ve,ge,Ce,ke,qe,De,be,ee,te,a,G,q,S,ne,ie,ce,Pe,oe,fe,he,we,de,Te,me,ze,Ie,Me,Ne,He,We,Le,Be,Ge,je,xe,Q,i,b,J,P,Z=e.top,x=[],r=e.nil,d=e.$$$,n=e.$$,ae=e.klass,c=e.module,j=e.hash2,W=e.send2,t=e.send,B=e.hash,$=e.truthy;return Z.$require("racc/parser.rb"),Z.$require("bcdice/arithmetic/node"),Z.$require("bcdice/command/lexer"),Z.$require("bcdice/command/parsed"),function(F,O,p){[ae(F,O,"Parser")].concat(p)}(d(n(x,"BCDice"),"Command"),d(n(x,"Racc"),"Parser"),x),O=x,N=P=[c(x[0],"BCDice")].concat(O),K=(J=[c(P[0],"Command")].concat(N))[0],U=d(n(J,"Racc"),"Parser"),y=J,i=ae(K,U,"Parser"),b=[i].concat(y),i.$$prototype.notations=i.$$prototype.lexer=i.$$prototype.modifier=i.$$prototype.prefix_number=i.$$prototype.suffix_number=i.$$prototype.need_suffix_number=i.$$prototype.need_prefix_number=i.$$prototype.critical=i.$$prototype.fumble=i.$$prototype.dollar=i.$$prototype.allowed_cmp_op=i.$$prototype.question_target=r,e.def(i,"$initialize",s=function(f,$e){var k,R,ue,Ee,se=s.$$p,Se=this;if(se&&(s.$$p=null),k=e.slice.call(arguments,0,arguments.length),null==(R=e.extract_kwargs(k)))R=j([],{});else if(!R.$$is_hash)throw e.ArgumentError.$new("expected kwargs");if(ue=k,!e.hasOwnProperty.call(R.$$smap,"round_type"))throw e.ArgumentError.$new("missing keyword: round_type");return Ee=R.$$smap.round_type,W(Se,e.find_super_dispatcher(Se,"initialize",s,!1,!0),"initialize",[],null),Se.notations=ue,Se.round_type=Ee,Se.prefix_number=!1,Se.suffix_number=!1,Se.need_prefix_number=!1,Se.need_suffix_number=!1,Se.modifier=!0,Se.critical=!1,Se.fumble=!1,Se.dollar=!1,Se.allowed_cmp_op=[r,">=",">","<=","<","==","!="],Se.question_target=!1},s.$$arity=-2),e.def(i,"$disable_modifier",l=function(){return this.modifier=!1,this},l.$$arity=0),e.def(i,"$enable_prefix_number",E=function(){return this.prefix_number=!0,this},E.$$arity=0),e.def(i,"$enable_suffix_number",u=function(){return this.suffix_number=!0,this},u.$$arity=0),e.def(i,"$has_prefix_number",o=function(){var f=this;return f.prefix_number=!0,f.need_prefix_number=!0,f},o.$$arity=0),e.def(i,"$has_suffix_number",h=function(){var f=this;return f.suffix_number=!0,f.need_suffix_number=!0,f},h.$$arity=0),e.def(i,"$enable_critical",A=function(){return this.critical=!0,this},A.$$arity=0),e.def(i,"$enable_fumble",X=function(){return this.fumble=!0,this},X.$$arity=0),e.def(i,"$enable_dollar",D=function(){return this.dollar=!0,this},D.$$arity=0),e.def(i,"$restrict_cmp_op_to",v=function(f){var $e,R=this;return $e=e.slice.call(arguments,0,arguments.length),R.allowed_cmp_op=$e,R},v.$$arity=-1),e.def(i,"$enable_question_target",m=function(){return this.question_target=!0,this},m.$$arity=0),e.def(i,"$parse",z=function(f){try{return this.lexer=n(b,"Lexer").$new(f,this.notations),this.$do_parse()}catch(k){if(!e.rescue(k,[n(b,"ParseError"),n(b,"ZeroDivisionError")]))throw k;try{return r}finally{e.pop_exception()}}},z.$$arity=1),i.$private(),e.def(i,"$parsed",M=function(f,$e,k,R){var ue;return t(n(b,"Parsed").$new(),"tap",[],((ue=function(Ae){var Fe,Ue,Ke,Ye,Ve,Qe,Se=null==ue.$$s?this:ue.$$s,pe=r;return null==Se.round_type&&(Se.round_type=r),null==Ae&&(Ae=r),pe=[f["$[]"]("command")],t(Ae,"command=",e.to_a(pe)),H(pe.length,1),pe=[(Fe=f["$[]"]("prefix"),Fe===r||null==Fe?r:t(Fe,"eval",[Se.round_type]))],t(Ae,"prefix_number=",e.to_a(pe)),H(pe.length,1),pe=[(Ue=f["$[]"]("suffix"),Ue===r||null==Ue?r:t(Ue,"eval",[Se.round_type]))],t(Ae,"suffix_number=",e.to_a(pe)),H(pe.length,1),pe=[(Ke=$e["$[]"]("critical"),Ke===r||null==Ke?r:t(Ke,"eval",[Se.round_type]))],t(Ae,"critical=",e.to_a(pe)),H(pe.length,1),pe=[(Ye=$e["$[]"]("fumble"),Ye===r||null==Ye?r:t(Ye,"eval",[Se.round_type]))],t(Ae,"fumble=",e.to_a(pe)),H(pe.length,1),pe=[(Ve=$e["$[]"]("dollar"),Ve===r||null==Ve?r:t(Ve,"eval",[Se.round_type]))],t(Ae,"dollar=",e.to_a(pe)),H(pe.length,1),pe=[k.$eval(Se.round_type)],t(Ae,"modify_number=",e.to_a(pe)),H(pe.length,1),pe=[R["$[]"]("cmp_op")],t(Ae,"cmp_op=",e.to_a(pe)),H(pe.length,1),R["$[]"]("target")["$=="]("?")?(t(Ae,"question_target=",e.to_a(pe=[!0])),H(pe.length,1),t(Ae,"target_number=",e.to_a(pe=[0])),pe[H(pe.length,1)]):(t(Ae,"question_target=",e.to_a(pe=[!1])),H(pe.length,1),pe=[(Qe=R["$[]"]("target"),Qe===r||null==Qe?r:t(Qe,"eval",[Se.round_type]))],t(Ae,"target_number=",e.to_a(pe)),pe[H(pe.length,1)])}).$$s=this,ue.$$arity=1,ue))},M.$$arity=4),e.def(i,"$next_token",Y=function(){return this.lexer.$next_token()},Y.$$arity=0),Me=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,33,34,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,36,37,17,18,6,r,5,r,r,17,18,6,r,5,r,r,17,18,r,r,5,23,24,25,26,56,54,55,57],Ne=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,r,17,15,15,18,18,23,r,18,30,30,23,23,24,r,23,31,31,24,24,25,r,24,44,44,25,25,28,r,25,47,47,28,28,29,r,28,48,48,29,29,33,r,29,49,49,33,33,34,r,33,50,50,34,34,36,r,34,r,r,36,36,37,r,36,r,r,37,37,r,r,37,27,27,27,27,52,52,52,52],He=[-2,4,16,-3,-1,11,r,33,13,35,23,30,1,r,28,40,r,37,44,r,r,-2,r,51,58,65,0,106,72,79,47,54,r,86,93,r,100,107,r,r,r,r,r,r,63,r,r,68,75,82,89,r,120,r,r,r,r,r],We=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],Le=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,r,r,21,47,48,40,51,52,49,50,44,46,3,r,r,r,13,r,r,r,r,r,r,r,32],Be=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,r,r,4,8,8,5,7,7,8,8,9,5,6,r,r,r,6,r,r,r,r,r,r,r,6],Ge=[r,6,13,3,9,-1,27,-15,-10,-1,-38],je=[r,r,r,r,r,r,19,16,15,r,r],xe=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],Q=B(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),e.const_set(b[0],"Racc_arg",[Me,Ne,We,He,Le,Be,je,Ge,19,xe,Q,58,35,!0]),e.const_set(b[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),e.const_set(b[0],"Racc_debug_parser",!1),e.def(i,"$_reduce_1",_=function(f,$e,k){var R;return $(this.modifier)||this.$raise(n(b,"ParseError")),R=e.to_ary(f),this.$parsed(null==R[0]?r:R[0],null==R[1]?r:R[1],null==R[2]?r:R[2],null==R[3]?r:R[3])},_.$$arity=3),e.def(i,"$_reduce_2",w=function(f,$e,k){var R;return $(this.modifier)||this.$raise(n(b,"ParseError")),R=e.to_ary(f),this.$parsed(null==R[0]?r:R[0],null==R[2]?r:R[2],null==R[1]?r:R[1],null==R[3]?r:R[3])},w.$$arity=3),e.def(i,"$_reduce_3",C=function(f,$e,k){var R,Se;return Se=null==(R=e.to_ary(f))[2]?r:R[2],this.$parsed(null==R[0]?r:R[0],null==R[1]?r:R[1],d(d(n(b,"Arithmetic"),"Node"),"Number").$new(0),Se)},C.$$arity=3),e.def(i,"$_reduce_4",L=function(f,$e,k){var ue,R=this;return $($(ue=R.prefix_number)?R.suffix_number:ue)||R.$raise(n(b,"ParseError")),j(["command","prefix","suffix"],{command:f["$[]"](1),prefix:f["$[]"](0),suffix:f["$[]"](2)})},L.$$arity=3),e.def(i,"$_reduce_5",I=function(f,$e,k){var R=this;return $(R.prefix_number)||R.$raise(n(b,"ParseError")),$(R.need_suffix_number)&&R.$raise(n(b,"ParseError")),j(["command","prefix"],{command:f["$[]"](1),prefix:f["$[]"](0)})},I.$$arity=3),e.def(i,"$_reduce_6",ye=function(f,$e,k){var R=this;return $(R.suffix_number)||R.$raise(n(b,"ParseError")),$(R.need_prefix_number)&&R.$raise(n(b,"ParseError")),j(["command","suffix"],{command:f["$[]"](0),suffix:f["$[]"](1)})},ye.$$arity=3),e.def(i,"$_reduce_7",ve=function(f,$e,k){var ue,R=this;return $($(ue=R.need_prefix_number)?ue:R.need_suffix_number)&&R.$raise(n(b,"ParseError")),j(["command"],{command:f["$[]"](0)})},ve.$$arity=3),e.def(i,"$_reduce_8",ge=function(f,$e,k){return j([],{})},ge.$$arity=3),e.def(i,"$_reduce_9",Ce=function(f,$e,k){var R,Se,Ue,Fe,se=r;return se=null==(R=e.to_ary(f))[0]?r:R[0],Se=null==R[2]?r:R[2],$($(Fe=this.critical)?se["$[]"]("critical")["$nil?"]():Fe)||this.$raise(n(b,"ParseError")),t(se,"[]=",e.to_a(Ue=["critical",Se])),H(Ue.length,1),se},Ce.$$arity=3),e.def(i,"$_reduce_10",ke=function(f,$e,k){var R,Se,Ue,Fe,se=r;return se=null==(R=e.to_ary(f))[0]?r:R[0],Se=null==R[2]?r:R[2],$($(Fe=this.fumble)?se["$[]"]("fumble")["$nil?"]():Fe)||this.$raise(n(b,"ParseError")),t(se,"[]=",e.to_a(Ue=["fumble",Se])),H(Ue.length,1),se},ke.$$arity=3),e.def(i,"$_reduce_11",qe=function(f,$e,k){var R,Se,Ue,Fe,se=r;return se=null==(R=e.to_ary(f))[0]?r:R[0],Se=null==R[2]?r:R[2],$($(Fe=this.dollar)?se["$[]"]("dollar")["$nil?"]():Fe)||this.$raise(n(b,"ParseError")),t(se,"[]=",e.to_a(Ue=["dollar",Se])),H(Ue.length,1),se},qe.$$arity=3),e.def(i,"$_reduce_12",De=function(f,$e,k){return f["$[]"](1)},De.$$arity=3),e.def(i,"$_reduce_13",be=function(f,$e,k){return d(d(n(b,"Arithmetic"),"Node"),"Negative").$new(f["$[]"](1))},be.$$arity=3),e.def(i,"$_reduce_14",ee=function(f,$e,k){return d(d(n(b,"Arithmetic"),"Node"),"BinaryOp").$new(f["$[]"](0),"+",f["$[]"](2))},ee.$$arity=3),e.def(i,"$_reduce_15",te=function(f,$e,k){return d(d(n(b,"Arithmetic"),"Node"),"BinaryOp").$new(f["$[]"](0),"-",f["$[]"](2))},te.$$arity=3),e.def(i,"$_reduce_16",a=function(f,$e,k){return $(this.allowed_cmp_op["$include?"](r))||this.$raise(n(b,"ParseError")),j([],{})},a.$$arity=3),e.def(i,"$_reduce_17",G=function(f,$e,k){var R,se,Ae;return Ae=null==(R=e.to_ary(f))[1]?r:R[1],$(this.allowed_cmp_op["$include?"](se=null==R[0]?r:R[0]))||this.$raise(n(b,"ParseError")),j(["cmp_op","target"],{cmp_op:se,target:Ae})},G.$$arity=3),e.def(i,"$_reduce_18",q=function(f,$e,k){var ue,R=this;return ue=f["$[]"](0),$(R.question_target)||R.$raise(n(b,"ParseError")),$(R.allowed_cmp_op["$include?"](ue))||R.$raise(n(b,"ParseError")),j(["cmp_op","target"],{cmp_op:ue,target:"?"})},q.$$arity=3),e.def(i,"$_reduce_19",S=function(f,$e,k){return d(d(n(b,"Arithmetic"),"Node"),"BinaryOp").$new(f["$[]"](0),"+",f["$[]"](2))},S.$$arity=3),e.def(i,"$_reduce_20",ne=function(f,$e,k){return d(d(n(b,"Arithmetic"),"Node"),"BinaryOp").$new(f["$[]"](0),"-",f["$[]"](2))},ne.$$arity=3),e.def(i,"$_reduce_22",ie=function(f,$e,k){return d(d(n(b,"Arithmetic"),"Node"),"BinaryOp").$new(f["$[]"](0),"*",f["$[]"](2))},ie.$$arity=3),e.def(i,"$_reduce_23",ce=function(f,$e,k){return f["$[]"](3).$new(f["$[]"](0),f["$[]"](2))},ce.$$arity=3),e.def(i,"$_reduce_25",Pe=function(f,$e,k){return d(d(n(b,"Arithmetic"),"Node"),"DivideWithGameSystemDefault")},Pe.$$arity=3),e.def(i,"$_reduce_26",oe=function(f,$e,k){return d(d(n(b,"Arithmetic"),"Node"),"DivideWithCeil")},oe.$$arity=3),e.def(i,"$_reduce_27",fe=function(f,$e,k){return d(d(n(b,"Arithmetic"),"Node"),"DivideWithCeil")},fe.$$arity=3),e.def(i,"$_reduce_28",he=function(f,$e,k){return d(d(n(b,"Arithmetic"),"Node"),"DivideWithRound")},he.$$arity=3),e.def(i,"$_reduce_29",we=function(f,$e,k){return d(d(n(b,"Arithmetic"),"Node"),"DivideWithFloor")},we.$$arity=3),e.def(i,"$_reduce_30",de=function(f,$e,k){return f["$[]"](1)},de.$$arity=3),e.def(i,"$_reduce_31",Te=function(f,$e,k){return d(d(n(b,"Arithmetic"),"Node"),"Negative").$new(f["$[]"](1))},Te.$$arity=3),e.def(i,"$_reduce_33",me=function(f,$e,k){return f["$[]"](1)},me.$$arity=3),e.def(i,"$_reduce_34",ze=function(f,$e,k){return d(d(n(b,"Arithmetic"),"Node"),"Number").$new(f["$[]"](0))},ze.$$arity=3),void e.def(i,"$_reduce_none",Ie=function(f,$e,k){return f["$[]"](0)},Ie.$$arity=3)},Opal.modules["bcdice/deprecated/checker"]=function(e){var W,F,V,J,K,U,y,i,b,N,g,p,B,Z=[],x=e.nil,d=e.$$,n=e.module,ae=e.send,c=e.truthy;return W=Z,F=B=[n(Z[0],"BCDice")].concat(W),V=p=[n(B[0],"Deprecated")].concat(F),N=n(p[0],"Checker"),g=[N].concat(V),N.$private(),e.def(N,"$check_result_legacy",J=function(l,E,u,o){var D,z,h=this,A=x,X=x,v=x,m=x,M=x;return A=ae(E,"map",[],"sides".$to_proc()),D=(X=ae(E,"map",[],"value".$to_proc())).$sum(),v=[100]["$==="](m=A)?h.$check_1D100(l,D,u,o):[20]["$==="](m)?h.$check_1D20(l,D,u,o):[6,6]["$==="](m)?h.$check_2D6(l,D,X,u,o):x,c(c(z=v["$nil?"]())?z:v["$empty?"]())&&(m=A.$uniq(),v=[10]["$==="](m)?h.$check_nD10(l,D,X,u,o):[6]["$==="](m)?h.$check_nD6(l,D,X,u,o):x,c(c(M=v["$nil?"]())?M:v["$empty?"]()))?x:d(g,"Result").$new(v.$delete_prefix(" \uff1e "))},J.$$arity=4),e.def(N,"$check_1D100",K=function(l,E,u,o){return x},K.$$arity=4),e.def(N,"$check_1D20",U=function(l,E,u,o){return x},U.$$arity=4),e.def(N,"$check_nD10",y=function(l,E,u,o,h){return x},y.$$arity=5),e.def(N,"$check_2D6",i=function(l,E,u,o,h){return x},i.$$arity=5),void e.def(N,"$check_nD6",b=function(l,E,u,o,h){return x},b.$$arity=5)},Opal.modules["bcdice/base"]=function(e){function H(P,V){return"number"==typeof P&&"number"==typeof V?P+V:P["$+"](V)}function Z(P,V){return"number"==typeof P&&"number"==typeof V?P-V:P["$-"](V)}var V,U,b,s,l,E,u,o,h,A,X,D,v,m,z,M,Y,_,w,C,L,I,ye,ve,ge,Ce,ke,qe,De,be,ee,te,q,S,ne,ie,ce,G,y,i,g,n=e.top,ae=[],c=e.nil,j=e.$$$,W=e.$$,t=e.module,B=e.klass,$=e.truthy,F=e.send,O=e.range,p=c;return n.$require("i18n"),n.$require("i18n/backend/fallbacks"),n.$require("bcdice/randomizer"),n.$require("bcdice/dice_table"),n.$require("bcdice/enum"),n.$require("bcdice/translate"),n.$require("bcdice/result"),n.$require("bcdice/command/parser"),n.$require("bcdice/deprecated/checker"),V=ae,U=g=[t(ae[0],"BCDice")].concat(V),y=B(g[0],null,"Base"),i=[y].concat(U),y.$$prototype.sort_add_dice=y.$$prototype.sort_barabara_dice=y.$$prototype.enabled_d9=y.$$prototype.raw_input=y.$$prototype.randomizer=y.$$prototype.enabled_upcase_input=y.$$prototype.debug=c,te=e.get_singleton_class(y),G=[te].concat(i),te.$attr_reader("prefixes"),e.def(te,"$register_prefix",q=function(oe){var he,we=this,de=c;return null==we.prefixes&&(we.prefixes=c),he=e.slice.call(arguments,0,arguments.length),we.prefixes=$(de=we.prefixes)?de:[],we.prefixes.$concat(he.$flatten())},q.$$arity=-1),e.def(te,"$register_prefix_from_super_class",S=function(){return this.$register_prefix(this.$superclass().$prefixes())},S.$$arity=0),e.def(te,"$prefixes_pattern",ne=function(){var fe,oe=this,he=c;return null==oe.prefixes_pattern&&(oe.prefixes_pattern=c),null==oe.prefixes&&(oe.prefixes=c),oe.prefixes_pattern=$(fe=oe.prefixes_pattern)?fe:c,$(oe.prefixes_pattern)?oe.prefixes_pattern:(oe.prefixes=$(he=oe.prefixes)?he:[],oe.prefixes.$freeze(),oe.prefixes_pattern=($(oe.prefixes["$empty?"]())?/(?!)/:e.regexp(["^(S)?(",oe.prefixes.$join("|"),")"],"i")).$freeze())},ne.$$arity=0),e.def(te,"$command_pattern",ie=function(){var oe,he,fe=this,we=c,de=c;return null==fe.command_pattern&&(fe.command_pattern=c),null==fe.prefixes&&(fe.prefixes=c),fe.command_pattern=$(he=fe.command_pattern)?he:c,$(fe.command_pattern)?fe.command_pattern:(fe.prefixes=$(we=fe.prefixes)?we:[],fe.prefixes.$freeze(),de=H(F(j(W(G,"CommonCommand"),"COMMANDS"),"map",[],((oe=function(me){return null==me&&(me=c),j(me,"PREFIX_PATTERN").$source()}).$$s=fe,oe.$$arity=1,oe)),fe.prefixes),fe.command_pattern=e.regexp(["^S?(",de.$join("|"),")"],"i").$freeze())},ie.$$arity=0),e.def(te,"$eval",ce=function(oe){return this.$new(oe).$eval()},ce.$$arity=1),y.$include(W(i,"Translate")),y.$include(j(W(i,"Deprecated"),"Checker")),e.def(y,"$initialize",b=function(a){var G=this;return G.raw_input=a,G.sort_add_dice=!1,G.sort_barabara_dice=!1,G.d66_sort_type=j(W(i,"D66SortType"),"NO_SORT"),G.enabled_d9=!1,G.round_type=j(W(i,"RoundType"),"FLOOR"),G.sides_implicit_d=6,G.upper_dice_reroll_threshold=c,G.reroll_dice_reroll_threshold=c,G.default_cmp_op=c,G.default_target_number=c,G.enabled_upcase_input=!0,G.locale="ja_jp",G.randomizer=j(W(i,"BCDice"),"Randomizer").$new(),G.debug=!1},b.$$arity=1),y.$attr_accessor("randomizer"),y.$attr_reader("d66_sort_type"),y.$attr_reader("round_type"),y.$attr_reader("sides_implicit_d"),y.$attr_reader("upper_dice_reroll_threshold"),y.$attr_reader("reroll_dice_reroll_threshold"),y.$attr_reader("default_cmp_op"),y.$attr_reader("default_target_number"),e.def(y,"$sort_add_dice?",s=function(){return this.sort_add_dice},s.$$arity=0),e.def(y,"$sort_barabara_dice?",l=function(){return this.sort_barabara_dice},l.$$arity=0),e.def(y,"$enabled_d9?",E=function(){return this.enabled_d9},E.$$arity=0),e.def(y,"$enable_debug",u=function(){return this.debug=!0},u.$$arity=0),e.def(y,"$eval",o=function(){var G,q,S,a=this,ne=c;return G=j(W(i,"BCDice"),"Preprocessor").$process(a.raw_input,a),q=$(S=a.$dice_command(G))?S:a.$eval_common_command(a.raw_input),$(q)?(ne=[a.randomizer.$rand_results()],F(q,"rands=",e.to_a(ne)),Z(ne.length,1),ne=[a.randomizer.$detailed_rand_results()],F(q,"detailed_rands=",e.to_a(ne)),Z(ne.length,1),q):c},o.$$arity=0),e.def(y,"$change_text",h=function(a){return a},h.$$arity=1),e.def(y,"$check_result",A=function(a,G,q,S){var ne=this,ie=c,ce=c,Pe=c,oe=c,fe=c;return ie=ne.$check_result_legacy(a,G,q,S),$(ie)?ie:(ce=F(G,"map",[],"sides".$to_proc()),oe=(Pe=F(G,"map",[],"value".$to_proc())).$sum(),(ie=[100]["$==="](fe=ce)?ne.$result_1d100(a,oe,q,S):[20]["$==="](fe)?ne.$result_1d20(a,oe,q,S):[6,6]["$==="](fe)?ne.$result_2d6(a,oe,Pe,q,S):c)["$=="](W(i,"Result").$nothing())?c:$(ie)?ie:(fe=ce.$uniq(),(ie=[10]["$==="](fe)?ne.$result_nd10(a,oe,Pe,q,S):[6]["$==="](fe)?ne.$result_nd6(a,oe,Pe,q,S):c)["$=="](W(i,"Result").$nothing())?c:$(ie)?ie:ne.$result_ndx(a,q,S)))},A.$$arity=4),e.def(y,"$grich_text",X=function(a,G,q){return c},X.$$arity=3),y.$private(),e.def(y,"$eval_common_command",D=function(a){try{var G;return a=this.$change_text(a),F(j(W(i,"CommonCommand"),"COMMANDS"),"each",[],((G=function(ne){var ce,ie=null==G.$$s?this:G.$$s;if(null==ie.randomizer&&(ie.randomizer=c),null==ne&&(ne=c),ce=ne.$eval(a,ie,ie.randomizer),!$(ce))return c;e.ret(ce)}).$$s=this,G.$$arity=1,G)),c}catch(S){if(S===e.returner)return S.$v;throw S}},D.$$arity=1),e.def(y,"$dice_command",v=function(a){var G,q=this,S=c,ne=c,ie=c,ce=c,Pe=c,oe=c,fe=c;return $(q.enabled_upcase_input)&&(a=a.$upcase()),S=q.$class().$prefixes_pattern().$match(a),$(S)?(ne=S["$[]"](1)["$nil?"]()["$!"](),$(ne)&&(a=a["$[]"](O(1,-1,!1))),ie=q.$eval_game_system_specific_command(a),$(ie["$is_a?"](W(i,"Result")))?(ce=[$(Pe=ie["$secret?"]())?Pe:ne],F(ie,"secret=",e.to_a(ce)),Z(ce.length,1),ie):$($(oe=$(fe=ie["$nil?"]())?fe:ie["$empty?"]())?oe:ie["$=="]("1"))?c:F(W(i,"Result").$new(),"tap",[],((G=function(we){return null==we&&(we=c),ce=[ie.$to_s()],F(we,"text=",e.to_a(ce)),Z(ce.length,1),F(we,"secret=",e.to_a(ce=[ne])),ce[Z(ce.length,1)]}).$$s=q,G.$$arity=1,G))):c},v.$$arity=1),e.def(y,"$eval_game_system_specific_command",m=function(a){return c},m.$$arity=1),e.def(y,"$result_ndx",z=function(a,G,q){return $(q["$is_a?"](W(i,"String")))?c:$(a.$send(G,q))?W(i,"Result").$success(this.$translate("success")):W(i,"Result").$failure(this.$translate("failure"))},z.$$arity=3),e.def(y,"$result_1d100",M=function(a,G,q,S){return c},M.$$arity=4),e.def(y,"$result_1d20",Y=function(a,G,q,S){return c},Y.$$arity=4),e.def(y,"$result_nd10",_=function(a,G,q,S,ne){return c},_.$$arity=5),e.def(y,"$result_2d6",w=function(a,G,q,S,ne){return c},w.$$arity=5),e.def(y,"$result_nd6",C=function(a,G,q,S,ne){return c},C.$$arity=5),e.def(y,"$get_table_by_2d6",L=function(a){return this.$get_table_by_nD6(a,2)},L.$$arity=1),e.def(y,"$get_table_by_1d6",I=function(a){return this.$get_table_by_nD6(a,1)},I.$$arity=1),e.def(y,"$get_table_by_nD6",ye=function(a,G){return this.$get_table_by_nDx(a,G,6)},ye.$$arity=2),e.def(y,"$get_table_by_nDx",ve=function(a,G,q){var ne,ie=c;return ne=this.randomizer.$roll_sum(G,q),ie=this.$get_table_value(a["$[]"](Z(ne,G))),$(ie["$nil?"]())?["1",0]:[ie,ne]},ve.$$arity=3),e.def(y,"$get_table_by_1d3",ge=function(a){var S,ne,P,G=this,ie=c;return G.$debug("get_table_by_1d3"),S=G.randomizer.$roll_sum(1,6),G.$debug("num",S),ne=(P=Z(S,1),"number"==typeof P?P/2:P["$/"](2)).$to_i(),G.$debug("index",ne),ie=a["$[]"](ne),$(ie["$nil?"]())?["1",0]:[ie,S]},ge.$$arity=1),e.def(y,"$get_table_by_d66_swap",Ce=function(a){var q;return q=this.randomizer.$roll_d66(j(W(i,"D66SortType"),"ASC")),[this.$get_table_by_number(q,a),q]},Ce.$$arity=1),e.def(y,"$get_table_by_d66",ke=function(a){var q,S,ne,ce,P,ie=c;return q=this.randomizer.$roll_once(6),S=this.randomizer.$roll_once(6),ne=H("number"==typeof(P=Z(q,1))?6*P:P["$*"](6),Z(S,1)),ie=a["$[]"](ne),ce=""+q+S,$(ie["$nil?"]())?["1",ce]:[ie,ce]},ke.$$arity=1),e.def(y,"$get_table_by_number",qe=function(a,G,q){try{var S;return null==q&&(q="1"),F(G,"each",[],((S=function(ce){var oe,Pe=null==S.$$s?this:S.$$s;if(null==ce&&(ce=c),oe=ce["$[]"](0),!$(function(P,V){return"number"==typeof P&&"number"==typeof V?P>=V:P["$>="](V)}(oe,a)))return c;e.ret(Pe.$get_table_value(ce["$[]"](1)))}).$$s=this,S.$$arity=1,S)),this.$get_table_value(q)}catch(ie){if(ie===e.returner)return ie.$v;throw ie}},qe.$$arity=-3),e.def(y,"$get_table_value",De=function(a){return $(a["$is_a?"](W(i,"Proc")))?a.$call():a},De.$$arity=1),e.def(y,"$roll_tables",be=function(a,G){var S=c;return S=G["$[]"](a),$(S)?S.$roll(this.randomizer).$to_s():c},be.$$arity=2),e.def(y,"$debug",ee=function(a,G){var S,ne,ie=this,ce=c,Pe=c;return S=e.slice.call(arguments,1,arguments.length),$(ie.debug)?(ce=$(a["$is_a?"](W(i,"String")))?a:a.$inspect(),$(S["$empty?"]())?ie.$warn(ce):(Pe=F(S,"map",[],((ne=function(fe){return null==fe&&(fe=c),$(fe["$is_a?"](W(i,"String")))?'"'+fe+'"':fe.$inspect()}).$$s=ie,ne.$$arity=1,ne)),ie.$warn(ce+": "+Pe.$join(", ")))):c},ee.$$arity=-2),j(j(W(ae,"I18n"),"Backend"),"Simple").$include(j(j(W(ae,"I18n"),"Backend"),"Fallbacks")),W(ae,"I18n").$load_path()["$<<"](W(ae,"Dir")["$[]"](W(ae,"File").$join(n.$__dir__(),"../../i18n/**/*.yml"))),p=["ja_jp"],F(W(ae,"I18n"),"default_locale=",e.to_a(p)),Z(p.length,1),p=[["ja_jp"]],F(W(ae,"I18n").$fallbacks(),"defaults=",e.to_a(p)),p[Z(p.length,1)]},Opal.modules["bcdice/game_system/sword_world/rating_lexer"]=function(e){var B,p,J,b,E,u,o,s,l,U,V,F,Z=[],x=e.nil,d=e.$$,n=e.module,ae=e.klass,c=e.hash2,j=e.truthy,W=e.send;return e.top.$require("strscan"),B=Z,p=F=[n(Z[0],"BCDice")].concat(B),J=V=[n(F[0],"GameSystem")].concat(p),b=U=[ae(V[0],d(V,"Base"),"SwordWorld")].concat(J),s=ae(U[0],null,"RatingLexer"),l=[s].concat(b),s.$$prototype.scanner=x,e.const_set(l[0],"SYMBOLS",c(["+","-","*","/","(",")","[","]","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),e.def(s,"$initialize",E=function(A){var X,D,m;return A=j(m=(D=(X=A)===x||null==X?x:W(X,"split",[" ",2]))===x||null==D?x:W(D,"first",[]))?m:"",this.scanner=d(l,"StringScanner").$new(A)},E.$$arity=1),e.def(s,"$next_token",u=function(){var A=this,X=x,D=x,m=x;return j(A.scanner["$eos?"]())?[!1,"$"]:j(X=A.scanner.$scan(/\d+/))?["NUMBER",X.$to_i()]:(D=A.scanner.$getch().$upcase(),[j(m=d(l,"SYMBOLS")["$[]"](D))?m:D.$to_sym(),D])},u.$$arity=0),void e.def(s,"$source",o=function(){return this.scanner.$string()},o.$$arity=0)},Opal.modules["bcdice/game_system/sword_world/rating_parsed"]=function(e){function H(B,$){return"number"==typeof B&&"number"==typeof $?B<$:B["$<"]($)}function Z(B,$){return"number"==typeof B&&"number"==typeof $?B+$:B["$+"]($)}function x(B,$){return"number"==typeof B&&"number"==typeof $?B>$:B["$>"]($)}var $,P,K,s,u,o,h,A,X,D,v,m,z,M,Y,_,w,l,E,y,N,O,d=[],n=e.nil,c=e.$$,j=e.module,W=e.klass,t=e.truthy;return $=d,P=O=[j(d[0],"BCDice")].concat($),K=N=[j(O[0],"GameSystem")].concat(P),s=y=[W(N[0],c(N,"Base"),"SwordWorld")].concat(K),l=W(y[0],null,"RatingParsed"),E=[l].concat(s),l.$$prototype.modifier_after_half=l.$$prototype.critical=l.$$prototype.semi_fixed_val=l.$$prototype.kept_modify=l.$$prototype.first_modify=l.$$prototype.first_to=l.$$prototype.rateup=l.$$prototype.tmp_fixed_val=l.$$prototype.rate=l.$$prototype.greatest_fortune=l.$$prototype.modifier=n,l.$attr_accessor("rate"),l.$attr_writer("critical"),l.$attr_writer("kept_modify"),l.$attr_writer("first_to"),l.$attr_writer("first_modify"),l.$attr_writer("rateup"),l.$attr_accessor("greatest_fortune"),l.$attr_writer("semi_fixed_val"),l.$attr_writer("tmp_fixed_val"),l.$attr_accessor("modifier"),l.$attr_writer("modifier_after_half"),e.def(l,"$initialize",u=function(){var L=this;return L.critical=n,L.min_critical=n,L.kept_modify=n,L.first_to=n,L.first_modify=n,L.greatest_fortune=!1,L.rateup=n,L.semi_fixed_val=n,L.tmp_fixed_val=n},u.$$arity=0),e.def(l,"$half",o=function(){return this.modifier_after_half["$nil?"]()["$!"]()},o.$$arity=0),e.def(l,"$critical",h=function(){var I;return t(I=this.critical)?I:t(this.$half())?13:10},h.$$arity=0),e.def(l,"$min_critical",A=function(){var L=this,I=n;return I=3,t(L.semi_fixed_val["$nil?"]())||(t(L.kept_modify["$nil?"]())?t(H(I,Z(L.semi_fixed_val,2)))&&(I=Z(L.semi_fixed_val,2)):t(H(I,Z(Z(L.semi_fixed_val,L.kept_modify),2)))&&(I=Z(Z(L.semi_fixed_val,L.kept_modify),2)),L.semi_fixed_val["$=="](1)&&(I=3)),t(x(I,13))&&(I=13),I},A.$$arity=0),e.def(l,"$first_modify",X=function(){var I;return t(I=this.first_modify)?I:0},X.$$arity=0),e.def(l,"$first_to",D=function(){var I;return t(I=this.first_to)?I:0},D.$$arity=0),e.def(l,"$rateup",v=function(){var I;return t(I=this.rateup)?I:0},v.$$arity=0),e.def(l,"$semi_fixed_val",m=function(){var ye,I=n;return I=t(ye=this.semi_fixed_val)?ye:0,t(x(I,6))&&(I=6),I},m.$$arity=0),e.def(l,"$tmp_fixed_val",z=function(){var ye,I=n;return I=t(ye=this.tmp_fixed_val)?ye:0,t(x(I,6))&&(I=6),I},z.$$arity=0),e.def(l,"$kept_modify",M=function(){var I;return t(I=this.kept_modify)?I:0},M.$$arity=0),e.def(l,"$modifier_after_half",Y=function(){var I;return t(I=this.modifier_after_half)?I:0},Y.$$arity=0),e.def(l,"$to_s",_=function(){var L=this,I=n;return I="KeyNo."+L.rate,t(H(L.$critical(),13))&&(I=Z(I,"c["+L.$critical()+"]")),t(L.$first_modify()["$!="](0))&&(I=Z(I,"m["+c(E,"Format").$modifier(L.$first_modify())+"]")),t(L.$first_to()["$!="](0))&&(I=Z(I,"m["+L.$first_to()+"]")),t(L.$rateup()["$!="](0))&&(I=Z(I,"r["+L.$rateup()+"]")),t(L.greatest_fortune)&&(I=Z(I,"gf")),t(L.$semi_fixed_val()["$!="](0))&&(I=Z(I,"sf["+L.$semi_fixed_val()+"]")),t(L.$tmp_fixed_val()["$!="](0))&&(I=Z(I,"tf["+L.$tmp_fixed_val()+"]")),t(L.$kept_modify()["$!="](0))&&(I=Z(I,"a["+c(E,"Format").$modifier(L.$kept_modify())+"]")),t(L.modifier["$!="](0))&&(I=Z(I,c(E,"Format").$modifier(L.modifier))),I},_.$$arity=0),void e.def(l,"$infinite_roll?",w=function(){return H(this.$critical(),this.$min_critical())},w.$$arity=0)},Opal.modules["bcdice/game_system/sword_world/rating_parser"]=function(e){function H(F,O){return"number"==typeof F&&"number"==typeof O?F-O:F["$-"](O)}var O,N,y,E,h,A,X,D,v,m,z,M,Y,_,w,C,L,I,ye,ve,ge,Ce,ke,qe,De,be,ee,te,a,G,q,S,ne,ie,ce,Pe,oe,fe,he,we,de,Te,me,ze,Ie,Me,Ne,He,Be,u,o,b,J,P,Z=e.top,x=[],r=e.nil,d=e.$$$,n=e.$$,ae=e.module,c=e.klass,j=e.hash2,W=e.send2,t=e.send,B=e.hash,$=e.truthy;return Z.$require("racc/parser.rb"),Z.$require("bcdice/arithmetic/node"),Z.$require("bcdice/enum"),Z.$require("bcdice/game_system/sword_world/rating_lexer"),Z.$require("bcdice/game_system/sword_world/rating_parsed"),O=x,N=P=[ae(x[0],"BCDice")].concat(O),y=J=[ae(P[0],"GameSystem")].concat(N),E=b=[c(J[0],n(J,"Base"),"SwordWorld")].concat(y),u=c(b[0],d(n(b,"Racc"),"Parser"),"RatingParser"),o=[u].concat(E),u.$$prototype.lexer=u.$$prototype.version=r,e.def(u,"$initialize",h=function(_e){var Re,Q;if(h.$$p&&(h.$$p=null),null==_e)_e=j([],{});else if(!_e.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(Re=_e.$$smap.version)&&(Re="v1_0"),null==(Q=_e.$$smap.round_type)&&(Q=d(n(o,"RoundType"),"CEIL")),W(this,e.find_super_dispatcher(this,"initialize",h,!1,!0),"initialize",[],null),this.version=Re,this.round_type=Q},h.$$arity=-1),e.def(u,"$set_debug",A=function(){return this.yydebug=!0,this},A.$$arity=0),e.def(u,"$parse",X=function(_e){try{return this.lexer=n(o,"RatingLexer").$new(_e),this.$do_parse()}catch(Q){if(!e.rescue(Q,[n(o,"ParseError"),n(o,"ZeroDivisionError")]))throw Q;try{return r}finally{e.pop_exception()}}},X.$$arity=1),u.$private(),e.def(u,"$parsed",D=function(_e,Re,Q){var T;return t(n(o,"RatingParsed").$new(),"tap",[],((T=function(f){var k,R,ue,Ee,$e=null==T.$$s?this:T.$$s,se=r;return null==$e.round_type&&($e.round_type=r),null==f&&(f=r),t(f,"rate=",e.to_a(se=[_e])),H(se.length,1),se=[(k=Q["$[]"]("critical"),k===r||null==k?r:t(k,"eval",[$e.round_type]))],t(f,"critical=",e.to_a(se)),H(se.length,1),se=[(R=Q["$[]"]("kept_modify"),R===r||null==R?r:t(R,"eval",[$e.round_type]))],t(f,"kept_modify=",e.to_a(se)),H(se.length,1),se=[Q["$[]"]("first_to")],t(f,"first_to=",e.to_a(se)),H(se.length,1),se=[Q["$[]"]("first_modify")],t(f,"first_modify=",e.to_a(se)),H(se.length,1),se=[(ue=Q["$[]"]("rateup"),ue===r||null==ue?r:t(ue,"eval",[$e.round_type]))],t(f,"rateup=",e.to_a(se)),H(se.length,1),se=[Q.$fetch("greatest_fortune",!1)],t(f,"greatest_fortune=",e.to_a(se)),H(se.length,1),se=[Q["$[]"]("semi_fixed_val")],t(f,"semi_fixed_val=",e.to_a(se)),H(se.length,1),se=[Q["$[]"]("tmp_fixed_val")],t(f,"tmp_fixed_val=",e.to_a(se)),H(se.length,1),se=[Re.$eval($e.round_type)],t(f,"modifier=",e.to_a(se)),H(se.length,1),se=[(Ee=Q["$[]"]("modifier_after_half"),Ee===r||null==Ee?r:t(Ee,"eval",[$e.round_type]))],t(f,"modifier_after_half=",e.to_a(se)),se[H(se.length,1)]}).$$s=this,T.$$arity=1,T))},D.$$arity=3),e.def(u,"$next_token",v=function(){return this.lexer.$next_token()},v.$$arity=0),we=[15,14,16,5,17,18,20,21,57,58,23,24,11,59,12,19,13,15,14,16,4,17,18,20,21,4,30,3,30,11,8,12,19,13,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,9,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,55,56,30,26,27,26,27,29,30,29,26,27,37,30,29,30,26,27,55,56,29,26,27,26,27,29,30,29,30,55,56,38,39,32,26,27,26,27,29,46,29,33,34,51,52,53,54],de=[6,6,6,1,6,6,6,6,49,49,10,10,6,49,6,6,6,22,22,22,3,22,22,22,22,0,11,0,12,22,4,22,22,22,11,11,12,12,11,14,12,15,41,41,43,43,19,14,14,15,15,14,20,15,19,19,5,21,19,23,20,20,44,44,20,21,21,23,23,21,24,23,26,45,45,50,50,27,24,24,26,26,24,29,26,27,27,16,55,27,56,29,29,62,62,29,55,55,56,56,55,57,56,58,63,63,17,18,13,57,57,58,58,57,25,58,13,13,33,34,38,39],Te=[22,3,r,17,28,56,-4,r,r,r,0,24,26,106,37,39,80,99,100,44,50,55,13,57,68,97,70,75,r,81,r,r,r,116,117,r,r,r,118,119,r,30,r,32,50,61,r,r,r,-2,63,r,r,r,r,86,88,99,101,r,r,r,81,92],me=[-33,-33,-4,-33,-33,-33,-1,-4,-3,64,-5,-33,-33,-33,-11,-33,-33,-33,-33,-33,-33,-33,-2,-33,-33,-33,-33,-33,-30,-33,-32,-7,-8,-33,-33,-12,-13,-14,-33,-33,-17,-18,-27,-19,-20,-21,-6,-28,-29,-33,-24,-9,-10,-15,-16,-33,-33,-33,-33,-31,-25,-26,-22,-23],ze=[25,31,6,35,36,1,49,22,40,41,43,2,44,45,7,47,48,r,50,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,60,61,62,63],Ie=[5,5,3,5,5,1,7,3,5,6,6,2,6,6,2,5,5,r,6,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,5,5,6,6],Me=[r,5,11,0,r,-11,-11,-23,r],Ne=[r,r,r,r,10,42,r,r,28],He=[0,0,"racc_error",2,22,"_reduce_1",3,22,"_reduce_2",2,23,"_reduce_3",0,24,"_reduce_4",2,24,"_reduce_5",4,24,"_reduce_6",3,24,"_reduce_7",3,24,"_reduce_8",4,24,"_reduce_9",4,24,"_reduce_10",2,24,"_reduce_11",3,24,"_reduce_12",3,24,"_reduce_13",3,24,"_reduce_14",4,24,"_reduce_15",4,24,"_reduce_16",3,24,"_reduce_17",2,25,"_reduce_18",2,25,"_reduce_19",3,25,"_reduce_20",3,25,"_reduce_21",3,28,"_reduce_22",3,28,"_reduce_23",1,28,"_reduce_none",3,27,"_reduce_25",3,27,"_reduce_26",1,27,"_reduce_none",2,26,"_reduce_28",2,26,"_reduce_29",1,26,"_reduce_none",3,29,"_reduce_31",1,29,"_reduce_32"],Be=B(!1,0,"error",1,"NUMBER",2,"K",3,"R",4,"H",5,"G",6,"F",7,"S",8,"T",9,"PLUS",10,"MINUS",11,"ASTERISK",12,"SLASH",13,"PARENL",14,"PARENR",15,"BRACKETL",16,"BRACKETR",17,"AT",18,"SHARP",19,"DOLLAR",20),e.const_set(o[0],"Racc_arg",[we,de,me,Te,ze,Ie,Ne,Me,21,He,Be,64,33,!0]),e.const_set(o[0],"Racc_token_to_s_table",["$end","error","NUMBER","K","R","H","G","F","S","T","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","AT","SHARP","DOLLAR","$start","expr","rate","option","modifier","unary","mul","add","term"]),e.const_set(o[0],"Racc_debug_parser",!1),e.def(u,"$_reduce_1",m=function(_e,Re,Q){var T,f,k,R,$e=r;return f=null==(T=e.to_ary(_e))[0]?r:T[0],k=$(R=($e=null==T[1]?r:T[1])["$[]"]("modifier"))?R:d(d(n(o,"Arithmetic"),"Node"),"Number").$new(0),this.$parsed(f,k,$e)},m.$$arity=3),e.def(u,"$_reduce_2",z=function(_e,Re,Q){var T,$e,Ee,se,k=r,ue=r;return $e=null==(T=e.to_ary(_e))[1]?r:T[1],$((k=null==T[2]?r:T[2])["$[]"]("modifier_after_half"))||(ue=["modifier_after_half",d(d(n(o,"Arithmetic"),"Node"),"Number").$new(0)],t(k,"[]=",e.to_a(ue)),H(ue.length,1)),Ee=$(se=k["$[]"]("modifier"))?se:d(d(n(o,"Arithmetic"),"Node"),"Number").$new(0),this.$parsed($e,Ee,k)},z.$$arity=3),e.def(u,"$_reduce_3",M=function(_e,Re,Q){return _e["$[]"](1).$to_i()},M.$$arity=3),e.def(u,"$_reduce_4",Y=function(_e,Re,Q){return j([],{})},Y.$$arity=3),e.def(u,"$_reduce_5",_=function(_e,Re,Q){var T,$e,k,f=r;return $e=null==(T=e.to_ary(_e))[1]?r:T[1],$((f=null==T[0]?r:T[0])["$[]"]("modifier")["$nil?"]())||this.$raise(n(o,"ParseError")),t(f,"[]=",e.to_a(k=["modifier",$e])),H(k.length,1),f},_.$$arity=3),e.def(u,"$_reduce_6",w=function(_e,Re,Q){var T,k,R,f=r;return k=null==(T=e.to_ary(_e))[2]?r:T[2],$((f=null==T[0]?r:T[0])["$[]"]("critical")["$nil?"]())||this.$raise(n(o,"ParseError")),t(f,"[]=",e.to_a(R=["critical",k])),H(R.length,1),f},w.$$arity=3),e.def(u,"$_reduce_7",C=function(_e,Re,Q){var T,k,R,f=r;return k=null==(T=e.to_ary(_e))[2]?r:T[2],$((f=null==T[0]?r:T[0])["$[]"]("critical")["$nil?"]())||this.$raise(n(o,"ParseError")),t(f,"[]=",e.to_a(R=["critical",k])),H(R.length,1),f},C.$$arity=3),e.def(u,"$_reduce_8",L=function(_e,Re,Q){var T,ue,R,f=r,k=r;return k=null==(T=e.to_ary(_e))[2]?r:T[2],$($(R=(f=null==T[0]?r:T[0])["$[]"]("first_to")["$nil?"]())?f["$[]"]("first_modify")["$nil?"]():R)||this.$raise(n(o,"ParseError")),ue=["first_to",k.$to_i()],t(f,"[]=",e.to_a(ue)),H(ue.length,1),f},L.$$arity=3),e.def(u,"$_reduce_9",I=function(_e,Re,Q){var T,ue,R,f=r,k=r;return k=null==(T=e.to_ary(_e))[3]?r:T[3],$($(R=(f=null==T[0]?r:T[0])["$[]"]("first_to")["$nil?"]())?f["$[]"]("first_modify")["$nil?"]():R)||this.$raise(n(o,"ParseError")),ue=["first_modify",k.$to_i()],t(f,"[]=",e.to_a(ue)),H(ue.length,1),f},I.$$arity=3),e.def(u,"$_reduce_10",ye=function(_e,Re,Q){var T,ue,R,f=r,k=r;return k=null==(T=e.to_ary(_e))[3]?r:T[3],$($(R=(f=null==T[0]?r:T[0])["$[]"]("first_to")["$nil?"]())?f["$[]"]("first_modify")["$nil?"]():R)||this.$raise(n(o,"ParseError")),ue=["first_modify",k.$to_i()["$-@"]()],t(f,"[]=",e.to_a(ue)),H(ue.length,1),f},ye.$$arity=3),e.def(u,"$_reduce_11",ve=function(_e,Re,Q){var T,k,f=r;return T=e.to_ary(_e),$((f=null==T[0]?r:T[0])["$[]"]("modifier_after_half")["$nil?"]())||this.$raise(n(o,"ParseError")),k=["modifier_after_half",d(d(n(o,"Arithmetic"),"Node"),"Number").$new(0)],t(f,"[]=",e.to_a(k)),H(k.length,1),f},ve.$$arity=3),e.def(u,"$_reduce_12",ge=function(_e,Re,Q){var T,k,R,f=r;return k=null==(T=e.to_ary(_e))[2]?r:T[2],$((f=null==T[0]?r:T[0])["$[]"]("modifier_after_half")["$nil?"]())||this.$raise(n(o,"ParseError")),t(f,"[]=",e.to_a(R=["modifier_after_half",k])),H(R.length,1),f},ge.$$arity=3),e.def(u,"$_reduce_13",Ce=function(_e,Re,Q){var T,k,ue,R,f=r;return f=null==(T=e.to_ary(_e))[0]?r:T[0],k=null==T[2]?r:T[2],$($(R=["v2_5","v2_0"]["$include?"](this.version))?f["$[]"]("rateup")["$nil?"]():R)||this.$raise(n(o,"ParseError")),t(f,"[]=",e.to_a(ue=["rateup",k])),H(ue.length,1),f},Ce.$$arity=3),e.def(u,"$_reduce_14",ke=function(_e,Re,Q){var T,k,re=this,f=r;return f=null==(T=e.to_ary(_e))[0]?r:T[0],$(["v2_5","v2_0"]["$include?"](re.version))||re.$raise(n(o,"ParseError")),$(f["$[]"]("greatest_fortune")["$nil?"]())||re.$raise(n(o,"ParseError")),$(f["$[]"]("semi_fixed_val")["$nil?"]())||re.$raise(n(o,"ParseError")),$(f["$[]"]("tmp_fixed_val")["$nil?"]())||re.$raise(n(o,"ParseError")),t(f,"[]=",e.to_a(k=["greatest_fortune",!0])),H(k.length,1),f},ke.$$arity=3),e.def(u,"$_reduce_15",qe=function(_e,Re,Q){var T,R,re=this,f=r,k=r;return f=null==(T=e.to_ary(_e))[0]?r:T[0],k=null==T[3]?r:T[3],$(["v2_5","v2_0"]["$include?"](re.version))||re.$raise(n(o,"ParseError")),$(f["$[]"]("greatest_fortune")["$nil?"]())||re.$raise(n(o,"ParseError")),$(f["$[]"]("semi_fixed_val")["$nil?"]())||re.$raise(n(o,"ParseError")),$(f["$[]"]("tmp_fixed_val")["$nil?"]())||re.$raise(n(o,"ParseError")),R=["semi_fixed_val",k.$to_i()],t(f,"[]=",e.to_a(R)),H(R.length,1),f},qe.$$arity=3),e.def(u,"$_reduce_16",De=function(_e,Re,Q){var T,R,re=this,f=r,k=r;return f=null==(T=e.to_ary(_e))[0]?r:T[0],k=null==T[3]?r:T[3],$(["v2_5","v2_0"]["$include?"](re.version))||re.$raise(n(o,"ParseError")),$(f["$[]"]("greatest_fortune")["$nil?"]())||re.$raise(n(o,"ParseError")),$(f["$[]"]("semi_fixed_val")["$nil?"]())||re.$raise(n(o,"ParseError")),$(f["$[]"]("tmp_fixed_val")["$nil?"]())||re.$raise(n(o,"ParseError")),R=["tmp_fixed_val",k.$to_i()],t(f,"[]=",e.to_a(R)),H(R.length,1),f},De.$$arity=3),e.def(u,"$_reduce_17",be=function(_e,Re,Q){var T,k,ue,R,f=r;return f=null==(T=e.to_ary(_e))[0]?r:T[0],k=null==T[2]?r:T[2],$($(R=this.version["$=="]("v2_5"))?f["$[]"]("kept_modify")["$nil?"]():R)||this.$raise(n(o,"ParseError")),t(f,"[]=",e.to_a(ue=["kept_modify",k])),H(ue.length,1),f},be.$$arity=3),e.def(u,"$_reduce_18",ee=function(_e,Re,Q){return _e["$[]"](1)},ee.$$arity=3),e.def(u,"$_reduce_19",te=function(_e,Re,Q){return d(d(n(o,"Arithmetic"),"Node"),"Negative").$new(_e["$[]"](1))},te.$$arity=3),e.def(u,"$_reduce_20",a=function(_e,Re,Q){return d(d(n(o,"Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"+",_e["$[]"](2))},a.$$arity=3),e.def(u,"$_reduce_21",G=function(_e,Re,Q){return d(d(n(o,"Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"-",_e["$[]"](2))},G.$$arity=3),e.def(u,"$_reduce_22",q=function(_e,Re,Q){return d(d(n(o,"Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"+",_e["$[]"](2))},q.$$arity=3),e.def(u,"$_reduce_23",S=function(_e,Re,Q){return d(d(n(o,"Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"-",_e["$[]"](2))},S.$$arity=3),e.def(u,"$_reduce_25",ne=function(_e,Re,Q){return d(d(n(o,"Arithmetic"),"Node"),"BinaryOp").$new(_e["$[]"](0),"*",_e["$[]"](2))},ne.$$arity=3),e.def(u,"$_reduce_26",ie=function(_e,Re,Q){return d(d(n(o,"Arithmetic"),"Node"),"DivideWithGameSystemDefault").$new(_e["$[]"](0),_e["$[]"](2))},ie.$$arity=3),e.def(u,"$_reduce_28",ce=function(_e,Re,Q){return _e["$[]"](1)},ce.$$arity=3),e.def(u,"$_reduce_29",Pe=function(_e,Re,Q){return d(d(n(o,"Arithmetic"),"Node"),"Negative").$new(_e["$[]"](1))},Pe.$$arity=3),e.def(u,"$_reduce_31",oe=function(_e,Re,Q){return _e["$[]"](1)},oe.$$arity=3),e.def(u,"$_reduce_32",fe=function(_e,Re,Q){return d(d(n(o,"Arithmetic"),"Node"),"Number").$new(_e["$[]"](0))},fe.$$arity=3),void e.def(u,"$_reduce_none",he=function(_e,Re,Q){return _e["$[]"](0)},he.$$arity=3)},function(e){function H(N,g){return"number"==typeof N&&"number"==typeof g?N>=g:N["$>="](g)}function Z(N,g){return"number"==typeof N&&"number"==typeof g?N<=g:N["$<="](g)}function x(N,g){return"number"==typeof N&&"number"==typeof g?N-g:N["$-"](g)}function r(N,g){return"number"==typeof N&&"number"==typeof g?N>g:N["$>"](g)}function d(N,g){return"number"==typeof N&&"number"==typeof g?N+g:N["$+"](g)}function ae(N,g){return"number"==typeof N&&"number"==typeof g?N*g:N["$*"](g)}var g,y,E,h,A,X,D,v,m,z,M,Y,u,o,b,K,j=e.top,W=[],t=e.nil,$=e.$$,F=e.module,O=e.klass,p=e.send2,P=e.truthy,V=e.send;j.$require("bcdice/base"),j.$require("bcdice/game_system/sword_world/rating_parser"),g=W,y=K=[F(W[0],"BCDice")].concat(g),E=b=[F(K[0],"GameSystem")].concat(y),u=O(b[0],$(b,"Base"),"SwordWorld"),o=[u].concat(E),u.$$prototype.rating_table=u.$$prototype.randomizer=t,e.const_set(o[0],"ID","SwordWorld"),e.const_set(o[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG"),e.const_set(o[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u3068"),e.const_set(o[0],"HELP_MESSAGE","\u30fbSW\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx[c]+m$f) (x:\u30ad\u30fc, c:\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024, m:\u30dc\u30fc\u30ca\u30b9, f:\u51fa\u76ee\u4fee\u6b63)\n"),u.$register_prefix("H?K"),e.def(u,"$initialize",h=function(w){var I=this;return h.$$p&&(h.$$p=null),p(I,e.find_super_dispatcher(I,"initialize",h,!1,!0),"initialize",[w],null),I.rating_table=0},h.$$arity=1),e.def(u,"$result_2d6",A=function(w,C,L,I,ye){var ge=t;return P(H(C,12))?$(o,"Result").$critical("\u81ea\u52d5\u7684\u6210\u529f"):P(Z(C,2))?$(o,"Result").$fumble("\u81ea\u52d5\u7684\u5931\u6557"):P(P(ge=I["$!="](">="))?ge:ye["$=="]("?"))?t:P(H(w,ye))?$(o,"Result").$success("\u6210\u529f"):$(o,"Result").$failure("\u5931\u6557")},A.$$arity=5),e.def(u,"$eval_game_system_specific_command",X=function(w){return this.$rating(w)},X.$$arity=1),u.$private(),e.def(u,"$rating_parser",D=function(){return $(o,"RatingParser").$new()},D.$$arity=0),e.def(u,"$rating",v=function(w){var C,L,I,ye,ve=this,ge=t,Ce=t,ke=t,qe=t,De=t,be=t,ee=t,te=t,a=t,G=t,q=t,S=t,ne=t,ie=t,Pe=t,oe=t;return ve.$debug("rating string",w),ge=ve.$rating_parser().$parse(w),P(ge)?(Ce=ve.$getSW2_0_RatingTable(),ke=x(Ce.$length(),1),ve.$debug("keyMax",ke),P(r(ge.$rate(),ke))?"\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc\u306f"+ke+"\u307e\u3067\u3067\u3059":P(ge["$infinite_roll?"]())?$(o,"Result").$new("C\u5024\u3092"+ge.$min_critical()+"\u4ee5\u4e0a\u306b\u3057\u3066\u304f\u3060\u3055\u3044"):(qe=ve.$getNewRates(Ce),De=ge+" \uff1e ",be=[],ee=[],te=[],a=0,G=0,q=0,S=0,ne=ge.$first_to(),ie=ge.$first_modify(),function(){var fe=e.new_brk();try{V(ve,"loop",[],((C=function(){var de,Te,Me,Ne,Ie,N,we=null==C.$$s?this:C.$$s,me=t,ze=t;if(Te=we.$rollDice(ge,S),ze=null==(de=e.to_ary(Te))[1]?t:de[1],a=me=null==de[0]?t:de[0],P(ne["$!="](0))?(a=me=ne,ne=0):P(ie["$!="](0))&&(a=d(a,ie),ie=0),P(Z(me,2))&&(be["$<<"](me.$to_s()),ee["$<<"](ze.$to_s()),te["$<<"]("**"),S=d(S,1),e.brk(t,fe)),P(P(Ie=ge.$kept_modify()["$!="](0))?a["$!="](2):Ie)&&(a=d(a,ge.$kept_modify())),P("number"==typeof(N=a)?N<2:N["$<"](2))&&(a=2),P(r(a,12))&&(a=12),Me=[d(ge.$rate(),ae(S,ge.$rateup())),ke].$min(),we.$debug("currentKey",Me),Ne=qe["$[]"](a)["$[]"](Me),we.$debug("rateValue",Ne),q=d(q,Ne),G=d(G,a),be["$<<"](a.$to_s()),ee["$<<"](ze.$to_s()),te["$<<"](P(r(a,2))?Ne:"**"),S=d(S,1),P(H(a,ge.$critical())))return t;e.brk(t,fe)}).$$s=ve,C.$$brk=fe,C.$$arity=0,C))}catch(he){if(he===fe)return he.$v;throw he}}(),I=ve.$getResultText(q,ge,ee,be,te,G,S),L=e.to_ary(I),Pe=null==L[1]?t:L[1],oe=null==L[2]?t:L[2],De=d(De,null==L[0]?t:L[0]),V($(o,"Result").$new(),"tap",[],((ye=function(he){var de=t;return null==he&&(he=t),V(he,"text=",e.to_a(de=[De])),x(de.length,1),V(he,"critical=",e.to_a(de=[Pe])),x(de.length,1),V(he,"fumble=",e.to_a(de=[oe])),de[x(de.length,1)]}).$$s=ve,ye.$$arity=1,ye)))):(ve.$debug("not matched"),"1")},v.$$arity=1),e.def(u,"$getSW2_0_RatingTable",m=function(){return["*,0,0,0,1,2,2,3,3,4,4","*,0,0,0,1,2,3,3,3,4,4","*,0,0,0,1,2,3,4,4,4,4","*,0,0,1,1,2,3,4,4,4,5","*,0,0,1,2,2,3,4,4,5,5","*,0,1,1,2,2,3,4,5,5,5","*,0,1,1,2,3,3,4,5,5,5","*,0,1,1,2,3,4,4,5,5,6","*,0,1,2,2,3,4,4,5,6,6","*,0,1,2,3,3,4,4,5,6,7","*,1,1,2,3,3,4,5,5,6,7","*,1,2,2,3,3,4,5,6,6,7","*,1,2,2,3,4,4,5,6,6,7","*,1,2,3,3,4,4,5,6,7,7","*,1,2,3,4,4,4,5,6,7,8","*,1,2,3,4,4,5,5,6,7,8","*,1,2,3,4,4,5,6,7,7,8","*,1,2,3,4,5,5,6,7,7,8","*,1,2,3,4,5,6,6,7,7,8","*,1,2,3,4,5,6,7,7,8,9","*,1,2,3,4,5,6,7,8,9,10","*,1,2,3,4,6,6,7,8,9,10","*,1,2,3,5,6,6,7,8,9,10","*,2,2,3,5,6,7,7,8,9,10","*,2,3,4,5,6,7,7,8,9,10","*,2,3,4,5,6,7,8,8,9,10","*,2,3,4,5,6,8,8,9,9,10","*,2,3,4,6,6,8,8,9,9,10","*,2,3,4,6,6,8,9,9,10,10","*,2,3,4,6,7,8,9,9,10,10","*,2,4,4,6,7,8,9,10,10,10","*,2,4,5,6,7,8,9,10,10,11","*,3,4,5,6,7,8,10,10,10,11","*,3,4,5,6,8,8,10,10,10,11","*,3,4,5,6,8,9,10,10,11,11","*,3,4,5,7,8,9,10,10,11,12","*,3,5,5,7,8,9,10,11,11,12","*,3,5,6,7,8,9,10,11,12,12","*,3,5,6,7,8,10,10,11,12,13","*,4,5,6,7,8,10,11,11,12,13","*,4,5,6,7,9,10,11,11,12,13","*,4,6,6,7,9,10,11,12,12,13","*,4,6,7,7,9,10,11,12,13,13","*,4,6,7,8,9,10,11,12,13,14","*,4,6,7,8,10,10,11,12,13,14","*,4,6,7,9,10,10,11,12,13,14","*,4,6,7,9,10,10,12,13,13,14","*,4,6,7,9,10,11,12,13,13,15","*,4,6,7,9,10,12,12,13,13,15","*,4,6,7,10,10,12,12,13,14,15","*,4,6,8,10,10,12,12,13,15,15","*,5,7,8,10,10,12,12,13,15,15","*,5,7,8,10,11,12,12,13,15,15","*,5,7,9,10,11,12,12,14,15,15","*,5,7,9,10,11,12,13,14,15,16","*,5,7,10,10,11,12,13,14,16,16","*,5,8,10,10,11,12,13,15,16,16","*,5,8,10,11,11,12,13,15,16,17","*,5,8,10,11,12,12,13,15,16,17","*,5,9,10,11,12,12,14,15,16,17","*,5,9,10,11,12,13,14,15,16,18","*,5,9,10,11,12,13,14,16,17,18","*,5,9,10,11,13,13,14,16,17,18","*,5,9,10,11,13,13,15,17,17,18","*,5,9,10,11,13,14,15,17,17,18","*,5,9,10,12,13,14,15,17,18,18","*,5,9,10,12,13,15,15,17,18,19","*,5,9,10,12,13,15,16,17,19,19","*,5,9,10,12,14,15,16,17,19,19","*,5,9,10,12,14,16,16,17,19,19","*,5,9,10,12,14,16,17,18,19,19","*,5,9,10,13,14,16,17,18,19,20","*,5,9,10,13,15,16,17,18,19,20","*,5,9,10,13,15,16,17,19,20,21","*,6,9,10,13,15,16,18,19,20,21","*,6,9,10,13,16,16,18,19,20,21","*,6,9,10,13,16,17,18,19,20,21","*,6,9,10,13,16,17,18,20,21,22","*,6,9,10,13,16,17,19,20,22,23","*,6,9,10,13,16,18,19,20,22,23","*,6,9,10,13,16,18,20,21,22,23","*,6,9,10,13,17,18,20,21,22,23","*,6,9,10,14,17,18,20,21,22,24","*,6,9,11,14,17,18,20,21,23,24","*,6,9,11,14,17,19,20,21,23,24","*,6,9,11,14,17,19,21,22,23,24","*,7,10,11,14,17,19,21,22,23,25","*,7,10,12,14,17,19,21,22,24,25","*,7,10,12,14,18,19,21,22,24,25","*,7,10,12,15,18,19,21,22,24,26","*,7,10,12,15,18,19,21,23,25,26","*,7,11,13,15,18,19,21,23,25,26","*,7,11,13,15,18,20,21,23,25,27","*,8,11,13,15,18,20,22,23,25,27","*,8,11,13,16,18,20,22,23,25,28","*,8,11,14,16,18,20,22,23,26,28","*,8,11,14,16,19,20,22,23,26,28","*,8,12,14,16,19,20,22,24,26,28","*,8,12,15,16,19,20,22,24,27,28","*,8,12,15,17,19,20,22,24,27,29","*,8,12,15,18,19,20,22,24,27,30"]},m.$$arity=0),e.def(u,"$getNewRates",z=function(w){var C,I=t,ye=t,ve=t,ge=t,Ce=t,ke=t,qe=t,De=t,be=t,ee=t,te=t,a=t;return I=[],ye=[],ve=[],ge=[],Ce=[],ke=[],qe=[],De=[],be=[],ee=[],te=[],V(w,"each",[],((C=function(S){var ie=t;return null==S&&(S=t),ie=S.$split(/,/),te.$push(0),I.$push(ie["$[]"](1).$to_i()),ye.$push(ie["$[]"](2).$to_i()),ve.$push(ie["$[]"](3).$to_i()),ge.$push(ie["$[]"](4).$to_i()),Ce.$push(ie["$[]"](5).$to_i()),ke.$push(ie["$[]"](6).$to_i()),qe.$push(ie["$[]"](7).$to_i()),De.$push(ie["$[]"](8).$to_i()),be.$push(ie["$[]"](9).$to_i()),ee.$push(ie["$[]"](10).$to_i())}).$$s=this,C.$$arity=1,C)),this.rating_table["$=="](1)&&(a=[31,(a=[32,(a=[33,10],V(ee,"[]=",e.to_a(a)),a[x(a.length,1)])],V(ee,"[]=",e.to_a(a)),a[x(a.length,1)])],V(ee,"[]=",e.to_a(a)),x(a.length,1)),[te,te,te,I,ye,ve,ge,Ce,ke,qe,De,be,ee]},z.$$arity=1),e.def(u,"$rollDice",M=function(w,C){var I=t;return[(I=this.randomizer.$roll_barabara(2,6)).$sum(),I.$join(",")]},M.$$arity=2),e.def(u,"$getResultText",Y=function(w,C,L,I,ye,ve,ge){var N,ke=t,qe=t,De=t,be=t,ee=t,te=t;return(ke=[]).$push("2D:["+L.$join(" ")+"]="+I.$join(",")),P(Z(ve,2))?(ke.$push(ye.$join(",")),ke.$push("\u81ea\u52d5\u7684\u5931\u6557"),[ke.$join(" \uff1e "),!1,!0]):(P(P(qe=r(ye.$size(),1))?qe:C.$modifier()["$!="](0))?(De=d(ye.$join(","),$(o,"Format").$modifier(C.$modifier())),P(C.$half())&&(De="("+De+")/2",P(C.$modifier_after_half()["$!="](0))&&(De=d(De,$(o,"Format").$modifier(C.$modifier_after_half())))),ke.$push(De)):P(C.$half())&&(De=ye.$first()+"/2",P(C.$modifier_after_half()["$!="](0))&&(De=d(De,$(o,"Format").$modifier(C.$modifier_after_half()))),ke.$push(De)),P(r(ge,1))&&(be=x(ge,1)+"\u56de\u8ee2",ke.$push(be)),ee=d(w,C.$modifier()),P(C.$half())&&(ee=(N=ee,"number"==typeof N?N/2:N["$/"](2)).$ceil(),P(C.$modifier_after_half()["$!="](0))&&(ee=d(ee,C.$modifier_after_half()))),te=ee.$to_s(),ke.$push(te),[ke.$join(" \uff1e "),r(ge,1),!1])},Y.$$arity=7)}(Opal)}}]);