(self.webpackChunkudonarium_lily=self.webpackChunkudonarium_lily||[]).push([[3342],{3342:function(_e,se,O){O(4656),function(s){function C(f,c){return"number"==typeof f&&"number"==typeof c?f>c:f["$>"](c)}function m(f,c){return"number"==typeof f&&"number"==typeof c?f+c:f["$+"](c)}function S(f,c){return"number"==typeof f&&"number"==typeof c?f<=c:f["$<="](c)}function x(f,c){return"number"==typeof f&&"number"==typeof c?f<c:f["$<"](c)}function B(f,c){return"number"==typeof f&&"number"==typeof c?f-c:f["$-"](c)}var c,ie,le,w,L,M,z,N,F,H,I,K,Y,j,q,J,Q,V,W,X,y,R,h,G,P=[],e=s.nil,D=s.$$,U=s.module,te=s.klass,a=s.truthy,A=s.send;c=P,ie=G=[U(P[0],"BCDice")].concat(c),le=h=[U(G[0],"GameSystem")].concat(ie),y=te(h[0],D(h,"Base"),"TorgEternity"),R=[y].concat(le),y.$$prototype.randomizer=e,s.const_set(R[0],"ID","TorgEternity"),s.const_set(R[0],"NAME","\u30c8\u30fc\u30b0 \u30a8\u30bf\u30cb\u30c6\u30a3"),s.const_set(R[0],"SORT_KEY","\u3068\u304a\u304f\u3048\u305f\u306b\u3066\u3044"),s.const_set(R[0],"HELP_MESSAGE",'\u30fb\u5224\u5b9a\n\u3000\u30fbTG\n\u3000\u3000"TG[m]"\u30671d20\u3092\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002[]\u5185\u306f\u7701\u7565\u53ef\u80fd\u3002\n\u3000\u3000m\u306f\u6280\u80fd\u57fa\u672c\u5024\u3092\u5165\u308c\u3066\u4e0b\u3055\u3044\u3002R\u30b3\u30de\u30f3\u30c9\u306b\u8aad\u66ff\u3055\u308c\u307e\u3059\u3002\n\u3000\u3000\u632f\u308a\u8db3\u3057\u3092\u81ea\u52d5\u3067\u884c\u3044\u300120\u306e\u51fa\u76ee\u304c\u51fa\u305f\u3068\u304d\u306b\u306f\u6280\u80fd\u7121\u3057\u5024\u3082\u4e26\u8a18\u3057\u307e\u3059\u3002\n\u3000\u3000(TORG\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3068\u540c\u3058\u6319\u52d5\u3092\u3059\u308b\u30b3\u30de\u30f3\u30c9\u3067\u3059\u3002\u30ed\u30fc\u30eb\u30dc\u30fc\u30ca\u30b9\u306e\u8aad\u307f\u66ff\u3048\u306e\u307f\u3001Eternity\u7248\u3068\u306a\u308a\u307e\u3059)\n\u3000\u30fbTE\n\u3000\u3000"TE"\u30671d20\u3092\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u3000\u3000\u632f\u308a\u8db3\u3057\u3092\u81ea\u52d5\u3067\u884c\u3044\u300120\u306e\u51fa\u76ee\u304c\u51fa\u305f\u3068\u304d\u306b\u306f\u6280\u80fd\u7121\u3057\u5024\u3082\u4e26\u8a18\u3057\u307e\u3059\u3002\n\u3000\u3000\u51fa\u76ee1\u306e\u6642\u306b\u306f\u300cMishap!\u3000\u81ea\u52d5\u5931\u6557\uff01\u300d\u3068\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\u3000\u30fbUP\n\u3000\u3000"UP"\u3067\u9ad8\u63da\u72b6\u614b\u306e\u30ed\u30fc\u30eb(\u901a\u5e38\u306e1d20\u306b\u52a0\u3048\u30011d20\u3092\u8ffd\u52a0\u3067\u632f\u308a\u8db3\u3057)\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u3000\u5404\u30ed\u30fc\u30eb\u3067\u306e\u632f\u308a\u8db3\u3057\u3092\u81ea\u52d5\u3067\u884c\u3044\u300120\u306e\u51fa\u76ee\u304c\u51fa\u305f\u3068\u304d\u306b\u306f\u6280\u80fd\u7121\u3057\u5024\u3082\u4e26\u8a18\u3057\u307e\u3059\u3002\n\u3000\u3000\u4e00\u6295\u76ee\u3067\u51fa\u76ee1\u306e\u6642\u306b\u306f\u300cMishap!\u3000\u81ea\u52d5\u5931\u6557\uff01\u300d\u3068\u51fa\u529b\u3055\u308c\u3001\u4e8c\u6295\u76ee\u306f\u884c\u308f\u308c\u307e\u305b\u3093\u3002\n\u3000\u30fbPOS\n\u3000\u3000"POSm"\u3067\u3001\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\u4f7f\u7528\u306b\u3088\u308b1d20\u306e\u30ed\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u3000m\u306f\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\u3092\u4f7f\u7528\u3059\u308b\u524d\u306e\u30ed\u30fc\u30eb\u7d50\u679c\u3092\u5165\u308c\u3066\u4e0b\u3055\u3044\u3002\n\u3000\u3000\u51fa\u76ee\u304c10\u672a\u6e80\u306e\u5834\u5408\u306f\u300110\u3078\u306e\u8aad\u307f\u66ff\u3048\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n\u3000\u3000\u307e\u305f\u3001\u632f\u308a\u8db3\u3057\u3092\u81ea\u52d5\u3067\u884c\u3044\u300120\u306e\u51fa\u76ee\u304c\u51fa\u305f\u3068\u304d\u306b\u306f\u6280\u80fd\u7121\u3057\u5024\u3082\u4e26\u8a18\u3057\u307e\u3059\u3002\n\u30fb\u30dc\u30fc\u30ca\u30b9\u30c0\u30e1\u30fc\u30b8\u30ed\u30fc\u30eb\n\u3000"xBD[+y]"\u3067\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002[]\u5185\u306f\u7701\u7565\u53ef\u80fd\u3002\n\u3000x\u306f\u30c0\u30e1\u30fc\u30b8\u30c0\u30a4\u30b9\u6570\u3002y\u306f\u30c0\u30e1\u30fc\u30b8\u57fa\u672c\u5024 or \u5f0f\u3092\u5165\u308c\u3066\u4e0b\u3055\u3044\u3002\n\u3000x\u306f1\u4ee5\u4e0a\u304c\u5fc5\u8981\u3067\u3059\u30020\u3060\u3068\u30a8\u30e9\u30fc\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\u30de\u30a4\u30ca\u30b9\u5024\u306f\u30b3\u30de\u30f3\u30c9\u3068\u3057\u3066\u8a8d\u8b58\u3055\u308c\u307e\u305b\u3093\u3002\n\u3000\u632f\u308a\u8db3\u3057\u51e6\u7406\u306f\u81ea\u52d5\u3067\u884c\u308f\u308c\u307e\u3059\u3002(\u632f\u308a\u8db3\u3057\u767a\u751f\u6642\u306e\u76ee\u306f\u3001\u300c5\u221e\u300d\u3068\u51fa\u529b\u3055\u308c\u307e\u3059)\n\u30fb\u5404\u7a2e\u8868\n\u3000"(\u8868\u30b3\u30de\u30f3\u30c9)(\u6570\u5024)"\u3067\u632f\u308a\u307e\u3059\u3002\n\u3000\u30fb\u6210\u529f\u30ec\u30d9\u30eb\u8868\u300cRTx or RESULTx\u300d\n\u3000\u30fb\u30c0\u30e1\u30fc\u30b8\u7d50\u679c\u8868\u300cDTx or DAMAGEx\u300d\n\u3000\u30fb\u30ed\u30fc\u30eb\u30dc\u30fc\u30ca\u30b9\u8868\u300cBTx+y or BONUSx+y or TOTALx+y\u300d x\u306f\u6570\u5024, y\u306f\u6280\u80fd\u57fa\u672c\u5024\n'),y.$register_prefix("TE","UP","POS","\\d+BD","TG","RT","Result","DT","damage","BT","bonus","total","1R20"),s.def(y,"$eval_game_system_specific_command",w=function(i){var n,r,u,o,_,d,g,t=this;return a(n=a(r=a(u=a(o=a(_=a(d=a(g=t.$torg_check(i))?g:t.$getRolld20DiceCommandResult(i))?d:t.$getUpRollDiceCommandResult(i))?_:t.$getPossibilityRollDiceCommandResult(i))?o:t.$getBonusDamageDiceCommandResult(i))?u:t.$getSuccessLevelDiceCommandResult(i))?r:t.$getDamageResultDiceCommandResult(i))?n:t.$getRollBonusDiceCommandResult(i)},w.$$arity=1),s.def(y,"$replace_text",L=function(i){var t;return(i=A(i,"gsub",[/TG(\d+)/i],((t=function(){return"1R20+"+D(R,"Regexp").$last_match(1)}).$$s=this,t.$$arity=0,t))).$gsub(/TG/i,"1R20")},L.$$arity=1),s.def(y,"$torg_check",M=function(i){var t,n,r=this,u=e,o=e,_=e,d=e,g=e,$=e,l=e;return i=r.$replace_text(i),u=/(^|\s)S?(1R20(([+-]\d+)*))(\s|$)/i.$match(i),a(u)?(i=u["$[]"](2),o=u["$[]"](3),r.$debug(o),a(o)&&(o=D(R,"ArithmeticEvaluator").$eval(o)),r.$debug(o),o=o.$to_i(),n=r.$torg_eternity_dice(!1,!1),d=null==(t=s.to_ary(n))[1]?e:t[1],g=null==t[2]?e:t[2],$=r.$get_torg_eternity_bonus(_=null==t[0]?e:t[0]),l=m(l=a(o)?a(C(o,0))?$+"["+g+"]+"+o:$+"["+g+"]"+o:$+"["+g+"]",m(" \uff1e ",m($,o).$to_s())),a(_["$!="](d))&&(l=m(l,m(m("(\u6280\u80fd\u7121",m(r.$get_torg_eternity_bonus(d),o).$to_s()),")"))),l="("+i+") \uff1e "+l):e},M.$$arity=1),s.def(y,"$getRolld20DiceCommandResult",z=function(i){var t,n,u,r=this,o=e,_=e,d=e,$=e,l=e;return r.$debug("Torg Eternity Dice Roll Command ? ",i),u=/(^|\s)(S)?(TE)$/i.$match(i),a(u)?(n=r.$torg_eternity_dice(!1,!0),o=null==(t=s.to_ary(n))[0]?e:t[0],_=null==t[1]?e:t[1],d=null==t[2]?e:t[2],(null==t[3]?e:t[3])["$=="](1)?$="d20\u30ed\u30fc\u30eb\uff08\u901a\u5e38\uff09 \uff1e 1d20["+d+"] \uff1e Mishap!\u3000\u7d76\u5bfe\u5931\u6557\uff01":(l=r.$format("%+d",r.$get_torg_eternity_bonus(o)),$=a(o["$!="](_))?"d20\u30ed\u30fc\u30eb\uff08\u901a\u5e38\uff09 \uff1e 1d20["+d+"] \uff1e "+l+"["+o+"]\uff08\u6280\u80fd\u6709\uff09 / "+r.$format("%+d",r.$get_torg_eternity_bonus(_))+"["+_+"]\uff08\u6280\u80fd\u7121\uff09":"d20\u30ed\u30fc\u30eb\uff08\u901a\u5e38\uff09 \uff1e 1d20["+d+"] \uff1e "+l+"["+o+"]"),$):e},z.$$arity=1),s.def(y,"$getUpRollDiceCommandResult",N=function(i){var t,n,u,r=this,o=e,_=e,d=e,$=e,v=e,E=e,T=e,k=e,p=e;return r.$debug("Torg Eternity Dice Roll ( UP ) Command ? ",i),u=/(^|\s)(S)?(UP)$/i.$match(i),a(u)?(n=r.$torg_eternity_dice(!1,!0),o=null==(t=s.to_ary(n))[0]?e:t[0],_=null==t[1]?e:t[1],d=null==t[2]?e:t[2],(null==t[3]?e:t[3])["$=="](1)?$="d20\u30ed\u30fc\u30eb\uff08\u9ad8\u63da\uff09 \uff1e 1d20["+d+"] \uff1e Mishap!\u3000\u7d76\u5bfe\u5931\u6557\uff01":(n=r.$torg_eternity_dice(!1,!1),v=null==(t=s.to_ary(n))[1]?e:t[1],E=null==t[2]?e:t[2],T=m(o,null==t[0]?e:t[0]),k=m(_,v),p=r.$format("%+d",r.$get_torg_eternity_bonus(T)),$=a(T["$!="](k))?"d20\u30ed\u30fc\u30eb\uff08\u9ad8\u63da\uff09 \uff1e 1d20["+d+"] + 1d20["+E+"] \uff1e "+p+"["+T+"]\uff08\u6280\u80fd\u6709\uff09 / "+r.$format("%+d",r.$get_torg_eternity_bonus(k))+"["+k+"]\uff08\u6280\u80fd\u7121\uff09":"d20\u30ed\u30fc\u30eb\uff08\u9ad8\u63da\uff09 \uff1e 1d20["+d+"] + 1d20["+E+"] \uff1e "+p+"["+T+"]"),$):e},N.$$arity=1),s.def(y,"$getPossibilityRollDiceCommandResult",F=function(i){var t,n,r=this,u=e,o=e,d=e,g=e,$=e,l=e,v=e;return r.$debug("Torg Eternity Possibility Roll Command ? ",i),u=/(^|\s)(S)?(POS)((\d+)(\+\d+)?)/i.$match(i),a(u)?(o=D(R,"ArithmeticEvaluator").$eval(u["$[]"](4)),n=r.$torg_eternity_dice(!0,!1),d=null==(t=s.to_ary(n))[1]?e:t[1],g=null==t[2]?e:t[2],$=m(null==t[0]?e:t[0],o),l=m(d,o),v=r.$format("%+d",r.$get_torg_eternity_bonus($)),a($["$!="](l))?"d20\u30ed\u30fc\u30eb\uff08\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\uff09 \uff1e "+o+"+1d20["+g+"] \uff1e "+v+"["+$+"]\uff08\u6280\u80fd\u6709\uff09 / "+r.$format("%+d",r.$get_torg_eternity_bonus(l))+"["+l+"]\uff08\u6280\u80fd\u7121\uff09":"d20\u30ed\u30fc\u30eb\uff08\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\uff09 \uff1e "+o+"+1d20["+g+"] \uff1e "+v+"["+$+"]"):e},F.$$arity=1),s.def(y,"$getBonusDamageDiceCommandResult",H=function(i){var t,n,r=this,u=e,o=e,_=e,d=e,g=e,$=e;return r.$debug("TorgEternity Bonus Damage Roll Command ? ",i),u=/(\d+)(BD)(([+\-]\d+)*)/i.$match(i),a(u)?(o=u["$[]"](1).$to_i(),n=r.$get_torg_eternity_modifier(u["$[]"](3)),_=null==(t=s.to_ary(n))[0]?e:t[0],d=null==t[1]?e:t[1],a(S(o,0))?g="\u30a8\u30e9\u30fc\u3067\u3059\u3002xBD (x\u22671) \u3068\u3057\u3066\u4e0b\u3055\u3044":(n=r.$get_torg_eternity_damage_bonus_dice(o),g="\u30dc\u30fc\u30ca\u30b9\u30c0\u30e1\u30fc\u30b8\u30ed\u30fc\u30eb("+o+"BD"+d+") \uff1e "+($=null==(t=s.to_ary(n))[0]?e:t[0])+"["+(null==t[1]?e:t[1])+"]"+d+" \uff1e "+m($,_)+"\u30c0\u30e1\u30fc\u30b8"),g):e},H.$$arity=1),s.def(y,"$getSuccessLevelDiceCommandResult",I=function(i){var t=this,n=e,r=e,u=e;return t.$debug("TorgEternity Success Level Table Command ? ",i),n=/(RT|Result)(-*\d+([+\-]\d+)*)/i.$match(i),a(n)?(r=D(R,"ArithmeticEvaluator").$eval(n["$[]"](2)),t.$debug(r),u=a(x(r,0))?"Failure.":t.$get_torg_eternity_success_level(r),t.$debug(u="\u6210\u529f\u30ec\u30d9\u30eb\u8868["+r+"] \uff1e "+u),u):e},I.$$arity=1),s.def(y,"$getDamageResultDiceCommandResult",K=function(i){var t=this,n=e,r=e,u=e;return t.$debug("TorgEternity Damage Result Table Command ? ",i),n=/(DT|Damage)(-*\d+([+\-]\d+)*)/i.$match(i),a(n)?(r=D(R,"ArithmeticEvaluator").$eval(n["$[]"](2)),t.$debug(r),u=t.$get_torg_eternity_damage_result(r),t.$debug(u="\u30c0\u30e1\u30fc\u30b8\u7d50\u679c\u8868["+r+"] \uff1e "+u),u):e},K.$$arity=1),s.def(y,"$getRollBonusDiceCommandResult",Y=function(i){var t,n,r=this,u=e,o=e,_=e,d=e,g=e,$=e,l=e;return r.$debug("TorgEternity Roll Bonus Table Command ? ",i),u=/(BT|Bonus|Total)(\d+)(([+\-]\d+)*)/i.$match(i),a(u)?(o=u["$[]"](2).$to_i(),_=r.$get_torg_eternity_bonus(o),r.$debug(_),n=r.$get_torg_eternity_modifier(u["$[]"](3)),d=null==(t=s.to_ary(n))[0]?e:t[0],g=null==t[1]?e:t[1],a(S(o,1))?$="\u30ed\u30fc\u30eb\u30dc\u30fc\u30ca\u30b9\u8868["+o+"] \uff1e Mishap!!":a(g["$empty?"]())?$="\u30ed\u30fc\u30eb\u30dc\u30fc\u30ca\u30b9\u8868["+o+"] \uff1e "+_:(l=m(_.$to_i(),d),r.$debug(l),$="\u30ed\u30fc\u30eb\u30dc\u30fc\u30ca\u30b9\u8868["+o+"]"+g+" \uff1e "+_+"["+o+"]"+g+" \uff1e "+l),r.$debug($),$):e},Y.$$arity=1),s.def(y,"$get_torg_eternity_table_result",j=function(i,t){var n,r=this,u=e;return u=e,function(){var o=s.new_brk();try{A(t,"each",[],((n=function(d){var $;return null==d&&(d=e),$=d["$[]"](0),a(C($,i))&&s.brk(e,o),u=d["$[]"](1)}).$$s=r,n.$$brk=o,n.$$arity=1,n))}catch(_){if(_===o)return _.$v;throw _}}(),u},j.$$arity=2),s.def(y,"$get_torg_eternity_modifier",q=function(i){var t=this,n=e,r=e;return t.$debug("modifier check : "+i),i["$=="]("")?(n=0,r=""):(n=D(R,"ArithmeticEvaluator").$eval(i),r=t.$format("%+d",n)),t.$debug(n),t.$debug(r),[n,r]},q.$$arity=1),s.def(y,"$torg_eternity_dice",J=function(i,t){var u=e,o=e,_=e,d=e,g=e,$=e,l=e,v=e;for(u=!0,o=!0,_=0,d=0,g=0,$="";a(u);)a($["$empty?"]())||($=m($,",")),l=this.randomizer.$roll_once(20),a(i)?(a(x(l,10))?(v=l+"\u219210",l=10,u=!1):v=l.$to_s(),$=m($,v)):$=m($,l.$to_s()),_=m(_,l),a(o)&&(d=m(d,l)),l["$=="](20)?o=!1:a(l["$!="](10))&&(u=!1,o=!1,a(t["$&"](l["$=="](1)))&&(g=1)),i=!1,t=!1;return[_,d,$,g]},J.$$arity=2),s.def(y,"$get_torg_eternity_damage_bonus_dice",Q=function(i){var n=this,r=e,u=e,o=e,_=e;if(n.$debug("bonus dice roll : "+i),r=0,u="",a(C(i,0)))for(r=0,u="";a(C(i,0));)a(u["$empty?"]())||(u+=","),_=(o=n.randomizer.$roll_once(6)).$to_s(),o["$=="](6)&&(o=5,_="5\u221e",i=m(i,1)),r=m(r,o),u=""+u+_,n.$debug(r),n.$debug(u),i=B(i,1);else u="0";return n.$debug(r),n.$debug(u),[r,u]},Q.$$arity=1),s.def(y,"$get_torg_eternity_success_level",V=function(i){return this.$get_torg_eternity_table_result(i,[[0,"Success - Standard."],[5,"Success - Good!"],[10,"Success - Outstanding!!"]])},V.$$arity=1),s.def(y,"$get_torg_eternity_damage_result",W=function(i){return this.$get_torg_eternity_table_result(i,[[-50,"\u30ce\u30fc\u30c0\u30e1\u30fc\u30b8"],[-5,"1\u30b7\u30e7\u30c3\u30af"],[0,"2\u30b7\u30e7\u30c3\u30af"],[5,"1\u30ec\u30d9\u30eb\u8ca0\u50b7 + 2\u30b7\u30e7\u30c3\u30af"],[10,"2\u30ec\u30d9\u30eb\u8ca0\u50b7 + 4\u30b7\u30e7\u30c3\u30af"],[15,"3\u30ec\u30d9\u30eb\u8ca0\u50b7 + 6\u30b7\u30e7\u30c3\u30af"],[20,"4\u30ec\u30d9\u30eb\u8ca0\u50b7 + 8\u30b7\u30e7\u30c3\u30af"],[25,"5\u30ec\u30d9\u30eb\u8ca0\u50b7 + 10\u30b7\u30e7\u30c3\u30af"],[30,"6\u30ec\u30d9\u30eb\u8ca0\u50b7 + 12\u30b7\u30e7\u30c3\u30af"],[35,"7\u30ec\u30d9\u30eb\u8ca0\u50b7 + 14\u30b7\u30e7\u30c3\u30af"],[40,"8\u30ec\u30d9\u30eb\u8ca0\u50b7 + 16\u30b7\u30e7\u30c3\u30af"],[45,"9\u30ec\u30d9\u30eb\u8ca0\u50b7 + 18\u30b7\u30e7\u30c3\u30af"],[50,"10\u30ec\u30d9\u30eb\u8ca0\u50b7 + 20\u30b7\u30e7\u30c3\u30af"]])},W.$$arity=1),s.def(y,"$get_torg_eternity_bonus",X=function(i){var f,r=e,u=e;return r=this.$get_torg_eternity_table_result(i,[[1,-10],[2,-8],[3,-6],[5,-4],[7,-2],[9,-1],[11,0],[13,1],[15,2],[16,3],[17,4],[18,5],[19,6],[20,7]]),a(C(i,20))&&(u=m((f=B(i,21),"number"==typeof f?f/5:f["$/"](5)).$to_i(),1),r=m(r,u)),r},X.$$arity=1)}(Opal)}}]);