(self.webpackChunkudonarium_lily=self.webpackChunkudonarium_lily||[]).push([[3719],{3719:function(Le,qe,Ge){Ge(4656),Opal.modules["bcdice/dice_table/table"]=function(e){var E,i,g,C,o,B,_,P,w,q,O,s=[],a=e.nil,z=e.$$,U=e.module,j=e.klass,W=e.hash2,M=e.truthy;return E=s,i=O=[U(s[0],"BCDice")].concat(E),g=q=[U(O[0],"DiceTable")].concat(i),P=j(q[0],null,"Table"),w=[P].concat(g),P.$$prototype.times=P.$$prototype.sides=P.$$prototype.name=P.$$prototype.items=a,e.defs(P,"$from_i18n",C=function(h,m){var y=a;return y=z(w,"I18n").$t(h,W(["locale"],{locale:m})),this.$new(y["$[]"]("name"),y["$[]"]("type"),y["$[]"]("items"))},C.$$arity=2),e.def(P,"$initialize",o=function(h,m,k){var y=this,S=a;return y.name=h,y.items=k.$freeze(),S=/(\d+)D(\d+)/i.$match(m),M(S)||y.$raise(z(w,"ArgumentError"),"Unexpected table type: "+m),y.times=S["$[]"](1).$to_i(),y.sides=S["$[]"](2).$to_i()},o.$$arity=3),e.def(P,"$roll",B=function(h){var k,m=this;return k=h.$roll_sum(m.times,m.sides),m.$choice(k)},B.$$arity=1),void e.def(P,"$choice",_=function(h){var k,m=this;return k=function(r,E){return"number"==typeof r&&"number"==typeof E?r-E:r["$-"](E)}(h,m.times),z(w,"RollResult").$new(m.name,h,m.items["$[]"](k))},_.$$arity=1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){function s(E,u){return"number"==typeof E&&"number"==typeof u?E-u:E["$-"](u)}var u,A,P,o,B,_,w,C,x,re,G=[],z=e.nil,j=e.$$,W=e.module,M=e.klass,r=e.hash2;return u=G,A=re=[W(G[0],"BCDice")].concat(u),P=x=[W(re[0],"DiceTable")].concat(A),w=M(x[0],null,"D66GridTable"),C=[w].concat(P),w.$$prototype.name=w.$$prototype.items=z,e.defs(w,"$from_i18n",o=function(h,m){var y=z;return y=j(C,"I18n").$t(h,r(["locale","raise"],{locale:m,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items"))},o.$$arity=2),e.def(w,"$initialize",B=function(h,m){return this.name=h,this.items=m.$freeze()},B.$$arity=2),void e.def(w,"$roll",_=function(h){var k,y,S,N,H,E;return k=h.$roll_once(6),y=h.$roll_once(6),S=function(E,u){return"number"==typeof E&&"number"==typeof u?E+u:E["$+"](u)}("number"==typeof(E=k)?10*E:E["$*"](10),y),N=s(k,1),H=s(y,1),j(C,"RollResult").$new(this.name,S,this.items["$[]"](N)["$[]"](H))},_.$$arity=1)},Opal.modules["bcdice/arithmetic/node"]=function(e){function Y(M,r){return"number"==typeof M&&"number"==typeof r?M/r:M["$/"](r)}var r,re,x,P,w,C,_,v,h,m,k,y,o,B,g,A,u,s=[],a=e.nil,G=e.$$$,z=e.$$,U=e.module,j=e.klass,W=e.send2;return r=s,re=u=[U(s[0],"BCDice")].concat(r),x=A=[U(u[0],"Arithmetic")].concat(re),function(P,w,C){var _,v,h,m,k,o=j(P,null,"BinaryOp");[o].concat(C),o.$$prototype.lhs=o.$$prototype.rhs=o.$$prototype.op=a,e.def(o,"$initialize",_=function(S,N,H){var L=this;return L.lhs=S,L.op=N,L.rhs=H},_.$$arity=3),e.def(o,"$eval",v=function(S){var L,N=this,H=a;return H=N.lhs.$eval(S),L=N.rhs.$eval(S),H.$send(N.op,L)},v.$$arity=1),e.def(o,"$output",h=function(){var S=this;return""+S.lhs.$output()+S.op+S.rhs.$output()},h.$$arity=0),e.def(o,"$s_exp",m=function(){var S=this;return"("+S.$op_for_s_exp()+" "+S.lhs.$s_exp()+" "+S.rhs.$s_exp()+")"},m.$$arity=0),e.def(o,"$op_for_s_exp",k=function(){return this.op},k.$$arity=0)}((g=[U(A[0],"Node")].concat(x))[0],0,g),P=g[0],w=z(g,"BinaryOp"),C=g,o=j(P,w,"DivideBase"),B=[o].concat(C),o.$$prototype.lhs=o.$$prototype.rhs=o.$$prototype.op=a,e.def(o,"$initialize",_=function(N,H){return _.$$p&&(_.$$p=null),W(this,e.find_super_dispatcher(this,"initialize",_,!1,!0),"initialize",[N,"/",H],null)},_.$$arity=2),e.def(o,"$eval",v=function(N){var L,H=this,J=a;return L=H.lhs.$eval(N),(J=H.rhs.$eval(N))["$=="](0)&&H.$raise(z(B,"ZeroDivisionError")),H.$divide_and_round(L,J,N)},v.$$arity=1),e.def(o,"$output",h=function(){var N=h.$$p,L=this,J=a,$e=a,se=a;for(N&&(h.$$p=null),$e=0,se=arguments.length,J=new Array(se);$e<se;$e++)J[$e]=arguments[$e];return""+W(L,e.find_super_dispatcher(L,"output",h,!1,!0),"output",J,N)+L.$rounding_method()},h.$$arity=0),o.$private(),e.def(o,"$rounding_method",m=function(){return G(this.$class(),"ROUNDING_METHOD")},m.$$arity=0),e.def(o,"$op_for_s_exp",k=function(){return""+this.op+this.$rounding_method()},k.$$arity=0),e.def(o,"$divide_and_round",y=function(N,H,L){return this.$raise(z(B,"NotImplementedError"))},y.$$arity=3),function(P,w,C){var _,o=j(P,w,"DivideWithGameSystemDefault"),B=[o].concat(C);e.const_set(B[0],"ROUNDING_METHOD",""),o.$private(),e.def(o,"$divide_and_round",_=function(h,m,k){var S;return S=k,G(z(B,"RoundType"),"CEIL")["$==="](S)?Y(h.$to_f(),m).$ceil():G(z(B,"RoundType"),"ROUND")["$==="](S)?Y(h.$to_f(),m).$round():Y(h,m).$to_i()},_.$$arity=3)}(g[0],z(g,"DivideBase"),g),function(P,w,C){var _,o=j(P,w,"DivideWithCeil"),B=[o].concat(C);e.const_set(B[0],"ROUNDING_METHOD","C"),o.$private(),e.def(o,"$divide_and_round",_=function(h,m,k){return Y(h.$to_f(),m).$ceil()},_.$$arity=3)}(g[0],z(g,"DivideBase"),g),function(P,w,C){var _,o=j(P,w,"DivideWithRound"),B=[o].concat(C);e.const_set(B[0],"ROUNDING_METHOD","R"),o.$private(),e.def(o,"$divide_and_round",_=function(h,m,k){return Y(h.$to_f(),m).$round()},_.$$arity=3)}(g[0],z(g,"DivideBase"),g),function(P,w,C){var _,o=j(P,w,"DivideWithFloor"),B=[o].concat(C);e.const_set(B[0],"ROUNDING_METHOD","F"),o.$private(),e.def(o,"$divide_and_round",_=function(h,m,k){return Y(h,m).$to_i()},_.$$arity=3)}(g[0],z(g,"DivideBase"),g),function(P,w,C){var _,v,h,m,o=j(P,null,"Negative");[o].concat(C),o.$$prototype.body=a,e.def(o,"$initialize",_=function(y){return this.body=y},_.$$arity=1),e.def(o,"$eval",v=function(y){return this.body.$eval(y)["$-@"]()},v.$$arity=1),e.def(o,"$output",h=function(){return"-"+this.body.$output()},h.$$arity=0),e.def(o,"$s_exp",m=function(){return"(- "+this.body.$s_exp()+")"},m.$$arity=0)}(g[0],0,g),function(P,w,C){var _,v,h,m,o=j(P,null,"Parenthesis");[o].concat(C),o.$$prototype.expr=a,e.def(o,"$initialize",_=function(y){return this.expr=y},_.$$arity=1),e.def(o,"$eval",v=function(y){return this.expr.$eval(y)},v.$$arity=1),e.def(o,"$output",h=function(){return"("+this.expr.$output()+")"},h.$$arity=0),e.def(o,"$s_exp",m=function(){return"(Parenthesis "+this.expr.$s_exp()+")"},m.$$arity=0)}(g[0],0,g),void function(P,w,C){var _,v,h,o=j(P,null,"Number");[o].concat(C),o.$$prototype.value=a,e.def(o,"$initialize",_=function(k){return this.value=k},_.$$arity=1),e.def(o,"$eval",v=function(k){return this.value},v.$$arity=1),e.def(o,"$output",h=function(){return this.value.$to_s()},h.$$arity=0),e.alias(o,"s_exp","output")}(g[0],0,g)},Opal.modules["racc/parser"]=function(e){function Y(x,d){return"number"==typeof x&&"number"==typeof d?x<d:x["$<"](d)}function Q(x,d){return"number"==typeof x&&"number"==typeof d?x-d:x["$-"](d)}function s(x,d){return"number"==typeof x&&"number"==typeof d?x+d:x["$+"](d)}function a(x,d){return"number"==typeof x&&"number"==typeof d?x>=d:x["$>="](d)}function G(x,d){return"number"==typeof x&&"number"==typeof d?x>d:x["$>"](d)}function z(x,d){return"number"==typeof x&&"number"==typeof d?x<=d:x["$<="](d)}var w,C,o,d,P,M=[],r=e.nil,E=e.$$$,u=e.$$,O=e.module,re=e.klass,i=e.truthy,A=e.gvars,q=e.send;return d=M,w=(P=[O(M[0],"Racc")].concat(d))[0],C=u(P,"StandardError"),o=P,[re(w,C,"ParseError")].concat(o),i(E("::","ParseError","skip_raise")?"constant":r)||e.const_set(M[0],"ParseError",E(u(M,"Racc"),"ParseError")),function(x,d){var B,h,m,k,y,S,N,H,L,J,$e,se,I,n,c,R,V,ce,ye,me,pe,be,ke,Se,Re,_,v,P=[O(x,"Racc")].concat(d);i(u(P,"Racc_No_Extensions","skip_raise")?"constant":r)||e.const_set(P[0],"Racc_No_Extensions",!1),B=P,_=re(P[0],null,"Parser"),v=[_].concat(B),_.$$prototype.yydebug=_.$$prototype.racc_debug_out=_.$$prototype.racc_error_status=_.$$prototype.racc_t=_.$$prototype.racc_vstack=_.$$prototype.racc_val=_.$$prototype.racc_state=_.$$prototype.racc_tstack=r,e.const_set(v[0],"Racc_Runtime_Version","1.4.6"),e.const_set(v[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),e.const_set(v[0],"Racc_Runtime_Core_Version_R","1.4.6"),e.const_set(v[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),e.const_set(v[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),e.const_set(v[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),e.const_set(v[0],"Racc_Runtime_Core_Version",u(v,"Racc_Runtime_Core_Version_R")),e.const_set(v[0],"Racc_Runtime_Core_Revision",u(v,"Racc_Runtime_Core_Revision_R")),e.const_set(v[0],"Racc_Runtime_Type","ruby"),e.defs(u(v,"Parser"),"$racc_runtime_type",h=function(){return u(v,"Racc_Runtime_Type")},h.$$arity=0),e.def(_,"$_racc_setup",m=function(){var $,p,t=this,b=r,l=r,f=r;return null==A.stderr&&(A.stderr=r),i(E(t.$class(),"Racc_debug_parser"))||(t.yydebug=!1),i(null!=($=t.yydebug)&&$!==r?"instance-variable":r)||(t.yydebug=!1),i(t.yydebug)&&(i(null!=(p=t.racc_debug_out)&&p!==r?"instance-variable":r)||(t.racc_debug_out=A.stderr),t.racc_debug_out=i(b=t.racc_debug_out)?b:A.stderr),l=E(t.$class(),"Racc_arg"),i(Y(l.$size(),14))&&(q(l,"[]=",e.to_a(f=[13,!0])),Q(f.length,1)),l},m.$$arity=0),e.def(_,"$_racc_init_sysvars",k=function(){var $=this;return $.racc_state=[0],$.racc_tstack=[],$.racc_vstack=[],$.racc_t=r,$.racc_val=r,$.racc_read_next=!0,$.racc_user_yyerror=!1,$.racc_error_status=0},k.$$arity=0),e.def(_,"$do_parse",y=function(){return this.$__send__(u(v,"Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},y.$$arity=0),e.def(_,"$next_token",S=function(){return this.$raise(u(v,"NotImplementedError"),this.$class()+"#next_token is not defined")},S.$$arity=0),e.def(_,"$_racc_do_parse_rb",N=function($,p){var t,l,f=this,Z=r,fe=r,ee=r,le=r,_e=r,ie=r,ue=r,F=r;return t=e.to_ary($),Z=null==t[0]?r:t[0],fe=null==t[1]?r:t[1],ee=null==t[2]?r:t[2],le=null==t[3]?r:t[3],_e=null==t[10]?r:t[10],f.$_racc_init_sysvars(),ie=ue=F=r,q(f,"catch",["racc_end_parse"],((l=function(){var de,he,D=null==l.$$s?this:l.$$s,ae=r,ge=r,ve=r;for(null==D.racc_state&&(D.racc_state=r),null==D.racc_read_next&&(D.racc_read_next=r),null==D.racc_t&&(D.racc_t=r),null==D.yydebug&&(D.yydebug=r),null==D.racc_val&&(D.racc_val=r);i(!0);)for(i(F=le["$[]"](D.racc_state["$[]"](-1)))?(i(D.racc_read_next)&&i(D.racc_t["$!="](0))&&(he=D.$next_token(),de=e.to_ary(he),ie=null==de[0]?r:de[0],D.racc_val=null==de[1]?r:de[1],D.racc_t=i(ie)?i(ae=_e["$[]"](ie))?ae:1:0,i(D.yydebug)&&D.$racc_read_token(D.racc_t,ie,D.racc_val),D.racc_read_next=!1),F=s(F,D.racc_t),i(i(ge=i(ve=a(F,0))?ue=Z["$[]"](F):ve)?fe["$[]"](F)["$=="](D.racc_state["$[]"](-1)):ge)||(ue=ee["$[]"](D.racc_state["$[]"](-1)))):ue=ee["$[]"](D.racc_state["$[]"](-1));i(ue=D.$_racc_evalact(ue,$)););}).$$s=f,l.$$arity=0,l))},N.$$arity=2),e.def(_,"$yyparse",H=function($,p){return this.$__send__(u(v,"Racc_YY_Parse_Method"),$,p,this.$_racc_setup(),!0)},H.$$arity=2),e.def(_,"$_racc_yyparse_rb",L=function($,p,t,b){var l,Z,ee=r,le=r,te=r,_e=r,ue=r,F=r,K=r;return l=e.to_ary(t),ee=null==l[0]?r:l[0],le=null==l[1]?r:l[1],te=null==l[2]?r:l[2],_e=null==l[3]?r:l[3],ue=null==l[10]?r:l[10],this.$_racc_init_sysvars(),F=r,K=r,q(this,"catch",["racc_end_parse"],((Z=function(){var ae,ne=null==Z.$$s?this:Z.$$s;for(null==ne.racc_state&&(ne.racc_state=r);!i(K=_e["$[]"](ne.racc_state["$[]"](-1)));)for(;i(F=ne.$_racc_evalact(te["$[]"](ne.racc_state["$[]"](-1)),t)););return q($,"__send__",[p],((ae=function(ve,oe){var De,ze,X=null==ae.$$s?this:ae.$$s,xe=r,Ne=r,Ee=r,Ae=r,Be=r,Te=r,Ce=r;for(null==X.racc_t&&(X.racc_t=r),null==X.racc_state&&(X.racc_state=r),null==X.racc_read_next&&(X.racc_read_next=r),null==ve&&(ve=r),null==oe&&(oe=r),X.racc_t=i(ve)?i(xe=ue["$[]"](ve))?xe:1:0,X.racc_val=oe,X.racc_read_next=!1,K=s(K,X.racc_t),i(i(De=i(ze=a(K,0))?F=ee["$[]"](K):ze)?le["$[]"](K)["$=="](X.racc_state["$[]"](-1)):De)||(F=te["$[]"](X.racc_state["$[]"](-1)));i(F=X.$_racc_evalact(F,t)););for(;i(i(Ne=i(Ee=(K=_e["$[]"](X.racc_state["$[]"](-1)))["$!"]())?Ee:X.racc_read_next["$!"]())?Ne:X.racc_t["$=="](0));)for(i(i(Ae=i(Be=i(Te=i(Ce=K)?K=s(K,X.racc_t):Ce)?a(K,0):Te)?F=ee["$[]"](K):Be)?le["$[]"](K)["$=="](X.racc_state["$[]"](-1)):Ae)||(F=te["$[]"](X.racc_state["$[]"](-1)));i(F=X.$_racc_evalact(F,t)););}).$$s=ne,ae.$$arity=2,ae))}).$$s=this,Z.$$arity=0,Z))},L.$$arity=4),e.def(_,"$_racc_evalact",J=function($,p){var t,l,te,ie,f=this,Z=r,fe=r,le=r,_e=r,ue=r,F=r,K=r,D=r,ne=r,de=r;if(Z=null==(t=e.to_ary(p))[0]?r:t[0],fe=null==t[1]?r:t[1],le=null==t[3]?r:t[3],te=null==t[11]?r:t[11],_e=null==t[12]?r:t[12],i(i(ie=G($,0))?Y($,te):ie))i(G(f.racc_error_status,0))&&(f.racc_t["$=="](1)||(f.racc_error_status=Q(f.racc_error_status,1))),f.racc_vstack.$push(f.racc_val),f.racc_state.$push($),f.racc_read_next=!0,i(f.yydebug)&&(f.racc_tstack.$push(f.racc_t),f.$racc_shift(f.racc_t,f.racc_tstack,f.racc_vstack));else if(i(i(ue=Y($,0))?G($,_e["$-@"]()):ue)){if(F=q(f,"catch",["racc_jump"],((l=function(){var ae=null==l.$$s?this:l.$$s;return null==ae.racc_state&&(ae.racc_state=r),ae.racc_state.$push(ae.$_racc_do_reduce(p,$)),!1}).$$s=f,l.$$arity=0,l)),i(F)){if(1["$==="](K=F))return f.racc_user_yyerror=!0,_e["$-@"]();if(2["$==="](K))return te;f.$raise("[Racc Bug] unknown jump code")}}else if($["$=="](te))i(f.yydebug)&&f.$racc_accept(),f.$throw("racc_end_parse",f.racc_vstack["$[]"](0));else{if($["$=="](_e["$-@"]())){for((0)["$==="](K=f.racc_error_status)?i(p["$[]"](21))||f.$on_error(f.racc_t,f.racc_val,f.racc_vstack):3["$==="](K)&&(f.racc_t["$=="](0)&&f.$throw("racc_end_parse",r),f.racc_read_next=!0),f.racc_user_yyerror=!1,f.racc_error_status=3;i(!0)&&(!i(D=le["$[]"](f.racc_state["$[]"](-1)))||(D=s(D,1),!i(i(ne=i(de=a(D,0))?$=Z["$[]"](D):de)?fe["$[]"](D)["$=="](f.racc_state["$[]"](-1)):ne)));)i(z(f.racc_state.$size(),1))&&f.$throw("racc_end_parse",r),f.racc_state.$pop(),f.racc_vstack.$pop(),i(f.yydebug)&&(f.racc_tstack.$pop(),f.$racc_e_pop(f.racc_state,f.racc_tstack,f.racc_vstack));return $}f.$raise("[Racc Bug] unknown action "+$.$inspect())}return i(f.yydebug)&&f.$racc_next_state(f.racc_state["$[]"](-1),f.racc_state),r},J.$$arity=2),e.def(_,"$_racc_do_reduce",$e=function($,p){var t,te,ie,de,he,ae,X,l=this,Z=r,fe=r,ee=r,le=r,_e=r,ue=r,F=r,K=r,D=r,ne=r,ge=r,ve=r,oe=r,Pe=r,we=r,xe=r;return Z=null==(t=e.to_ary($))[4]?r:t[4],fe=null==t[5]?r:t[5],ee=null==t[6]?r:t[6],le=null==t[7]?r:t[7],te=null==t[8]?r:t[8],_e=null==t[9]?r:t[9],ie=null==t[13]?r:t[13],ue=l.racc_state,F=l.racc_vstack,K=l.racc_tstack,D=function(x,d){return"number"==typeof x?-3*x:x["$*"](-3)}(p),ne=_e["$[]"](D),de=_e["$[]"](s(D,1)),he=_e["$[]"](s(D,2)),ae=[],i(l.yydebug)&&(ge=K["$[]"](ne["$-@"](),ne)),ve=F["$[]"](ne["$-@"](),ne),i(l.yydebug)&&(oe=[ne["$-@"](),ne,ae],q(K,"[]=",e.to_a(oe)),Q(oe.length,1)),oe=[ne["$-@"](),ne,ae],q(F,"[]=",e.to_a(oe)),Q(oe.length,1),oe=[ne["$-@"](),ne,ae],q(ue,"[]=",e.to_a(oe)),Q(oe.length,1),i(ie)?F.$push(l.$__send__(he,ve,F,ve["$[]"](0))):F.$push(l.$__send__(he,ve,F)),K.$push(de),i(l.yydebug)&&l.$racc_reduce(ge,de,K,F),X=Q(de,te),i(D=le["$[]"](X))&&(D=s(D,ue["$[]"](-1)),i(i(Pe=i(we=a(D,0))?xe=Z["$[]"](D):we)?fe["$[]"](D)["$=="](X):Pe))?xe:ee["$[]"](X)},$e.$$arity=2),e.def(_,"$on_error",se=function($,p,t){var l,b=this;return b.$raise(u(v,"ParseError"),b.$sprintf("\nparse error on value %s (%s)",p.$inspect(),i(l=b.$token_to_str($))?l:"?"))},se.$$arity=3),e.def(_,"$yyerror",I=function(){return this.$throw("racc_jump",1)},I.$$arity=0),e.def(_,"$yyaccept",n=function(){return this.$throw("racc_jump",2)},n.$$arity=0),e.def(_,"$yyerrok",c=function(){return this.racc_error_status=0},c.$$arity=0),e.def(_,"$racc_read_token",R=function($,p,t){var b=this;return b.racc_debug_out.$print("read    "),b.racc_debug_out.$print(p.$inspect(),"(",b.$racc_token2str($),") "),b.racc_debug_out.$puts(t.$inspect()),b.racc_debug_out.$puts()},R.$$arity=3),e.def(_,"$racc_shift",V=function($,p,t){var b=this;return b.racc_debug_out.$puts("shift   "+b.$racc_token2str($)),b.$racc_print_stacks(p,t),b.racc_debug_out.$puts()},V.$$arity=3),e.def(_,"$racc_reduce",ce=function($,p,t,b){var l,f=this,Z=r;return(Z=f.racc_debug_out).$print("reduce "),i($["$empty?"]())?Z.$print(" <none>"):q($,"each",[],((l=function(ee){return null==ee&&(ee=r),Z.$print(" ",(null==l.$$s?this:l.$$s).$racc_token2str(ee))}).$$s=f,l.$$arity=1,l)),Z.$puts(" --\x3e "+f.$racc_token2str(p)),f.$racc_print_stacks(t,b),f.racc_debug_out.$puts()},ce.$$arity=4),e.def(_,"$racc_accept",ye=function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},ye.$$arity=0),e.def(_,"$racc_e_pop",me=function($,p,t){var b=this;return b.racc_debug_out.$puts("error recovering mode: pop token"),b.$racc_print_states($),b.$racc_print_stacks(p,t),b.racc_debug_out.$puts()},me.$$arity=3),e.def(_,"$racc_next_state",pe=function($,p){var t=this;return t.racc_debug_out.$puts("goto    "+$),t.$racc_print_states(p),t.racc_debug_out.$puts()},pe.$$arity=2),e.def(_,"$racc_print_stacks",be=function($,p){var t,l=r;return(l=this.racc_debug_out).$print("        ["),q($,"each_index",[],((t=function(Z){return null==Z&&(Z=r),l.$print(" (",(null==t.$$s?this:t.$$s).$racc_token2str($["$[]"](Z))," ",p["$[]"](Z).$inspect(),")")}).$$s=this,t.$$arity=1,t)),l.$puts(" ]")},be.$$arity=2),e.def(_,"$racc_print_states",ke=function($){var p,b=r;return(b=this.racc_debug_out).$print("        ["),q($,"each",[],((p=function(f){return null==f&&(f=r),b.$print(" ",f)}).$$s=this,p.$$arity=1,p)),b.$puts(" ]")},ke.$$arity=1),e.def(_,"$racc_token2str",Se=function($){var t;return i(t=E(this.$class(),"Racc_token_to_s_table")["$[]"]($))?t:this.$raise("[Racc Bug] can't convert token "+$+" to string")},Se.$$arity=1),e.def(_,"$token_to_str",Re=function($){return E(this.$class(),"Racc_token_to_s_table")["$[]"]($)},Re.$$arity=1)}(M[0],M)},Opal.modules.strscan=function(e){var E,re,i,A,q,x,d,g,P,w,C,o,B,_,v,h,m,k,y,S,N,H,L,J,$e,se,u,O,s=[],a=e.nil,z=e.$$,j=e.truthy,W=e.send;return E=s,u=(0,e.klass)(s[0],null,"StringScanner"),O=[u].concat(E),u.$$prototype.pos=u.$$prototype.string=u.$$prototype.working=u.$$prototype.matched=u.$$prototype.prev_pos=u.$$prototype.match=a,u.$attr_reader("pos"),u.$attr_reader("matched"),e.def(u,"$initialize",re=function(n){var c=this;return c.string=n,c.pos=0,c.matched=a,c.working=n,c.match=[]},re.$$arity=1),u.$attr_reader("string"),e.def(u,"$beginning_of_line?",i=function(){var n=this;return 0===n.pos||"\n"===n.string.charAt(n.pos-1)},i.$$arity=0),e.alias(u,"bol?","beginning_of_line?"),e.def(u,"$scan",A=function(n){var c=this,R=(n=c.$anchor(n)).exec(c.working);return null==R?c.matched=a:"object"==typeof R?(c.prev_pos=c.pos,c.pos+=R[0].length,c.working=c.working.substring(R[0].length),c.matched=R[0],c.match=R,R[0]):"string"==typeof R?(c.pos+=R.length,c.working=c.working.substring(R.length),R):a},A.$$arity=1),e.def(u,"$scan_until",q=function(n){var c=this;n=c.$anchor(n);for(var ce,R=c.pos,V=c.working;;){if(ce=n.exec(V),R+=1,V=V.substr(1),null!=ce)return c.matched=c.string.substr(c.pos,R-c.pos-1+ce[0].length),c.match=ce,c.prev_pos=R-1,c.pos=R,c.working=V.substr(ce[0].length),c.matched;if(0===V.length)return c.match=[],c.matched=a}},q.$$arity=1),e.def(u,"$[]",x=function(n){var R;if(j(this.match["$empty?"]()))return a;R=n,z(O,"Symbol")["$==="](R)?n=n.$to_s():z(O,"String")["$==="](R)||(n=z(O,"Opal")["$coerce_to!"](n,z(O,"Integer"),"to_int"));var V=this.match;return n<0&&(n+=V.length),n<0||n>=V.length||null==V[n]?a:V[n]},x.$$arity=1),e.def(u,"$check",d=function(n){var c=this,R=(n=c.$anchor(n)).exec(c.working);return c.matched=null==R?a:R[0]},d.$$arity=1),e.def(u,"$check_until",g=function(n){var c=this,R=c.prev_pos,V=c.pos,ce=c.$scan_until(n);return ce!==a&&(c.matched=ce.substr(-1),c.working=c.string.substr(V)),c.prev_pos=R,c.pos=V,ce},g.$$arity=1),e.def(u,"$peek",P=function(n){return this.working.substring(0,n)},P.$$arity=1),e.def(u,"$eos?",w=function(){return 0===this.working.length},w.$$arity=0),e.def(u,"$exist?",C=function(n){var R=n.exec(this.working);return null==R?a:0==R.index?0:R.index+1},C.$$arity=1),e.def(u,"$skip",o=function(n){var c=this,R=(n=c.$anchor(n)).exec(c.working);if(null==R)return c.match=[],c.matched=a;var V=R[0],ce=V.length;return c.matched=V,c.match=R,c.prev_pos=c.pos,c.pos+=ce,c.working=c.working.substring(ce),ce},o.$$arity=1),e.def(u,"$skip_until",B=function(n){var R=this.$scan_until(n);return R===a?a:(this.matched=R.substr(-1),R.length)},B.$$arity=1),e.def(u,"$get_byte",_=function(){var n=this,c=a;return n.pos<n.string.length?(n.prev_pos=n.pos,n.pos+=1,c=n.matched=n.working.substring(0,1),n.working=n.working.substring(1)):n.matched=a,c},_.$$arity=0),e.alias(u,"getch","get_byte"),e.def(u,"$match?",v=function(n){var c=this,R=(n=c.$anchor(n)).exec(c.working);return null==R?a:(c.prev_pos=c.pos,R[0].length)},v.$$arity=1),e.def(u,"$pos=",h=function(n){var c=this;return n<0&&(n+=c.string.$length()),c.pos=n,c.working=c.string.slice(n)},h.$$arity=1),e.def(u,"$matched_size",m=function(){return this.matched===a?a:this.matched.length},m.$$arity=0),e.def(u,"$post_match",k=function(){var n=this;return n.matched===a?a:n.string.substr(n.pos)},k.$$arity=0),e.def(u,"$pre_match",y=function(){var n=this;return n.matched===a?a:n.string.substr(0,n.prev_pos)},y.$$arity=0),e.def(u,"$reset",S=function(){var n=this;return n.working=n.string,n.matched=a,n.pos=0},S.$$arity=0),e.def(u,"$rest",N=function(){return this.working},N.$$arity=0),e.def(u,"$rest?",H=function(){return 0!==this.working.length},H.$$arity=0),e.def(u,"$rest_size",L=function(){return this.$rest().$size()},L.$$arity=0),e.def(u,"$terminate",J=function(){var c,M,n=this;return n.match=a,c=[n.string.$length()],W(n,"pos=",e.to_a(c)),c[(M=c.length,"number"==typeof M?M-1:M["$-"](1))]},J.$$arity=0),e.def(u,"$unscan",$e=function(){var n=this;return n.pos=n.prev_pos,n.prev_pos=a,n.match=a,n},$e.$$arity=0),u.$private(),e.def(u,"$anchor",se=function(n){var R=n.toString().match(/\/([^\/]+)$/);return R=R?R[1]:void 0,new RegExp("^(?:"+n.source+")",R)},se.$$arity=1),a&&"anchor"},Opal.modules["bcdice/normalize"]=function(e){var E,re,i,u,j,M,Q=[],s=e.nil,z=e.module;return j=Q,E=M=[z(Q[0],"BCDice")].concat(j),[u=z(M[0],"Normalize")].concat(E),u.$module_function(),e.def(u,"$comparison_operator",re=function(q){var d;return/<=|=</["$==="](d=q)?"<=":/>=|=>/["$==="](d)?">=":/<>|!=|=!/["$==="](d)?"!=":/</["$==="](d)?"<":/>/["$==="](d)?">":/=/["$==="](d)?"==":s},re.$$arity=1),void e.def(u,"$target_number",i=function(q){return q["$=="]("?")?q:q.$to_i()},i.$$arity=1)},Opal.modules["bcdice/common_command/lexer"]=function(e){var r,re,d,w,C,o,g,P,A,u,Y=e.top,Q=[],s=e.nil,G=e.$$,z=e.module,U=e.klass,j=e.hash2,W=e.truthy;return Y.$require("strscan"),Y.$require("bcdice/normalize"),r=Q,re=u=[z(Q[0],"BCDice")].concat(r),d=A=[z(u[0],"CommonCommand")].concat(re),g=U(A[0],null,"Lexer"),P=[g].concat(d),g.$$prototype.scanner=s,e.const_set(P[0],"SYMBOLS",j(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),e.def(g,"$initialize",w=function(_){var h;return _=W(h=_.$split(" ",2).$first())?h:"",this.scanner=G(P,"StringScanner").$new(_)},w.$$arity=1),e.def(g,"$next_token",C=function(){var _=this,v=s,h=s,m=s,y=s;return W(_.scanner["$eos?"]())?[!1,"$"]:W(v=_.scanner.$scan(/\d+/))?["NUMBER",v.$to_i()]:W(h=_.scanner.$scan(/[<>!=]+/))?["CMP_OP",G(P,"Normalize").$comparison_operator(h)]:(m=_.scanner.$getch().$upcase(),[W(y=G(P,"SYMBOLS")["$[]"](m))?y:m.$to_sym(),m])},C.$$arity=0),void e.def(g,"$source",o=function(){return this.scanner.$string()},o.$$arity=0)},Opal.modules["bcdice/arithmetic/parser"]=function(e){var M,O,x,P,w,C,o,B,_,v,h,m,k,y,S,N,H,L,J,$e,se,I,n,c,R,V,ce,ye,me,ke,d,g,i,E,Y=e.top,Q=[],s=e.nil,a=e.$$$,G=e.$$,z=e.module,U=e.klass,j=e.hash;return Y.$require("racc/parser.rb"),Y.$require("bcdice/common_command/lexer"),Y.$require("bcdice/arithmetic/node"),M=Q,O=E=[z(Q[0],"BCDice")].concat(M),x=i=[z(E[0],"Arithmetic")].concat(O),d=U(i[0],a(G(i,"Racc"),"Parser"),"Parser"),g=[d].concat(x),d.$$prototype.lexer=s,e.defs(d,"$parse",P=function($){return this.$new().$parse($)},P.$$arity=1),e.def(d,"$parse",w=function($){try{return this.lexer=a(a(G(g,"BCDice"),"CommonCommand"),"Lexer").$new($),this.$do_parse()}catch(t){if(!e.rescue(t,[G(g,"ParseError")]))throw t;try{return s}finally{e.pop_exception()}}},w.$$arity=1),d.$private(),e.def(d,"$next_token",C=function(){return this.lexer.$next_token()},C.$$arity=0),se=[8,17,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,s,s,4,5,4,5,7,9,7,s,s,10,11,s,10,11,22,26,24,25,27],I=[0,9,4,2,2,0,0,4,4,0,5,4,7,18,18,5,5,7,7,5,10,7,11,19,19,10,10,11,11,10,12,11,13,s,s,12,12,13,13,12,1,13,s,s,16,16,s,1,1,16,21,21,21,21],n=[-2,40,-6,s,0,8,s,10,s,1,18,20,28,30,s,s,37,s,4,14,s,47,s,s,s,s,s,s],c=[-17,-17,-3,-6,-17,-17,-14,-17,-16,-17,-17,-17,-17,-17,-12,-13,-17,28,-1,-2,-4,-7,-15,-5,-8,-9,-10,-11],R=[14,15,23,1,18,19,s,s,20,21,16],V=[3,3,4,1,2,2,s,s,3,3,1],ce=[s,3,-6,-4,-19,s],ye=[s,s,2,3,s,6],me=[0,0,"racc_error",3,14,"_reduce_1",3,14,"_reduce_2",1,14,"_reduce_none",3,15,"_reduce_4",4,15,"_reduce_5",1,15,"_reduce_none",0,17,"_reduce_7",1,17,"_reduce_8",1,17,"_reduce_9",1,17,"_reduce_10",1,17,"_reduce_11",2,16,"_reduce_12",2,16,"_reduce_13",1,16,"_reduce_none",3,18,"_reduce_15",1,18,"_reduce_16"],ke=j(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12),e.const_set(g[0],"Racc_arg",[se,I,c,n,R,V,ye,ce,13,me,ke,28,17,!0]),e.const_set(g[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","add","mul","unary","round_type","term"]),e.const_set(g[0],"Racc_debug_parser",!1),e.def(d,"$_reduce_1",o=function($,p,t){return a(a(G(g,"Arithmetic"),"Node"),"BinaryOp").$new($["$[]"](0),"+",$["$[]"](2))},o.$$arity=3),e.def(d,"$_reduce_2",B=function($,p,t){return a(a(G(g,"Arithmetic"),"Node"),"BinaryOp").$new($["$[]"](0),"-",$["$[]"](2))},B.$$arity=3),e.def(d,"$_reduce_4",_=function($,p,t){return a(a(G(g,"Arithmetic"),"Node"),"BinaryOp").$new($["$[]"](0),"*",$["$[]"](2))},_.$$arity=3),e.def(d,"$_reduce_5",v=function($,p,t){return $["$[]"](3).$new($["$[]"](0),$["$[]"](2))},v.$$arity=3),e.def(d,"$_reduce_7",h=function($,p,t){return a(a(G(g,"Arithmetic"),"Node"),"DivideWithGameSystemDefault")},h.$$arity=3),e.def(d,"$_reduce_8",m=function($,p,t){return a(a(G(g,"Arithmetic"),"Node"),"DivideWithCeil")},m.$$arity=3),e.def(d,"$_reduce_9",k=function($,p,t){return a(a(G(g,"Arithmetic"),"Node"),"DivideWithCeil")},k.$$arity=3),e.def(d,"$_reduce_10",y=function($,p,t){return a(a(G(g,"Arithmetic"),"Node"),"DivideWithRound")},y.$$arity=3),e.def(d,"$_reduce_11",S=function($,p,t){return a(a(G(g,"Arithmetic"),"Node"),"DivideWithFloor")},S.$$arity=3),e.def(d,"$_reduce_12",N=function($,p,t){return $["$[]"](1)},N.$$arity=3),e.def(d,"$_reduce_13",H=function($,p,t){return a(a(G(g,"Arithmetic"),"Node"),"Negative").$new($["$[]"](1))},H.$$arity=3),e.def(d,"$_reduce_15",L=function($,p,t){return $["$[]"](1)},L.$$arity=3),e.def(d,"$_reduce_16",J=function($,p,t){return a(a(G(g,"Arithmetic"),"Node"),"Number").$new($["$[]"](0))},J.$$arity=3),void e.def(d,"$_reduce_none",$e=function($,p,t){return $["$[]"](0)},$e.$$arity=3)},Opal.modules["bcdice/arithmetic"]=function(e){var W,u,i,x,q,O,re,r,Y=e.top,Q=[],s=e.nil,G=e.$$,z=e.module,U=e.send;return Y.$require("bcdice/arithmetic/node"),Y.$require("bcdice/arithmetic/parser"),W=Q,u=r=[z(Q[0],"BCDice")].concat(W),re=[O=z(r[0],"Arithmetic")].concat(u),i=e.get_singleton_class(O),q=[i].concat(re),void e.def(i,"$eval",x=function(g,P){var w;try{return(w=G(q,"Parser").$parse(g))===s||null==w?s:U(w,"eval",[P])}catch(B){if(!e.rescue(B,[G(q,"ZeroDivisionError")]))throw B;try{return s}finally{e.pop_exception()}}},x.$$arity=2)},function(e){function Q(i,A){return"number"==typeof i&&"number"==typeof A?i>=A:i["$>="](A)}function s(i,A){return"number"==typeof i&&"number"==typeof A?i+A:i["$+"](A)}var A,g,B,h,m,k,_,v,w,x,G=e.top,z=[],U=e.nil,j=e.$$$,W=e.$$,M=e.module,r=e.klass,E=e.send2,u=e.truthy,O=e.send,re=e.hash2;G.$require("bcdice/dice_table/table"),G.$require("bcdice/dice_table/d66_grid_table"),G.$require("bcdice/arithmetic"),A=z,g=x=[M(z[0],"BCDice")].concat(A),B=w=[M(x[0],"GameSystem")].concat(g),_=r(w[0],W(w,"Base"),"AngelGear"),v=[_].concat(B),_.$$prototype.randomizer=U,e.const_set(v[0],"ID","AngelGear"),e.const_set(v[0],"NAME","\u30a8\u30f3\u30bc\u30eb\u30ae\u30a2 \u5929\u4f7f\u5927\u6226TRPG The 2nd Editon"),e.const_set(v[0],"SORT_KEY","\u3048\u3093\u305b\u308b\u304d\u30422"),e.const_set(v[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\u3000nAG[s][\xb1a]\n[]\u5185\u306f\u7701\u7565\u53ef\u80fd\u3002\nn:\u5224\u5b9a\u5024\ns:\u6280\u80fd\u5024\na:\u4fee\u6b63\n\uff08\u4f8b\uff09\n12AG 10AG3\xb120\n\n\u30fb\u611f\u60c5\u8868\u3000ET\n"),e.def(_,"$initialize",h=function(S){var L=this;return h.$$p&&(h.$$p=null),E(L,e.find_super_dispatcher(L,"initialize",h,!1,!0),"initialize",[S],null),L.sort_barabara_dice=!0},h.$$arity=1),e.def(_,"$eval_game_system_specific_command",m=function(S){var N,L=U;return u(L=/^(\d+)AG(\d+)?(([+\-]\d+)*)$/.$match(S))?this.$resolute_action(L["$[]"](1).$to_i(),(N=L["$[]"](2))===U||null==N?U:O(N,"to_i",[]),L["$[]"](3),S):this.$roll_tables(S,W(v,"TABLES"))},m.$$arity=1),e.def(_,"$resolute_action",k=function(S,N,H,L){var J,I,V,se=U,n=U,c=U,R=U;return I=(se=this.randomizer.$roll_barabara(S,6).$sort()).$join(","),n=0,c=0,u(N)&&(c=O(se,"count",[],((J=function(ye){return null==ye&&(ye=U),function(i,A){return"number"==typeof i&&"number"==typeof A?i<=A:i["$<="](A)}(ye,N)}).$$s=this,J.$$arity=1,J)),u(H["$empty?"]())||(n=W(v,"Arithmetic").$eval(H,j(W(v,"RoundType"),"FLOOR")))),u(Q(s(c,n),100))&&(R="(\u798f\u97f3\u767a\u751f)"),V="("+L+") \uff1e "+c+"["+I+"]"+this.$format("%+d",n)+" \uff1e \u6210\u529f\u6570: "+s(c,n)+R,u(Q(s(c,n),100))?W(v,"Result").$critical(V):function(i,A){return"number"==typeof A?0<A:(0)["$<"](A)}(0,s(c,n))?W(v,"Result").$success(V):W(v,"Result").$failure(V)},k.$$arity=4),e.const_set(v[0],"TABLES",re(["ET"],{ET:j(W(v,"DiceTable"),"D66GridTable").$new("\u611f\u60c5\u8868",[["\u597d\u5947\u5fc3\uff08\u597d\u5947\u5fc3\uff09","\u61a7\u308c\uff08\u3042\u3053\u304c\u308c\uff09","\u5c0a\u656c\uff08\u305d\u3093\u3051\u3044\uff09","\u4ef2\u9593\u610f\u8b58\uff08\u306a\u304b\u307e\u3044\u3057\u304d\uff09","\u6bcd\u6027\u611b\uff08\u307c\u305b\u3044\u3042\u3044\uff09","\u611f\u5fc3\uff08\u304b\u3093\u3057\u3093\uff09"],["\u7d14\u611b\uff08\u3058\u3085\u3093\u3042\u3044\uff09","\u53cb\u60c5\uff08\u3086\u3046\u3058\u3087\u3046\uff09","\u540c\u60c5\uff08\u3069\u3046\u3058\u3087\u3046\uff09","\u7236\u6027\u611b\uff08\u3075\u305b\u3044\u3042\u3044\uff09","\u5e78\u798f\u611f\uff08\u3053\u3046\u3075\u304f\u304b\u3093\uff09","\u4fe1\u983c\uff08\u3057\u3093\u3089\u3044\uff09"],["\u7af6\u4e89\u5fc3\uff08\u304d\u3087\u3046\u305d\u3046\u3057\u3093\uff09","\u89aa\u8fd1\u611f\uff08\u3057\u3093\u304d\u3093\u304b\u3093\uff09","\u307e\u3054\u3053\u308d","\u597d\u610f\uff08\u3053\u3046\u3044\uff09","\u6709\u70ba\uff08\u3086\u3046\u3044\uff09","\u5d07\u62dd\uff08\u3059\u3046\u306f\u3044\uff09"],["\u5927\u5acc\u3044\uff08\u3060\u3044\u304d\u3089\u3044\uff09","\u59ac\u307f\uff08\u306d\u305f\u307f\uff09","\u4fae\u8511\uff08\u3076\u3079\u3064\uff09","\u8150\u308c\u7e01\uff08\u304f\u3055\u308c\u3048\u3093\uff09","\u6050\u6016\uff08\u304d\u3087\u3046\u3075\uff09","\u52a3\u7b49\u611f\uff08\u308c\u3063\u3068\u3046\u304b\u3093\uff09"],["\u504f\u611b\uff08\u3078\u3093\u3042\u3044\uff09","\u5bc2\u3057\u3055\uff08\u3055\u3073\u3057\u3055\uff09","\u6190\u61ab\uff08\u308c\u3093\u3073\u3093\uff09","\u95d8\u4e89\u5fc3\uff08\u3068\u3046\u305d\u3046\u3057\u3093\uff09","\u98df\u50b7\uff08\u3057\u3087\u304f\u3057\u3087\u3046\uff09","\u5618\u3064\u304d\uff08\u3046\u305d\u3064\u304d\uff09"],["\u7518\u3048\uff08\u3042\u307e\u3048\uff09","\u82db\u7acb\u3061\uff08\u3044\u3089\u3060\u3061\uff09","\u4e0b\u5fc3\uff08\u3057\u305f\u3054\u3053\u308d\uff09","\u618e\u60aa\uff08\u305e\u3046\u304a\uff09","\u7591\u60d1\uff08\u304e\u308f\u304f\uff09","\u652f\u914d\uff08\u3057\u306f\u3044\uff09"]])}).$freeze()),_.$register_prefix("\\d+AG",W(v,"TABLES").$keys())}(Opal)}}]);